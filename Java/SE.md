# SE

## åŸºç¡€

### æ•°æ®

#### å˜é‡ç±»å‹

|          |    æˆå‘˜å˜é‡    |       å±€éƒ¨å˜é‡       |          é™æ€å˜é‡           |
| :------: | :------------: | :------------------: | :-------------------------: |
| å®šä¹‰ä½ç½® | åœ¨ç±»ä¸­ï¼Œæ–¹æ³•å¤– | æ–¹æ³•ä¸­æˆ–è€…æ–¹æ³•çš„å½¢å‚ |       åœ¨ç±»ä¸­ï¼Œæ–¹æ³•å¤–        |
| åˆå§‹åŒ–å€¼ | æœ‰é»˜è®¤åˆå§‹åŒ–å€¼ |  æ— ï¼Œèµ‹å€¼åæ‰èƒ½ä½¿ç”¨  |       æœ‰é»˜è®¤åˆå§‹åŒ–å€¼        |
| è°ƒç”¨æ–¹æ³• |    å¯¹è±¡è°ƒç”¨    |                      |     å¯¹è±¡è°ƒç”¨ï¼Œç±»åè°ƒç”¨      |
| å­˜å‚¨ä½ç½® |      å †ä¸­      |         æ ˆä¸­         | æ–¹æ³•åŒºï¼ˆJDK8 ä»¥åç§»åˆ°å †ä¸­ï¼‰ |
| ç”Ÿå‘½å‘¨æœŸ |  ä¸å¯¹è±¡å…±å­˜äº¡  |     ä¸æ–¹æ³•å…±å­˜äº¡     |         ä¸ç±»å…±å­˜äº¡          |
|   åˆ«å   |    å®ä¾‹å˜é‡    |                      |    ç±»å˜é‡ï¼Œé™æ€æˆå‘˜å˜é‡     |

é™æ€å˜é‡åªæœ‰ä¸€ä¸ªï¼Œæˆå‘˜å˜é‡æ˜¯ç±»ä¸­çš„å˜é‡ï¼Œå±€éƒ¨å˜é‡æ˜¯æ–¹æ³•ä¸­çš„å˜é‡

åˆå­¦æ—¶ç¬”è®°å†…å®¹å‚è€ƒè§†é¢‘ï¼šhttps://www.bilibili.com/video/BV1TE41177mPï¼Œéšç€å­¦ä¹ çš„æ·±å…¥åˆå¢åŠ å¾ˆå¤šçŸ¥è¯†

***

#### æ•°æ®ç±»å‹

##### åŸºæœ¬ç±»å‹

Java è¯­è¨€æä¾›äº†å…«ç§åŸºæœ¬ç±»å‹ã€‚å…­ç§æ•°å­—ç±»å‹ï¼ˆå››ä¸ªæ•´æ•°å‹ï¼Œä¸¤ä¸ªæµ®ç‚¹å‹ï¼‰ï¼Œä¸€ç§å­—ç¬¦ç±»å‹ï¼Œè¿˜æœ‰ä¸€ç§å¸ƒå°”å‹

**byteï¼š**

- byte æ•°æ®ç±»å‹æ˜¯ 8 ä½ã€æœ‰ç¬¦å·çš„ï¼Œä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•°ï¼Œ**8 ä½ä¸€ä¸ªå­—èŠ‚**ï¼Œé¦–ä½æ˜¯ç¬¦å·ä½
- æœ€å°å€¼æ˜¯ -128ï¼ˆ-2^7ï¼‰ã€æœ€å¤§å€¼æ˜¯ 127ï¼ˆ2^7-1ï¼‰
- é»˜è®¤å€¼æ˜¯ `0`
- byte ç±»å‹ç”¨åœ¨å¤§å‹æ•°ç»„ä¸­èŠ‚çº¦ç©ºé—´ï¼Œä¸»è¦ä»£æ›¿æ•´æ•°ï¼Œbyte å˜é‡å ç”¨çš„ç©ºé—´åªæœ‰ int ç±»å‹çš„å››åˆ†ä¹‹ä¸€
- ä¾‹å­ï¼š`byte a = 100ï¼Œbyte b = -50`

**shortï¼š**

- short æ•°æ®ç±»å‹æ˜¯ 16 ä½ã€æœ‰ç¬¦å·çš„ä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•°
- æœ€å°å€¼æ˜¯ -32768ï¼ˆ-2^15ï¼‰ã€æœ€å¤§å€¼æ˜¯ 32767ï¼ˆ2^15 - 1ï¼‰
- short æ•°æ®ç±»å‹ä¹Ÿå¯ä»¥åƒ byte é‚£æ ·èŠ‚çœç©ºé—´ï¼Œä¸€ä¸ª short å˜é‡æ˜¯ int å‹å˜é‡æ‰€å ç©ºé—´çš„äºŒåˆ†ä¹‹ä¸€
- é»˜è®¤å€¼æ˜¯ `0`
- ä¾‹å­ï¼š`short s = 1000ï¼Œshort r = -20000`

**intï¼š**

- int æ•°æ®ç±»å‹æ˜¯ 32 ä½ 4 å­—èŠ‚ã€æœ‰ç¬¦å·çš„ä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•°
- æœ€å°å€¼æ˜¯ -2,147,483,648ï¼ˆ-2^31ï¼‰ã€æœ€å¤§å€¼æ˜¯ 2,147,483,647ï¼ˆ2^31 - 1ï¼‰
- ä¸€èˆ¬åœ°æ•´å‹å˜é‡é»˜è®¤ä¸º int ç±»å‹
- é»˜è®¤å€¼æ˜¯ `0`
- ä¾‹å­ï¼š`int a = 100000, int b = -200000`

**longï¼š**

- long æ•°æ®ç±»å‹æ˜¯ 64 ä½ 8 å­—èŠ‚ã€æœ‰ç¬¦å·çš„ä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•°
- æœ€å°å€¼æ˜¯ -9,223,372,036,854,775,808ï¼ˆ-2^63ï¼‰ã€æœ€å¤§å€¼æ˜¯ 9,223,372,036,854,775,807ï¼ˆ2^63 -1ï¼‰
- è¿™ç§ç±»å‹ä¸»è¦ä½¿ç”¨åœ¨éœ€è¦æ¯”è¾ƒå¤§æ•´æ•°çš„ç³»ç»Ÿä¸Š
- é»˜è®¤å€¼æ˜¯ ` 0L`
- ä¾‹å­ï¼š `long a = 100000Lï¼ŒLong b = -200000L`ï¼ŒL ç†è®ºä¸Šä¸åˆ†å¤§å°å†™ï¼Œä½†æ˜¯è‹¥å†™æˆ I å®¹æ˜“ä¸æ•°å­— 1 æ··æ·†ï¼Œä¸å®¹æ˜“åˆ†è¾©

**floatï¼š**

- float æ•°æ®ç±»å‹æ˜¯å•ç²¾åº¦ã€32 ä½ã€ç¬¦åˆ IEEE 754 æ ‡å‡†çš„æµ®ç‚¹æ•°
- float åœ¨å‚¨å­˜å¤§å‹æµ®ç‚¹æ•°ç»„çš„æ—¶å€™å¯èŠ‚çœå†…å­˜ç©ºé—´
- é»˜è®¤å€¼æ˜¯ `0.0f`
- æµ®ç‚¹æ•°ä¸èƒ½ç”¨æ¥è¡¨ç¤ºç²¾ç¡®çš„å€¼ï¼Œå¦‚è´§å¸
- ä¾‹å­ï¼š`float f1 = 234.5F`

**doubleï¼š**

- double æ•°æ®ç±»å‹æ˜¯åŒç²¾åº¦ã€64 ä½ã€ç¬¦åˆ IEEE 754 æ ‡å‡†çš„æµ®ç‚¹æ•°
- æµ®ç‚¹æ•°çš„é»˜è®¤ç±»å‹ä¸º double ç±»å‹
- double ç±»å‹åŒæ ·ä¸èƒ½è¡¨ç¤ºç²¾ç¡®çš„å€¼ï¼Œå¦‚è´§å¸
- é»˜è®¤å€¼æ˜¯ `0.0d`
- ä¾‹å­ï¼š`double d1 = 123.4`

**booleanï¼š**

- boolean æ•°æ®ç±»å‹è¡¨ç¤ºä¸€ä½çš„ä¿¡æ¯
- åªæœ‰ä¸¤ä¸ªå–å€¼ï¼štrue å’Œ false
- JVM è§„èŒƒæŒ‡å‡º boolean å½“åš int å¤„ç†ï¼Œboolean æ•°ç»„å½“åš byte æ•°ç»„å¤„ç†ï¼Œè¿™æ ·å¯ä»¥å¾—å‡º boolean ç±»å‹å•ç‹¬ä½¿ç”¨å äº† 4 ä¸ªå­—èŠ‚ï¼Œåœ¨æ•°ç»„ä¸­æ˜¯ 1 ä¸ªå­—èŠ‚
- é»˜è®¤å€¼æ˜¯ `false`
- ä¾‹å­ï¼š`boolean one = true`

**charï¼š**

- char ç±»å‹æ˜¯ä¸€ä¸ªå•ä¸€çš„ 16 ä½**ä¸¤ä¸ªå­—èŠ‚**çš„ Unicode å­—ç¬¦
- æœ€å°å€¼æ˜¯ `\u0000`ï¼ˆå³ä¸º 0ï¼‰
- æœ€å¤§å€¼æ˜¯ `\uffff`ï¼ˆå³ä¸º 65535ï¼‰
- char æ•°æ®ç±»å‹å¯ä»¥**å­˜å‚¨ä»»ä½•å­—ç¬¦**
- ä¾‹å­ï¼š`char c = 'A'`ï¼Œ`char c = 'å¼ '`



****



##### ä¸Šä¸‹è½¬å‹

* float ä¸ doubleï¼š

  Java ä¸èƒ½éšå¼æ‰§è¡Œ**å‘ä¸‹è½¬å‹**ï¼Œå› ä¸ºè¿™ä¼šä½¿å¾—ç²¾åº¦é™ä½ï¼Œä½†æ˜¯å¯ä»¥å‘ä¸Šè½¬å‹

  ```java
  //1.1å­—é¢é‡å±äºdoubleç±»å‹ï¼Œä¸èƒ½ç›´æ¥å°†1.1ç›´æ¥èµ‹å€¼ç»™ float å˜é‡ï¼Œå› ä¸ºè¿™æ˜¯å‘ä¸‹è½¬å‹
  float f = 1.1;//æŠ¥é”™
  //1.1f å­—é¢é‡æ‰æ˜¯ float ç±»å‹
  float f = 1.1f;
  ```

  ```java
  float f1 = 1.234f;
  double d1 = f1;
  
  double d2 = 1.23;
  float f2 = (float) d2;//å‘ä¸‹è½¬å‹éœ€è¦å¼ºè½¬
  ```

  ```java
  int i1 = 1245;
  long l1 = i1;
  
  long l2 = 1234;
  int i2 = (int) l2;
  ```

* éšå¼ç±»å‹è½¬æ¢ï¼š

  å­—é¢é‡ 1 æ˜¯ int ç±»å‹ï¼Œæ¯” short ç±»å‹ç²¾åº¦è¦é«˜ï¼Œå› æ­¤ä¸èƒ½éšå¼åœ°å°† int ç±»å‹å‘ä¸‹è½¬å‹ä¸º short ç±»å‹

  ä½¿ç”¨ += æˆ–è€… ++ è¿ç®—ç¬¦ä¼šæ‰§è¡Œç±»å‹è½¬æ¢ï¼š

  ```java
  short s1 = 1;
  s1 += 1;	//s1++;
  //ä¸Šé¢çš„è¯­å¥ç›¸å½“äºå°† s1 + 1 çš„è®¡ç®—ç»“æœè¿›è¡Œäº†å‘ä¸‹è½¬å‹
  s1 = (short) (s1 + 1);
  ```
  
  



***



##### å¼•ç”¨ç±»å‹

å¼•ç”¨æ•°æ®ç±»å‹ï¼šç±»ï¼Œæ¥å£ï¼Œæ•°ç»„éƒ½æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆå«åŒ…è£…ç±»

åŒ…è£…ç±»çš„ä½œç”¨ï¼š

* åŒ…è£…ç±»ä½œä¸ºç±»é¦–å…ˆæ‹¥æœ‰äº† Object ç±»çš„æ–¹æ³•
* åŒ…è£…ç±»ä½œä¸ºå¼•ç”¨ç±»å‹çš„å˜é‡å¯ä»¥**å­˜å‚¨ null å€¼**


```java
åŸºæœ¬æ•°æ®ç±»å‹                åŒ…è£…ç±»ï¼ˆå¼•ç”¨æ•°æ®ç±»å‹ï¼‰
byte                      Byte
short                     Short
int                       Integer
long                      Long

float                     Float
double                    Double
char                      Character
boolean                   Boolean
```
Java ä¸ºåŒ…è£…ç±»åšäº†ä¸€äº›ç‰¹æ®ŠåŠŸèƒ½ï¼Œå…·ä½“æ¥çœ‹ç‰¹æ®ŠåŠŸèƒ½ä¸»è¦æœ‰ï¼š

* å¯ä»¥æŠŠåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹çš„å€¼
  1. è°ƒç”¨ toString() æ–¹æ³•
  2. è°ƒç”¨ Integer.toString(åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼) å¾—åˆ°å­—ç¬¦ä¸²
  3. ç›´æ¥æŠŠåŸºæœ¬æ•°æ®ç±»å‹ + ç©ºå­—ç¬¦ä¸²å°±å¾—åˆ°äº†å­—ç¬¦ä¸²ï¼ˆæ¨èä½¿ç”¨ï¼‰

* æŠŠå­—ç¬¦ä¸²ç±»å‹çš„æ•°å€¼è½¬æ¢æˆå¯¹åº”çš„åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ï¼ˆ**é‡è¦**ï¼‰

  1. Xxx.parseXxx("å­—ç¬¦ä¸²ç±»å‹çš„æ•°å€¼") â†’ `Integer.parseInt(numStr)`
  2. Xxx.valueOf("å­—ç¬¦ä¸²ç±»å‹çš„æ•°å€¼")   â†’ `Integer.valueOf(numStr)` ï¼ˆæ¨èä½¿ç”¨ï¼‰

  ```java
  public class PackageClass02 {
      public static void main(String[] args) {
          // 1.æŠŠåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼è½¬æˆå­—ç¬¦ä¸²
          Integer it = 100 ;
          // a.è°ƒç”¨toString()æ–¹æ³•ã€‚
          String itStr = it.toString();
          System.out.println(itStr+1);//1001
          // b.è°ƒç”¨Integer.toString(åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼)å¾—åˆ°å­—ç¬¦ä¸²ã€‚
          String itStr1 = Integer.toString(it);
          System.out.println(itStr1+1);//1001
          // c.ç›´æ¥æŠŠåŸºæœ¬æ•°æ®ç±»å‹+ç©ºå­—ç¬¦ä¸²å°±å¾—åˆ°äº†å­—ç¬¦ä¸²ã€‚
          String itStr2 = it + "";
          System.out.println(itStr2+1);// 1001
  
          // 2.æŠŠå­—ç¬¦ä¸²ç±»å‹çš„æ•°å€¼è½¬æ¢æˆå¯¹åº”çš„åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼
          String numStr = "23";
          int numInt = Integer.valueOf(numStr);
          System.out.println(numInt+1);//24
  
          String doubleStr = "99.9";
          double doubleDb = Double.valueOf(doubleStr);
          System.out.println(doubleDb+0.1);//100.0
      }
  }
  ```

> ä»»ä½•ç±»å‹åœ¨å’ŒStringç›¸åŠ çš„æ—¶å€™ï¼Œéƒ½ä¼šå…ˆè½¬æ¢æˆStringã€‚
>
> æ•…`1System.out.println(itStr+1)`ä¼šå…ˆå°†`1`è½¬æ¢æˆ`"1"`ï¼Œæœ€ç»ˆå¾—åˆ°`1001`ã€‚


***



##### ç±»å‹å¯¹æ¯”

* æœ‰äº†åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å¼•ç”¨æ•°æ®ç±»å‹ï¼Ÿ

  > å¼•ç”¨æ•°æ®ç±»å‹å°è£…äº†æ•°æ®å’Œå¤„ç†è¯¥æ•°æ®çš„æ–¹æ³•ï¼Œæ¯”å¦‚ Integer.parseInt(String) å°±æ˜¯å°† String å­—ç¬¦ç±»å‹æ•°æ®è½¬æ¢ä¸º Integer æ•´å‹
  >
  > Java ä¸­å¤§éƒ¨åˆ†ç±»å’Œæ–¹æ³•éƒ½æ˜¯é’ˆå¯¹å¼•ç”¨æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬æ³›å‹å’Œé›†åˆ

* å¼•ç”¨æ•°æ®ç±»å‹é‚£ä¹ˆå¥½ï¼Œä¸ºä»€ä¹ˆè¿˜ç”¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Ÿ

  > å¼•ç”¨ç±»å‹çš„å¯¹è±¡è¦å¤šå‚¨å­˜å¯¹è±¡å¤´ï¼Œå¯¹åŸºæœ¬æ•°æ®ç±»å‹æ¥è¯´ç©ºé—´æµªè´¹ç‡å¤ªé«˜ã€‚é€»è¾‘ä¸Šæ¥è®²ï¼ŒJava åªæœ‰åŒ…è£…ç±»å°±å¤Ÿäº†ï¼Œä¸ºäº†è¿è¡Œé€Ÿåº¦ï¼Œéœ€è¦ç”¨åˆ°åŸºæœ¬æ•°æ®ç±»å‹ï¼›ä¼˜å…ˆè€ƒè™‘è¿è¡Œæ•ˆç‡çš„é—®é¢˜ï¼Œæ‰€ä»¥äºŒè€…åŒæ—¶å­˜åœ¨æ˜¯åˆä¹æƒ…ç†çš„

* Java é›†åˆä¸èƒ½å­˜æ”¾åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåªå­˜æ”¾å¯¹è±¡çš„å¼•ç”¨ï¼Ÿ

  > ä¸èƒ½æ”¾åŸºæœ¬æ•°æ®ç±»å‹æ˜¯å› ä¸ºä¸æ˜¯ Object çš„å­ç±»ã€‚æ³›å‹æ€æƒ³ï¼Œå¦‚æœä¸ç”¨æ³›å‹è¦å†™å¾ˆå¤šå‚æ•°ç±»å‹ä¸åŒçš„ä½†åŠŸèƒ½ç›¸åŒçš„å‡½æ•°ï¼ˆæ–¹æ³•é‡è½½ï¼‰

* ==

  > == æ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»å‹ï¼šæ¯”è¾ƒçš„æ˜¯å…·ä½“çš„å€¼
  > == æ¯”è¾ƒå¼•ç”¨æ•°æ®ç±»å‹ï¼šæ¯”è¾ƒçš„æ˜¯å¯¹è±¡åœ°å€å€¼



***



#### è£…ç®±æ‹†ç®±

**è‡ªåŠ¨è£…ç®±**ï¼šå¯ä»¥ç›´æ¥æŠŠåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼æˆ–è€…å˜é‡èµ‹å€¼ç»™åŒ…è£…ç±»

**è‡ªåŠ¨æ‹†ç®±**ï¼šå¯ä»¥æŠŠåŒ…è£…ç±»çš„å˜é‡ç›´æ¥èµ‹å€¼ç»™åŸºæœ¬æ•°æ®ç±»å‹

```java
public class PackegeClass {
    public static void main(String[] args) {
        int a = 12 ;
        Integer a1 = 12 ;  // è‡ªåŠ¨è£…ç®±
        Integer a2 = a ;   // è‡ªåŠ¨è£…ç®±
        Integer a3 = null; // å¼•ç”¨æ•°æ®ç±»å‹çš„é»˜è®¤å€¼å¯ä»¥ä¸ºnull

        Integer c = 100 ;
        int c1 = c ;      // è‡ªåŠ¨æ‹†ç®±

        Integer it = Integer.valueOf(12);  	// æ‰‹å·¥è£…ç®±ï¼
        // Integer it1 = new Integer(12); 	// æ‰‹å·¥è£…ç®±ï¼
        Integer it2 = 12;

        Integer it3 = 111 ;
        int it33 = it3.intValue(); // æ‰‹å·¥æ‹†ç®±
    }
}
```

**è‡ªåŠ¨è£…ç®±**åç¼–è¯‘ååº•å±‚è°ƒç”¨ `Integer.valueOf()` å®ç°ï¼Œæºç ï¼š

```java
public static Integer valueOf(int i) {
    if (i >= IntegerCache.low && i <= IntegerCache.high)
        // ã€ç¼“å­˜æ± ã€‘ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„
        return IntegerCache.cache[i + (-IntegerCache.low)];
    return new Integer(i);
}
```

è‡ªåŠ¨æ‹†ç®±è°ƒç”¨ `java.lang.Integer#intValue`ï¼Œæºç ï¼š

```java
public int intValue() {
    return value;
}
```



***



#### ç¼“å­˜æ± 

new Integer(123) ä¸ Integer.valueOf(123) çš„åŒºåˆ«åœ¨äºï¼š

- new Integer(123)ï¼šæ¯æ¬¡éƒ½ä¼šæ–°å»ºä¸€ä¸ªå¯¹è±¡

- Integer.valueOf(123)ï¼šä¼šä½¿ç”¨ç¼“å­˜æ± ä¸­çš„å¯¹è±¡ï¼Œå¤šæ¬¡è°ƒç”¨å–å¾—åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨

  ```java
  Integer x = new Integer(123);
  Integer y = new Integer(123);
  System.out.println(x == y);    // false
  Integer z = Integer.valueOf(123);
  Integer k = Integer.valueOf(123);
  System.out.println(z == k);   // true
  ```

valueOf() æ–¹æ³•çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å…ˆåˆ¤æ–­å€¼æ˜¯å¦åœ¨ç¼“å­˜æ± ä¸­ï¼Œå¦‚æœåœ¨çš„è¯å°±ç›´æ¥è¿”å›ç¼“å­˜æ± çš„å†…å®¹ã€‚ç¼–è¯‘å™¨ä¼šåœ¨è‡ªåŠ¨è£…ç®±è¿‡ç¨‹è°ƒç”¨ valueOf() æ–¹æ³•ï¼Œå› æ­¤å¤šä¸ªå€¼ç›¸åŒä¸”å€¼åœ¨ç¼“å­˜æ± èŒƒå›´å†…çš„ Integer å®ä¾‹ä½¿ç”¨è‡ªåŠ¨è£…ç®±æ¥åˆ›å»ºï¼Œé‚£ä¹ˆå°±ä¼šå¼•ç”¨ç›¸åŒçš„å¯¹è±¡

**åŸºæœ¬ç±»å‹å¯¹åº”çš„ç¼“å­˜æ± å¦‚ä¸‹ï¼š**

- Boolean values true and false
- all byte values
- Short values between -128 and 127
- Long values between -128 and 127
- Integer values between -128 and 127
- Character in the range \u0000 to \u007F (0 and 127)

åœ¨ jdk 1.8 æ‰€æœ‰çš„æ•°å€¼ç±»ç¼“å†²æ± ä¸­ï¼Œ**Integer çš„ç¼“å­˜æ±  IntegerCache å¾ˆç‰¹æ®Šï¼Œè¿™ä¸ªç¼“å†²æ± çš„ä¸‹ç•Œæ˜¯ -128ï¼Œä¸Šç•Œé»˜è®¤æ˜¯ 127**ï¼Œä½†æ˜¯ä¸Šç•Œæ˜¯å¯è°ƒçš„ï¼Œåœ¨å¯åŠ¨ JVM æ—¶é€šè¿‡ `AutoBoxCacheMax=<size>` æ¥æŒ‡å®šè¿™ä¸ªç¼“å†²æ± çš„å¤§å°ï¼Œè¯¥é€‰é¡¹åœ¨ JVM åˆå§‹åŒ–çš„æ—¶å€™ä¼šè®¾å®šä¸€ä¸ªåä¸º java.lang.IntegerCache.high ç³»ç»Ÿå±æ€§ï¼Œç„¶å IntegerCache åˆå§‹åŒ–çš„æ—¶å€™å°±ä¼šè¯»å–è¯¥ç³»ç»Ÿå±æ€§æ¥å†³å®šä¸Šç•Œ

```java
Integer x = 100;				// è‡ªåŠ¨è£…ç®±ï¼Œåº•å±‚è°ƒç”¨ Integer.valueOf(1)
Integer y = 100;
System.out.println(x == y);   	// true

Integer x = 1000;
Integer y = 1000;
System.out.println(x == y);   	// falseï¼Œå› ä¸ºç¼“å­˜æ± æœ€å¤§127

int x = 1000;
Integer y = 1000;
System.out.println(x == y);		// trueï¼Œå› ä¸º y ä¼šè°ƒç”¨ intValue ã€è‡ªåŠ¨æ‹†ç®±ã€‘è¿”å› int åŸå§‹å€¼è¿›è¡Œæ¯”è¾ƒ
```



***



#### è¾“å…¥æ•°æ®

è¯­æ³•ï¼š`Scanner sc = new Scanner(System.in)`

* next()ï¼šé‡åˆ°äº†ç©ºæ ¼ï¼Œå°±ä¸å†å½•å…¥æ•°æ®äº†ï¼Œç»“æŸæ ‡è®°ï¼šç©ºæ ¼ã€tab é”®
* nextLine()ï¼šå¯ä»¥å°†æ•°æ®å®Œæ•´çš„æ¥æ”¶è¿‡æ¥ï¼Œç»“æŸæ ‡è®°ï¼šå›è½¦æ¢è¡Œç¬¦

ä¸€èˆ¬ä½¿ç”¨ `sc.nextInt()` æˆ–è€… `sc.nextLine()` æ¥å—æ•´å‹å’Œå­—ç¬¦ä¸²ï¼Œç„¶åè½¬æˆéœ€è¦çš„æ•°æ®ç±»å‹

* Scannerï¼š`BufferedReader br = new BufferedReader(new InputStreamReader(System.in))`
* printï¼š`PrintStream.write()`

> ä½¿ç”¨å¼•ç”¨æ•°æ®ç±»å‹çš„API

```java
public static void main(String[] args) {
    Scanner sc = new Scanner(System.in);
    while (sc.hasNextLine()) {
        String msg = sc.nextLine();
    }
}
```





****



### æ•°ç»„

#### åˆå§‹åŒ–

æ•°ç»„å°±æ˜¯å­˜å‚¨æ•°æ®é•¿åº¦å›ºå®šçš„å®¹å™¨ï¼Œå­˜å‚¨å¤šä¸ªæ•°æ®çš„æ•°æ®ç±»å‹è¦ä¸€è‡´ï¼Œ**æ•°ç»„ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡**

åˆ›å»ºæ•°ç»„ï¼š

* æ•°æ®ç±»å‹[] æ•°ç»„åï¼š`int[] arr`  ï¼ˆå¸¸ç”¨ï¼‰
* æ•°æ®ç±»å‹ æ•°ç»„å[]ï¼š`int arr[]`

é™æ€åˆå§‹åŒ–ï¼š

* æ•°æ®ç±»å‹[] æ•°ç»„å = new æ•°æ®ç±»å‹[]{å…ƒç´ 1,å…ƒç´ 2,...}ï¼š`int[] arr = new int[]{11,22,33}`
* æ•°æ®ç±»å‹[] æ•°ç»„å = {å…ƒç´ 1,å…ƒç´ 2,...}ï¼š`int[] arr = {44,55,66}`

åŠ¨æ€åˆå§‹åŒ–

* æ•°æ®ç±»å‹[] æ•°ç»„å = new æ•°æ®ç±»å‹[æ•°ç»„é•¿åº¦]ï¼š`int[] arr = new int[3]`



#### å…ƒç´ è®¿é—®

* **ç´¢å¼•**ï¼šæ¯ä¸€ä¸ªå­˜å‚¨åˆ°æ•°ç»„çš„å…ƒç´ ï¼Œéƒ½ä¼šè‡ªåŠ¨çš„æ‹¥æœ‰ä¸€ä¸ªç¼–å·ï¼Œä» **0** å¼€å§‹ã€‚è¿™ä¸ªè‡ªåŠ¨ç¼–å·ç§°ä¸ºæ•°ç»„ç´¢å¼•ï¼ˆindexï¼‰ï¼Œå¯ä»¥é€šè¿‡æ•°ç»„çš„ç´¢å¼•è®¿é—®åˆ°æ•°ç»„ä¸­çš„å…ƒç´ 

* **è®¿é—®æ ¼å¼**ï¼šæ•°ç»„å[ç´¢å¼•]ï¼Œ`arr[0]`
* **èµ‹å€¼ï¼š**`arr[0] = 10`



***



#### å†…å­˜åˆ†é…

å†…å­˜æ˜¯è®¡ç®—æœºä¸­çš„é‡è¦å™¨ä»¶ï¼Œä¸´æ—¶å­˜å‚¨åŒºåŸŸï¼Œä½œç”¨æ˜¯è¿è¡Œç¨‹åºã€‚ç¼–å†™çš„ç¨‹åºæ˜¯å­˜æ”¾åœ¨ç¡¬ç›˜ä¸­ï¼Œåœ¨ç¡¬ç›˜ä¸­çš„ç¨‹åºæ˜¯ä¸ä¼šè¿è¡Œçš„ï¼Œå¿…é¡»æ”¾è¿›å†…å­˜ä¸­æ‰èƒ½è¿è¡Œï¼Œè¿è¡Œå®Œæ¯•åä¼šæ¸…ç©ºå†…å­˜ï¼ŒJava è™šæ‹Ÿæœºè¦è¿è¡Œç¨‹åºï¼Œå¿…é¡»è¦å¯¹å†…å­˜è¿›è¡Œç©ºé—´çš„åˆ†é…å’Œç®¡ç†

| åŒºåŸŸåç§°   | ä½œç”¨                                                       |
| ---------- | ---------------------------------------------------------- |
| å¯„å­˜å™¨     | ç»™ CPU ä½¿ç”¨                                                |
| æœ¬åœ°æ–¹æ³•æ ˆ | JVM åœ¨ä½¿ç”¨æ“ä½œç³»ç»ŸåŠŸèƒ½çš„æ—¶å€™ä½¿ç”¨                           |
| æ–¹æ³•åŒº     | å­˜å‚¨å¯ä»¥è¿è¡Œçš„ class æ–‡ä»¶                                  |
| å †å†…å­˜     | å­˜å‚¨å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œnew æ¥åˆ›å»ºçš„ï¼Œéƒ½å­˜å‚¨åœ¨å †å†…å­˜             |
| æ–¹æ³•æ ˆ     | æ–¹æ³•è¿è¡Œæ—¶ä½¿ç”¨çš„å†…å­˜ï¼Œæ¯”å¦‚ main æ–¹æ³•è¿è¡Œï¼Œè¿›å…¥æ–¹æ³•æ ˆä¸­æ‰§è¡Œ |

**å†…å­˜åˆ†é…å›¾**ï¼šJava å†…å­˜åˆ†é…

* ä¸€ä¸ªæ•°ç»„å†…å­˜å›¾

  ![](images/æ•°ç»„å†…å­˜åˆ†é…-ä¸€ä¸ªæ•°ç»„å†…å­˜å›¾.png)

* ä¸¤ä¸ªæ•°ç»„å†…å­˜å›¾

  ![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/æ•°ç»„å†…å­˜åˆ†é…-ä¸¤ä¸ªæ•°ç»„å†…å­˜å›¾.png)

* å¤šä¸ªæ•°ç»„æŒ‡å‘ç›¸åŒå†…å­˜å›¾

  ![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/æ•°ç»„å†…å­˜åˆ†é…-å¤šä¸ªæ•°ç»„æŒ‡å‘ä¸€ä¸ªæ•°ç»„å†…å­˜å›¾.png)

***



#### æ•°ç»„å¼‚å¸¸

* ç´¢å¼•è¶Šç•Œå¼‚å¸¸ï¼šArrayIndexOutOfBoundsException 

* ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼šNullPointerException 

  ```java
  public class ArrayDemo {
      public static void main(String[] args) {
          int[] arr = new int[3];
          //æŠŠnullèµ‹å€¼ç»™æ•°ç»„
          arr = null;
          System.out.println(arr[0]);
      }
  }
  ```

  arr = nullï¼Œè¡¨ç¤ºå˜é‡ arr å°†ä¸å†ä¿å­˜æ•°ç»„çš„å†…å­˜åœ°å€ï¼Œä¹Ÿå°±ä¸å…è®¸å†æ“ä½œæ•°ç»„ï¼Œå› æ­¤è¿è¡Œçš„æ—¶å€™ä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚åœ¨å¼€å‘ä¸­ï¼Œç©ºæŒ‡é’ˆå¼‚å¸¸æ˜¯ä¸èƒ½å‡ºç°çš„ï¼Œä¸€æ—¦å‡ºç°äº†ï¼Œå°±å¿…é¡»è¦ä¿®æ”¹ç¼–å†™çš„ä»£ç 

  è§£å†³æ–¹æ¡ˆï¼šç»™æ•°ç»„ä¸€ä¸ªçœŸæ­£çš„å †å†…å­˜ç©ºé—´å¼•ç”¨å³å¯
  
  

***



#### äºŒç»´æ•°ç»„

äºŒç»´æ•°ç»„ä¹Ÿæ˜¯ä¸€ç§å®¹å™¨ï¼Œä¸åŒäºä¸€ç»´æ•°ç»„ï¼Œè¯¥å®¹å™¨å­˜å‚¨çš„éƒ½æ˜¯ä¸€ç»´æ•°ç»„å®¹å™¨

åˆå§‹åŒ–ï¼š

* åŠ¨æ€åˆå§‹åŒ–ï¼šæ•°æ®ç±»å‹[][] å˜é‡å = new æ•°æ®ç±»å‹[m] [n]ï¼Œ`int[][] arr = new int[3][3]`
  
  * m è¡¨ç¤ºè¿™ä¸ªäºŒç»´æ•°ç»„ï¼Œå¯ä»¥å­˜æ”¾å¤šå°‘ä¸ªä¸€ç»´æ•°ç»„ï¼Œè¡Œ
  * n è¡¨ç¤ºæ¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œå¯ä»¥å­˜æ”¾å¤šå°‘ä¸ªå…ƒç´ ï¼Œåˆ—
  
* é™æ€åˆå§‹åŒ–
  * æ•°æ®ç±»å‹[][] å˜é‡å = new æ•°æ®ç±»å‹ [][]{{å…ƒç´ 1, å…ƒç´ 2...} , {å…ƒç´ 1, å…ƒç´ 2...} 
  
  * æ•°æ®ç±»å‹[][] å˜é‡å = {{å…ƒç´ 1, å…ƒç´ 2...}, {å…ƒç´ 1, å…ƒç´ 2...}...}
  
  * `int[][] arr = {{11,22,33}, {44,55,66}}`
  
    

****



### è¿ç®—

* i++ ä¸ ++i çš„åŒºåˆ«ï¼Ÿ
  
  i++ è¡¨ç¤ºå…ˆå°† i æ”¾åœ¨è¡¨è¾¾å¼ä¸­è¿ç®—ï¼Œç„¶åå†åŠ  1ï¼Œ++i è¡¨ç¤ºå…ˆå°† i åŠ  1ï¼Œç„¶åå†æ”¾åœ¨è¡¨è¾¾å¼ä¸­è¿ç®—

* || å’Œ |ï¼Œ&& å’Œ& çš„åŒºåˆ«ï¼Œé€»è¾‘è¿ç®—ç¬¦

  **& å’Œ| ç§°ä¸ºå¸ƒå°”è¿ç®—ç¬¦ï¼Œä½è¿ç®—ç¬¦ï¼›&& å’Œ || ç§°ä¸ºæ¡ä»¶å¸ƒå°”è¿ç®—ç¬¦ï¼Œä¹Ÿå«çŸ­è·¯è¿ç®—ç¬¦**

  å¦‚æœ && è¿ç®—ç¬¦çš„ç¬¬ä¸€ä¸ªæ“ä½œæ•°æ˜¯ falseï¼Œå°±ä¸éœ€è¦è€ƒè™‘ç¬¬äºŒä¸ªæ“ä½œæ•°çš„å€¼äº†ï¼Œå› ä¸ºæ— è®ºç¬¬äºŒä¸ªæ“ä½œæ•°çš„å€¼æ˜¯ä»€ä¹ˆï¼Œå…¶ç»“æœéƒ½æ˜¯ falseï¼›åŒæ ·ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ•°æ˜¯ trueï¼Œ|| è¿ç®—ç¬¦å°±è¿”å› trueï¼Œæ— éœ€è€ƒè™‘ç¬¬äºŒä¸ªæ“ä½œæ•°çš„å€¼ï¼›ä½† & å’Œ | å´ä¸æ˜¯è¿™æ ·ï¼Œå®ƒä»¬æ€»æ˜¯è¦è®¡ç®—ä¸¤ä¸ªæ“ä½œæ•°ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œ**å°½å¯èƒ½ä½¿ç”¨ && å’Œ || è¿ç®—ç¬¦**

* å¼‚æˆ– ^ï¼šä¸¤ä½ç›¸å¼‚ä¸º 1ï¼Œç›¸åŒä¸º 0ï¼Œåˆå«ä¸è¿›ä½åŠ æ³•

* åŒæˆ–ï¼šä¸¤ä½ç›¸åŒä¸º 1ï¼Œç›¸å¼‚ä¸º 0

* switchï¼šä» Java 7 å¼€å§‹ï¼Œå¯ä»¥åœ¨ switch æ¡ä»¶åˆ¤æ–­è¯­å¥ä¸­ä½¿ç”¨ String å¯¹è±¡

  ```java
  String s = "a";
  switch (s) {
      case "a":
          System.out.println("aaa");
          break;
      case "b":
          System.out.println("bbb");
          break;
      default:
          break;
  }
  ```
  
  switch ä¸æ”¯æŒ longã€floatã€doubleï¼Œswitch çš„è®¾è®¡åˆè¡·æ˜¯å¯¹é‚£äº›åªæœ‰å°‘æ•°å‡ ä¸ªå€¼çš„ç±»å‹è¿›è¡Œç­‰å€¼åˆ¤æ–­ï¼Œå¦‚æœå€¼è¿‡äºå¤æ‚ï¼Œé‚£ä¹ˆç”¨ if æ¯”è¾ƒåˆé€‚
  
* breakï¼šè·³å‡ºä¸€å±‚å¾ªç¯

* ç§»ä½è¿ç®—ï¼šè®¡ç®—æœºé‡Œä¸€èˆ¬ç”¨**è¡¥ç è¡¨ç¤ºæ•°å­—**ï¼Œæ­£æ•°ã€è´Ÿæ•°çš„è¡¨ç¤ºåŒºåˆ«å°±æ˜¯æœ€é«˜ä½æ˜¯ 0 è¿˜æ˜¯ 1
  
  * æ­£æ•°çš„åŸç åç è¡¥ç ç›¸åŒï¼Œæœ€é«˜ä½ä¸º 0
  
    ```java
    100:	00000000  00000000  00000000  01100100
    ```
  
  * è´Ÿæ•°ï¼š
    åŸç ï¼šæœ€é«˜ä½ä¸º 1ï¼Œå…¶ä½™ä½ç½®å’Œæ­£æ•°ç›¸åŒ
    åç ï¼šä¿è¯ç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™ä½ç½®å–å
    è¡¥ç ï¼šä¿è¯ç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™ä½ç½®å–åååŠ  1ï¼Œå³åç  +1
  
    ```java
    -100 åŸç :	10000000  00000000  00000000  01100100	//32ä½
    -100 åç :	11111111  11111111  11111111  10011011
    -100 è¡¥ç :	11111111  11111111  11111111  10011100
    ```
  
    è¡¥ç  â†’ åŸç ï¼šç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™ä½ç½®å–ååŠ  1
  
  è¿ç®—ç¬¦ï¼š
  
  * `>>` è¿ç®—ç¬¦ï¼šå°†äºŒè¿›åˆ¶ä½è¿›è¡Œå³ç§»æ“ä½œï¼Œç›¸å½“äºé™¤ 2
  * `<<` è¿ç®—ç¬¦ï¼šå°†äºŒè¿›åˆ¶ä½è¿›è¡Œå·¦ç§»æ“ä½œï¼Œç›¸å½“äºä¹˜ 2
  * `>>>` è¿ç®—ç¬¦ï¼šæ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥ 0 è¡¥é½
  
  è¿ç®—è§„åˆ™ï¼š
  
  * æ­£æ•°çš„å·¦ç§»ä¸å³ç§»ï¼Œç©ºä½è¡¥ 0
  
  * è´Ÿæ•°åŸç çš„å·¦ç§»ä¸å³ç§»ï¼Œç©ºä½è¡¥ 0
    
    è´Ÿæ•°åç çš„å·¦ç§»ä¸å³ç§»ï¼Œç©ºä½è¡¥ 1
    
    è´Ÿæ•°è¡¥ç ï¼Œå·¦ç§»ä½ä½è¡¥ 0ï¼ˆä¼šå¯¼è‡´è´Ÿæ•°å˜ä¸ºæ­£æ•°çš„é—®é¢˜ï¼Œå› ä¸ºç§»åŠ¨äº†ç¬¦å·ä½ï¼‰ï¼Œå³ç§»é«˜ä½è¡¥ 1
    
  * æ— ç¬¦å·ç§»ä½ï¼Œç©ºä½è¡¥ 0



****



### å‚æ•°

#### å½¢å‚å®å‚

å½¢å‚ï¼š

* å½¢å¼å‚æ•°ï¼Œç”¨äºå®šä¹‰æ–¹æ³•çš„æ—¶å€™ä½¿ç”¨çš„å‚æ•°ï¼Œåªèƒ½æ˜¯å˜é‡
* å½¢å‚åªæœ‰åœ¨æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œè™šæ‹Ÿæœºæ‰åˆ†é…å†…å­˜å•å…ƒï¼Œæ–¹æ³•è°ƒç”¨ç»“æŸä¹‹åä¾¿ä¼šé‡Šæ”¾æ‰€åˆ†é…çš„å†…å­˜å•å…ƒ

å®å‚ï¼šè°ƒç”¨æ–¹æ³•æ—¶ä¼ é€’çš„æ•°æ®å¯ä»¥æ˜¯å¸¸é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯å˜é‡



#### å¯å˜å‚æ•°

å¯å˜å‚æ•°ç”¨åœ¨å½¢å‚ä¸­å¯ä»¥æ¥æ”¶å¤šä¸ªæ•°æ®ï¼Œåœ¨æ–¹æ³•å†…éƒ¨**æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°ç»„**

æ ¼å¼ï¼šæ•°æ®ç±»å‹... å‚æ•°åç§°

ä½œç”¨ï¼šä¼ è¾“å‚æ•°éå¸¸çµæ´»ï¼Œå¯ä»¥ä¸ä¼ è¾“å‚æ•°ã€ä¼ è¾“ä¸€ä¸ªå‚æ•°ã€æˆ–è€…ä¼ è¾“ä¸€ä¸ªæ•°ç»„

å¯å˜å‚æ•°çš„æ³¨æ„äº‹é¡¹ï¼š

* ä¸€ä¸ªå½¢å‚åˆ—è¡¨ä¸­å¯å˜å‚æ•°åªèƒ½æœ‰ä¸€ä¸ª
* å¯å˜å‚æ•°å¿…é¡»æ”¾åœ¨å½¢å‚åˆ—è¡¨çš„**æœ€åé¢**

```java
public static void main(String[] args) {
	sum(); // å¯ä»¥ä¸ä¼ è¾“å‚æ•°ã€‚
	sum(10); // å¯ä»¥ä¼ è¾“ä¸€ä¸ªå‚æ•°ã€‚
	sum(10,20,30); // å¯ä»¥ä¼ è¾“å¤šä¸ªå‚æ•°ã€‚
	sum(new int[]{10,30,50,70,90}); // å¯ä»¥ä¼ è¾“ä¸€ä¸ªæ•°ç»„ã€‚
}

public static void sum(int... nums){
	int sum = 0;
	for(int i : a) {
		sum += i;
	}
	return sum;
}
```



***



### æ–¹æ³•

#### æ–¹æ³•æ¦‚è¿°

æ–¹æ³•ï¼ˆmethodï¼‰æ˜¯å°†å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„ä»£ç å—ç»„ç»‡æˆä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä½¿å…¶å…·æœ‰ç‰¹æ®ŠåŠŸèƒ½çš„ä»£ç é›†

æ³¨æ„ï¼šæ–¹æ³•å¿…é¡»å…ˆåˆ›å»ºæ‰å¯ä»¥ä½¿ç”¨ï¼Œè¯¥è¿‡ç¨‹æˆä¸ºæ–¹æ³•å®šä¹‰ï¼Œæ–¹æ³•åˆ›å»ºåå¹¶ä¸æ˜¯ç›´æ¥å¯ä»¥è¿è¡Œçš„ï¼Œéœ€è¦æ‰‹åŠ¨ä½¿ç”¨åæ‰æ‰§è¡Œï¼Œè¯¥è¿‡ç¨‹æˆä¸ºæ–¹æ³•è°ƒç”¨

åœ¨æ–¹æ³•å†…éƒ¨å®šä¹‰çš„å«å±€éƒ¨å˜é‡ï¼Œå±€éƒ¨å˜é‡ä¸èƒ½åŠ  staticï¼ŒåŒ…æ‹¬ protectedã€privateã€public è¿™äº›ä¹Ÿä¸èƒ½åŠ 

åŸå› ï¼šå±€éƒ¨å˜é‡æ˜¯ä¿å­˜åœ¨æ ˆä¸­çš„ï¼Œè€Œé™æ€å˜é‡ä¿å­˜äºæ–¹æ³•åŒºï¼ˆJDK8 åœ¨å †ä¸­ï¼‰ï¼Œå±€éƒ¨å˜é‡å‡ºäº†æ–¹æ³•å°±è¢«æ ˆå›æ”¶äº†ï¼Œè€Œé™æ€å˜é‡ä¸ä¼šï¼Œæ‰€ä»¥**åœ¨å±€éƒ¨å˜é‡å‰ä¸èƒ½åŠ  static å…³é”®å­—**ï¼Œé™æ€å˜é‡æ˜¯å®šä¹‰åœ¨ç±»ä¸­ï¼Œåˆå«ç±»å˜é‡



***



#### å®šä¹‰è°ƒç”¨

å®šä¹‰æ ¼å¼ï¼š

```java
public static è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å‚æ•°) {
	//æ–¹æ³•ä½“;
	return æ•°æ® ;
}
```

è°ƒç”¨æ ¼å¼ï¼š

```java
æ•°æ®ç±»å‹ å˜é‡å = æ–¹æ³•å (å‚æ•°) ;
```

* æ–¹æ³•åï¼šè°ƒç”¨æ–¹æ³•æ—¶å€™ä½¿ç”¨çš„æ ‡è¯†
* å‚æ•°ï¼šç”±æ•°æ®ç±»å‹å’Œå˜é‡åç»„æˆï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨é€—å·éš”å¼€
* æ–¹æ³•ä½“ï¼šå®ŒæˆåŠŸèƒ½çš„ä»£ç å—
* returnï¼šå¦‚æœæ–¹æ³•æ“ä½œå®Œæ¯•ï¼Œæœ‰æ•°æ®è¿”å›ï¼Œç”¨äºæŠŠæ•°æ®è¿”å›ç»™è°ƒç”¨è€…

å¦‚æœæ–¹æ³•æ“ä½œå®Œæ¯•

* void ç±»å‹çš„æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼Œè€Œä¸”æ–¹æ³•ä½“ä¸­ä¸€èˆ¬ä¸å†™ return
* é void ç±»å‹çš„æ–¹æ³•ï¼Œæ¨èç”¨å˜é‡æ¥æ”¶è°ƒç”¨

åŸç†ï¼šæ¯ä¸ªæ–¹æ³•åœ¨è¢«è°ƒç”¨æ‰§è¡Œçš„æ—¶å€™ï¼Œéƒ½ä¼šè¿›å…¥æ ˆå†…å­˜ï¼Œå¹¶ä¸”æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œæ–¹æ³•å†…éƒ¨ä»£ç è°ƒç”¨å®Œæ¯•ä¹‹åï¼Œä¼šä»æ ˆå†…å­˜ä¸­å¼¹æ ˆæ¶ˆå¤±



***



#### æ³¨æ„äº‹é¡¹

* æ–¹æ³•ä¸èƒ½åµŒå¥—å®šä¹‰

  ```java
  public class MethodDemo {
  	public static void main(String[] args) {
  	}
  	public static void methodOne() {
  		public static void methodTwo() {
  			// è¿™é‡Œä¼šå¼•å‘ç¼–è¯‘é”™è¯¯!!!
  		}
  	}
  }
  ```

* void è¡¨ç¤ºæ— è¿”å›å€¼ï¼Œå¯ä»¥çœç•¥ returnï¼Œä¹Ÿå¯ä»¥å•ç‹¬çš„ä¹¦å†™ returnï¼Œåé¢ä¸åŠ æ•°æ®

  ```java
  public static void methodTwo() {
  	//return 100; ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºæ²¡æœ‰å…·ä½“è¿”å›å€¼ç±»å‹
  	return;
  	//System.out.println(100); returnè¯­å¥åé¢ä¸èƒ½è·Ÿæ•°æ®æˆ–ä»£ç 
  }
  ```

  

***



#### æ–¹æ³•é‡è½½

##### é‡è½½ä»‹ç»

æ–¹æ³•é‡è½½æŒ‡åŒä¸€ä¸ªç±»ä¸­å®šä¹‰çš„å¤šä¸ªæ–¹æ³•ä¹‹é—´çš„å…³ç³»ï¼Œæ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„å¤šä¸ªæ–¹æ³•ç›¸äº’æ„æˆé‡è½½ï¼š

1. å¤šä¸ªæ–¹æ³•åœ¨**åŒä¸€ä¸ªç±»**ä¸­
2. å¤šä¸ªæ–¹æ³•å…·æœ‰**ç›¸åŒçš„æ–¹æ³•å**
3. å¤šä¸ªæ–¹æ³•çš„**å‚æ•°ä¸ç›¸åŒ**ï¼Œç±»å‹ä¸åŒæˆ–è€…æ•°é‡ä¸åŒ

é‡è½½ä»…å¯¹åº”æ–¹æ³•çš„å®šä¹‰ï¼Œä¸æ–¹æ³•çš„è°ƒç”¨æ— å…³ï¼Œè°ƒç”¨æ–¹å¼å‚ç…§æ ‡å‡†æ ¼å¼

é‡è½½ä»…é’ˆå¯¹åŒä¸€ä¸ªç±»ä¸­æ–¹æ³•çš„åç§°ä¸å‚æ•°è¿›è¡Œè¯†åˆ«ï¼Œä¸è¿”å›å€¼æ— å…³ï¼Œ**ä¸èƒ½é€šè¿‡è¿”å›å€¼æ¥åˆ¤å®šä¸¤ä¸ªæ–¹æ³•æ˜¯å¦æ„æˆé‡è½½**

åŸç†ï¼šJVM â†’ è¿è¡Œæœºåˆ¶ â†’ æ–¹æ³•è°ƒç”¨ â†’ å¤šæ€åŸç†

```java
public class MethodDemo {
	public static void fn(int a) {
		//æ–¹æ³•ä½“
	}
    
	public static int fn(int a) { /*é”™è¯¯åŸå› ï¼šé‡è½½ä¸è¿”å›å€¼æ— å…³*/
		//æ–¹æ³•ä½“
	}
    
    public static void fn(int a, int b) {/*æ­£ç¡®æ ¼å¼*/
		//æ–¹æ³•ä½“
	}
}
```



***



##### æ–¹æ³•é€‰å–

é‡è½½çš„æ–¹æ³•åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å³å¯å®Œæˆè¯†åˆ«ï¼Œæ–¹æ³•è°ƒç”¨æ—¶ Java ç¼–è¯‘å™¨ä¼šæ ¹æ®æ‰€ä¼ å…¥å‚æ•°çš„å£°æ˜ç±»å‹ï¼ˆæ³¨æ„ä¸å®é™…ç±»å‹åŒºåˆ†ï¼‰æ¥é€‰å–é‡è½½æ–¹æ³•ã€‚é€‰å–çš„è¿‡ç¨‹å…±åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š

* ä¸€é˜¶æ®µï¼šåœ¨ä¸è€ƒè™‘å¯¹åŸºæœ¬ç±»å‹è‡ªåŠ¨è£…æ‹†ç®± (auto-boxingï¼Œauto-unboxing)ï¼Œä»¥åŠå¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰å–é‡è½½æ–¹æ³•
* äºŒé˜¶æ®µï¼šå¦‚æœç¬¬ä¸€é˜¶æ®µä¸­æ²¡æœ‰æ‰¾åˆ°é€‚é…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨å…è®¸è‡ªåŠ¨è£…æ‹†ç®±ï¼Œä½†ä¸å…è®¸å¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰å–é‡è½½æ–¹æ³•
* ä¸‰é˜¶æ®µï¼šå¦‚æœç¬¬äºŒé˜¶æ®µä¸­æ²¡æœ‰æ‰¾åˆ°é€‚é…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨å…è®¸è‡ªåŠ¨è£…æ‹†ç®±ä»¥åŠå¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰å–é‡è½½æ–¹æ³•

å¦‚æœ Java ç¼–è¯‘å™¨åœ¨åŒä¸€ä¸ªé˜¶æ®µä¸­æ‰¾åˆ°äº†å¤šä¸ªé€‚é…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¸ºè´´åˆ‡çš„ï¼Œè€Œå†³å®šè´´åˆ‡ç¨‹åº¦çš„ä¸€ä¸ªå…³é”®å°±æ˜¯å½¢å¼å‚æ•°ç±»å‹çš„ç»§æ‰¿å…³ç³»ï¼Œ**ä¸€èˆ¬ä¼šé€‰æ‹©å½¢å‚ä¸ºå‚æ•°ç±»å‹çš„å­ç±»çš„æ–¹æ³•ï¼Œå› ä¸ºå­ç±»æ—¶æ›´å…·ä½“çš„å®ç°**ï¼š

```java
public class MethodDemo {
    void invoke(Object obj, Object... args) { ... }
    void invoke(String s, Object obj, Object... args) { ... }

    invoke(null, 1); 	// è°ƒç”¨ç¬¬äºŒä¸ªinvokeæ–¹æ³•ï¼Œé€‰å–çš„ç¬¬äºŒé˜¶æ®µ
    invoke(null, 1, 2); // è°ƒç”¨ç¬¬äºŒä¸ªinvokeæ–¹æ³•ï¼ŒåŒ¹é…ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªï¼Œä½†Stringæ˜¯Objectçš„å­ç±»
    
    invoke(null, new Object[]{1}); // åªæœ‰æ‰‹åŠ¨ç»•å¼€å¯å˜é•¿å‚æ•°çš„è¯­æ³•ç³–ï¼Œæ‰èƒ½è°ƒç”¨ç¬¬ä¸€ä¸ªinvokeæ–¹æ³•
    							   // å¯å˜å‚æ•°åº•å±‚æ˜¯æ•°ç»„ï¼ŒJVM->è¿è¡Œæœºåˆ¶->ä»£ç ä¼˜åŒ–
}
```

å› æ­¤ä¸æå€¡å¯å˜é•¿å‚æ•°æ–¹æ³•çš„é‡è½½



***



##### ç»§æ‰¿é‡è½½

é™¤äº†åŒä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•ï¼Œé‡è½½ä¹Ÿå¯ä»¥ä½œç”¨äºè¿™ä¸ªç±»æ‰€ç»§æ‰¿è€Œæ¥çš„æ–¹æ³•ã€‚å¦‚æœå­ç±»å®šä¹‰äº†ä¸çˆ¶ç±»ä¸­**éç§æœ‰æ–¹æ³•**åŒåçš„æ–¹æ³•ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°ç±»å‹ä¸åŒï¼Œé‚£ä¹ˆåœ¨å­ç±»ä¸­ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åŒæ ·æ„æˆäº†é‡è½½

* å¦‚æœè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼Œé‚£ä¹ˆå­ç±»ä¸­çš„æ–¹æ³•éšè—äº†çˆ¶ç±»ä¸­çš„æ–¹æ³•
* å¦‚æœè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¸æ˜¯é™æ€çš„ï¼Œä¸”éƒ½ä¸æ˜¯ç§æœ‰çš„ï¼Œé‚£ä¹ˆå­ç±»çš„æ–¹æ³•é‡å†™äº†çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯**å¤šæ€**



***



#### å‚æ•°ä¼ é€’

Java çš„å‚æ•°æ˜¯ä»¥**å€¼ä¼ é€’**çš„å½¢å¼ä¼ å…¥æ–¹æ³•ä¸­

å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ«åœ¨äºä¼ é€’åä¼šä¸ä¼šå½±å“å®å‚çš„å€¼ï¼š**å€¼ä¼ é€’ä¼šåˆ›å»ºå‰¯æœ¬**ï¼Œå¼•ç”¨ä¼ é€’ä¸ä¼šåˆ›å»ºå‰¯æœ¬

* åŸºæœ¬æ•°æ®ç±»å‹ï¼šå½¢å¼å‚æ•°çš„æ”¹å˜ï¼Œä¸å½±å“å®é™…å‚æ•°
  
  æ¯ä¸ªæ–¹æ³•åœ¨æ ˆå†…å­˜ä¸­ï¼Œéƒ½ä¼šæœ‰ç‹¬ç«‹çš„æ ˆç©ºé—´ï¼Œæ–¹æ³•è¿è¡Œç»“æŸåå°±ä¼šå¼¹æ ˆæ¶ˆå¤±
  
  ```java
  public class ArgsDemo01 {
  	public static void main(String[] args) {
  		int number = 100;
  		System.out.println("è°ƒç”¨changeæ–¹æ³•å‰ï¼š" + number);//100
  		change(number);
  		System.out.println("è°ƒç”¨changeæ–¹æ³•åï¼š" + number);//100
  	}
  	public static void change(int number) {
  		number = 200;
  	}
  }
  ```
  
* å¼•ç”¨ç±»å‹ï¼šå½¢å¼å‚æ•°çš„æ”¹å˜ï¼Œå½±å“å®é™…å‚æ•°çš„å€¼
  
  **å¼•ç”¨æ•°æ®ç±»å‹çš„ä¼ å‚ï¼Œæœ¬è´¨ä¸Šæ˜¯å°†å¯¹è±¡çš„åœ°å€ä»¥å€¼çš„æ–¹å¼ä¼ é€’åˆ°å½¢å‚ä¸­**ï¼Œå†…å­˜ä¸­ä¼šé€ æˆä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå†…å­˜çš„æ•ˆæœï¼Œæ‰€ä»¥å³ä½¿æ–¹æ³•å¼¹æ ˆï¼Œå †å†…å­˜ä¸­çš„æ•°æ®ä¹Ÿå·²ç»æ˜¯æ”¹å˜åçš„ç»“æœ
  
  ```java
  public class PassByValueExample {
      public static void main(String[] args) {
          Dog dog = new Dog("A");
          func(dog);
          System.out.println(dog.getName());	// B
      }
      private static void func(Dog dog) {
          dog.setName("B");
      }
  }
  class Dog {
      String name;//.....
  }
  ```
  
  



***



### æšä¸¾

æšä¸¾æ˜¯ Java ä¸­çš„ä¸€ç§ç‰¹æ®Šç±»å‹ï¼Œä¸ºäº†åšä¿¡æ¯çš„æ ‡å¿—å’Œä¿¡æ¯çš„åˆ†ç±»

å®šä¹‰æšä¸¾çš„æ ¼å¼ï¼š

```java
ä¿®é¥°ç¬¦ enum æšä¸¾åç§°{
	ç¬¬ä¸€è¡Œéƒ½æ˜¯ç½—åˆ—æšä¸¾å®ä¾‹çš„åç§°ã€‚
}
```

æšä¸¾çš„ç‰¹ç‚¹ï¼š

* æšä¸¾ç±»æ˜¯ç”¨ final ä¿®é¥°çš„ï¼Œæšä¸¾ç±»ä¸èƒ½è¢«ç»§æ‰¿
* æšä¸¾ç±»é»˜è®¤ç»§æ‰¿äº† java.lang.Enum æšä¸¾ç±»
* æšä¸¾ç±»çš„ç¬¬ä¸€è¡Œéƒ½æ˜¯å¸¸é‡ï¼Œå¿…é¡»æ˜¯ç½—åˆ—æšä¸¾ç±»çš„å®ä¾‹åç§°
* æšä¸¾ç±»ç›¸å½“äºæ˜¯å¤šä¾‹è®¾è®¡æ¨¡å¼
* æ¯ä¸ªæšä¸¾é¡¹éƒ½æ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯ä¸€ä¸ªé™æ€æˆå‘˜å˜é‡

| æ–¹æ³•å                                            | è¯´æ˜                                 |
| ------------------------------------------------- | ------------------------------------ |
| String name()                                     | è·å–æšä¸¾é¡¹çš„åç§°                     |
| int ordinal()                                     | è¿”å›æšä¸¾é¡¹åœ¨æšä¸¾ç±»ä¸­çš„ç´¢å¼•å€¼         |
| int compareTo(E  o)                               | æ¯”è¾ƒä¸¤ä¸ªæšä¸¾é¡¹ï¼Œè¿”å›çš„æ˜¯ç´¢å¼•å€¼çš„å·®å€¼ |
| String toString()                                 | è¿”å›æšä¸¾å¸¸é‡çš„åç§°                   |
| static <T> T  valueOf(Class<T> type,String  name) | è·å–æŒ‡å®šæšä¸¾ç±»ä¸­çš„æŒ‡å®šåç§°çš„æšä¸¾å€¼   |
| values()                                          | è·å¾—æ‰€æœ‰çš„æšä¸¾é¡¹                     |

* æºç åˆ†æï¼š

  ```java
  enum Season {
      SPRING , SUMMER , AUTUMN , WINTER;
  }
  // æšä¸¾ç±»çš„ç¼–è¯‘ä»¥åæºä»£ç ï¼š
  public final class Season extends java.lang.Enum<Season> {
  	public static final Season SPRING = new Season();
  	public static final Season SUMMER = new Season();
  	public static final Season AUTUMN = new Season();
  	public static final Season WINTER = new Season();
  
  	public static Season[] values();
  	public static Season valueOf(java.lang.String);
  }
  ```

* API ä½¿ç”¨

  ```java
  public class EnumDemo {
      public static void main(String[] args){
          // è·å–ç´¢å¼•
          Season s = Season.SPRING;
          System.out.println(s);	//SPRING
          System.out.println(s.ordinal()); // 0ï¼Œè¯¥å€¼ä»£è¡¨ç´¢å¼•ï¼Œsummer å°±æ˜¯ 1
          s.s.doSomething();
          // è·å–å…¨éƒ¨æšä¸¾
          Season[] ss = Season.values();
          for(int i = 0; i < ss.length; i++){
              System.out.println(ss[i]);
          }
          
          int result = Season.SPRING.compareTo(Season.WINTER);
          System.out.println(result);//-3
      }
  }
  enum Season {
      SPRING , SUMMER , AUTUMN , WINTER;
      
      public void doSomething() {
          System.out.println("hello ");
      }
  }
  ```






***



### Debug

Debug æ˜¯ä¾›ç¨‹åºå‘˜ä½¿ç”¨çš„ç¨‹åºè°ƒè¯•å·¥å…·ï¼Œå®ƒå¯ä»¥ç”¨äºæŸ¥çœ‹ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œä¹Ÿå¯ä»¥ç”¨äºè¿½è¸ªç¨‹åºæ‰§è¡Œè¿‡ç¨‹æ¥è°ƒè¯•ç¨‹åºã€‚

åŠ æ–­ç‚¹ â†’ Debug è¿è¡Œ â†’ å•æ­¥è¿è¡Œ â†’ çœ‹ Debugger çª—å£ â†’ çœ‹ Console çª—å£

![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/DebugæŒ‰é”®è¯´æ˜.png)

<img src="https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/Debugæ¡ä»¶æ–­ç‚¹.png" alt="Debugæ¡ä»¶æ–­ç‚¹" style="zoom:50%;" />







***



## å¯¹è±¡

### æ¦‚è¿°

Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„é«˜çº§ç¼–ç¨‹è¯­è¨€

é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾ï¼š**å°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€**

ä¸¤ä¸ªæ¦‚å¿µï¼šç±»å’Œå¯¹è±¡

* ç±»ï¼šç›¸åŒäº‹ç‰©å…±åŒç‰¹å¾çš„æè¿°ï¼Œç±»åªæ˜¯å­¦æœ¯ä¸Šçš„ä¸€ä¸ªæ¦‚å¿µå¹¶éçœŸå®å­˜åœ¨çš„ï¼Œåªèƒ½æè¿°ä¸€ç±»äº‹ç‰©
* å¯¹è±¡ï¼šæ˜¯çœŸå®å­˜åœ¨çš„å®ä¾‹ï¼Œ å®ä¾‹ == å¯¹è±¡ï¼Œ**å¯¹è±¡æ˜¯ç±»çš„å®ä¾‹åŒ–**
* ç»“è®ºï¼šæœ‰äº†ç±»å’Œå¯¹è±¡å°±å¯ä»¥æè¿°ä¸‡åƒä¸–ç•Œæ‰€æœ‰çš„äº‹ç‰©ï¼Œå¿…é¡»å…ˆæœ‰ç±»æ‰èƒ½æœ‰å¯¹è±¡



***



### ç±»

#### å®šä¹‰

å®šä¹‰æ ¼å¼

```java
ä¿®é¥°ç¬¦ class ç±»å{
}
```

1. ç±»åçš„é¦–å­—æ¯å»ºè®®å¤§å†™ï¼Œæ»¡è¶³é©¼å³°æ¨¡å¼ï¼Œæ¯”å¦‚ StudentNameCode
2. ä¸€ä¸ª Java ä»£ç ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªç±»ï¼ŒæŒ‰ç…§è§„èŒƒä¸€ä¸ª Java æ–‡ä»¶ä¸€ä¸ªç±»
3. ä¸€ä¸ª Java ä»£ç æ–‡ä»¶ä¸­ï¼Œåªèƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ public ä¿®é¥°ï¼Œ**public ä¿®é¥°çš„ç±»åå¿…é¡»æˆä¸ºå½“å‰ Java ä»£ç çš„æ–‡ä»¶åç§°**

```java
ç±»ä¸­çš„æˆåˆ†:æœ‰ä¸”ä»…æœ‰äº”å¤§æˆåˆ†
ä¿®é¥°ç¬¦ class ç±»å{
		1.æˆå‘˜å˜é‡(Field):  	æè¿°ç±»æˆ–è€…å¯¹è±¡çš„å±æ€§ä¿¡æ¯çš„ã€‚
        2.æˆå‘˜æ–¹æ³•(Method):		æè¿°ç±»æˆ–è€…å¯¹è±¡çš„è¡Œä¸ºä¿¡æ¯çš„ã€‚
		3.æ„é€ å™¨(Constructor):	 åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡è¿”å›ã€‚
		4.ä»£ç å—
		5.å†…éƒ¨ç±»
	  }
ç±»ä¸­æœ‰ä¸”ä»…æœ‰è¿™äº”ç§æˆåˆ†ï¼Œå¦åˆ™ä»£ç æŠ¥é”™ï¼
public class ClassDemo {
    System.out.println(1);//æŠ¥é”™
}
```



***



#### æ„é€ å™¨

æ„é€ å™¨æ ¼å¼ï¼š

```java
ä¿®é¥°ç¬¦ ç±»å(å½¢å‚åˆ—è¡¨){

}
```

ä½œç”¨ï¼šåˆå§‹åŒ–ç±»çš„ä¸€ä¸ªå¯¹è±¡è¿”å›

åˆ†ç±»ï¼šæ— å‚æ•°æ„é€ å™¨ï¼Œæœ‰å‚æ•°æ„é€ å™¨

æ³¨æ„ï¼š**ä¸€ä¸ªç±»é»˜è®¤è‡ªå¸¦ä¸€ä¸ªæ— å‚æ•°æ„é€ å™¨**ï¼Œå†™äº†æœ‰å‚æ•°æ„é€ å™¨é»˜è®¤çš„æ— å‚æ•°æ„é€ å™¨å°±æ¶ˆå¤±ï¼Œè¿˜éœ€è¦ç”¨æ— å‚æ•°æ„é€ å™¨å°±è¦é‡æ–°å†™

æ„é€ å™¨åˆå§‹åŒ–å¯¹è±¡çš„æ ¼å¼ï¼šç±»å å¯¹è±¡åç§° = new æ„é€ å™¨

* æ— å‚æ•°æ„é€ å™¨çš„ä½œç”¨ï¼šåˆå§‹åŒ–ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼ˆä½¿ç”¨å¯¹è±¡çš„é»˜è®¤å€¼åˆå§‹åŒ–ï¼‰è¿”å›
* æœ‰å‚æ•°æ„é€ å™¨çš„ä½œç”¨ï¼šåˆå§‹åŒ–ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼ˆå¯ä»¥åœ¨åˆå§‹åŒ–å¯¹è±¡çš„æ—¶å€™ä¸ºå¯¹è±¡èµ‹å€¼ï¼‰è¿”å›



------



### åŒ…

åŒ…ï¼šåˆ†é—¨åˆ«ç±»çš„ç®¡ç†å„ç§ä¸åŒçš„æŠ€æœ¯ï¼Œä¾¿äºç®¡ç†æŠ€æœ¯ï¼Œæ‰©å±•æŠ€æœ¯ï¼Œé˜…è¯»æŠ€æœ¯

å®šä¹‰åŒ…çš„æ ¼å¼ï¼š`package åŒ…å`ï¼Œå¿…é¡»æ”¾åœ¨ç±»åçš„æœ€ä¸Šé¢

å¯¼åŒ…æ ¼å¼ï¼š`import åŒ…å.ç±»å`

ç›¸åŒåŒ…ä¸‹çš„ç±»å¯ä»¥ç›´æ¥è®¿é—®ï¼›ä¸åŒåŒ…ä¸‹çš„ç±»å¿…é¡»å¯¼åŒ…æ‰å¯ä»¥ä½¿ç”¨



***



### å°è£…

å°è£…çš„å“²å­¦æ€ç»´ï¼šåˆç†éšè—ï¼Œåˆç†æš´éœ²

å°è£…æœ€åˆçš„ç›®çš„ï¼šæé«˜ä»£ç çš„å®‰å…¨æ€§å’Œå¤ç”¨æ€§ï¼Œç»„ä»¶åŒ–

å°è£…çš„æ­¥éª¤ï¼š

1. **æˆå‘˜å˜é‡åº”è¯¥ç§æœ‰ï¼Œç”¨ private ä¿®é¥°ï¼Œåªèƒ½åœ¨æœ¬ç±»ä¸­ç›´æ¥è®¿é—®**
2. **æä¾›æˆå¥—çš„ getter å’Œ setter æ–¹æ³•æš´éœ²æˆå‘˜å˜é‡çš„å–å€¼å’Œèµ‹å€¼**

ä½¿ç”¨ private ä¿®é¥°æˆå‘˜å˜é‡çš„åŸå› ï¼šå®ç°æ•°æ®å°è£…ï¼Œä¸æƒ³è®©åˆ«äººä½¿ç”¨ä¿®æ”¹ä½ çš„æ•°æ®ï¼Œæ¯”è¾ƒå®‰å…¨



***



### this

this å…³é”®å­—çš„ä½œç”¨ï¼š

* this å…³é”®å­—ä»£è¡¨äº†å½“å‰å¯¹è±¡çš„å¼•ç”¨
* this å‡ºç°åœ¨æ–¹æ³•ä¸­ï¼š**å“ªä¸ªå¯¹è±¡è°ƒç”¨è¿™ä¸ªæ–¹æ³• this å°±ä»£è¡¨è°**
* this å¯ä»¥å‡ºç°åœ¨æ„é€ å™¨ä¸­ï¼šä»£è¡¨æ„é€ å™¨æ­£åœ¨åˆå§‹åŒ–çš„é‚£ä¸ªå¯¹è±¡
* this å¯ä»¥åŒºåˆ†å˜é‡æ˜¯è®¿é—®çš„æˆå‘˜å˜é‡è¿˜æ˜¯å±€éƒ¨å˜é‡



------



### static

#### åŸºæœ¬ä»‹ç»

Java æ˜¯é€šè¿‡æˆå‘˜å˜é‡æ˜¯å¦æœ‰ static ä¿®é¥°æ¥åŒºåˆ†æ˜¯ç±»çš„è¿˜æ˜¯å±äºå¯¹è±¡çš„

æŒ‰ç…§æœ‰æ—  static ä¿®é¥°ï¼Œæˆå‘˜å˜é‡å’Œæ–¹æ³•å¯ä»¥åˆ†ä¸ºï¼š

* æˆå‘˜å˜é‡ï¼š
  * é™æ€æˆå‘˜å˜é‡ï¼ˆç±»å˜é‡ï¼‰ï¼šstatic ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œå±äºç±»æœ¬èº«ï¼Œ**ä¸ç±»ä¸€èµ·åŠ è½½ä¸€æ¬¡ï¼Œåªæœ‰ä¸€ä¸ª**ï¼Œç›´æ¥ç”¨ç±»åè®¿é—®å³å¯
  * å®ä¾‹æˆå‘˜å˜é‡ï¼šæ—  static ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œå±äºç±»çš„æ¯ä¸ªå¯¹è±¡çš„ï¼Œ**ä¸ç±»çš„å¯¹è±¡ä¸€èµ·åŠ è½½**ï¼Œå¯¹è±¡æœ‰å¤šå°‘ä¸ªï¼Œå®ä¾‹æˆå‘˜å˜é‡å°±åŠ è½½å¤šå°‘ä¸ªï¼Œå¿…é¡»ç”¨ç±»çš„å¯¹è±¡æ¥è®¿é—®
  
* æˆå‘˜æ–¹æ³•ï¼š
  * é™æ€æ–¹æ³•ï¼šæœ‰ static ä¿®é¥°çš„æˆå‘˜æ–¹æ³•ç§°ä¸ºé™æ€æ–¹æ³•ä¹Ÿå«ç±»æ–¹æ³•ï¼Œå±äºç±»æœ¬èº«çš„ï¼Œç›´æ¥ç”¨ç±»åè®¿é—®å³å¯
  * å®ä¾‹æ–¹æ³•ï¼šæ—  static ä¿®é¥°çš„æˆå‘˜æ–¹æ³•ç§°ä¸ºå®ä¾‹æ–¹æ³•ï¼Œå±äºç±»çš„æ¯ä¸ªå¯¹è±¡çš„ï¼Œå¿…é¡»ç”¨ç±»çš„å¯¹è±¡æ¥è®¿é—®



****



#### static ç”¨æ³•

æˆå‘˜å˜é‡çš„è®¿é—®è¯­æ³•ï¼š

* é™æ€æˆå‘˜å˜é‡ï¼šåªæœ‰ä¸€ä»½å¯ä»¥è¢«ç±»å’Œç±»çš„å¯¹è±¡**å…±äº«è®¿é—®**
  * ç±»å.é™æ€æˆå‘˜å˜é‡ï¼ˆåŒä¸€ä¸ªç±»ä¸­è®¿é—®é™æ€æˆå‘˜å˜é‡å¯ä»¥çœç•¥ç±»åä¸å†™ï¼‰
  * å¯¹è±¡.é™æ€æˆå‘˜å˜é‡ï¼ˆä¸æ¨èï¼‰

* å®ä¾‹æˆå‘˜å˜é‡ï¼š
  * å¯¹è±¡.å®ä¾‹æˆå‘˜å˜é‡ï¼ˆå…ˆåˆ›å»ºå¯¹è±¡ï¼‰

æˆå‘˜æ–¹æ³•çš„è®¿é—®è¯­æ³•ï¼š

* é™æ€æ–¹æ³•ï¼šæœ‰ static ä¿®é¥°ï¼Œå±äºç±»

  * ç±»å.é™æ€æ–¹æ³•ï¼ˆåŒä¸€ä¸ªç±»ä¸­è®¿é—®é™æ€æˆå‘˜å¯ä»¥çœç•¥ç±»åä¸å†™ï¼‰
  * å¯¹è±¡.é™æ€æ–¹æ³•ï¼ˆä¸æ¨èï¼Œå‚è€ƒ JVM â†’ è¿è¡Œæœºåˆ¶ â†’ æ–¹æ³•è°ƒç”¨ï¼‰
  
* å®ä¾‹æ–¹æ³•ï¼šæ—  static ä¿®é¥°ï¼Œå±äºå¯¹è±¡

  * å¯¹è±¡.å®ä¾‹æ–¹æ³•
  
  ```java
  public class Student {
      // 1.é™æ€æ–¹æ³•ï¼šæœ‰staticä¿®é¥°ï¼Œå±äºç±»ï¼Œç›´æ¥ç”¨ç±»åè®¿é—®å³å¯ï¼
      public static void inAddr(){ }
      // 2.å®ä¾‹æ–¹æ³•ï¼šæ— staticä¿®é¥°ï¼Œå±äºå¯¹è±¡ï¼Œå¿…é¡»ç”¨å¯¹è±¡è®¿é—®ï¼
      public void eat(){}
      
      public static void main(String[] args) {
          // a.ç±»å.é™æ€æ–¹æ³•
          Student.inAddr();
          inAddr();
          // b.å¯¹è±¡.å®ä¾‹æ–¹æ³•
          // Student.eat(); // æŠ¥é”™äº†ï¼
          Student sea = new Student();
          sea.eat();
      }
  }
  ```



***



#### ä¸¤ä¸ªé—®é¢˜

å†…å­˜é—®é¢˜ï¼š

* æ ˆå†…å­˜å­˜æ”¾ main æ–¹æ³•å’Œåœ°å€

* å †å†…å­˜å­˜æ”¾å¯¹è±¡å’Œå˜é‡

* æ–¹æ³•åŒºå­˜æ”¾ class å’Œé™æ€å˜é‡ï¼ˆjdk8 ä»¥åç§»å…¥å †ï¼‰

è®¿é—®é—®é¢˜ï¼š

* å®ä¾‹æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹æˆå‘˜å˜é‡ï¼Ÿå¯ä»¥ï¼Œå› ä¸ºå®ƒä»¬éƒ½å±äºå¯¹è±¡
* å®ä¾‹æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®é™æ€æˆå‘˜å˜é‡ï¼Ÿå¯ä»¥ï¼Œé™æ€æˆå‘˜å˜é‡å¯ä»¥è¢«å…±äº«è®¿é—®
* å®ä¾‹æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹æ–¹æ³•? å¯ä»¥ï¼Œå®ä¾‹æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•éƒ½å±äºå¯¹è±¡
* å®ä¾‹æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®é™æ€æ–¹æ³•ï¼Ÿå¯ä»¥ï¼Œé™æ€æ–¹æ³•å¯ä»¥è¢«å…±äº«è®¿é—®
* é™æ€æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹å˜é‡ï¼Ÿ ä¸å¯ä»¥ï¼Œå®ä¾‹å˜é‡**å¿…é¡»ç”¨å¯¹è±¡è®¿é—®**ï¼ï¼
* é™æ€æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®é™æ€å˜é‡ï¼Ÿ å¯ä»¥ï¼Œé™æ€æˆå‘˜å˜é‡å¯ä»¥è¢«å…±äº«è®¿é—®ã€‚
* é™æ€æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹æ–¹æ³•? ä¸å¯ä»¥ï¼Œå®ä¾‹æ–¹æ³•å¿…é¡»ç”¨å¯¹è±¡è®¿é—®ï¼ï¼
* é™æ€æ–¹æ³•æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®é™æ€æ–¹æ³•ï¼Ÿå¯ä»¥ï¼Œé™æ€æ–¹æ³•å¯ä»¥è¢«å…±äº«è®¿é—®ï¼ï¼



------



### ç»§æ‰¿

#### åŸºæœ¬ä»‹ç»

ç»§æ‰¿æ˜¯ Java ä¸­ä¸€èˆ¬åˆ°ç‰¹æ®Šçš„å…³ç³»ï¼Œæ˜¯ä¸€ç§å­ç±»åˆ°çˆ¶ç±»çš„å…³ç³»

* è¢«ç»§æ‰¿çš„ç±»ç§°ä¸ºï¼šçˆ¶ç±»/è¶…ç±»
* ç»§æ‰¿çˆ¶ç±»çš„ç±»ç§°ä¸ºï¼šå­ç±»

ç»§æ‰¿çš„ä½œç”¨ï¼š

* **æé«˜ä»£ç çš„å¤ç”¨**ï¼Œç›¸åŒä»£ç å¯ä»¥å®šä¹‰åœ¨çˆ¶ç±»ä¸­
* å­ç±»ç»§æ‰¿çˆ¶ç±»ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨çˆ¶ç±»è¿™äº›ä»£ç ï¼ˆç›¸åŒä»£ç é‡å¤åˆ©ç”¨ï¼‰
* å­ç±»å¾—åˆ°çˆ¶ç±»çš„å±æ€§ï¼ˆæˆå‘˜å˜é‡ï¼‰å’Œè¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰ï¼Œè¿˜å¯ä»¥å®šä¹‰è‡ªå·±çš„åŠŸèƒ½ï¼Œå­ç±»æ›´å¼ºå¤§

ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š

1. å­ç±»çš„å…¨éƒ¨æ„é€ å™¨é»˜è®¤å…ˆè®¿é—®çˆ¶ç±»çš„æ— å‚æ•°æ„é€ å™¨ï¼Œå†æ‰§è¡Œè‡ªå·±çš„æ„é€ å™¨
2. **å•ç»§æ‰¿**ï¼šä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªç›´æ¥çˆ¶ç±»
3. å¤šå±‚ç»§æ‰¿ï¼šä¸€ä¸ªç±»å¯ä»¥é—´æ¥ç»§æ‰¿å¤šä¸ªçˆ¶ç±»ï¼ˆå®¶è°±ï¼‰
4. ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªå­ç±»
5. ä¸€ä¸ªç±»è¦ä¹ˆé»˜è®¤ç»§æ‰¿äº† Object ç±»ï¼Œè¦ä¹ˆé—´æ¥ç»§æ‰¿äº† Object ç±»ï¼Œ**Object ç±»æ˜¯ Java ä¸­çš„ç¥–å®—ç±»**

ç»§æ‰¿çš„æ ¼å¼ï¼š

```java
å­ç±» extends çˆ¶ç±»{

}
```

å­ç±»ä¸èƒ½ç»§æ‰¿çˆ¶ç±»çš„ä¸œè¥¿ï¼š

* å­ç±»ä¸èƒ½ç»§æ‰¿çˆ¶ç±»çš„æ„é€ å™¨ï¼Œå­ç±»æœ‰è‡ªå·±çš„æ„é€ å™¨
* å­ç±»æ˜¯ä¸èƒ½å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„ç§æœ‰æˆå‘˜çš„ï¼Œå¯ä»¥åå°„æš´åŠ›å»è®¿é—®ç»§æ‰¿è‡ªçˆ¶ç±»çš„ç§æœ‰æˆå‘˜
* å­ç±»æ˜¯ä¸èƒ½ç»§æ‰¿çˆ¶ç±»çš„é™æ€æˆå‘˜ï¼Œçˆ¶ç±»é™æ€æˆå‘˜åªæœ‰ä¸€ä»½å¯ä»¥è¢«å­ç±»å…±äº«è®¿é—®ï¼Œ**å…±äº«å¹¶éç»§æ‰¿**

```java
public class ExtendsDemo {
    public static void main(String[] args) {
        Cat c = new Cat();
        // c.run();
        Cat.test();
        System.out.println(Cat.schoolName);
    }
}

class Cat extends Animal{
}

class Animal{
    public static String schoolName ="seazean";
    public static void test(){}
    private void run(){}
}
```



***



#### å˜é‡è®¿é—®

ç»§æ‰¿åæˆå‘˜å˜é‡çš„è®¿é—®ç‰¹ç‚¹ï¼š**å°±è¿‘åŸåˆ™**ï¼Œå­ç±»æœ‰æ‰¾å­ç±»ï¼Œå­ç±»æ²¡æœ‰æ‰¾çˆ¶ç±»ï¼Œçˆ¶ç±»æ²¡æœ‰å°±æŠ¥é”™

å¦‚æœè¦ç”³æ˜è®¿é—®çˆ¶ç±»çš„æˆå‘˜å˜é‡å¯ä»¥ä½¿ç”¨ï¼šsuper.çˆ¶ç±»æˆå‘˜å˜é‡ï¼ŒsuperæŒ‡çˆ¶ç±»å¼•ç”¨

```java
public class ExtendsDemo {
    public static void wmain(String[] args) {
        Wolf w = new Wolf();w
        w.showName();
    }
}

class Wolf extends Animal{
    private String name = "å­ç±»ç‹¼";
    public void showName(){
        String name = "å±€éƒ¨åç§°";
        System.out.println(name); // å±€éƒ¨name
        System.out.println(this.name); // å­ç±»å¯¹è±¡çš„name
        System.out.println(super.name); // çˆ¶ç±»çš„
        System.out.println(name1); // çˆ¶ç±»çš„
        //System.out.println(name2); // æŠ¥é”™ã€‚å­ç±»çˆ¶ç±»éƒ½æ²¡æœ‰
    }
}

class Animal{
    public String name = "çˆ¶ç±»åŠ¨ç‰©åç§°";
    public String name1 = "çˆ¶ç±»";
}
```



***



#### æ–¹æ³•è®¿é—®

å­ç±»ç»§æ‰¿äº†çˆ¶ç±»å°±å¾—åˆ°äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œ**å¯ä»¥ç›´æ¥è°ƒç”¨**ï¼Œå—æƒé™ä¿®é¥°ç¬¦çš„é™åˆ¶ï¼Œä¹Ÿå¯ä»¥é‡å†™æ–¹æ³•

æ–¹æ³•é‡å†™ï¼šå­ç±»é‡å†™ä¸€ä¸ªä¸çˆ¶ç±»ç”³æ˜ä¸€æ ·çš„æ–¹æ³•æ¥**è¦†ç›–**çˆ¶ç±»çš„è¯¥æ–¹æ³•

æ–¹æ³•é‡å†™çš„æ ¡éªŒæ³¨è§£ï¼š@Override

* æ–¹æ³•åŠ äº†è¿™ä¸ªæ³¨è§£ï¼Œé‚£å°±å¿…é¡»æ˜¯æˆåŠŸé‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œå¦åˆ™æŠ¥é”™
* @Override ä¼˜åŠ¿ï¼šå¯è¯»æ€§å¥½ï¼Œå®‰å…¨ï¼Œä¼˜é›…

**å­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½**ï¼Œé‡å†™æœ‰ä»¥ä¸‹ä¸‰ä¸ªé™åˆ¶ï¼š

- å­ç±»æ–¹æ³•çš„è®¿é—®æƒé™å¿…é¡»å¤§äºç­‰äºçˆ¶ç±»æ–¹æ³•
- å­ç±»æ–¹æ³•çš„è¿”å›ç±»å‹å¿…é¡»æ˜¯çˆ¶ç±»æ–¹æ³•è¿”å›ç±»å‹æˆ–ä¸ºå…¶å­ç±»å‹
- å­ç±»æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹å¿…é¡»æ˜¯çˆ¶ç±»æŠ›å‡ºå¼‚å¸¸ç±»å‹æˆ–ä¸ºå…¶å­ç±»å‹

ç»§æ‰¿ä¸­çš„éšè—é—®é¢˜ï¼š

- å­ç±»å’Œçˆ¶ç±»æ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼Œé‚£ä¹ˆå­ç±»ä¸­çš„æ–¹æ³•ä¼šéšè—çˆ¶ç±»ä¸­çš„æ–¹æ³•
- åœ¨å­ç±»ä¸­å¯ä»¥å®šä¹‰å’Œçˆ¶ç±»æˆå‘˜å˜é‡åŒåçš„æˆå‘˜å˜é‡ï¼Œæ­¤æ—¶å­ç±»çš„æˆå‘˜å˜é‡éšè—äº†çˆ¶ç±»çš„æˆå‘˜å˜é‡ï¼Œåœ¨åˆ›å»ºå¯¹è±¡ä¸ºå¯¹è±¡åˆ†é…å†…å­˜çš„è¿‡ç¨‹ä¸­ï¼Œ**éšè—å˜é‡ä¾ç„¶ä¼šè¢«åˆ†é…å†…å­˜**

```java
public class ExtendsDemo {
    public static void main(String[] args) {
        Wolf w = new Wolf();
        w.run();
    }
}
class Wolf extends Animal{
    @Override
    public void run(){}//
}
class Animal{
    public void run(){}
}
```



***



#### å¸¸è§é—®é¢˜

* ä¸ºä»€ä¹ˆå­ç±»æ„é€ å™¨ä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Ÿ
  
  1. å­ç±»çš„æ„é€ å™¨çš„ç¬¬ä¸€è¡Œé»˜è®¤ super() è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ•°æ„é€ å™¨ï¼Œå†™ä¸å†™éƒ½å­˜åœ¨
  2. å­ç±»ç»§æ‰¿çˆ¶ç±»ï¼Œå­ç±»å°±å¾—åˆ°äº†çˆ¶ç±»çš„å±æ€§å’Œè¡Œä¸ºã€‚è°ƒç”¨å­ç±»æ„é€ å™¨åˆå§‹åŒ–å­ç±»å¯¹è±¡æ•°æ®æ—¶ï¼Œå¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»æ„é€ å™¨åˆå§‹åŒ–ç»§æ‰¿è‡ªçˆ¶ç±»çš„å±æ€§å’Œè¡Œä¸º
  3. å‚è€ƒ JVM â†’ ç±»åŠ è½½ â†’ å¯¹è±¡åˆ›å»º
  
  ```java
  class Animal {
      public Animal() {
          System.out.println("==çˆ¶ç±»Animalçš„æ— å‚æ•°æ„é€ å™¨==");
      }
  }
  
  class Tiger extends Animal {
      public Tiger() {
          super(); // é»˜è®¤å­˜åœ¨çš„ï¼Œæ ¹æ®å‚æ•°å»åŒ¹é…è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ã€‚
          System.out.println("==å­ç±»Tigerçš„æ— å‚æ•°æ„é€ å™¨==");
      }
      public Tiger(String name) {
          //super();  é»˜è®¤å­˜åœ¨çš„ï¼Œæ ¹æ®å‚æ•°å»åŒ¹é…è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ã€‚
          System.out.println("==å­ç±»Tigerçš„æœ‰å‚æ•°æ„é€ å™¨==");
      }
  }
  ```
  
* **ä¸ºä»€ä¹ˆ Java æ˜¯å•ç»§æ‰¿çš„ï¼Ÿ**
  
  ç­”ï¼šåè¯æ³•ï¼Œå‡å¦‚ Java å¯ä»¥å¤šç»§æ‰¿ï¼Œè¯·çœ‹å¦‚ä¸‹ä»£ç ï¼š
  
  ```java
  class A{
  	public void test(){
  		System.out.println("A");
  	}
  }
  class B{
  	public void test(){
  		System.out.println("B");
  	}
  }
  class C extends A , B {
  	public static void main(String[] args){
  		C c = new C();
          c.test(); 
          // å‡ºç°äº†ç±»çš„äºŒä¹‰æ€§ï¼æ‰€ä»¥Javaä¸èƒ½å¤šç»§æ‰¿ï¼ï¼
  	}
  }
  ```
  
  



------



### super

ç»§æ‰¿å super è°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œçˆ¶ç±»æ„é€ å™¨åˆå§‹åŒ–ç»§æ‰¿è‡ªçˆ¶ç±»çš„æ•°æ®ã€‚


æ€»ç»“ä¸æ‹“å±•ï¼š

* this ä»£è¡¨äº†å½“å‰å¯¹è±¡çš„å¼•ç”¨ï¼ˆç»§æ‰¿ä¸­æŒ‡ä»£å­ç±»å¯¹è±¡ï¼‰ï¼šthis.å­ç±»æˆå‘˜å˜é‡ã€this.å­ç±»æˆå‘˜æ–¹æ³•ã€**this(...)** å¯ä»¥æ ¹æ®å‚æ•°åŒ¹é…è®¿é—®æœ¬ç±»å…¶ä»–æ„é€ å™¨
* super ä»£è¡¨äº†çˆ¶ç±»å¯¹è±¡çš„å¼•ç”¨ï¼ˆç»§æ‰¿ä¸­æŒ‡ä»£äº†çˆ¶ç±»å¯¹è±¡ç©ºé—´ï¼‰ï¼šsuper.çˆ¶ç±»æˆå‘˜å˜é‡ã€super.çˆ¶ç±»çš„æˆå‘˜æ–¹æ³•ã€super(...) å¯ä»¥æ ¹æ®å‚æ•°åŒ¹é…è®¿é—®çˆ¶ç±»çš„æ„é€ å™¨

æ³¨æ„ï¼š

* this(...) å€Ÿç”¨æœ¬ç±»å…¶ä»–æ„é€ å™¨ï¼Œsuper(...) è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨
* this(...) æˆ– super(...) å¿…é¡»æ”¾åœ¨æ„é€ å™¨çš„ç¬¬ä¸€è¡Œï¼Œå¦åˆ™æŠ¥é”™
* this(...) å’Œ super(...) **ä¸èƒ½åŒæ—¶å‡ºç°**åœ¨æ„é€ å™¨ä¸­ï¼Œå› ä¸ºæ„é€ å‡½æ•°å¿…é¡»å‡ºç°åœ¨ç¬¬ä¸€è¡Œä¸Šï¼Œåªèƒ½é€‰æ‹©ä¸€ä¸ª

```java
public class ThisDemo {
    public static void main(String[] args) {
        // éœ€æ±‚ï¼šå¸Œæœ›å¦‚æœä¸å†™å­¦æ ¡é»˜è®¤å°±æ˜¯â€å¼ ä¸‰â€œï¼
        Student s1 = new Student("å¤©è“¬å…ƒå¸…", 1000 );
        Student s2 = new Student("é½å¤©å¤§åœ£", 2000, "æ¸…åå¤§å­¦" );
    }
}
class Study extends Student {
   public Study(String name, int age, String schoolName) {
        super(name , age , schoolName) ; 
       // æ ¹æ®å‚æ•°åŒ¹é…è°ƒç”¨çˆ¶ç±»æ„é€ å™¨
   }
}

class Student{
    private String name ;
    private int age ;
    private String schoolName ;

    public Student() {
    }
    public Student(String name , int age){
        // å€Ÿç”¨å…„å¼Ÿæ„é€ å™¨çš„åŠŸèƒ½ï¼
        this(name , age , "å¼ ä¸‰");
    }
	public Student(String name, int age, String schoolName) {
        this.name = name;
        this.age = age;
        this.schoolName = schoolName;
    }
	// .......get + set
}
```



***



### final

#### åŸºæœ¬ä»‹ç»

final ç”¨äºä¿®é¥°ï¼šç±»ï¼Œæ–¹æ³•ï¼Œå˜é‡

* final ä¿®é¥°ç±»ï¼Œç±»ä¸èƒ½è¢«ç»§æ‰¿äº†ï¼Œç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å¯ä»¥ä½¿ç”¨
* final å¯ä»¥ä¿®é¥°æ–¹æ³•ï¼Œæ–¹æ³•å°±ä¸èƒ½è¢«é‡å†™
* final ä¿®é¥°å˜é‡æ€»è§„åˆ™ï¼šå˜é‡æœ‰ä¸”ä»…èƒ½è¢«èµ‹å€¼ä¸€æ¬¡

final å’Œ abstract çš„å…³ç³»æ˜¯**äº’æ–¥å…³ç³»**ï¼Œä¸èƒ½åŒæ—¶ä¿®é¥°ç±»æˆ–è€…åŒæ—¶ä¿®é¥°æ–¹æ³•



***



#### ä¿®é¥°å˜é‡

##### é™æ€å˜é‡

final ä¿®é¥°é™æ€æˆå‘˜å˜é‡ï¼Œå˜é‡å˜æˆäº†å¸¸é‡

å¸¸é‡ï¼šæœ‰ public static final ä¿®é¥°ï¼Œåç§°å­—æ¯å…¨éƒ¨å¤§å†™ï¼Œå¤šä¸ªå•è¯ç”¨ä¸‹åˆ’çº¿è¿æ¥

final ä¿®é¥°é™æ€æˆå‘˜å˜é‡å¯ä»¥åœ¨å“ªäº›åœ°æ–¹èµ‹å€¼ï¼š

1. å®šä¹‰çš„æ—¶å€™èµ‹å€¼ä¸€æ¬¡

2. å¯ä»¥åœ¨é™æ€ä»£ç å—ä¸­èµ‹å€¼ä¸€æ¬¡

```java
public class FinalDemo {
	//å¸¸é‡ï¼špublic static finalä¿®é¥°ï¼Œåç§°å­—æ¯å…¨éƒ¨å¤§å†™ï¼Œä¸‹åˆ’çº¿è¿æ¥ã€‚
    public static final String SCHOOL_NAME = "å¼ ä¸‰" ;
    public static final String SCHOOL_NAME1;

    static{
        //SCHOOL_NAME = "java";//æŠ¥é”™
        SCHOOL_NAME1 = "å¼ ä¸‰1";
    }
}
```



***



##### å®ä¾‹å˜é‡

final ä¿®é¥°å˜é‡çš„æ€»è§„åˆ™ï¼šæœ‰ä¸”ä»…èƒ½è¢«èµ‹å€¼ä¸€æ¬¡

final ä¿®é¥°å®ä¾‹æˆå‘˜å˜é‡å¯ä»¥åœ¨å“ªäº›åœ°æ–¹èµ‹å€¼ 1 æ¬¡ï¼š

1. å®šä¹‰çš„æ—¶å€™èµ‹å€¼ä¸€æ¬¡
2. å¯ä»¥åœ¨å®ä¾‹ä»£ç å—ä¸­èµ‹å€¼ä¸€æ¬¡
3. å¯ä»¥åœ¨æ¯ä¸ªæ„é€ å™¨ä¸­èµ‹å€¼ä¸€æ¬¡

```java
public class FinalDemo {
    private final String name = "å¼ ä¸‰" ;
    private final String name1;
    private final String name2;
    {
        // å¯ä»¥åœ¨å®ä¾‹ä»£ç å—ä¸­èµ‹å€¼ä¸€æ¬¡ã€‚
        name1 = "å¼ ä¸‰1";
    }
	//æ„é€ å™¨èµ‹å€¼ä¸€æ¬¡
    public FinalDemo(){
        name2 = "å¼ ä¸‰2";
    }
    public FinalDemo(String a){
        name2 = "å¼ ä¸‰2";
    }

    public static void main(String[] args) {
        FinalDemo f1 = new FinalDemo();
        //f1.name = "å¼ ä¸‰1"; // ç¬¬äºŒæ¬¡èµ‹å€¼ æŠ¥é”™ï¼
    }
}
```



***



### æŠ½è±¡ç±»

#### åŸºæœ¬ä»‹ç»

> çˆ¶ç±»çŸ¥é“å­ç±»è¦å®ŒæˆæŸä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯æ¯ä¸ªå­ç±»å®ç°æƒ…å†µä¸ä¸€æ ·

æŠ½è±¡æ–¹æ³•ï¼šæ²¡æœ‰æ–¹æ³•ä½“ï¼Œåªæœ‰æ–¹æ³•ç­¾åï¼Œå¿…é¡»ç”¨ abstract ä¿®é¥°çš„æ–¹æ³•å°±æ˜¯æŠ½è±¡æ–¹æ³•

æŠ½è±¡ç±»ï¼šæ‹¥æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»å¿…é¡»å®šä¹‰æˆæŠ½è±¡ç±»ï¼Œå¿…é¡»ç”¨ abstract ä¿®é¥°ï¼Œ**æŠ½è±¡ç±»æ˜¯ä¸ºäº†è¢«ç»§æ‰¿**

ä¸€ä¸ªç±»ç»§æ‰¿æŠ½è±¡ç±»ï¼Œ**å¿…é¡»é‡å†™æŠ½è±¡ç±»çš„å…¨éƒ¨æŠ½è±¡æ–¹æ³•**ï¼Œå¦åˆ™è¿™ä¸ªç±»å¿…é¡»å®šä¹‰æˆæŠ½è±¡ç±»

```java
public class AbstractDemo {
    public static void main(String[] args) {
        Dog d = new Dog();
        d.run();
    }
}

class Dog extends Animal{
    @Override
    public void run() { 
        System.out.println("ğŸ•è·‘"); 
    }
}

abstract class Animal{
    public abstract void run();
}
```



***



#### å¸¸è§é—®é¢˜

ä¸€ã€æŠ½è±¡ç±»æ˜¯å¦æœ‰æ„é€ å™¨ï¼Œæ˜¯å¦å¯ä»¥åˆ›å»ºå¯¹è±¡?

* æŠ½è±¡ç±»æœ‰æ„é€ å™¨ï¼Œä½†æ˜¯æŠ½è±¡ç±»ä¸èƒ½åˆ›å»ºå¯¹è±¡ï¼Œç±»çš„å…¶ä»–æˆåˆ†å®ƒéƒ½å…·å¤‡ï¼Œæ„é€ å™¨æä¾›ç»™å­ç±»ç»§æ‰¿åè°ƒç”¨çˆ¶ç±»æ„é€ å™¨ä½¿ç”¨
* æŠ½è±¡ç±»ä¸­å­˜åœ¨æŠ½è±¡æ–¹æ³•ï¼Œä½†ä¸èƒ½æ‰§è¡Œï¼Œ**æŠ½è±¡ç±»ä¸­ä¹Ÿå¯æ²¡æœ‰æŠ½è±¡æ–¹æ³•**

> æŠ½è±¡åœ¨å­¦æœ¯ä¸Šæœ¬èº«æ„å‘³ç€ä¸èƒ½å®ä¾‹åŒ–

```java
public class AbstractDemo {
    public static void main(String[] args) {
        //Animal a = new Animal(); æŠ½è±¡ç±»ä¸èƒ½åˆ›å»ºå¯¹è±¡ï¼
        //a.run(); // æŠ½è±¡æ–¹æ³•ä¸èƒ½æ‰§è¡Œ
    }
}
abstract class Animal{
    private String name;
    public static String schoolName = "å¼ ä¸‰";
    public Animal(){ }

    public abstract void run();
    //æ™®é€šæ–¹æ³•
    public void go(){ }
}
```

äºŒã€static ä¸ abstract èƒ½åŒæ—¶ä½¿ç”¨å—ï¼Ÿ

ç­”ï¼šä¸èƒ½ï¼Œè¢« static ä¿®é¥°çš„æ–¹æ³•å±äºç±»ï¼Œæ˜¯ç±»è‡ªå·±çš„ä¸œè¥¿ï¼Œä¸æ˜¯ç»™å­ç±»æ¥ç»§æ‰¿çš„ï¼Œè€ŒæŠ½è±¡æ–¹æ³•æœ¬èº«æ²¡æœ‰å®ç°ï¼Œå°±æ˜¯ç”¨æ¥ç»™å­ç±»ç»§æ‰¿



***



#### å­˜åœ¨æ„ä¹‰

**è¢«ç»§æ‰¿**ï¼ŒæŠ½è±¡ç±»å°±æ˜¯ä¸ºäº†è¢«å­ç±»ç»§æ‰¿ï¼Œå¦åˆ™æŠ½è±¡ç±»å°†æ¯«æ— æ„ä¹‰ï¼ˆæ ¸å¿ƒï¼‰

æŠ½è±¡ç±»ä½“ç°çš„æ˜¯"æ¨¡æ¿æ€æƒ³"ï¼š**éƒ¨åˆ†å®ç°ï¼Œéƒ¨åˆ†æŠ½è±¡**ï¼Œå¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»è®¾è®¡ä¸€ä¸ªæ¨¡æ¿æ¨¡å¼

```java
//ä½œæ–‡æ¨¡æ¿
public class ExtendsDemo {
    public static void main(String[] args) {
        Student xiaoMa = new Student();
        xiaoMa.write();
    }
}
class Student extends Template{
    @Override
    public String writeText() {return "\tå†…å®¹"}
}
// 1.å†™ä¸€ä¸ªæ¨¡æ¿ç±»ï¼šä»£è¡¨äº†ä½œæ–‡æ¨¡æ¿ã€‚
abstract class Template{
    private String title = "\t\t\t\t\tæ ‡é¢˜";
    private String start = "\tå¼€å¤´";
    private String last = "\tç»“å°¾";
    public void write(){
        System.out.println(title+"\n"+start);
        System.out.println(writeText());
        System.out.println(last);
    }
    // æ­£æ–‡éƒ¨åˆ†å®šä¹‰æˆæŠ½è±¡æ–¹æ³•ï¼Œäº¤ç»™å­ç±»é‡å†™ï¼ï¼
    public abstract String writeText();
}
```



***



### æ¥å£

#### åŸºæœ¬ä»‹ç»

æ¥å£æ˜¯ Java è¯­è¨€ä¸­ä¸€ç§å¼•ç”¨ç±»å‹ï¼Œæ˜¯æ–¹æ³•çš„é›†åˆã€‚

æ¥å£æ˜¯æ›´åŠ å½»åº•çš„æŠ½è±¡ï¼Œæ¥å£ä¸­åªæœ‰æŠ½è±¡æ–¹æ³•å’Œå¸¸é‡ï¼Œæ²¡æœ‰å…¶ä»–æˆåˆ†

```java
 ä¿®é¥°ç¬¦ interface æ¥å£åç§°{
	// æŠ½è±¡æ–¹æ³•
	// é»˜è®¤æ–¹æ³•
	// é™æ€æ–¹æ³•
	// ç§æœ‰æ–¹æ³•
}
```

* æŠ½è±¡æ–¹æ³•ï¼šæ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•é»˜è®¤ä¼šåŠ ä¸Š public abstract ä¿®é¥°ï¼Œæ‰€ä»¥å¯ä»¥çœç•¥ä¸å†™

* é™æ€æ–¹æ³•ï¼šé™æ€æ–¹æ³•å¿…é¡»æœ‰æ–¹æ³•ä½“

* å¸¸é‡ï¼šæ˜¯ public static final ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œä»…èƒ½è¢«èµ‹å€¼ä¸€æ¬¡ï¼Œå€¼ä¸èƒ½æ”¹å˜ã€‚å¸¸é‡çš„åç§°è§„èŒƒä¸Šè¦æ±‚å…¨éƒ¨å¤§å†™ï¼Œå¤šä¸ªå•è¯ä¸‹åˆ’çº¿è¿æ¥ï¼Œpublic static final å¯ä»¥çœç•¥ä¸å†™

  ```java
  public interface InterfaceDemo{
      //public static final String SCHOOL_NAME = "å¼ ä¸‰";
  	String SCHOOL_NAME = "å¼ ä¸‰";
      
      //public abstract void run();
      void run();//é»˜è®¤è¡¥å……
  }
  ```




***




#### å®ç°æ¥å£

**æ¥å£æ˜¯ç”¨æ¥è¢«ç±»å®ç°çš„ã€‚**

* ç±»ä¸ç±»æ˜¯ç»§æ‰¿å…³ç³»ï¼šä¸€ä¸ªç±»åªèƒ½ç›´æ¥ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œå•ç»§æ‰¿
* ç±»ä¸æ¥å£æ˜¯å®ç°å…³ç³»ï¼šä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œå¤šå®ç°ï¼Œæ¥å£ä¸èƒ½ç»§æ‰¿ç±»
* æ¥å£ä¸æ¥å£ç»§æ‰¿å…³ç³»ï¼š**å¤šç»§æ‰¿**

```java
ä¿®é¥°ç¬¦ class å®ç°ç±»åç§° implements æ¥å£1,æ¥å£2,æ¥å£3,....{

}
ä¿®é¥°ç¬¦ interface æ¥å£å extend æ¥å£1,æ¥å£2,æ¥å£3,....{
    
}
```

å®ç°å¤šä¸ªæ¥å£çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼š

1. å½“ä¸€ä¸ªç±»å®ç°å¤šä¸ªæ¥å£æ—¶ï¼Œå¤šä¸ªæ¥å£ä¸­å­˜åœ¨åŒåçš„é™æ€æ–¹æ³•å¹¶ä¸ä¼šå†²çªï¼Œåªèƒ½é€šè¿‡å„è‡ªæ¥å£åè®¿é—®é™æ€æ–¹æ³•

2. å½“ä¸€ä¸ªç±»å®ç°å¤šä¸ªæ¥å£æ—¶ï¼Œå¤šä¸ªæ¥å£ä¸­å­˜åœ¨åŒåçš„é»˜è®¤æ–¹æ³•ï¼Œå®ç°ç±»å¿…é¡»é‡å†™è¿™ä¸ªæ–¹æ³•

3. å½“ä¸€ä¸ªç±»æ—¢ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œåˆå®ç°è‹¥å¹²ä¸ªæ¥å£æ—¶ï¼Œçˆ¶ç±»ä¸­æˆå‘˜æ–¹æ³•ä¸æ¥å£ä¸­é»˜è®¤æ–¹æ³•é‡åï¼Œå­ç±»**å°±è¿‘é€‰æ‹©æ‰§è¡Œçˆ¶ç±»**çš„æˆå‘˜æ–¹æ³•

4. æ¥å£ä¸­ï¼Œæ²¡æœ‰æ„é€ å™¨ï¼Œ**ä¸èƒ½åˆ›å»ºå¯¹è±¡**ï¼Œæ¥å£æ˜¯æ›´å½»åº•çš„æŠ½è±¡ï¼Œè¿æ„é€ å™¨éƒ½æ²¡æœ‰ï¼Œè‡ªç„¶ä¸èƒ½åˆ›å»ºå¯¹è±¡

   ```java
   public class InterfaceDemo {
       public static void main(String[] args) {
           Student s = new Student();
           s.run();
           s.rule();
       }
   }
   class Student implements Food, Person{
       @Override
       public void eat() {}
       
       @Override
       public void run() {}
   }
   interface Food{
       void eat();
   }
   interface Person{
       void run();
   }
   //å¯ä»¥ç›´æ¥ interface Person extend Food,
   //ç„¶å class Student implements Person æ•ˆæœä¸€æ ·
   ```

   

***



#### æ–°å¢åŠŸèƒ½

jdk1.8 ä»¥åæ–°å¢çš„åŠŸèƒ½ï¼š

* é»˜è®¤æ–¹æ³•ï¼ˆå°±æ˜¯æ™®é€šå®ä¾‹æ–¹æ³•ï¼‰
  * å¿…é¡»ç”¨ default ä¿®é¥°ï¼Œé»˜è®¤ä¼š public ä¿®é¥°
  * å¿…é¡»ç”¨æ¥å£çš„å®ç°ç±»çš„å¯¹è±¡æ¥è°ƒç”¨
  * å¿…é¡»æœ‰é»˜è®¤å®ç°
* é™æ€æ–¹æ³•
  * é»˜è®¤ä¼š public ä¿®é¥°
  * æ¥å£çš„é™æ€æ–¹æ³•å¿…é¡»ç”¨æ¥å£çš„ç±»åæœ¬èº«æ¥è°ƒç”¨
  * è°ƒç”¨æ ¼å¼ï¼šClassName.method()
  * å¿…é¡»æœ‰é»˜è®¤å®ç°
* ç§æœ‰æ–¹æ³•ï¼šJDK 1.9 æ‰å¼€å§‹æœ‰çš„ï¼Œåªèƒ½åœ¨**æœ¬ç±»ä¸­**è¢«å…¶ä»–çš„é»˜è®¤æ–¹æ³•æˆ–è€…ç§æœ‰æ–¹æ³•è®¿é—®

```java
public class InterfaceDemo {
    public static void main(String[] args) {
        // 1.é»˜è®¤æ–¹æ³•è°ƒç”¨ï¼šå¿…é¡»ç”¨æ¥å£çš„å®ç°ç±»å¯¹è±¡è°ƒç”¨ã€‚
        Man m = new Man();
        m.run();
        m.work();

        // 2.æ¥å£çš„é™æ€æ–¹æ³•å¿…é¡»ç”¨æ¥å£çš„ç±»åæœ¬èº«æ¥è°ƒç”¨ã€‚
        InterfaceJDK8.inAddr();
    }
}
class Man implements InterfaceJDK8 {
    @Override
    public void work() {
        System.out.println("å·¥ä½œä¸­ã€‚ã€‚ã€‚");
    }
}

interface InterfaceJDK8 {
    //æŠ½è±¡æ–¹æ³•ï¼ï¼
    void work();
    // a.é»˜è®¤æ–¹æ³•ï¼ˆå°±æ˜¯ä¹‹å‰å†™çš„æ™®é€šå®ä¾‹æ–¹æ³•ï¼‰
    // å¿…é¡»ç”¨æ¥å£çš„å®ç°ç±»çš„å¯¹è±¡æ¥è°ƒç”¨ã€‚
    default void run() {
        go();
        System.out.println("å¼€å§‹è·‘æ­¥ğŸƒâ€");
    }

    // b.é™æ€æ–¹æ³•
    // æ³¨æ„ï¼šæ¥å£çš„é™æ€æ–¹æ³•å¿…é¡»ç”¨æ¥å£çš„ç±»åæœ¬èº«æ¥è°ƒç”¨
    static void inAddr() {
        System.out.println("æˆ‘ä»¬åœ¨æ­¦æ±‰");
    }
    
    // c.ç§æœ‰æ–¹æ³•ï¼ˆå°±æ˜¯ç§æœ‰çš„å®ä¾‹æ–¹æ³•ï¼‰: JDK 1.9æ‰å¼€å§‹æœ‰çš„ã€‚
    // åªèƒ½åœ¨æœ¬æ¥å£ä¸­è¢«å…¶ä»–çš„é»˜è®¤æ–¹æ³•æˆ–è€…ç§æœ‰æ–¹æ³•è®¿é—®ã€‚
    private void go() {
        System.out.println("å¼€å§‹ã€‚ã€‚");
    }
}
```



***



#### å¯¹æ¯”æŠ½è±¡ç±»

| **å‚æ•°**           | **æŠ½è±¡ç±»**                                                   | **æ¥å£**                                                     |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| é»˜è®¤çš„æ–¹æ³•å®ç°     | å¯ä»¥æœ‰é»˜è®¤çš„æ–¹æ³•å®ç°                                         | æ¥å£å®Œå…¨æ˜¯æŠ½è±¡çš„ï¼Œjdk8 ä»¥åæœ‰é»˜è®¤çš„å®ç°                      |
| å®ç°               | å­ç±»ä½¿ç”¨ **extends** å…³é”®å­—æ¥ç»§æ‰¿æŠ½è±¡ç±»ã€‚å¦‚æœå­ç±»ä¸æ˜¯æŠ½è±¡ç±»çš„è¯ï¼Œå®ƒéœ€è¦æä¾›æŠ½è±¡ç±»ä¸­æ‰€æœ‰å£°æ˜çš„æ–¹æ³•çš„å®ç°ã€‚ | å­ç±»ä½¿ç”¨å…³é”®å­— **implements** æ¥å®ç°æ¥å£ã€‚å®ƒéœ€è¦æä¾›æ¥å£ä¸­æ‰€æœ‰å£°æ˜çš„æ–¹æ³•çš„å®ç° |
| æ„é€ å™¨             | æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å™¨                                           | æ¥å£ä¸èƒ½æœ‰æ„é€ å™¨                                             |
| ä¸æ­£å¸¸Javaç±»çš„åŒºåˆ« | é™¤äº†ä¸èƒ½å®ä¾‹åŒ–æŠ½è±¡ç±»ä¹‹å¤–ï¼Œå’Œæ™®é€š Java ç±»æ²¡æœ‰ä»»ä½•åŒºåˆ«         | æ¥å£æ˜¯å®Œå…¨ä¸åŒçš„ç±»å‹                                         |
| è®¿é—®ä¿®é¥°ç¬¦         | æŠ½è±¡æ–¹æ³•æœ‰ **public**ã€**protected** å’Œ **default** è¿™äº›ä¿®é¥°ç¬¦ | æ¥å£é»˜è®¤ä¿®é¥°ç¬¦æ˜¯ **public**ï¼Œåˆ«çš„ä¿®é¥°ç¬¦éœ€è¦æœ‰æ–¹æ³•ä½“          |
| mainæ–¹æ³•           | æŠ½è±¡æ–¹æ³•å¯ä»¥æœ‰ main æ–¹æ³•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥è¿è¡Œå®ƒ                   | jdk8 ä»¥å‰æ¥å£æ²¡æœ‰ main æ–¹æ³•ï¼Œä¸èƒ½è¿è¡Œï¼›jdk8 ä»¥åæ¥å£å¯ä»¥æœ‰ default å’Œ static æ–¹æ³•ï¼Œå¯ä»¥è¿è¡Œ main æ–¹æ³• |
| å¤šç»§æ‰¿             | æŠ½è±¡æ–¹æ³•å¯ä»¥ç»§æ‰¿ä¸€ä¸ªç±»å’Œå®ç°å¤šä¸ªæ¥å£                         | æ¥å£å¯ä»¥ç»§æ‰¿ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒæ¥å£ï¼Œæ¥å£ä¸å¯ç»§æ‰¿ç±»               |
| é€Ÿåº¦               | æ¯”æ¥å£é€Ÿåº¦è¦å¿«                                               | æ¥å£æ˜¯ç¨å¾®æœ‰ç‚¹æ…¢çš„ï¼Œå› ä¸ºå®ƒéœ€è¦æ—¶é—´å»å¯»æ‰¾åœ¨ç±»ä¸­å®ç°çš„æ–¹æ³•     |
| æ·»åŠ æ–°æ–¹æ³•         | å¦‚æœå¾€æŠ½è±¡ç±»ä¸­æ·»åŠ æ–°çš„æ–¹æ³•ï¼Œå¯ä»¥ç»™å®ƒæä¾›é»˜è®¤çš„å®ç°ï¼Œå› æ­¤ä¸éœ€è¦æ”¹å˜ç°åœ¨çš„ä»£ç  | å¦‚æœå¾€æ¥å£ä¸­æ·»åŠ æ–¹æ³•ï¼Œé‚£ä¹ˆå¿…é¡»æ”¹å˜å®ç°è¯¥æ¥å£çš„ç±»             |





------



### å¤šæ€

#### åŸºæœ¬ä»‹ç»

å¤šæ€çš„æ¦‚å¿µï¼šåŒä¸€ä¸ªå®ä½“åŒæ—¶å…·æœ‰å¤šç§å½¢å¼åŒä¸€ä¸ªç±»å‹çš„å¯¹è±¡ï¼Œæ‰§è¡ŒåŒä¸€ä¸ªè¡Œä¸ºï¼Œåœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ä¼šè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºç‰¹å¾

å¤šæ€çš„æ ¼å¼ï¼š

* çˆ¶ç±»ç±»å‹èŒƒå›´ > å­ç±»ç±»å‹èŒƒå›´

```java
çˆ¶ç±»ç±»å‹ å¯¹è±¡åç§° = new å­ç±»æ„é€ å™¨;
æ¥å£	  å¯¹è±¡åç§° = new å®ç°ç±»æ„é€ å™¨;
```

å¤šæ€çš„æ‰§è¡Œï¼š

* å¯¹äºæ–¹æ³•çš„è°ƒç”¨ï¼š**ç¼–è¯‘çœ‹å·¦è¾¹ï¼Œè¿è¡Œçœ‹å³è¾¹**ï¼ˆåˆ†æ´¾æœºåˆ¶ï¼‰
* å¯¹äºå˜é‡çš„è°ƒç”¨ï¼š**ç¼–è¯‘çœ‹å·¦è¾¹ï¼Œè¿è¡Œçœ‹å·¦è¾¹**

å¤šæ€çš„ä½¿ç”¨è§„åˆ™ï¼š

* å¿…é¡»å­˜åœ¨ç»§æ‰¿æˆ–è€…å®ç°å…³ç³»
* å¿…é¡»å­˜åœ¨çˆ¶ç±»ç±»å‹çš„å˜é‡å¼•ç”¨å­ç±»ç±»å‹çš„å¯¹è±¡
* å­˜åœ¨æ–¹æ³•é‡å†™

å¤šæ€çš„ä¼˜åŠ¿ï¼š
* åœ¨å¤šæ€å½¢å¼ä¸‹ï¼Œå³è¾¹å¯¹è±¡å¯ä»¥å®ç°ç»„ä»¶åŒ–åˆ‡æ¢ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤ï¼Œä¹Ÿå¯ä»¥å®ç°ç±»ä¸ç±»ä¹‹é—´çš„**è§£è€¦**
* çˆ¶ç±»ç±»å‹ä½œä¸ºæ–¹æ³•å½¢å¼å‚æ•°ï¼Œä¼ é€’å­ç±»å¯¹è±¡ç»™æ–¹æ³•ï¼Œå¯ä»¥ä¼ å…¥ä¸€åˆ‡å­ç±»å¯¹è±¡è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨ï¼Œæ›´èƒ½ä½“ç°å‡ºå¤šæ€çš„**æ‰©å±•æ€§**ä¸ä¾¿åˆ©æ€§

å¤šæ€çš„åŠ£åŠ¿ï¼š 
* å¤šæ€å½¢å¼ä¸‹ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨å­ç±»ç‰¹æœ‰çš„åŠŸèƒ½ï¼Œå› ä¸ºç¼–è¯‘çœ‹å·¦è¾¹ï¼Œçˆ¶ç±»ä¸­æ²¡æœ‰å­ç±»ç‹¬æœ‰çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä»£ç åœ¨ç¼–è¯‘é˜¶æ®µå°±ç›´æ¥æŠ¥é”™äº†

```java
public class PolymorphicDemo {
    public static void main(String[] args) {
        Animal c = new Cat();
        c.run();
        //c.eat();//æŠ¥é”™  ç¼–è¯‘çœ‹å·¦è¾¹ éœ€è¦å¼ºè½¬
        go(c);
        go(new Dog);   
    }
    //ç”¨ Dogæˆ–è€…Cat éƒ½æ²¡åŠæ³•è®©æ‰€æœ‰åŠ¨ç‰©å‚ä¸è¿›æ¥ï¼Œåªèƒ½ç”¨Anima
    public static void go(Animal d){}
    
}
class Dog extends Animal{}

class Cat extends Animal{
    public void eat();
    @Override
    public void run(){}
}

class Animal{
    public void run(){}
}
```



***



#### ä¸Šä¸‹è½¬å‹

>åŸºæœ¬æ•°æ®ç±»å‹çš„è½¬æ¢ï¼š
>
>1. å°èŒƒå›´ç±»å‹çš„å˜é‡æˆ–è€…å€¼å¯ä»¥ç›´æ¥èµ‹å€¼ç»™å¤§èŒƒå›´ç±»å‹çš„å˜é‡
>2. å¤§èŒƒå›´ç±»å‹çš„å˜é‡æˆ–è€…å€¼å¿…é¡»å¼ºåˆ¶ç±»å‹è½¬æ¢ç»™å°èŒƒå›´ç±»å‹çš„å˜é‡

å¼•ç”¨æ•°æ®ç±»å‹çš„**è‡ªåŠ¨**ç±»å‹è½¬æ¢è¯­æ³•ï¼šå­ç±»ç±»å‹çš„å¯¹è±¡æˆ–è€…å˜é‡å¯ä»¥è‡ªåŠ¨ç±»å‹è½¬æ¢èµ‹å€¼ç»™çˆ¶ç±»ç±»å‹çš„å˜é‡

**çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡**

- **å‘ä¸Šè½¬å‹ (upcasting)**ï¼šé€šè¿‡å­ç±»å¯¹è±¡ï¼ˆå°èŒƒå›´ï¼‰å®ä¾‹åŒ–çˆ¶ç±»å¯¹è±¡ï¼ˆå¤§èŒƒå›´ï¼‰ï¼Œè¿™ç§å±äºè‡ªåŠ¨è½¬æ¢
- **å‘ä¸‹è½¬å‹ (downcasting)**ï¼šé€šè¿‡çˆ¶ç±»å¯¹è±¡ï¼ˆå¤§èŒƒå›´ï¼‰å®ä¾‹åŒ–å­ç±»å¯¹è±¡ï¼ˆå°èŒƒå›´ï¼‰ï¼Œè¿™ç§å±äºå¼ºåˆ¶è½¬æ¢

```java
public class PolymorphicDemo {
    public static void main(String[] args){
        Animal a = new Cat();	// å‘ä¸Šè½¬å‹
        Cat c = (Cat)a;			// å‘ä¸‹è½¬å‹
    }
}
class Animal{}
class Cat extends Animal{}
```



***



#### instanceof

instanceofï¼šåˆ¤æ–­å·¦è¾¹çš„å¯¹è±¡æ˜¯å¦æ˜¯å³è¾¹çš„ç±»çš„å®ä¾‹ï¼Œæˆ–è€…æ˜¯å…¶ç›´æ¥æˆ–é—´æ¥å­ç±»ï¼Œæˆ–è€…æ˜¯å…¶æ¥å£çš„å®ç°ç±»

* å¼•ç”¨ç±»å‹å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šçˆ¶ç±»ç±»å‹çš„å˜é‡æˆ–è€…å¯¹è±¡å¼ºåˆ¶ç±»å‹è½¬æ¢æˆå­ç±»ç±»å‹çš„å˜é‡ï¼Œå¦åˆ™æŠ¥é”™
* å¼ºåˆ¶ç±»å‹è½¬æ¢çš„æ ¼å¼ï¼š**ç±»å‹ å˜é‡åç§° = (ç±»å‹)(å¯¹è±¡æˆ–è€…å˜é‡)**
* æœ‰ç»§æ‰¿/å®ç°å…³ç³»çš„ä¸¤ä¸ªç±»å‹å°±å¯ä»¥è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œç¼–è¯‘é˜¶æ®µä¸€å®šä¸æŠ¥é”™ï¼Œä½†æ˜¯è¿è¡Œé˜¶æ®µå¯èƒ½å‡ºç°ç±»å‹è½¬æ¢å¼‚å¸¸ ClassCastException

```java
public class Demo{
    public static void main(String[] args){
		Aniaml a = new Dog();
		//Dog d = (Dog)a;
        //Cat c = (Cat)a; ç¼–è¯‘ä¸æŠ¥é”™ï¼Œè¿è¡ŒæŠ¥ClassCastExceptioné”™è¯¯
        if(a instanceof Cat){
            Cat c = (Cat)a; 
        } else if(a instanceof Dog) {
            Dog d = (Dog)a;
        }
    }
}
class Dog extends Animal{}
class Cat extends Animal{}
class Animal{}
```



***



### å†…éƒ¨ç±»

#### æ¦‚è¿°

å†…éƒ¨ç±»æ˜¯ç±»çš„äº”å¤§æˆåˆ†ä¹‹ä¸€ï¼šæˆå‘˜å˜é‡ï¼Œæ–¹æ³•ï¼Œæ„é€ å™¨ï¼Œä»£ç å—ï¼Œå†…éƒ¨ç±»

æ¦‚å¿µï¼šå®šä¹‰åœ¨ä¸€ä¸ªç±»é‡Œé¢çš„ç±»å°±æ˜¯å†…éƒ¨ç±»

ä½œç”¨ï¼šæä¾›æ›´å¥½çš„å°è£…æ€§ï¼Œä½“ç°å‡ºç»„ä»¶æ€æƒ³ï¼Œ**é—´æ¥è§£å†³ç±»æ— æ³•å¤šç»§æ‰¿å¼•èµ·çš„ä¸€ç³»åˆ—é—®é¢˜**

åˆ†ç±»ï¼šé™æ€å†…éƒ¨ç±»ã€å®ä¾‹å†…éƒ¨ç±»ï¼ˆæˆå‘˜å†…éƒ¨ç±»ï¼‰ã€å±€éƒ¨å†…éƒ¨ç±»ã€**åŒ¿åå†…éƒ¨ç±»**ï¼ˆé‡ç‚¹ï¼‰



***



#### é™æ€å†…éƒ¨ç±»

å®šä¹‰ï¼šæœ‰ static ä¿®é¥°ï¼Œå±äºå¤–éƒ¨ç±»æœ¬èº«ï¼Œä¼šåŠ è½½ä¸€æ¬¡

é™æ€å†…éƒ¨ç±»ä¸­çš„æˆåˆ†ç ”ç©¶ï¼š

* ç±»æœ‰çš„æˆåˆ†å®ƒéƒ½æœ‰ï¼Œé™æ€å†…éƒ¨ç±»å±äºå¤–éƒ¨ç±»æœ¬èº«ï¼Œåªä¼šåŠ è½½ä¸€æ¬¡
* ç‰¹ç‚¹ä¸å¤–éƒ¨ç±»æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œåªæ˜¯ä½ç½®åœ¨åˆ«äººé‡Œé¢
* å¯ä»¥å®šä¹‰é™æ€æˆå‘˜

é™æ€å†…éƒ¨ç±»çš„è®¿é—®æ ¼å¼ï¼šå¤–éƒ¨ç±»åç§°.å†…éƒ¨ç±»åç§°

é™æ€å†…éƒ¨ç±»åˆ›å»ºå¯¹è±¡çš„æ ¼å¼ï¼šå¤–éƒ¨ç±»åç§°.å†…éƒ¨ç±»åç§° å¯¹è±¡åç§° = new å¤–éƒ¨ç±»åç§°.å†…éƒ¨ç±»æ„é€ å™¨

é™æ€å†…éƒ¨ç±»çš„è®¿é—®æ‹“å±•ï¼š

* é™æ€å†…éƒ¨ç±»ä¸­æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„é™æ€æˆå‘˜?	å¯ä»¥ï¼Œå¤–éƒ¨ç±»çš„é™æ€æˆå‘˜åªæœ‰ä¸€ä»½ï¼Œå¯ä»¥è¢«å…±äº«
* é™æ€å†…éƒ¨ç±»ä¸­æ˜¯å¦å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„å®ä¾‹æˆå‘˜?	ä¸å¯ä»¥ï¼Œå¤–éƒ¨ç±»çš„æˆå‘˜å¿…é¡»ç”¨å¤–éƒ¨ç±»å¯¹è±¡è®¿é—®

```java
public class Demo{
    public static void main(String[] args){
        Outter.Inner in = new Outter.Inner();
    }
}

static class Outter{
    public static int age;
    private double salary;
    public static class Inner{
         //æ‹¥æœ‰ç±»çš„æ‰€æœ‰åŠŸèƒ½ æ„é€ å™¨ æ–¹æ³• æˆå‘˜å˜é‡
         System.out.println(age);
         //System.out.println(salary);æŠ¥é”™
	}
}
```



***



#### å®ä¾‹å†…éƒ¨ç±»

å®šä¹‰ï¼šæ—  static ä¿®é¥°çš„å†…éƒ¨ç±»ï¼Œå±äºå¤–éƒ¨ç±»çš„æ¯ä¸ªå¯¹è±¡ï¼Œè·Ÿç€å¤–éƒ¨ç±»å¯¹è±¡ä¸€èµ·åŠ è½½

å®ä¾‹å†…éƒ¨ç±»çš„æˆåˆ†ç‰¹ç‚¹ï¼šå®ä¾‹å†…éƒ¨ç±»ä¸­ä¸èƒ½å®šä¹‰é™æ€æˆå‘˜ï¼Œå…¶ä»–éƒ½å¯ä»¥å®šä¹‰

å®ä¾‹å†…éƒ¨ç±»çš„è®¿é—®æ ¼å¼ï¼šå¤–éƒ¨ç±»åç§°.å†…éƒ¨ç±»åç§°

åˆ›å»ºå¯¹è±¡çš„æ ¼å¼ï¼šå¤–éƒ¨ç±»åç§°.å†…éƒ¨ç±»åç§° å¯¹è±¡åç§° = new å¤–éƒ¨ç±»æ„é€ å™¨.new å†…éƒ¨æ„é€ å™¨

* `Outter.Inner in = new Outter().new Inner()`

**å®ä¾‹å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„å…¨éƒ¨æˆå‘˜**

* å®ä¾‹å†…éƒ¨ç±»ä¸­å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„é™æ€æˆå‘˜ï¼Œå¤–éƒ¨ç±»çš„é™æ€æˆå‘˜å¯ä»¥è¢«å…±äº«è®¿é—®
* å®ä¾‹å†…éƒ¨ç±»ä¸­å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„å®ä¾‹æˆå‘˜ï¼Œå®ä¾‹å†…éƒ¨ç±»å±äºå¤–éƒ¨ç±»å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»å¯¹è±¡çš„å®ä¾‹æˆå‘˜



***



#### å±€éƒ¨å†…éƒ¨ç±»

å±€éƒ¨å†…éƒ¨ç±»ï¼šå®šä¹‰åœ¨æ–¹æ³•ä¸­ï¼Œåœ¨æ„é€ å™¨ä¸­ï¼Œä»£ç å—ä¸­ï¼Œfor å¾ªç¯ä¸­å®šä¹‰çš„å†…éƒ¨ç±»

å±€éƒ¨å†…éƒ¨ç±»ä¸­çš„æˆåˆ†ç‰¹ç‚¹ï¼šåªèƒ½å®šä¹‰å®ä¾‹æˆå‘˜ï¼Œä¸èƒ½å®šä¹‰é™æ€æˆå‘˜

```java
public class InnerClass{
	public static void main(String[] args){
        String name;
        class{}
    }
    public static void test(){
		class Animal{}
		class Cat extends Animal{}  
	}
}
```



***



#### åŒ¿åå†…éƒ¨ç±»

åŒ¿åå†…éƒ¨ç±»ï¼šæ²¡æœ‰åå­—çš„å±€éƒ¨å†…éƒ¨ç±»

åŒ¿åå†…éƒ¨ç±»çš„æ ¼å¼ï¼š

```java
new ç±»å|æŠ½è±¡ç±»|æ¥å£(å½¢å‚){
	//æ–¹æ³•é‡å†™ã€‚
}
```
 åŒ¿åå†…éƒ¨ç±»çš„ç‰¹ç‚¹ï¼š

* åŒ¿åå†…éƒ¨ç±»ä¸èƒ½å®šä¹‰é™æ€æˆå‘˜
* åŒ¿åå†…éƒ¨ç±»ä¸€æ—¦å†™å‡ºæ¥ï¼Œå°±ä¼šç«‹å³åˆ›å»ºä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»çš„å¯¹è±¡è¿”å›
* **åŒ¿åå†…éƒ¨ç±»çš„å¯¹è±¡çš„ç±»å‹ç›¸å½“äºæ˜¯å½“å‰ new çš„é‚£ä¸ªçš„ç±»å‹çš„å­ç±»ç±»å‹**
* åŒ¿åå†…éƒ¨ç±»å¼•ç”¨å±€éƒ¨å˜é‡å¿…é¡»æ˜¯**å¸¸é‡**ï¼Œåº•å±‚åˆ›å»ºä¸ºå†…éƒ¨ç±»çš„æˆå‘˜å˜é‡ï¼ˆåŸå› ï¼šJVM â†’ è¿è¡Œæœºåˆ¶ â†’ ä»£ç ä¼˜åŒ–ï¼‰

```java
public class Anonymity {
    public static void main(String[] args) {
        Animal a = new Animal(){
            @Override
            public void run() {
                System.out.println("çŒ«è·‘çš„è´¼æºœ~~");
                //System.out.println(n);
            }
        };
        a.run();
        a.go();
    }
}
abstract class Animal{
    public abstract void run();

    public void go(){
        System.out.println("å¼€å§‹go~~~");
    }
}
```



***



### æƒé™ç¬¦

æƒé™ä¿®é¥°ç¬¦ï¼šæœ‰å››ç§**ï¼ˆprivate -> ç¼ºçœ -> protected - > public ï¼‰**
å¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡ï¼Œä¿®é¥°æ–¹æ³•ï¼Œä¿®é¥°æ„é€ å™¨ï¼Œå†…éƒ¨ç±»ï¼Œä¸åŒä¿®é¥°ç¬¦ä¿®é¥°çš„æˆå‘˜èƒ½å¤Ÿè¢«è®¿é—®çš„æƒé™å°†å—åˆ°é™åˆ¶

| å››ç§ä¿®é¥°ç¬¦è®¿é—®æƒé™ | private | ç¼ºçœ | protected | public |
| ------------------ | :-----: | :--: | :-------: | :----: |
| æœ¬ç±»ä¸­             |    âˆš    |  âˆš   |     âˆš     |   âˆš    |
| æœ¬åŒ…ä¸‹çš„å­ç±»ä¸­     |    X    |  âˆš   |     âˆš     |   âˆš    |
| æœ¬åŒ…ä¸‹å…¶ä»–ç±»ä¸­     |    X    |  âˆš   |     âˆš     |   âˆš    |
| å…¶ä»–åŒ…ä¸‹çš„å­ç±»ä¸­   |    X    |  X   |     âˆš     |   âˆš    |
| å…¶ä»–åŒ…ä¸‹çš„å…¶ä»–ç±»ä¸­ |    X    |  X   |     X     |   âˆš    |

protected ç”¨äºä¿®é¥°æˆå‘˜ï¼Œè¡¨ç¤ºåœ¨ç»§æ‰¿ä½“ç³»ä¸­æˆå‘˜å¯¹äºå­ç±»å¯è§

* åŸºç±»çš„ protected æˆå‘˜æ˜¯åŒ…å†…å¯è§çš„ï¼Œå¹¶ä¸”å¯¹å­ç±»å¯è§
* è‹¥å­ç±»ä¸åŸºç±»ä¸åœ¨åŒä¸€åŒ…ä¸­ï¼Œé‚£ä¹ˆå­ç±»å®ä¾‹å¯ä»¥è®¿é—®å…¶ä»åŸºç±»ç»§æ‰¿è€Œæ¥çš„ protected æ–¹æ³•ï¼ˆé‡å†™ï¼‰ï¼Œè€Œä¸èƒ½è®¿é—®åŸºç±»å®ä¾‹çš„ protected æ–¹æ³•





***



### ä»£ç å—

#### é™æ€ä»£ç å—

é™æ€ä»£ç å—çš„æ ¼å¼ï¼š

 ```java
static {
}
 ```

* é™æ€ä»£ç å—ç‰¹ç‚¹ï¼š 
  * å¿…é¡»æœ‰ static ä¿®é¥°ï¼Œåªèƒ½è®¿é—®é™æ€èµ„æº
  * ä¼šä¸ç±»ä¸€èµ·ä¼˜å…ˆåŠ è½½ï¼Œä¸”è‡ªåŠ¨è§¦å‘æ‰§è¡Œä¸€æ¬¡
* é™æ€ä»£ç å—ä½œç”¨ï¼š
  * å¯ä»¥åœ¨æ‰§è¡Œç±»çš„æ–¹æ³•ç­‰æ“ä½œä¹‹å‰å…ˆåœ¨é™æ€ä»£ç å—ä¸­è¿›è¡Œé™æ€èµ„æºçš„åˆå§‹åŒ– 
  * **å…ˆæ‰§è¡Œé™æ€ä»£ç å—ï¼Œåœ¨æ‰§è¡Œ main å‡½æ•°é‡Œçš„æ“ä½œ**

```java
public class CodeDemo {
    public static String schoolName ;
    public static ArrayList<String> lists = new ArrayList<>();

    // é™æ€ä»£ç å—,å±äºç±»ï¼Œä¸ç±»ä¸€èµ·åŠ è½½ä¸€æ¬¡!
    static {
        System.out.println("é™æ€ä»£ç å—è¢«è§¦å‘æ‰§è¡Œ~~~~~~~");
        // åœ¨é™æ€ä»£ç å—ä¸­è¿›è¡Œé™æ€èµ„æºçš„åˆå§‹åŒ–æ“ä½œ
        schoolName = "å¼ ä¸‰";
        lists.add("3");
        lists.add("4");
        lists.add("5");
    }
    public static void main(String[] args) {
        System.out.println("mainæ–¹æ³•è¢«æ‰§è¡Œ");
        System.out.println(schoolName);
        System.out.println(lists);
    }
}
/*é™æ€ä»£ç å—è¢«è§¦å‘æ‰§è¡Œ~~~~~~~
mainæ–¹æ³•è¢«æ‰§è¡Œ
å¼ ä¸‰
[3, 4, 5] */
```



***



#### å®ä¾‹ä»£ç å—

å®ä¾‹ä»£ç å—çš„æ ¼å¼ï¼š

```java
{

}
```

* å®ä¾‹ä»£ç å—çš„ç‰¹ç‚¹ï¼š
  * æ—  static ä¿®é¥°ï¼Œå±äºå¯¹è±¡
  * ä¼šä¸ç±»çš„å¯¹è±¡ä¸€èµ·åŠ è½½ï¼Œæ¯æ¬¡åˆ›å»ºç±»çš„å¯¹è±¡çš„æ—¶å€™ï¼Œå®ä¾‹ä»£ç å—éƒ½ä¼šè¢«åŠ è½½ä¸”è‡ªåŠ¨è§¦å‘æ‰§è¡Œä¸€æ¬¡
  * å®ä¾‹ä»£ç å—çš„ä»£ç åœ¨åº•å±‚å®é™…ä¸Šæ˜¯æå–åˆ°æ¯ä¸ªæ„é€ å™¨ä¸­å»æ‰§è¡Œçš„
  
* å®ä¾‹ä»£ç å—çš„ä½œç”¨ï¼šå®ä¾‹ä»£ç å—å¯ä»¥åœ¨åˆ›å»ºå¯¹è±¡ä¹‹å‰è¿›è¡Œå®ä¾‹èµ„æºçš„åˆå§‹åŒ–æ“ä½œ

```java
public class CodeDemo {
    private String name;
    private ArrayList<String> lists = new ArrayList<>();
    {
        name = "ä»£ç å—";
        lists.add("java");
        System.out.println("å®ä¾‹ä»£ç å—è¢«è§¦å‘æ‰§è¡Œä¸€æ¬¡~~~~~~~~");
    }
    public CodeDemo02(){ }//æ„é€ æ–¹æ³•
    public CodeDemo02(String name){}

    public static void main(String[] args) {
        CodeDemo c = new CodeDemo();//å®ä¾‹ä»£ç å—è¢«è§¦å‘æ‰§è¡Œä¸€æ¬¡
        System.out.println(c.name);
        System.out.println(c.lists);
        new CodeDemo02();//å®ä¾‹ä»£ç å—è¢«è§¦å‘æ‰§è¡Œä¸€æ¬¡
    }
}
```





***






## API

### Object

#### åŸºæœ¬ä»‹ç»

Object ç±»æ˜¯ Java ä¸­çš„ç¥–å®—ç±»ï¼Œä¸€ä¸ªç±»æˆ–è€…é»˜è®¤ç»§æ‰¿ Object ç±»ï¼Œæˆ–è€…é—´æ¥ç»§æ‰¿ Object ç±»ï¼ŒObject ç±»çš„æ–¹æ³•æ˜¯ä¸€åˆ‡å­ç±»éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨

Object ç±»å¸¸ç”¨æ–¹æ³•ï¼š

* `public String toString()`ï¼šé»˜è®¤æ˜¯è¿”å›å½“å‰å¯¹è±¡åœ¨å †å†…å­˜ä¸­çš„åœ°å€ä¿¡æ¯ï¼šç±»çš„å…¨é™å@å†…å­˜åœ°å€ï¼Œä¾‹ï¼šStudent@735b478ï¼›
  * ç›´æ¥è¾“å‡ºå¯¹è±¡åç§°ï¼Œé»˜è®¤ä¼šè°ƒç”¨ toString() æ–¹æ³•ï¼Œæ‰€ä»¥çœç•¥ toString() ä¸å†™ï¼›
  * å¦‚æœè¾“å‡ºå¯¹è±¡çš„å†…å®¹ï¼Œéœ€è¦é‡å†™ toString() æ–¹æ³•ï¼ŒtoString æ–¹æ³•å­˜åœ¨çš„æ„ä¹‰æ˜¯ä¸ºäº†è¢«å­ç±»é‡å†™
* `public boolean equals(Object o)`ï¼šé»˜è®¤æ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨æ˜¯å¦ç›¸åŒ
* `protected Object clone()`ï¼šåˆ›å»ºå¹¶è¿”å›æ­¤å¯¹è±¡çš„å‰¯æœ¬ 

åªè¦ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ä¸€æ ·ï¼Œå°±è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ï¼š

```java
public boolean equals(Object o) {
	// 1.åˆ¤æ–­æ˜¯å¦è‡ªå·±å’Œè‡ªå·±æ¯”è¾ƒï¼Œå¦‚æœæ˜¯åŒä¸€ä¸ªå¯¹è±¡æ¯”è¾ƒç›´æ¥è¿”å›true
	if (this == o) return true;
	// 2.åˆ¤æ–­è¢«æ¯”è¾ƒè€…æ˜¯å¦ä¸ºnull ,ä»¥åŠæ˜¯å¦æ˜¯å­¦ç”Ÿç±»å‹ã€‚
	if (o == null || this.getClass() != o.getClass()) return false;
	// 3.oä¸€å®šæ˜¯å­¦ç”Ÿç±»å‹ï¼Œå¼ºåˆ¶è½¬æ¢æˆå­¦ç”Ÿï¼Œå¼€å§‹æ¯”è¾ƒå†…å®¹ï¼
	Student student = (Student) o;
	return age == student.age &&
           sex == student.sex &&
           Objects.equals(name, student.name);
}
```

**é¢è¯•é¢˜**ï¼š== å’Œ equals çš„åŒºåˆ«

* == æ¯”è¾ƒçš„æ˜¯å˜é‡ï¼ˆæ ˆï¼‰å†…å­˜ä¸­å­˜æ”¾çš„å¯¹è±¡çš„ï¼ˆå †ï¼‰å†…å­˜åœ°å€ï¼Œç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„**åœ°å€**æ˜¯å¦ç›¸åŒï¼Œå³æ˜¯å¦æ˜¯æŒ‡ç›¸åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ¯”è¾ƒçš„æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æŒ‡é’ˆæ“ä½œ
* Object ç±»ä¸­çš„æ–¹æ³•ï¼Œ**é»˜è®¤æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨**ï¼Œé‡å†™ equals æ–¹æ³•æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„**å†…å®¹**æ˜¯å¦ç›¸ç­‰ï¼Œæ‰€æœ‰çš„ç±»éƒ½æ˜¯ç»§æ‰¿è‡ª java.lang.Object ç±»ï¼Œæ‰€ä»¥é€‚ç”¨äºæ‰€æœ‰å¯¹è±¡

hashCode çš„ä½œç”¨ï¼š

* hashCode çš„å­˜åœ¨ä¸»è¦æ˜¯ç”¨äºæŸ¥æ‰¾çš„å¿«æ·æ€§ï¼Œå¦‚ Hashtableï¼ŒHashMap ç­‰ï¼Œå¯ä»¥åœ¨æ•£åˆ—å­˜å‚¨ç»“æ„ä¸­ç¡®å®šå¯¹è±¡çš„å­˜å‚¨åœ°å€
* å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸åŒï¼Œå°±æ˜¯é€‚ç”¨äº equals(java.lang.Object) æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ä¸€å®šè¦ç›¸åŒ
* å“ˆå¸Œå€¼ç›¸åŒçš„æ•°æ®ä¸ä¸€å®šå†…å®¹ç›¸åŒï¼Œå†…å®¹ç›¸åŒçš„æ•°æ®å“ˆå¸Œå€¼ä¸€å®šç›¸åŒ



***



#### æ·±æµ…å…‹éš†

Object çš„ clone() æ˜¯ protected æ–¹æ³•ï¼Œä¸€ä¸ªç±»ä¸æ˜¾å¼å»é‡å†™ clone()ï¼Œå°±ä¸èƒ½ç›´æ¥å»è°ƒç”¨è¯¥ç±»å®ä¾‹çš„ clone() æ–¹æ³•

æ·±æµ…æ‹·è´ï¼ˆå…‹éš†ï¼‰çš„æ¦‚å¿µï¼š

* æµ…æ‹·è´ (shallowCopy)ï¼š**å¯¹åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œå€¼ä¼ é€’ï¼Œå¯¹å¼•ç”¨æ•°æ®ç±»å‹åªæ˜¯å¤åˆ¶äº†å¼•ç”¨**ï¼Œè¢«å¤åˆ¶å¯¹è±¡å±æ€§çš„æ‰€æœ‰çš„å¼•ç”¨ä»ç„¶æŒ‡å‘åŸæ¥çš„å¯¹è±¡ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯å¢åŠ äº†ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘åŸæ¥å¯¹è±¡çš„å†…å­˜åœ°å€

  **Java ä¸­çš„å¤åˆ¶æ–¹æ³•åŸºæœ¬éƒ½æ˜¯æµ…æ‹·è´**ï¼šObject.clone()ã€System.arraycopy()ã€Arrays.copyOf()

* æ·±æ‹·è´ (deepCopy)ï¼šå¯¹åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œå€¼ä¼ é€’ï¼Œå¯¹å¼•ç”¨æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ªæ•´ä¸ªç‹¬ç«‹çš„å¯¹è±¡æ‹·è´ï¼Œä¼šæ‹·è´æ‰€æœ‰çš„å±æ€§å¹¶æŒ‡å‘çš„åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯æŠŠæ‰€æœ‰å±æ€§å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„å†…å­˜ï¼Œå¢åŠ ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ–°å†…å­˜ã€‚æ‰€ä»¥ä½¿ç”¨æ·±æ‹·è´çš„æƒ…å†µä¸‹ï¼Œé‡Šæ”¾å†…å­˜çš„æ—¶å€™ä¸ä¼šå‡ºç°ä½¿ç”¨æµ…æ‹·è´æ—¶é‡Šæ”¾åŒä¸€å—å†…å­˜çš„é”™è¯¯

Cloneable æ¥å£æ˜¯ä¸€ä¸ªæ ‡è¯†æ€§æ¥å£ï¼Œå³è¯¥æ¥å£ä¸åŒ…å«ä»»ä½•æ–¹æ³•ï¼ˆåŒ…æ‹¬ cloneï¼‰ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªç±»æƒ³åˆæ³•çš„è¿›è¡Œå…‹éš†ï¼Œé‚£ä¹ˆå°±å¿…é¡»å®ç°è¿™ä¸ªæ¥å£ï¼Œåœ¨ä½¿ç”¨ clone() æ–¹æ³•æ—¶ï¼Œè‹¥è¯¥ç±»æœªå®ç° Cloneable æ¥å£ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸

* Clone & Copyï¼š`Student s = new Student`

  `Student s1 = s`ï¼šåªæ˜¯ copy äº†ä¸€ä¸‹ referenceï¼Œs å’Œ s1 æŒ‡å‘å†…å­˜ä¸­åŒä¸€ä¸ª Objectï¼Œå¯¹å¯¹è±¡çš„ä¿®æ”¹ä¼šå½±å“å¯¹æ–¹

  `Student s2 = s.clone()`ï¼šä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ Student å¯¹è±¡ï¼Œå¹¶ä¸”å’Œ s å…·æœ‰ç›¸åŒçš„å±æ€§å€¼å’Œæ–¹æ³•

* Shallow Clone & Deep Cloneï¼š
  
  æµ…å…‹éš†ï¼šObject ä¸­çš„ clone() æ–¹æ³•åœ¨å¯¹æŸä¸ªå¯¹è±¡å…‹éš†æ—¶å¯¹å…¶ä»…ä»…æ˜¯ç®€å•åœ°æ‰§è¡ŒåŸŸå¯¹åŸŸçš„ copy
  
  * å¯¹åŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»çš„å…‹éš†æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚Stringã€Integer ç­‰åŒ…è£…ç±»å‹åœ¨å†…å­˜ä¸­æ˜¯**ä¸å¯ä»¥è¢«æ”¹å˜çš„å¯¹è±¡**ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨å…‹éš†æ—¶å¯ä»¥è§†ä¸ºåŸºæœ¬ç±»å‹ï¼Œåªéœ€æµ…å…‹éš†å¼•ç”¨å³å¯
  * å¦‚æœå¯¹ä¸€ä¸ªå¼•ç”¨ç±»å‹è¿›è¡Œå…‹éš†æ—¶åªæ˜¯å…‹éš†äº†å®ƒçš„å¼•ç”¨ï¼Œå’ŒåŸå§‹å¯¹è±¡å…±äº«å¯¹è±¡æˆå‘˜å˜é‡

  ![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/Objectæµ…å…‹éš†.jpg)

  æ·±å…‹éš†ï¼šåœ¨å¯¹æ•´ä¸ªå¯¹è±¡æµ…å…‹éš†åï¼Œå¯¹å…¶å¼•ç”¨å˜é‡è¿›è¡Œå…‹éš†ï¼Œå¹¶å°†å…¶æ›´æ–°åˆ°æµ…å…‹éš†å¯¹è±¡ä¸­å»

  ```java
  public class Student  implements Cloneable{
      private String name;
      private Integer age;
      private Date date;
  
      @Override
      protected Object clone() throws CloneNotSupportedException {
          Student s = (Student) super.clone();
          s.date = (Date) date.clone();
          return s;
      }
      //.....
  }
  ```

SDP â†’ åˆ›å»ºå‹ â†’ åŸå‹æ¨¡å¼



***



### Objects

Objects ç±»ä¸ Object æ˜¯ç»§æ‰¿å…³ç³»

Objects çš„æ–¹æ³•ï¼š

* `public static boolean equals(Object a, Object b)`ï¼šæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒ
  
    ```java
  public static boolean equals(Object a, Object b) {
      // è¿›è¡Œéç©ºåˆ¤æ–­ï¼Œä»è€Œå¯ä»¥é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸
      return a == b || a != null && a.equals(b);
  }
  ```

* `public static boolean isNull(Object obj)`ï¼šåˆ¤æ–­å˜é‡æ˜¯å¦ä¸º null ï¼Œä¸º null è¿”å› true

* `public static String toString(å¯¹è±¡)`ï¼šè¿”å›å‚æ•°ä¸­å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼

* `public static String toString(å¯¹è±¡, é»˜è®¤å­—ç¬¦ä¸²)`ï¼šè¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼

```java
public class ObjectsDemo {
    public static void main(String[] args) {
        Student s1 = null;
        Student s2 = new Student();
        System.out.println(Objects.equals(s1 , s2));//æ¨èä½¿ç”¨
        // System.out.println(s1.equals(s2)); // ç©ºæŒ‡é’ˆå¼‚å¸¸
 
        System.out.println(Objects.isNull(s1));
        System.out.println(s1 == null);//ç›´æ¥åˆ¤æ–­æ¯”è¾ƒå¥½
    }
}

public class Student {
}
```



***



### String

#### åŸºæœ¬ä»‹ç»

String è¢«å£°æ˜ä¸º finalï¼Œå› æ­¤ä¸å¯è¢«ç»§æ‰¿ **ï¼ˆInteger ç­‰åŒ…è£…ç±»ä¹Ÿä¸èƒ½è¢«ç»§æ‰¿ï¼‰**

```java
public final class String implements java.io.Serializable, Comparable<String>, CharSequence {
 	/** The value is used for character storage. */
    private final char value[];
    /** Cache the hash code for the string */
    private int hash; // Default to 0
}
```

åœ¨ Java 9 ä¹‹åï¼ŒString ç±»çš„å®ç°æ”¹ç”¨ byte æ•°ç»„å­˜å‚¨å­—ç¬¦ä¸²ï¼ŒåŒæ—¶ä½¿ç”¨ `coder` æ¥æ ‡è¯†ä½¿ç”¨äº†å“ªç§ç¼–ç 

value æ•°ç»„è¢«å£°æ˜ä¸º finalï¼Œè¿™æ„å‘³ç€ value æ•°ç»„åˆå§‹åŒ–ä¹‹åå°±ä¸èƒ½å†å¼•ç”¨å…¶å®ƒæ•°ç»„ï¼Œå¹¶ä¸” String å†…éƒ¨æ²¡æœ‰æ”¹å˜ value æ•°ç»„çš„æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥**ä¿è¯ String ä¸å¯å˜ï¼Œä¹Ÿä¿è¯çº¿ç¨‹å®‰å…¨**

æ³¨æ„ï¼šä¸èƒ½æ”¹å˜çš„æ„æ€æ˜¯**æ¯æ¬¡æ›´æ”¹å­—ç¬¦ä¸²éƒ½ä¼šäº§ç”Ÿæ–°çš„å¯¹è±¡**ï¼Œå¹¶ä¸æ˜¯å¯¹åŸå§‹å¯¹è±¡è¿›è¡Œæ”¹å˜

```java
String s = "abc";
s = s + "cd"; //s = abccd æ–°å¯¹è±¡
```



****



#### å¸¸ç”¨æ–¹æ³•

å¸¸ç”¨ APIï¼š

* `public boolean equals(String s)`ï¼šæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²å†…å®¹æ˜¯å¦ç›¸åŒã€åŒºåˆ†å¤§å°å†™

* `public boolean equalsIgnoreCase(String anotherString)`ï¼šæ¯”è¾ƒå­—ç¬¦ä¸²çš„å†…å®¹ï¼Œå¿½ç•¥å¤§å°å†™
* `public int length()`ï¼šè¿”å›æ­¤å­—ç¬¦ä¸²çš„é•¿åº¦
* `public String trim()`ï¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶å€¼ä¸ºæ­¤å­—ç¬¦ä¸²ï¼Œå¹¶åˆ é™¤ä»»ä½•å‰å¯¼å’Œå°¾éšç©ºæ ¼
* `public String[] split(String regex)`ï¼šå°†å­—ç¬¦ä¸²æŒ‰ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„
* `public char charAt(int index)`ï¼šå–ç´¢å¼•å¤„çš„å€¼
* `public char[] toCharArray()`ï¼šå°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºå­—ç¬¦æ•°ç»„åè¿”å›
* `public boolean startsWith(String prefix)`ï¼šæµ‹è¯•æ­¤å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šçš„å‰ç¼€å¼€å¤´
* `public int indexOf(String str)`ï¼šè¿”å›æŒ‡å®šå­å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„å­—ç¬¦ä¸²å†…çš„ç´¢å¼•ï¼Œæ²¡æœ‰è¿”å› -1
* `public int lastIndexOf(String str)`ï¼šè¿”å›å­—ç¬¦ä¸²æœ€åä¸€æ¬¡å‡ºç° str çš„ç´¢å¼•ï¼Œæ²¡æœ‰è¿”å› -1
* `public String substring(int beginIndex)`ï¼šè¿”å›å­å­—ç¬¦ä¸²ï¼Œä»¥åŸå­—ç¬¦ä¸²æŒ‡å®šç´¢å¼•å¤„åˆ°ç»“å°¾
* `public String substring(int i, int j)`ï¼šæŒ‡å®šç´¢å¼•å¤„æ‰©å±•åˆ° j - 1 çš„ä½ç½®ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¸º j - i
* `public String toLowerCase()`ï¼šå°†æ­¤ String æ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå°å†™ï¼Œä½¿ç”¨é»˜è®¤è¯­è¨€ç¯å¢ƒçš„è§„åˆ™
* `public String toUpperCase()`ï¼šä½¿ç”¨é»˜è®¤è¯­è¨€ç¯å¢ƒçš„è§„åˆ™å°†æ­¤ String æ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™
* `public String replace(CharSequence target, CharSequence replacement)`ï¼šä½¿ç”¨æ–°å€¼ï¼Œå°†å­—ç¬¦ä¸²ä¸­çš„æ—§å€¼æ›¿æ¢ï¼Œå¾—åˆ°æ–°çš„å­—ç¬¦ä¸²

```java
String s = 123-78;
s.replace("-","");//12378
```



***



#### æ„é€ æ–¹å¼

æ„é€ æ–¹æ³•ï¼š

* `public String()`ï¼šåˆ›å»ºä¸€ä¸ªç©ºç™½å­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¸å«æœ‰ä»»ä½•å†…å®¹
* `public String(char[] chs)`ï¼šæ ¹æ®å­—ç¬¦æ•°ç»„çš„å†…å®¹ï¼Œæ¥åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡
* `public String(String original)`ï¼šæ ¹æ®ä¼ å…¥çš„å­—ç¬¦ä¸²å†…å®¹ï¼Œæ¥åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡

ç›´æ¥èµ‹å€¼ï¼š`String s = "abc"` ç›´æ¥èµ‹å€¼çš„æ–¹å¼åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡ï¼Œå†…å®¹å°±æ˜¯ abc

- é€šè¿‡æ„é€ æ–¹æ³•åˆ›å»ºï¼šé€šè¿‡ new åˆ›å»ºçš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œæ¯ä¸€æ¬¡ new éƒ½ä¼šç”³è¯·ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œè™½ç„¶å†…å®¹ç›¸åŒï¼Œä½†æ˜¯åœ°å€å€¼ä¸åŒï¼Œ**è¿”å›å †å†…å­˜ä¸­å¯¹è±¡çš„å¼•ç”¨**
- ç›´æ¥èµ‹å€¼æ–¹å¼åˆ›å»ºï¼šä»¥ `" "` æ–¹å¼ç»™å‡ºçš„å­—ç¬¦ä¸²ï¼Œåªè¦å­—ç¬¦åºåˆ—ç›¸åŒï¼ˆé¡ºåºå’Œå¤§å°å†™ï¼‰ï¼Œæ— è®ºåœ¨ç¨‹åºä»£ç ä¸­å‡ºç°å‡ æ¬¡ï¼ŒJVM éƒ½åªä¼š**åœ¨ String Pool ä¸­åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡**ï¼Œå¹¶åœ¨å­—ç¬¦ä¸²æ± ä¸­ç»´æŠ¤

`String str = new String("abc")` åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡ï¼š

* åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼šå­—ç¬¦ä¸²æ± ä¸­å·²ç»å­˜åœ¨ abc å¯¹è±¡ï¼Œé‚£ä¹ˆç›´æ¥åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ”¾å…¥å †ä¸­ï¼Œè¿”å›å †å†…å¼•ç”¨
* åˆ›å»ºä¸¤ä¸ªå¯¹è±¡ï¼šå­—ç¬¦ä¸²æ± ä¸­æœªæ‰¾åˆ° abc å¯¹è±¡ï¼Œé‚£ä¹ˆåˆ†åˆ«åœ¨å †ä¸­å’Œå­—ç¬¦ä¸²æ± ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå­—ç¬¦ä¸²æ± ä¸­çš„æ¯”è¾ƒéƒ½æ˜¯é‡‡ç”¨ equals() 
  <img src="https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/Stringæ„é€ æ–¹æ³•å­—èŠ‚ç .png" style="zoom: 67%;" />

`new String("a") + new String("b")` åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡ï¼š

* å¯¹è±¡ 1ï¼šnew StringBuilder()

* å¯¹è±¡ 2ï¼šnew String("a")ã€å¯¹è±¡ 3ï¼šå¸¸é‡æ± ä¸­çš„ a

* å¯¹è±¡ 4ï¼šnew String("b")ã€å¯¹è±¡ 5ï¼šå¸¸é‡æ± ä¸­çš„ b
  <img src="https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/Stringæ‹¼æ¥æ–¹æ³•å­—èŠ‚ç .png" style="zoom:67%;" />

*  StringBuilder çš„ toString()ï¼š

  ```java
  @Override
  public String toString() {
      return new String(value, 0, count);
  }
  ```

  * å¯¹è±¡ 6ï¼šnew String("ab")
  * StringBuilder çš„ toString() è°ƒç”¨ï¼Œ**åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ²¡æœ‰ç”Ÿæˆ ab**ï¼Œnew String("ab") ä¼šåˆ›å»ºä¸¤ä¸ªå¯¹è±¡å› ä¸ºä¼ å‚æ•°çš„æ—¶å€™ä½¿ç”¨å­—é¢é‡åˆ›å»ºäº†å¯¹è±¡ abï¼Œå½“ä½¿ç”¨æ•°ç»„æ„é€  String å¯¹è±¡æ—¶ï¼Œæ²¡æœ‰åŠ å…¥å¸¸é‡æ± çš„æ“ä½œ



***



#### String Pool

##### åŸºæœ¬ä»‹ç»

å­—ç¬¦ä¸²å¸¸é‡æ± ï¼ˆString Pool / StringTable / ä¸²æ± ï¼‰ä¿å­˜ç€æ‰€æœ‰å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆliteral stringsï¼‰ï¼Œè¿™äº›å­—é¢é‡åœ¨ç¼–è¯‘æ—¶æœŸå°±ç¡®å®šï¼Œå¸¸é‡æ± ç±»ä¼¼äº Java ç³»ç»Ÿçº§åˆ«æä¾›çš„**ç¼“å­˜**ï¼Œå­˜æ”¾å¯¹è±¡å’Œå¼•ç”¨

* StringTableï¼Œç±»ä¼¼ HashTable ç»“æ„ï¼Œé€šè¿‡ `-XX:StringTableSize` è®¾ç½®å¤§å°ï¼ŒJDK 1.8 ä¸­é»˜è®¤ 60013
* å¸¸é‡æ± ä¸­çš„å­—ç¬¦ä¸²ä»…æ˜¯ç¬¦å·ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰å˜ä¸ºå¯¹è±¡ï¼Œå¯ä»¥é¿å…é‡å¤åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡
* å­—ç¬¦ä¸²**å˜é‡**çš„æ‹¼æ¥çš„åŸç†æ˜¯ StringBuilder#appendï¼Œappend æ–¹æ³•æ¯”å­—ç¬¦ä¸²æ‹¼æ¥æ•ˆç‡é«˜ï¼ˆJDK 1.8ï¼‰
* å­—ç¬¦ä¸²**å¸¸é‡**æ‹¼æ¥çš„åŸç†æ˜¯ç¼–è¯‘æœŸä¼˜åŒ–ï¼Œæ‹¼æ¥ç»“æœæ”¾å…¥å¸¸é‡æ± 
* å¯ä»¥ä½¿ç”¨ String çš„ intern() æ–¹æ³•åœ¨è¿è¡Œè¿‡ç¨‹å°†å­—ç¬¦ä¸²æ·»åŠ åˆ° String Pool ä¸­



***



##### intern()

JDK 1.8ï¼šå½“ä¸€ä¸ªå­—ç¬¦ä¸²è°ƒç”¨ intern() æ–¹æ³•æ—¶ï¼Œå¦‚æœ String Pool ä¸­ï¼š
* å­˜åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²å’Œè¯¥å­—ç¬¦ä¸²å€¼ç›¸ç­‰ï¼Œå°±ä¼šè¿”å› String Pool ä¸­å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼ˆéœ€è¦å˜é‡æ¥æ”¶ï¼‰
* ä¸å­˜åœ¨ï¼Œä¼šæŠŠå¯¹è±¡çš„**å¼•ç”¨åœ°å€**å¤åˆ¶ä¸€ä»½æ”¾å…¥ä¸²æ± ï¼Œå¹¶è¿”å›ä¸²æ± ä¸­çš„å¼•ç”¨åœ°å€ï¼Œå‰ææ˜¯å †å†…å­˜æœ‰è¯¥å¯¹è±¡ï¼Œå› ä¸º Pool åœ¨å †ä¸­ï¼Œä¸ºäº†èŠ‚çœå†…å­˜ä¸å†åˆ›å»ºæ–°å¯¹è±¡

JDK 1.6ï¼šå°†è¿™ä¸ªå­—ç¬¦ä¸²å¯¹è±¡å°è¯•æ”¾å…¥ä¸²æ± ï¼Œå¦‚æœæœ‰å°±ä¸æ”¾å…¥ï¼Œè¿”å›å·²æœ‰çš„ä¸²æ± ä¸­çš„å¯¹è±¡çš„å¼•ç”¨ï¼›å¦‚æœæ²¡æœ‰ä¼šæŠŠæ­¤å¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œæ”¾å…¥ä¸²æ± ï¼ŒæŠŠä¸²æ± ä¸­çš„å¯¹è±¡è¿”å›

```java
public class Demo {
    // å¸¸é‡æ± ä¸­çš„ä¿¡æ¯éƒ½åŠ è½½åˆ°è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œè¿™æ—¶a b abæ˜¯å¸¸é‡æ± ä¸­çš„ç¬¦å·ï¼Œè¿˜ä¸æ˜¯javaå­—ç¬¦ä¸²å¯¹è±¡ï¼Œæ˜¯æ‡’æƒ°çš„
    // ldc #2 ä¼šæŠŠ a ç¬¦å·å˜ä¸º "a" å­—ç¬¦ä¸²å¯¹è±¡     ldc:åç¼–è¯‘åçš„æŒ‡ä»¤
    // ldc #3 ä¼šæŠŠ b ç¬¦å·å˜ä¸º "b" å­—ç¬¦ä¸²å¯¹è±¡
    // ldc #4 ä¼šæŠŠ ab ç¬¦å·å˜ä¸º "ab" å­—ç¬¦ä¸²å¯¹è±¡
    public static void main(String[] args) {
        String s1 = "a"; 	// æ‡’æƒ°çš„
        String s2 = "b";
        String s3 = "ab";	// ä¸²æ± 
        
        String s4 = s1 + s2;	// è¿”å›çš„æ˜¯å †å†…åœ°å€
        // åŸç†ï¼šnew StringBuilder().append("a").append("b").toString()  new String("ab")
        
        String s5 = "a" + "b";  // javac åœ¨ç¼–è¯‘æœŸé—´çš„ä¼˜åŒ–ï¼Œç»“æœå·²ç»åœ¨ç¼–è¯‘æœŸç¡®å®šä¸ºab

        System.out.println(s3 == s4); // false
        System.out.println(s3 == s5); // true

        String x2 = new String("c") + new String("d"); // new String("cd")
        // è™½ç„¶ newï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± æ²¡æœ‰ cd å¯¹è±¡ï¼Œå› ä¸º toString() æ–¹æ³•
        x2.intern();
        String x1 = "cd";

        System.out.println(x1 == x2); //true
    }
}
```

- == æ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»å‹ï¼šæ¯”è¾ƒçš„æ˜¯å…·ä½“çš„å€¼
- == æ¯”è¾ƒå¼•ç”¨æ•°æ®ç±»å‹ï¼šæ¯”è¾ƒçš„æ˜¯å¯¹è±¡åœ°å€å€¼

ç»“è®ºï¼š

```java
String s1 = "ab";								// ä»…æ”¾å…¥ä¸²æ± 
String s2 = new String("a") + new String("b");	// ä»…æ”¾å…¥å †
// ä¸Šé¢ä¸¤æ¡æŒ‡ä»¤çš„ç»“æœå’Œä¸‹é¢çš„ æ•ˆæœ ç›¸åŒ
String s = new String("ab");
```



****



##### å¸¸è§é—®é¢˜

é—®é¢˜ä¸€ï¼š

```java
public static void main(String[] args) {
    String s = new String("a") + new String("b");//new String("ab")
    //åœ¨ä¸Šä¸€è¡Œä»£ç æ‰§è¡Œå®Œä»¥åï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å¹¶æ²¡æœ‰"ab"

    String s2 = s.intern();
    //jdk6ï¼šä¸²æ± ä¸­åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²"ab"
    //jdk8ï¼šä¸²æ± ä¸­æ²¡æœ‰åˆ›å»ºå­—ç¬¦ä¸²"ab",è€Œæ˜¯åˆ›å»ºä¸€ä¸ªå¼•ç”¨æŒ‡å‘ new String("ab")ï¼Œå°†æ­¤å¼•ç”¨è¿”å›

    System.out.println(s2 == "ab");//jdk6:true  jdk8:true
    System.out.println(s == "ab");//jdk6:false  jdk8:true
}
```

é—®é¢˜äºŒï¼š

```java
public static void main(String[] args) {
    String str1 = new StringBuilder("58").append("tongcheng").toString();
    System.out.println(str1 == str1.intern());//trueï¼Œå­—ç¬¦ä¸²æ± ä¸­ä¸å­˜åœ¨ï¼ŒæŠŠå †ä¸­çš„å¼•ç”¨å¤åˆ¶ä¸€ä»½æ”¾å…¥ä¸²æ± 

    String str2 = new StringBuilder("ja").append("va").toString();
    System.out.println(str2 == str2.intern());//falseï¼Œå­—ç¬¦ä¸²æ± ä¸­å­˜åœ¨ï¼Œç›´æ¥è¿”å›å·²ç»å­˜åœ¨çš„å¼•ç”¨
}
```

åŸå› ï¼š

* System ç±»å½“è°ƒç”¨ Version çš„é™æ€æ–¹æ³•ï¼Œå¯¼è‡´ Version åˆå§‹åŒ–ï¼š

  ```java
  private static void initializeSystemClass() {
      sun.misc.Version.init();
  }
  ```

* Version ç±»åˆå§‹åŒ–æ—¶éœ€è¦å¯¹é™æ€å¸¸é‡å­—æ®µåˆå§‹åŒ–ï¼Œè¢« launcher_name é™æ€å¸¸é‡å­—æ®µæ‰€å¼•ç”¨çš„ `"java"` å­—ç¬¦ä¸²å­—é¢é‡å°±è¢«æ”¾å…¥çš„å­—ç¬¦ä¸²å¸¸é‡æ± ï¼š

  ```java
  package sun.misc;
  
  public class Version {
      private static final String launcher_name = "java";
      private static final String java_version = "1.8.0_221";
      private static final String java_runtime_name = "Java(TM) SE Runtime Environment";
      private static final String java_profile_name = "";
      private static final String java_runtime_version = "1.8.0_221-b11";
      //...
  }
  ```



***



##### å†…å­˜ä½ç½®

Java 7 ä¹‹å‰ï¼ŒString Pool è¢«æ”¾åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ï¼Œå±äºæ°¸ä¹…ä»£ï¼›Java 7 ä»¥åï¼ŒString Pool è¢«ç§»åˆ°å †ä¸­ï¼Œè¿™æ˜¯å› ä¸ºæ°¸ä¹…ä»£çš„ç©ºé—´æœ‰é™ï¼Œåœ¨å¤§é‡ä½¿ç”¨å­—ç¬¦ä¸²çš„åœºæ™¯ä¸‹ä¼šå¯¼è‡´ OutOfMemoryError é”™è¯¯

æ¼”ç¤º StringTable ä½ç½®ï¼š

* `-Xmx10m` è®¾ç½®å †å†…å­˜ 10m

* åœ¨ JDK8 ä¸‹è®¾ç½®ï¼š `-Xmx10m -XX:-UseGCOverheadLimit`ï¼ˆè¿è¡Œå‚æ•°åœ¨ Run Configurations VM optionsï¼‰

* åœ¨ JDK6 ä¸‹è®¾ç½®ï¼š `-XX:MaxPermSize=10m`

  ```java
  public static void main(String[] args) throws InterruptedException {
      List<String> list = new ArrayList<String>();
      int i = 0;
      try {
          for (int j = 0; j < 260000; j++) {
              list.add(String.valueOf(j).intern());
              i++;
          }
      } catch (Throwable e) {
          e.printStackTrace();
      } finally {
          System.out.println(i);
      }
  }
  ```

![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/JVM-å†…å­˜å›¾å¯¹æ¯”.png)



***



#### ä¼˜åŒ–å¸¸é‡æ± 

ä¸¤ç§æ–¹å¼ï¼š

* è°ƒæ•´ -XX:StringTableSize=æ¡¶ä¸ªæ•°ï¼Œæ•°é‡è¶Šå°‘ï¼Œæ€§èƒ½è¶Šå·®

* intern å°†å­—ç¬¦ä¸²å¯¹è±¡æ”¾å…¥å¸¸é‡æ± ï¼Œé€šè¿‡å¤ç”¨å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œå‡å°‘å†…å­˜å ç”¨

```java
/**
 * æ¼”ç¤º intern å‡å°‘å†…å­˜å ç”¨
 * -XX:StringTableSize=200000 -XX:+PrintStringTableStatistics
 * -Xsx500m -Xmx500m -XX:+PrintStringTableStatistics -XX:StringTableSize=200000
 */
public class Demo1_25 {
    public static void main(String[] args) throws IOException {
        List<String> address = new ArrayList<>();
        System.in.read();
        for (int i = 0; i < 10; i++) {
            //å¾ˆå¤šæ•°æ®
            try (BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream("linux.words"), "utf-8"))) {
                String line = null;
                long start = System.nanoTime();
                while (true) {
                    line = reader.readLine();
                    if(line == null) {
                        break;
                    }
                    address.add(line.intern());
                }
                System.out.println("cost:" +(System.nanoTime()-start)/1000000);
            }
        }
        System.in.read();
    }
}
```



***



#### ä¸å¯å˜å¥½å¤„

* å¯ä»¥ç¼“å­˜ hash å€¼ï¼Œä¾‹å¦‚ String ç”¨åš HashMap çš„ keyï¼Œä¸å¯å˜çš„ç‰¹æ€§å¯ä»¥ä½¿å¾— hash å€¼ä¹Ÿä¸å¯å˜ï¼Œåªè¦è¿›è¡Œä¸€æ¬¡è®¡ç®—
* String Pool çš„éœ€è¦ï¼Œå¦‚æœä¸€ä¸ª String å¯¹è±¡å·²ç»è¢«åˆ›å»ºè¿‡äº†ï¼Œå°±ä¼šä» String Pool ä¸­å–å¾—å¼•ç”¨ï¼Œåªæœ‰ String æ˜¯ä¸å¯å˜çš„ï¼Œæ‰å¯èƒ½ä½¿ç”¨ String Pool
* å®‰å…¨æ€§ï¼ŒString ç»å¸¸ä½œä¸ºå‚æ•°ï¼ŒString ä¸å¯å˜æ€§å¯ä»¥ä¿è¯å‚æ•°ä¸å¯å˜ã€‚ä¾‹å¦‚åœ¨ä½œä¸ºç½‘ç»œè¿æ¥å‚æ•°çš„æƒ…å†µä¸‹å¦‚æœ String æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆåœ¨ç½‘ç»œè¿æ¥è¿‡ç¨‹ä¸­ï¼ŒString è¢«æ”¹å˜ï¼Œæ”¹å˜ String çš„é‚£ä¸€æ–¹ä»¥ä¸ºç°åœ¨è¿æ¥çš„æ˜¯å…¶å®ƒä¸»æœºï¼Œè€Œå®é™…æƒ…å†µå´ä¸ä¸€å®šæ˜¯
* String ä¸å¯å˜æ€§å¤©ç”Ÿå…·å¤‡çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å®‰å…¨åœ°ä½¿ç”¨
* é˜²æ­¢å­ç±»ç»§æ‰¿ï¼Œç ´å String çš„ API çš„ä½¿ç”¨





***



### StringBuilder

String StringBuffer å’Œ StringBuilder åŒºåˆ«ï¼š

* String : **ä¸å¯å˜**çš„å­—ç¬¦åºåˆ—ï¼Œçº¿ç¨‹å®‰å…¨
* StringBuffer : **å¯å˜**çš„å­—ç¬¦åºåˆ—ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œåº•å±‚æ–¹æ³•åŠ  synchronizedï¼Œæ•ˆç‡ä½
* StringBuilder : **å¯å˜**çš„å­—ç¬¦åºåˆ—ï¼ŒJDK5.0 æ–°å¢ï¼›çº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜

ç›¸åŒç‚¹ï¼šåº•å±‚ä½¿ç”¨ char[] å­˜å‚¨

æ„é€ æ–¹æ³•ï¼š

* `public StringBuilder()`ï¼šåˆ›å»ºä¸€ä¸ªç©ºç™½å¯å˜å­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¸å«æœ‰ä»»ä½•å†…å®¹
* `public StringBuilder(String str)`ï¼šæ ¹æ®å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œæ¥åˆ›å»ºå¯å˜å­—ç¬¦ä¸²å¯¹è±¡

å¸¸ç”¨API : 

* `public StringBuilder append(ä»»æ„ç±»å‹)`ï¼šæ·»åŠ æ•°æ®ï¼Œå¹¶è¿”å›å¯¹è±¡æœ¬èº«
* `public StringBuilder reverse()`ï¼šè¿”å›ç›¸åçš„å­—ç¬¦åºåˆ—
* `public String toString()`ï¼šé€šè¿‡ toString() å°±å¯ä»¥å®ç°æŠŠ StringBuilder è½¬æ¢ä¸º String

å­˜å‚¨åŸç†ï¼š

```java
String str = "abc";
char data[] = {'a', 'b', 'c'};
StringBuffer sb1 = new StringBuffer();//new byte[16] 
sb1.append('a'); //value[0] = 'a';
```

append æºç ï¼šæ‰©å®¹ä¸ºäºŒå€

```java
public AbstractStringBuilder append(String str) {
    if (str == null) return appendNull();
    int len = str.length();
    ensureCapacityInternal(count + len);
    str.getChars(0, len, value, count);
    count += len;
    return this;
}
private void ensureCapacityInternal(int minimumCapacity) {
    // åˆ›å»ºè¶…è¿‡æ•°ç»„é•¿åº¦å°±æ–°çš„charæ•°ç»„ï¼ŒæŠŠæ•°æ®æ‹·è´è¿‡å»
    if (minimumCapacity - value.length > 0) {
        //int newCapacity = (value.length << 1) + 2;æ¯æ¬¡æ‰©å®¹2å€+2
        value = Arrays.copyOf(value, newCapacity(minimumCapacity));
    }
}
public void getChars(int srcBegin, int srcEnd, char dst[], int dstBegin) {
    // å°†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦å¤åˆ¶åˆ°ç›®æ ‡å­—ç¬¦æ•°ç»„ä¸­
	// å­—ç¬¦ä¸²è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæ­¤æ—¶valueæ˜¯å­—ç¬¦ä¸²çš„å€¼ï¼Œdstæ˜¯ç›®æ ‡å­—ç¬¦æ•°ç»„
    System.arraycopy(value, srcBegin, dst, dstBegin, srcEnd - srcBegin);
}
```





****



### Arrays

Array çš„å·¥å…·ç±» Arrays

å¸¸ç”¨APIï¼š

* `public static String toString(int[] a)`ï¼šè¿”å›æŒ‡å®šæ•°ç»„çš„å†…å®¹çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼
* `public static void sort(int[] a)`ï¼šæŒ‰ç…§æ•°å­—é¡ºåºæ’åˆ—æŒ‡å®šçš„æ•°ç»„
* `public static int binarySearch(int[] a, int key)`ï¼šåˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾è¿”å›æŒ‡å®šå…ƒç´ çš„ç´¢å¼•
* `public static <T> List<T> asList(T... a)`ï¼šè¿”å›ç”±æŒ‡å®šæ•°ç»„æ”¯æŒçš„åˆ—è¡¨

```java
public class MyArraysDemo {
      public static void main(String[] args) {
		//æŒ‰ç…§æ•°å­—é¡ºåºæ’åˆ—æŒ‡å®šçš„æ•°ç»„
        int [] arr = {3,2,4,6,7};
        Arrays.sort(arr);
        System.out.println(Arrays.toString(arr));
		
        int [] arr = {1,2,3,4,5,6,7,8,9,10};
        int index = Arrays.binarySearch(arr, 0);
        System.out.println(index);
        //1,æ•°ç»„å¿…é¡»æœ‰åº
        //2.å¦‚æœè¦æŸ¥æ‰¾çš„å…ƒç´ å­˜åœ¨,é‚£ä¹ˆè¿”å›çš„æ˜¯è¿™ä¸ªå…ƒç´ å®é™…çš„ç´¢å¼•
        //3.å¦‚æœè¦æŸ¥æ‰¾çš„å…ƒç´ ä¸å­˜åœ¨,é‚£ä¹ˆè¿”å›çš„æ˜¯ (-æ’å…¥ç‚¹-1)
            //æ’å…¥ç‚¹:å¦‚æœè¿™ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­,ä»–åº”è¯¥åœ¨å“ªä¸ªç´¢å¼•ä¸Š.
      }
  }
```





***



### Random

ç”¨äºç”Ÿæˆä¼ªéšæœºæ•°ã€‚

ä½¿ç”¨æ­¥éª¤ï¼š
1. å¯¼å…¥åŒ…ï¼š`import java.util.Random`
2. åˆ›å»ºå¯¹è±¡ï¼š`Random r = new Random()`
3. éšæœºæ•´æ•°ï¼š`int num = r.nextInt(10)`
   * è§£é‡Šï¼š10 ä»£è¡¨çš„æ˜¯ä¸€ä¸ªèŒƒå›´ï¼Œå¦‚æœæ‹¬å·å†™ 10ï¼Œäº§ç”Ÿçš„éšæœºæ•°å°±æ˜¯ 0 - 9ï¼Œæ‹¬å·å†™ 20 çš„éšæœºæ•°åˆ™æ˜¯ 0 - 19	
   * è·å– 0 - 10ï¼š`int num = r.nextInt(10 + 1)`

4. éšæœºå°æ•°ï¼š`public double nextDouble()` ä»èŒƒå›´ `0.0d` è‡³ `1.0d` ï¼ˆå·¦é—­å³å¼€ï¼‰ï¼Œä¼ªéšæœºåœ°ç”Ÿæˆå¹¶è¿”å›



***



### System

System ä»£è¡¨å½“å‰ç³»ç»Ÿ

é™æ€æ–¹æ³•ï¼š

* `public static void exit(int status)`ï¼šç»ˆæ­¢ JVM è™šæ‹Ÿæœºï¼Œ**é 0 æ˜¯å¼‚å¸¸ç»ˆæ­¢**

* `public static long currentTimeMillis()`ï¼šè·å–å½“å‰ç³»ç»Ÿæ­¤åˆ»æ—¶é—´æ¯«ç§’å€¼

* `static void arraycopy(Object var0, int var1, Object var2, int var3, int var4)`ï¼šæ•°ç»„æ‹·è´
  * å‚æ•°ä¸€ï¼šåŸæ•°ç»„
  * å‚æ•°äºŒï¼šä»åŸæ•°ç»„çš„å“ªä¸ªä½ç½®å¼€å§‹èµ‹å€¼
  * å‚æ•°ä¸‰ï¼šç›®æ ‡æ•°ç»„
  * å‚æ•°å››ï¼šä»ç›®æ ‡æ•°ç»„çš„å“ªä¸ªä½ç½®å¼€å§‹èµ‹å€¼
  * å‚æ•°äº”ï¼šèµ‹å€¼å‡ ä¸ª

```java
public class SystemDemo {
    public static void main(String[] args) {
        //System.exit(0); // 0ä»£è¡¨æ­£å¸¸ç»ˆæ­¢!!
        long startTime = System.currentTimeMillis();//å®šä¹‰sdf æŒ‰ç…§æ ¼å¼è¾“å‡º
        for(int i = 0; i < 10000; i++){è¾“å‡ºi}
		long endTime = new Date().getTime();
		System.out.println( (endTime - startTime)/1000.0 +"s");//ç¨‹åºç”¨æ—¶

        int[] arr1 = new int[]{10 ,20 ,30 ,40 ,50 ,60 ,70};
        int[] arr2 = new int[6]; // [ 0 , 0 , 0 , 0 , 0 , 0]
        // å˜æˆarrs2 = [0 , 30 , 40 , 50 , 0 , 0 ]
        System.arraycopy(arr1, 2, arr2, 1, 3);
    }
}
```





***



### Date

æ„é€ å™¨ï¼š

* `public Date()`ï¼šåˆ›å»ºå½“å‰ç³»ç»Ÿçš„æ­¤åˆ»æ—¥æœŸæ—¶é—´å¯¹è±¡ã€‚
*  `public Date(long time)`ï¼šæŠŠæ—¶é—´æ¯«ç§’å€¼è½¬æ¢æˆæ—¥æœŸå¯¹è±¡

æ–¹æ³•ï¼š

* `public long getTime()`ï¼šè¿”å›è‡ª 1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 GMT ä»¥æ¥æ€»çš„æ¯«ç§’æ•°ã€‚

æ—¶é—´è®°å½•çš„ä¸¤ç§æ–¹å¼ï¼š

1. Date æ—¥æœŸå¯¹è±¡
2. æ—¶é—´æ¯«ç§’å€¼ï¼šä» `1970-01-01 00:00:00` å¼€å§‹èµ°åˆ°æ­¤åˆ»çš„æ€»çš„æ¯«ç§’å€¼ï¼Œ1s = 1000ms

```java
public class DateDemo {
    public static void main(String[] args) {
        Date d = new Date();
        System.out.println(d);//Fri Oct 16 21:58:44 CST 2020
        long time = d.getTime() + 121*1000;//è¿‡121sæ˜¯ä»€ä¹ˆæ—¶é—´
        System.out.println(time);//1602856875485
        
        Date d1 = new Date(time);
        System.out.println(d1);//Fri Oct 16 22:01:15 CST 2020
    }
}
```

```java
public static void main(String[] args){
    Date d = new Date();
    long startTime = d.getTime();
    for(int i = 0; i < 10000; i++){è¾“å‡ºi}
    long endTime = new Date().getTime();
    System.out.println( (endTime - startTime) / 1000.0 +"s");
    //è¿è¡Œä¸€ä¸‡æ¬¡è¾“å‡ºéœ€è¦å¤šé•¿æ—¶é—´
}
```



***



### DateFormat

DateFormat ä½œç”¨ï¼š

1. å¯ä»¥æŠŠâ€œæ—¥æœŸå¯¹è±¡â€æˆ–è€…â€œæ—¶é—´æ¯«ç§’å€¼â€æ ¼å¼åŒ–æˆæˆ‘ä»¬å–œæ¬¢çš„æ—¶é—´å½¢å¼ï¼ˆæ ¼å¼åŒ–æ—¶é—´ï¼‰
2. å¯ä»¥æŠŠå­—ç¬¦ä¸²çš„æ—¶é—´å½¢å¼è§£ææˆæ—¥æœŸå¯¹è±¡ï¼ˆè§£æå­—ç¬¦ä¸²æ—¶é—´ï¼‰

DateFormat æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œä½¿ç”¨å®ƒçš„å­ç±»ï¼šSimpleDateFormat

SimpleDateFormat  ç®€å•æ—¥æœŸæ ¼å¼åŒ–ç±»ï¼š

* `public SimpleDateFormat(String pattern)`ï¼šæŒ‡å®šæ—¶é—´çš„æ ¼å¼åˆ›å»ºç®€å•æ—¥æœŸå¯¹è±¡
* `public String format(Date date) `ï¼šæŠŠæ—¥æœŸå¯¹è±¡æ ¼å¼åŒ–æˆæˆ‘ä»¬å–œæ¬¢çš„æ—¶é—´å½¢å¼ï¼Œè¿”å›å­—ç¬¦ä¸²
* `public String format(Object time)`ï¼šæŠŠæ—¶é—´æ¯«ç§’å€¼æ ¼å¼åŒ–æˆè®¾å®šçš„æ—¶é—´å½¢å¼ï¼Œè¿”å›å­—ç¬¦ä¸²!
* `public Date parse(String date)`ï¼šæŠŠå­—ç¬¦ä¸²çš„æ—¶é—´è§£ææˆæ—¥æœŸå¯¹è±¡

>yyyyå¹´MMæœˆddæ—¥ HH:mm:ss EEE a" å‘¨å‡  ä¸Šåˆä¸‹åˆ

```java
public static void main(String[] args){
	Date date = new Date();
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss);
    String time = sdf.format(date);
    System.out.println(time);//2020-10-18 19:58:34
    //è¿‡121såæ˜¯ä»€ä¹ˆæ—¶é—´
    long time = date.getTime();
    time+=121;
    System.out.println(sdf.formate(time));
    String d = "2020-10-18 20:20:20";//æ ¼å¼ä¸€è‡´
    Date newDate = sdf.parse(d);
    System.out.println(sdf.format(newDate)); //æŒ‰ç…§å‰é¢çš„æ–¹æ³•è¾“å‡º
}
```




****



### Calendar

Calendar ä»£è¡¨äº†ç³»ç»Ÿæ­¤åˆ»æ—¥æœŸå¯¹åº”çš„æ—¥å†å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æ¥åˆ›å»ºå¯¹è±¡

Calendar æ—¥å†ç±»åˆ›å»ºæ—¥å†å¯¹è±¡ï¼š`Calendar rightNow = Calendar.getInstance()`ï¼ˆ**é¥¿æ±‰å•ä¾‹æ¨¡å¼**ï¼‰

Calendar çš„æ–¹æ³•ï¼š

* `public static Calendar getInstance()`ï¼šè¿”å›ä¸€ä¸ªæ—¥å†ç±»çš„å¯¹è±¡
* `public int get(int field)`ï¼šå–æ—¥æœŸä¸­çš„æŸä¸ªå­—æ®µä¿¡æ¯
* `public void set(int field,int value)`ï¼šä¿®æ”¹æ—¥å†çš„æŸä¸ªå­—æ®µä¿¡æ¯
* `public void add(int field,int amount)`ï¼šä¸ºæŸä¸ªå­—æ®µå¢åŠ /å‡å°‘æŒ‡å®šçš„å€¼
* `public final Date getTime()`ï¼šæ‹¿åˆ°æ­¤åˆ»æ—¥æœŸå¯¹è±¡
* `public long getTimeInMillis()`ï¼šæ‹¿åˆ°æ­¤åˆ»æ—¶é—´æ¯«ç§’å€¼

```java
public static void main(String[] args){
	Calendar rightNow = Calendar.getInsance(); 
	int year = rightNow.get(Calendar.YEAR);//è·å–å¹´
    int month = rightNow.get(Calendar.MONTH) + 1;//æœˆè¦+1
    int days = rightNow.get(Calendar.DAY_OF_YEAR);
    rightNow.set(Calendar.YEAR , 2099);//ä¿®æ”¹æŸä¸ªå­—æ®µ
    rightNow.add(Calendar.HOUR , 15);//åŠ 15å°æ—¶  -15å°±æ˜¯å‡å»15å°æ—¶
    Date date = rightNow.getTime();//æ—¥å†å¯¹è±¡
    long time = rightNow.getTimeInMillis();//æ—¶é—´æ¯«ç§’å€¼
    //700å¤©åæ˜¯ä»€ä¹ˆæ—¥å­
    rightNow.add(Calendar.DAY_OF_YEAR , 701);
    Date date d = rightNow.getTime();
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    System.out.println(sdf.format(d));//è¾“å‡º700å¤©åçš„æ—¥æœŸ
}
```



***



### LocalDateTime

JDK1.8 æ–°å¢ï¼Œçº¿ç¨‹å®‰å…¨

+ LocalDate       è¡¨ç¤ºæ—¥æœŸï¼ˆå¹´æœˆæ—¥ï¼‰  
+ LocalTime       è¡¨ç¤ºæ—¶é—´ï¼ˆæ—¶åˆ†ç§’ï¼‰
+ LocalDateTime    è¡¨ç¤ºæ—¶é—´+ æ—¥æœŸ ï¼ˆå¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰

æ„é€ æ–¹æ³•ï¼š

* public static LocalDateTime now()ï¼šè·å–å½“å‰ç³»ç»Ÿæ—¶é—´ 
* public static LocalDateTime of(å¹´, æœˆ , æ—¥, æ—¶, åˆ†, ç§’)ï¼šä½¿ç”¨æŒ‡å®šå¹´æœˆæ—¥å’Œæ—¶åˆ†ç§’åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡

å¸¸ç”¨APIï¼š

| æ–¹æ³•å                                                    | è¯´æ˜                                                         |
| --------------------------------------------------------- | ------------------------------------------------------------ |
| public int getYear()                                      | è·å–å¹´                                                       |
| public int getMonthValue()                                | è·å–æœˆä»½ï¼ˆ1-12ï¼‰                                             |
| public int getDayOfMonth()                                | è·å–æœˆä»½ä¸­çš„ç¬¬å‡ å¤©ï¼ˆ1-31ï¼‰                                   |
| public int getDayOfYear()                                 | è·å–ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼ˆ1-366ï¼‰                                  |
| public DayOfWeek getDayOfWeek()                           | è·å–æ˜ŸæœŸ                                                     |
| public int getMinute()                                    | è·å–åˆ†é’Ÿ                                                     |
| public int getHour()                                      | è·å–å°æ—¶                                                     |
| public LocalDate  toLocalDate()                           | è½¬æ¢æˆä¸ºä¸€ä¸ª LocalDate å¯¹è±¡ï¼ˆå¹´æœˆæ—¥ï¼‰                        |
| public LocalTime toLocalTime()                            | è½¬æ¢æˆä¸ºä¸€ä¸ª LocalTime å¯¹è±¡ï¼ˆæ—¶åˆ†ç§’ï¼‰                        |
| public String format(æŒ‡å®šæ ¼å¼)                            | æŠŠä¸€ä¸ª LocalDateTime æ ¼å¼åŒ–æˆä¸ºä¸€ä¸ªå­—ç¬¦ä¸²                    |
| public LocalDateTime parse(å‡†å¤‡è§£æçš„å­—ç¬¦ä¸², è§£ææ ¼å¼)    | æŠŠä¸€ä¸ªæ—¥æœŸå­—ç¬¦ä¸²è§£ææˆä¸ºä¸€ä¸ª LocalDateTime å¯¹è±¡              |
| public static DateTimeFormatter ofPattern(String pattern) | ä½¿ç”¨æŒ‡å®šçš„æ—¥æœŸæ¨¡æ¿è·å–ä¸€ä¸ªæ—¥æœŸæ ¼å¼åŒ–å™¨ DateTimeFormatter å¯¹è±¡ |

```java
public class JDK8DateDemo2 {
    public static void main(String[] args) {
        LocalDateTime now = LocalDateTime.now();
        System.out.println(now);

        LocalDateTime localDateTime = LocalDateTime.of(2020, 11, 11, 11, 11, 11);
        System.out.println(localDateTime);
        DateTimeFormatter pattern = DateTimeFormatter.ofPattern("yyyyå¹´MMæœˆddæ—¥ HH:mm:ss");
        String s = localDateTime.format(pattern);
		LocalDateTime parse = LocalDateTime.parse(s, pattern);
    }
}
```

| æ–¹æ³•å                                      | è¯´æ˜           |
| ------------------------------------------- | -------------- |
| public LocalDateTime plusYears (long years) | æ·»åŠ æˆ–è€…å‡å»å¹´ |
| public LocalDateTime withYear(int year)     | ç›´æ¥ä¿®æ”¹å¹´     |



**æ—¶é—´é—´éš”** Duration ç±»APIï¼š

| æ–¹æ³•å                                           | è¯´æ˜                 |
| ------------------------------------------------ | -------------------- |
| public static Period between(å¼€å§‹æ—¶é—´,ç»“æŸæ—¶é—´)  | è®¡ç®—ä¸¤ä¸ªâ€œæ—¶é—´"çš„é—´éš” |
| public int getYears()                            | è·å¾—è¿™æ®µæ—¶é—´çš„å¹´æ•°   |
| public int getMonths()                           | è·å¾—æ­¤æœŸé—´çš„æ€»æœˆæ•°   |
| public int getDays()                             | è·å¾—æ­¤æœŸé—´çš„å¤©æ•°     |
| public long toTotalMonths()                      | è·å–æ­¤æœŸé—´çš„æ€»æœˆæ•°   |
| public static Durationbetween(å¼€å§‹æ—¶é—´,ç»“æŸæ—¶é—´) | è®¡ç®—ä¸¤ä¸ªâ€œæ—¶é—´"çš„é—´éš” |
| public long toSeconds()                          | è·å¾—æ­¤æ—¶é—´é—´éš”çš„ç§’   |
| public long toMillis()                           | è·å¾—æ­¤æ—¶é—´é—´éš”çš„æ¯«ç§’ |
| public long toNanos()                            | è·å¾—æ­¤æ—¶é—´é—´éš”çš„çº³ç§’ |

```java
public class JDK8DateDemo9 {
    public static void main(String[] args) {
        LocalDate localDate1 = LocalDate.of(2020, 1, 1);
        LocalDate localDate2 = LocalDate.of(2048, 12, 12);
        Period period = Period.between(localDate1, localDate2);
        System.out.println(period);//P28Y11M11D
		Duration duration = Duration.between(localDateTime1, localDateTime2);
        System.out.println(duration);//PT21H57M58S
    }
}
```



***



### Math

Math ç”¨äºåšæ•°å­¦è¿ç®—

Math ç±»ä¸­çš„æ–¹æ³•å…¨éƒ¨æ˜¯é™æ€æ–¹æ³•ï¼Œç›´æ¥ç”¨ç±»åè°ƒç”¨å³å¯ï¼š

| æ–¹æ³•                                         | è¯´æ˜                              |
| -------------------------------------------- | --------------------------------- |
| public static int abs(int a)                 | è·å–å‚æ•°açš„ç»å¯¹å€¼                 |
| public static double ceil(double a)          | å‘ä¸Šå–æ•´                          |
| public static double floor(double a)         | å‘ä¸‹å–æ•´                          |
| public static double pow(double a, double b) | è·å– a çš„ b æ¬¡å¹‚                  |
| public static long round(double a)           | å››èˆäº”å…¥å–æ•´                      |
| public static int max(int a,int b)           | è¿”å›è¾ƒå¤§å€¼                        |
| public static int min(int a,int b)           | è¿”å›è¾ƒå°å€¼                        |
| public static double random()                | è¿”å›å€¼ä¸º double çš„æ­£å€¼ï¼Œ[0.0,1.0) |

```java
public class MathDemo {
    public static void main(String[] args) {
        // 1.å–ç»å¯¹å€¼:è¿”å›æ­£æ•°ã€‚
        System.out.println(Math.abs(10));
        System.out.println(Math.abs(-10.3));
        // 2.å‘ä¸Šå–æ•´: 5
        System.out.println(Math.ceil(4.00000001)); // 5.0
        System.out.println(Math.ceil(-4.00000001));//4.0
        // 3.å‘ä¸‹å–æ•´ï¼š4
        System.out.println(Math.floor(4.99999999)); // 4.0
        System.out.println(Math.floor(-4.99999999)); // 5.0
        // 4.æ±‚æŒ‡æ•°æ¬¡æ–¹
        System.out.println(Math.pow(2 , 3)); // 2^3 = 8.0
        // 5.å››èˆäº”å…¥ 10
        System.out.println(Math.round(4.49999)); // 4
        System.out.println(Math.round(4.500001)); // 5
        System.out.println(Math.round(5.5));//6
    }
}
```



****



### DecimalFormat

ä½¿ä»»ä½•å½¢å¼çš„æ•°å­—è§£æå’Œæ ¼å¼åŒ–

```java
public static void main(String[]args){
    double pi = 3.1415927;ã€€//åœ†å‘¨ç‡
    //å–ä¸€ä½æ•´æ•°
    System.out.println(new DecimalFormat("0").format(pi));ã€€ã€€ã€€//3
    //å–ä¸€ä½æ•´æ•°å’Œä¸¤ä½å°æ•°
    System.out.println(new DecimalFormat("0.00").format(pi));ã€€//3.14
    //å–ä¸¤ä½æ•´æ•°å’Œä¸‰ä½å°æ•°ï¼Œæ•´æ•°ä¸è¶³éƒ¨åˆ†ä»¥0å¡«è¡¥ã€‚
    System.out.println(new DecimalFormat("00.000").format(pi));// 03.142
    //å–æ‰€æœ‰æ•´æ•°éƒ¨åˆ†
    System.out.println(new DecimalFormat("#").format(pi));ã€€ã€€ã€€//3
    //ä»¥ç™¾åˆ†æ¯”æ–¹å¼è®¡æ•°ï¼Œå¹¶å–ä¸¤ä½å°æ•°
    System.out.println(new DecimalFormat("#.##%").format(pi));ã€€//314.16%

    long c =299792458;ã€€ã€€//å…‰é€Ÿ
    //æ˜¾ç¤ºä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œå¹¶å–äº”ä½å°æ•°
    System.out.println(new DecimalFormat("#.#####E0").format(c));//2.99792E8
    //æ˜¾ç¤ºä¸ºä¸¤ä½æ•´æ•°çš„ç§‘å­¦è®¡æ•°æ³•ï¼Œå¹¶å–å››ä½å°æ•°
    System.out.println(new DecimalFormat("00.####E0").format(c));//29.9792E7
    //æ¯ä¸‰ä½ä»¥é€—å·è¿›è¡Œåˆ†éš”ã€‚
    System.out.println(new DecimalFormat(",###").format(c));//299,792,458
    //å°†æ ¼å¼åµŒå…¥æ–‡æœ¬
    System.out.println(new DecimalFormat("å…‰é€Ÿå¤§å°ä¸ºæ¯ç§’,###ç±³ã€‚").format(c));

}
```





***



### BigDecimal

Java åœ¨ java.math åŒ…ä¸­æä¾›çš„ API ç±»ï¼Œç”¨æ¥å¯¹è¶…è¿‡16ä½æœ‰æ•ˆä½çš„æ•°è¿›è¡Œç²¾ç¡®çš„è¿ç®—

æ„é€ æ–¹æ³•ï¼š

* `public static BigDecimal valueOf(double val)`ï¼šåŒ…è£…æµ®ç‚¹æ•°æˆä¸ºå¤§æ•°æ®å¯¹è±¡ã€‚
* `public BigDecimal(double val)`
* `public BigDecimal(String val)`

å¸¸ç”¨APIï¼š

* `public BigDecimal add(BigDecimal value)`ï¼šåŠ æ³•è¿ç®—
* `public BigDecimal subtract(BigDecimal value)`ï¼šå‡æ³•è¿ç®— 
* `public BigDecimal multiply(BigDecimal value)`ï¼šä¹˜æ³•è¿ç®— 
* `public BigDecimal divide(BigDecimal value)`ï¼šé™¤æ³•è¿ç®—
* `public double doubleValue()`ï¼šæŠŠ BigDecimal è½¬æ¢æˆ double ç±»å‹
* `public int intValue()`ï¼šè½¬ä¸º int å…¶ä»–ç±»å‹ç›¸åŒ
* `public BigDecimal divide (BigDecimal valueï¼Œç²¾ç¡®å‡ ä½ï¼Œèˆå…¥æ¨¡å¼)`ï¼šé™¤æ³•

```java
public class BigDecimalDemo {
    public static void main(String[] args) {
        // æµ®ç‚¹å‹è¿ç®—çš„æ—¶å€™ç›´æ¥+ - * / å¯èƒ½ä¼šå‡ºç°æ•°æ®å¤±çœŸï¼ˆç²¾åº¦é—®é¢˜ï¼‰ã€‚
        System.out.println(0.1 + 0.2);
        System.out.println(1.301 / 100);
        
        double a = 0.1 ;
        double b = 0.2 ;
        double c = a + b ;
        System.out.println(c);//0.30000000000000004
        
        // 1.æŠŠæµ®ç‚¹æ•°è½¬æ¢æˆå¤§æ•°æ®å¯¹è±¡è¿ç®—
        BigDecimal a1 = BigDecimal.valueOf(a);
        BigDecimal b1 = BigDecimal.valueOf(b);
        BigDecimal c1 = a1.add(b1);//a1.divide(b1);ä¹Ÿå¯ä»¥
		System.out.println(c1);

        // BigDecimalåªæ˜¯è§£å†³ç²¾åº¦é—®é¢˜çš„æ‰‹æ®µï¼Œdoubleæ•°æ®æ‰æ˜¯æˆ‘ä»¬çš„ç›®çš„ï¼ï¼
        double d = c1.doubleValue();
    }
}
```

æ€»ç»“ï¼š

1. BigDecimal æ˜¯ç”¨æ¥è¿›è¡Œç²¾ç¡®è®¡ç®—çš„
2. åˆ›å»º BigDecimal çš„å¯¹è±¡ï¼Œæ„é€ æ–¹æ³•ä½¿ç”¨å‚æ•°ç±»å‹ä¸ºå­—ç¬¦ä¸²çš„
3. å››åˆ™è¿ç®—ä¸­çš„é™¤æ³•ï¼Œå¦‚æœé™¤ä¸å°½è¯·ä½¿ç”¨ divide çš„ä¸‰ä¸ªå‚æ•°çš„æ–¹æ³•

```java
BigDecimal divide = bd1.divide(å‚ä¸è¿ç®—çš„å¯¹è±¡,å°æ•°ç‚¹åç²¾ç¡®åˆ°å¤šå°‘ä½,èˆå…¥æ¨¡å¼);
//å‚æ•°1ï¼šè¡¨ç¤ºå‚ä¸è¿ç®—çš„BigDecimal å¯¹è±¡ã€‚
//å‚æ•°2ï¼šè¡¨ç¤ºå°æ•°ç‚¹åé¢ç²¾ç¡®åˆ°å¤šå°‘ä½
//å‚æ•°3ï¼šèˆå…¥æ¨¡å¼  
// BigDecimal.ROUND_UP  è¿›ä¸€æ³•
// BigDecimal.ROUND_FLOOR å»å°¾æ³•
// BigDecimal.ROUND_HALF_UP å››èˆäº”å…¥
```



***



### Regex

#### æ¦‚è¿°

æ­£åˆ™è¡¨è¾¾å¼çš„ä½œç”¨ï¼šæ˜¯ä¸€äº›ç‰¹æ®Šå­—ç¬¦ç»„æˆçš„æ ¡éªŒè§„åˆ™ï¼Œå¯ä»¥æ ¡éªŒä¿¡æ¯çš„æ­£ç¡®æ€§ï¼Œæ ¡éªŒé‚®ç®±ã€ç”µè¯å·ç ã€é‡‘é¢ç­‰ã€‚

æ¯”å¦‚æ£€éªŒ qq å·ï¼š

```java
public static boolean checkQQRegex(String qq){
    return qq!=null && qq.matches("\\d{4,}");//å³æ˜¯æ•°å­— å¿…é¡»å¤§äº4ä½æ•°
}// ç”¨\\d  æ˜¯å› ä¸º\ç”¨æ¥å‘Šè¯‰å®ƒæ˜¯ä¸€ä¸ªæ ¡éªŒç±»ï¼Œä¸æ˜¯æ™®é€šçš„å­—ç¬¦ æ¯”å¦‚ \t \n
```

java.util.regex åŒ…ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªç±»ï¼š

- Pattern ç±»ï¼š

  Pattern å¯¹è±¡æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„ç¼–è¯‘è¡¨ç¤ºã€‚Pattern ç±»æ²¡æœ‰å…¬å…±æ„é€ æ–¹æ³•ï¼Œè¦åˆ›å»ºä¸€ä¸ª Pattern å¯¹è±¡ï¼Œå¿…é¡»é¦–å…ˆè°ƒç”¨å…¶å…¬å…±é™æ€ç¼–è¯‘æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª Pattern å¯¹è±¡ã€‚è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°

- Matcher ç±»ï¼š

  Matcher å¯¹è±¡æ˜¯å¯¹è¾“å…¥å­—ç¬¦ä¸²è¿›è¡Œè§£é‡Šå’ŒåŒ¹é…æ“ä½œçš„å¼•æ“ã€‚ä¸Pattern ç±»ä¸€æ ·ï¼ŒMatcher ä¹Ÿæ²¡æœ‰å…¬å…±æ„é€ æ–¹æ³•ï¼Œéœ€è¦è°ƒç”¨ Pattern å¯¹è±¡çš„ matcher æ–¹æ³•æ¥è·å¾—ä¸€ä¸ª Matcher å¯¹è±¡

- PatternSyntaxExceptionï¼š

  PatternSyntaxException æ˜¯ä¸€ä¸ªéå¼ºåˆ¶å¼‚å¸¸ç±»ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­çš„è¯­æ³•é”™è¯¯ã€‚



***



#### å­—ç¬¦åŒ¹é…

##### æ™®é€šå­—ç¬¦

å­—æ¯ã€æ•°å­—ã€æ±‰å­—ã€ä¸‹åˆ’çº¿ã€ä»¥åŠæ²¡æœ‰ç‰¹æ®Šå®šä¹‰çš„æ ‡ç‚¹ç¬¦å·ï¼Œéƒ½æ˜¯â€œæ™®é€šå­—ç¬¦â€ã€‚è¡¨è¾¾å¼ä¸­çš„æ™®é€šå­—ç¬¦ï¼Œåœ¨åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™ï¼ŒåŒ¹é…ä¸ä¹‹ç›¸åŒçš„ä¸€ä¸ªå­—ç¬¦ã€‚å…¶ä»–ç»Ÿç§°**å…ƒå­—ç¬¦**



***



##### ç‰¹æ®Šå­—ç¬¦

\r\n æ˜¯ Windows ä¸­çš„æ–‡æœ¬è¡Œç»“æŸæ ‡ç­¾ï¼Œåœ¨ Unix/Linux åˆ™æ˜¯ \n

| å…ƒå­—ç¬¦ | è¯´æ˜                                                         |
| ------ | ------------------------------------------------------------ |
| \      | å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºä¸€ä¸ªç‰¹æ®Šå­—ç¬¦æˆ–åŸä¹‰å­—ç¬¦ï¼Œå‘Šè¯‰å®ƒæ˜¯ä¸€ä¸ªæ ¡éªŒç±»ï¼Œä¸æ˜¯æ™®é€šå­—ç¬¦ |
| \f     | æ¢é¡µç¬¦                                                       |
| \n     | æ¢è¡Œç¬¦                                                       |
| \r     | å›è½¦ç¬¦                                                       |
| \t     | åˆ¶è¡¨ç¬¦                                                       |
| \\     | ä»£è¡¨ \ æœ¬èº«                                                  |
| ()     | ä½¿ç”¨ () å®šä¹‰ä¸€ä¸ªå­è¡¨è¾¾å¼ã€‚å­è¡¨è¾¾å¼çš„å†…å®¹å¯ä»¥å½“æˆä¸€ä¸ªç‹¬ç«‹å…ƒç´  |



***



##### æ ‡å‡†å­—ç¬¦

èƒ½å¤Ÿä¸å¤šç§å­—ç¬¦åŒ¹é…çš„è¡¨è¾¾å¼ï¼Œæ³¨æ„åŒºåˆ†å¤§å°å†™ï¼Œå¤§å†™æ˜¯ç›¸åçš„æ„æ€ï¼Œåªèƒ½æ ¡éªŒ**å•**ä¸ªå­—ç¬¦ã€‚

| å…ƒå­—ç¬¦ | è¯´æ˜                                                         |
| ------ | ------------------------------------------------------------ |
| .      | åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ˆé™¤äº†æ¢è¡Œç¬¦ï¼‰ï¼Œå¦‚æœè¦åŒ¹é…åŒ…æ‹¬ \n åœ¨å†…çš„æ‰€æœ‰å­—ç¬¦ï¼Œä¸€èˆ¬ç”¨ [\s\S] |
| \d     | æ•°å­—å­—ç¬¦ï¼Œ0~9 ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œç­‰ä»·äº [0-9]                     |
| \D     | éæ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº  [ ^0-9]                                  |
| \w     | å¤§å°å†™å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº[a-zA-Z_0-9_]                |
| \W     | å¯¹\wå–éï¼Œç­‰ä»·äº[ ^\w]                                       |
| \s     | ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ç©ºç™½å­—ç¬¦çš„å…¶ä¸­ä»»æ„ä¸€ä¸ªï¼Œç­‰ä»·äº[\f\n\r\t\v] |
| \S     | å¯¹ \s å–é                                                   |

\x åŒ¹é…åå…­è¿›åˆ¶å­—ç¬¦ï¼Œ\0 åŒ¹é…å…«è¿›åˆ¶ï¼Œä¾‹å¦‚ \xA å¯¹åº”å€¼ä¸º 10 çš„ ASCII å­—ç¬¦ ï¼Œå³ \n



***



##### è‡ªå®šä¹‰ç¬¦

è‡ªå®šä¹‰ç¬¦å·é›†åˆï¼Œ[ ] æ–¹æ‹¬å·åŒ¹é…æ–¹å¼ï¼Œèƒ½å¤ŸåŒ¹é…æ–¹æ‹¬å·ä¸­**ä»»æ„ä¸€ä¸ª**å­—ç¬¦

| å…ƒå­—ç¬¦       | è¯´æ˜                                      |
| ------------ | ----------------------------------------- |
| [ab5@]       | åŒ¹é… "a" æˆ– "b" æˆ– "5" æˆ– "@"             |
| [^abc]       | åŒ¹é… "a","b","c" ä¹‹å¤–çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦       |
| [f-k]        | åŒ¹é… "f"~"k" ä¹‹é—´çš„ä»»æ„ä¸€ä¸ªå­—æ¯           |
| [^A-F0-3]    | åŒ¹é… "A","F","0"~"3" ä¹‹å¤–çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦   |
| [a-d[m-p]]   | åŒ¹é… a åˆ° d æˆ–è€… m åˆ° pï¼š[a-dm-p]ï¼ˆå¹¶é›†ï¼‰ |
| [a-z&&[m-p]] | åŒ¹é… a åˆ° z å¹¶ä¸” m åˆ° pï¼š[a-dm-p]ï¼ˆäº¤é›†ï¼‰ |
| [^]          | å–å                                      |

* æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šç¬¦å·ï¼Œè¢«åŒ…å«åˆ°ä¸­æ‹¬å·ä¸­ï¼Œåˆ™å¤±å»ç‰¹æ®Šæ„ä¹‰ï¼Œé™¤äº† ^,- ä¹‹å¤–ï¼Œéœ€è¦åœ¨å‰é¢åŠ  \

* æ ‡å‡†å­—ç¬¦é›†åˆï¼Œé™¤å°æ•°ç‚¹å¤–ï¼Œå¦‚æœè¢«åŒ…å«äºä¸­æ‹¬å·ï¼Œè‡ªå®šä¹‰å­—ç¬¦é›†åˆå°†åŒ…å«è¯¥é›†åˆã€‚
  æ¯”å¦‚ï¼š[\d. \ -+] å°†åŒ¹é…ï¼šæ•°å­—ã€å°æ•°ç‚¹ã€+ã€-



***



##### é‡è¯å­—ç¬¦

ä¿®é¥°åŒ¹é…æ¬¡æ•°çš„ç‰¹æ®Šç¬¦å·ã€‚

* åŒ¹é…æ¬¡æ•°ä¸­çš„è´ªå©ªæ¨¡å¼(åŒ¹é…å­—ç¬¦è¶Šå¤šè¶Šå¥½ï¼Œé»˜è®¤ ï¼)ï¼Œ\* å’Œ + éƒ½æ˜¯è´ªå©ªå‹å…ƒå­—ç¬¦ã€‚
* åŒ¹é…æ¬¡æ•°ä¸­çš„éè´ªå©ªæ¨¡å¼ï¼ˆåŒ¹é…å­—ç¬¦è¶Šå°‘è¶Šå¥½ï¼Œä¿®é¥°åŒ¹é…æ¬¡æ•°çš„ç‰¹æ®Šç¬¦å·åå†åŠ ä¸Šä¸€ä¸ª ? å·ï¼‰

| å…ƒå­—ç¬¦ | è¯´æ˜                              |
| ------ | --------------------------------- |
| X?     | X ä¸€æ¬¡æˆ–ä¸€æ¬¡ä¹Ÿæ²¡ï¼Œæœ‰ç›¸å½“äº {0,1}  |
| X*     | X ä¸å‡ºç°æˆ–å‡ºç°ä»»æ„æ¬¡ï¼Œç›¸å½“äº {0,} |
| X+     | X è‡³å°‘ä¸€æ¬¡ï¼Œç›¸å½“äº {1,}           |
| X{n}   | X æ°å¥½ n æ¬¡                       |
| {n,}   | X è‡³å°‘ n æ¬¡                       |
| {n,m}  | X è‡³å°‘ n æ¬¡ï¼Œä½†æ˜¯ä¸è¶…è¿‡ m æ¬¡      |



***



#### ä½ç½®åŒ¹é…

##### å­—ç¬¦è¾¹ç•Œ

æœ¬ç»„æ ‡è®°åŒ¹é…çš„ä¸æ˜¯å­—ç¬¦è€Œæ˜¯ä½ç½®ï¼Œç¬¦åˆæŸç§æ¡ä»¶çš„ä½ç½®

| å…ƒå­—ç¬¦ | è¯´æ˜                                                         |
| ------ | ------------------------------------------------------------ |
| ^      | ä¸å­—ç¬¦ä¸²å¼€å§‹çš„åœ°æ–¹åŒ¹é…ï¼ˆåœ¨å­—ç¬¦é›†åˆä¸­ç”¨æ¥æ±‚éï¼Œåœ¨å­—ç¬¦é›†åˆå¤–ç”¨ä½œåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ï¼‰ |
| $      | ä¸å­—ç¬¦ä¸²ç»“æŸçš„åœ°æ–¹åŒ¹é…                                       |
| \b     | åŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œ                                             |



***



##### æ•è·ç»„

æ•è·ç»„æ˜¯æŠŠå¤šä¸ªå­—ç¬¦å½“ä¸€ä¸ªå•ç‹¬å•å…ƒè¿›è¡Œå¤„ç†çš„æ–¹æ³•ï¼Œå®ƒé€šè¿‡å¯¹æ‹¬å·å†…çš„å­—ç¬¦åˆ†ç»„æ¥åˆ›å»ºã€‚

åœ¨è¡¨è¾¾å¼ `((A)(B(C)))`ï¼Œæœ‰å››ä¸ªè¿™æ ·çš„ç»„ï¼š((A)(B(C)))ã€(A)ã€(B(C))ã€(C)ï¼ˆæŒ‰ç…§æ‹¬å·ä»å·¦åˆ°å³ä¾æ¬¡ä¸º group(1)...ï¼‰

* è°ƒç”¨ matcher å¯¹è±¡çš„ groupCount æ–¹æ³•è¿”å›ä¸€ä¸ª int å€¼ï¼Œè¡¨ç¤º matcher å¯¹è±¡å½“å‰æœ‰å¤šä¸ªæ•è·ç»„ã€‚
* ç‰¹æ®Šçš„ç»„ group(0)ã€group()ï¼Œä»£è¡¨æ•´ä¸ªè¡¨è¾¾å¼ï¼Œè¯¥ç»„ä¸åŒ…æ‹¬åœ¨ groupCount çš„è¿”å›å€¼ä¸­ã€‚ 

| è¡¨è¾¾å¼                    | è¯´æ˜                                                         |
| ------------------------- | ------------------------------------------------------------ |
| \|  (åˆ†æ”¯ç»“æ„)            | å·¦å³ä¸¤è¾¹è¡¨è¾¾å¼ä¹‹é—´ "æˆ–" å…³ç³»ï¼ŒåŒ¹é…å·¦è¾¹æˆ–è€…å³è¾¹               |
| ()  (æ•è·ç»„)              | (1) åœ¨è¢«ä¿®é¥°åŒ¹é…æ¬¡æ•°çš„æ—¶å€™ï¼Œæ‹¬å·ä¸­çš„è¡¨è¾¾å¼å¯ä»¥ä½œä¸ºæ•´ä½“è¢«ä¿®é¥°<br/>(2) å–åŒ¹é…ç»“æœçš„æ—¶å€™ï¼Œæ‹¬å·ä¸­çš„è¡¨è¾¾å¼åŒ¹é…åˆ°çš„å†…å®¹å¯ä»¥è¢«å•ç‹¬å¾—åˆ°<br/>(3) æ¯ä¸€å¯¹æ‹¬å·åˆ†é…ä¸€ä¸ªç¼–å·,()çš„æ•è·æ ¹æ®å·¦æ‹¬å·çš„é¡ºåºä» 1 å¼€å§‹è‡ªåŠ¨ç¼–å·ã€‚æ•è·å…ƒç´ ç¼–å·ä¸ºé›¶çš„ç¬¬ä¸€ä¸ªæ•è·æ˜¯ç”±æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…çš„æ–‡æœ¬ |
| (?:Expression)   éæ•è·ç»„ | ä¸€äº›è¡¨è¾¾å¼ä¸­ï¼Œä¸å¾—ä¸ä½¿ç”¨( )ï¼Œä½†åˆä¸éœ€è¦ä¿å­˜ () ä¸­å­è¡¨è¾¾å¼åŒ¹é…çš„å†…å®¹ï¼Œè¿™æ—¶å¯ä»¥ç”¨éæ•è·ç»„æ¥æŠµæ¶ˆä½¿ç”¨( )å¸¦æ¥çš„å‰¯ä½œç”¨ã€‚ |



***



##### åå‘å¼•ç”¨

åå‘å¼•ç”¨ï¼ˆ\numberï¼‰ï¼Œåˆå«å›æº¯å¼•ç”¨ï¼š

* æ¯ä¸€å¯¹()ä¼šåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œä½¿ç”¨ () çš„æ•è·æ ¹æ®å·¦æ‹¬å·çš„é¡ºåºä»1å¼€å§‹è‡ªåŠ¨ç¼–å·

* é€šè¿‡åå‘å¼•ç”¨ï¼Œå¯ä»¥å¯¹åˆ†ç»„å·²æ•è·çš„å­—ç¬¦ä¸²è¿›è¡Œå¼•ç”¨ï¼Œç»§ç»­åŒ¹é…

* **æŠŠåŒ¹é…åˆ°çš„å­—ç¬¦é‡å¤ä¸€éåœ¨è¿›è¡ŒåŒ¹é…**

* åº”ç”¨ 1ï¼š

  ```java
  String regex = "((\d)3)\1[0-9](\w)\2{2}";
  ```

  * é¦–å…ˆåŒ¹é… ((\d)3)ï¼Œå…¶æ¬¡ \1 åŒ¹é… ((\d)3) å·²ç»åŒ¹é…åˆ°çš„å†…å®¹ï¼Œ\2 åŒ¹é… (\d)ï¼Œ {2} æŒ‡çš„æ˜¯ \2 çš„å€¼å‡ºç°ä¸¤æ¬¡
  * å®ä¾‹ï¼š23238n22ï¼ˆåŒ¹é…åˆ° 2 æœªæ¥å°±ç»§ç»­åŒ¹é… 2ï¼‰
  * å®ä¾‹ï¼š43438n44

* åº”ç”¨ 2ï¼šçˆ¬è™«

  ```java
  String regex = "<(h[1-6])>\w*?<\/\1>";
  ```

  åŒ¹é…ç»“æœ

  ```java
  <h1>x</h1>//åŒ¹é…
  <h2>x</h2>//åŒ¹é…
  <h3>x</h1>//ä¸åŒ¹é…
  ```

  

***



##### é›¶å®½æ–­è¨€

é¢„æœç´¢ï¼ˆé›¶å®½æ–­è¨€ï¼‰ï¼ˆç¯è§†ï¼‰

* åªè¿›è¡Œå­è¡¨è¾¾å¼çš„åŒ¹é…ï¼ŒåŒ¹é…å†…å®¹ä¸è®¡å…¥æœ€ç»ˆçš„åŒ¹é…ç»“æœï¼Œæ˜¯é›¶å®½åº¦

* åˆ¤æ–­å½“å‰ä½ç½®çš„å‰åå­—ç¬¦ï¼Œæ˜¯å¦ç¬¦åˆæŒ‡å®šçš„æ¡ä»¶ï¼Œä½†ä¸åŒ¹é…å‰åçš„å­—ç¬¦ï¼Œ**æ˜¯å¯¹ä½ç½®çš„åŒ¹é…**

* æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå­è¡¨è¾¾å¼åŒ¹é…åˆ°çš„æ˜¯å­—ç¬¦å†…å®¹ï¼Œè€Œéä½ç½®ï¼Œå¹¶è¢«ä¿å­˜åˆ°æœ€ç»ˆçš„åŒ¹é…ç»“æœä¸­ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºè¿™ä¸ªå­è¡¨è¾¾å¼æ˜¯å æœ‰å­—ç¬¦çš„ï¼›å¦‚æœå­è¡¨è¾¾å¼åŒ¹é…çš„ä»…ä»…æ˜¯ä½ç½®ï¼Œæˆ–è€…åŒ¹é…çš„å†…å®¹å¹¶ä¸ä¿å­˜åˆ°æœ€ç»ˆçš„åŒ¹é…ç»“æœä¸­ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºè¿™ä¸ªå­è¡¨è¾¾å¼æ˜¯**é›¶å®½åº¦**çš„ã€‚å æœ‰å­—ç¬¦è¿˜æ˜¯é›¶å®½åº¦ï¼Œæ˜¯é’ˆå¯¹åŒ¹é…çš„å†…å®¹æ˜¯å¦ä¿å­˜åˆ°æœ€ç»ˆçš„åŒ¹é…ç»“æœä¸­è€Œè¨€çš„

  | è¡¨è¾¾å¼   | è¯´æ˜                                    |
  | -------- | --------------------------------------- |
  | (?=exp)  | æ–­è¨€è‡ªèº«å‡ºç°çš„ä½ç½®çš„åé¢èƒ½åŒ¹é…è¡¨è¾¾å¼exp |
  | (?<=exp) | æ–­è¨€è‡ªèº«å‡ºç°çš„ä½ç½®çš„å‰é¢èƒ½åŒ¹é…è¡¨è¾¾å¼exp |
  | (?!exp)  | æ–­è¨€æ­¤ä½ç½®çš„åé¢ä¸èƒ½åŒ¹é…è¡¨è¾¾å¼exp       |
  | (?<!exp) | æ–­è¨€æ­¤ä½ç½®çš„å‰é¢ä¸èƒ½åŒ¹é…è¡¨è¾¾å¼exp       |




***



#### åŒ¹é…æ¨¡å¼

æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ¨¡å¼ï¼š

* IGNORECASE å¿½ç•¥å¤§å°å†™æ¨¡å¼
  * åŒ¹é…æ—¶å¿½ç•¥å¤§å°å†™ã€‚
  * é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯è¦åŒºåˆ†å¤§å°å†™çš„ã€‚
* SINGLELINE å•è¡Œæ¨¡å¼
  * æ•´ä¸ªæ–‡æœ¬çœ‹ä½œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåªæœ‰ä¸€ä¸ªå¼€å¤´ï¼Œä¸€ä¸ªç»“å°¾ã€‚
  * ä½¿å°æ•°ç‚¹ "." å¯ä»¥åŒ¹é…åŒ…å«æ¢è¡Œç¬¦ï¼ˆ\nï¼‰åœ¨å†…çš„ä»»æ„å­—ç¬¦ã€‚
* MULTILINE å¤šè¡Œæ¨¡å¼
  * æ¯è¡Œéƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œéƒ½æœ‰å¼€å¤´å’Œç»“å°¾ã€‚
  * åœ¨æŒ‡å®šäº† MULTILINE ä¹‹åï¼Œå¦‚æœéœ€è¦ä»…åŒ¹é…å­—ç¬¦ä¸²å¼€å§‹å’Œç»“æŸä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨ \A å’Œ \Z



***



#### åˆ†ç»„åŒ¹é…

Pattern ç±»ï¼š

* `static Pattern compile(String regex)`ï¼šå°†ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼ç¼–è¯‘ä¸ºæ¨¡å¼
* `Matcher matcher(CharSequence input)`ï¼šåˆ›å»ºä¸€ä¸ªåŒ¹é…å™¨ï¼ŒåŒ¹é…ç»™å®šçš„è¾“å…¥ä¸æ­¤æ¨¡å¼
* `static boolean matches(String regex, CharSequence input)`ï¼šç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶åŒ¹é…è¾“å…¥

Matcher ç±»ï¼š

* `boolean find()`ï¼šæ‰«æè¾“å…¥çš„åºåˆ—ï¼ŒæŸ¥æ‰¾ä¸è¯¥æ¨¡å¼åŒ¹é…çš„ä¸‹ä¸€ä¸ªå­åºåˆ—
* `String group()`ï¼šè¿”å›ä¸ä¸Šä¸€ä¸ªåŒ¹é…çš„è¾“å…¥å­åºåˆ—ï¼ŒåŒ group(0)ï¼ŒåŒ¹é…æ•´ä¸ªè¡¨è¾¾å¼çš„å­å­—ç¬¦ä¸²
* `String group(int group)`ï¼šè¿”å›åœ¨ä¸Šä¸€æ¬¡åŒ¹é…æ“ä½œæœŸé—´ç”±ç»™å®šç»„æ•è·çš„è¾“å…¥å­åºåˆ— 
* `int groupCount()`ï¼šè¿”å›æ­¤åŒ¹é…å™¨æ¨¡å¼ä¸­æ•è·ç»„çš„æ•°é‡

```java
public class Demo01{
	public static void main(String[] args) {
		//è¡¨è¾¾å¼å¯¹è±¡
		Pattern p = Pattern.compile("\\w+");
		//åˆ›å»ºMatcherå¯¹è±¡
		Matcher m = p.matcher("asfsdf2&&3323");
		//boolean b = m.matches();//å°è¯•å°†æ•´ä¸ªå­—ç¬¦åºåˆ—ä¸è¯¥æ¨¡å¼åŒ¹é…
		//System.out.println(b);//false
		//boolean b2 = m.find();//è¯¥æ–¹æ³•æ‰«æè¾“å…¥çš„åºåˆ—ï¼ŒæŸ¥æ‰¾ä¸è¯¥æ¨¡å¼åŒ¹é…çš„ä¸‹ä¸€ä¸ªå­åºåˆ—
		//System.out.println(b2);//true
		
		//System.out.println(m.find());
		//System.out.println(m.group());//asfsdf2
		//System.out.println(m.find());
		//System.out.println(m.group());//3323
		
		while(m.find()){
			System.out.println(m.group());	//group(),group(0)åŒ¹é…æ•´ä¸ªè¡¨è¾¾å¼çš„å­å­—ç¬¦ä¸²
			System.out.println(m.group(0));
		}
		
	}
}
```

```java
public class Demo02 {
	public static void main(String[] args) {
		//åœ¨è¿™ä¸ªå­—ç¬¦ä¸²ï¼šasfsdf23323ï¼Œæ˜¯å¦ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š\w+
		//è¡¨è¾¾å¼å¯¹è±¡
        Pattern p = Pattern.compile("(([a-z]+)([0-9]+))");//ä¸éœ€è¦åŠ å¤šä½™çš„æ‹¬å·
		//åˆ›å»ºMatcherå¯¹è±¡
		Matcher m = p.matcher("aa232**ssd445");
	
		while(m.find()){
			System.out.println(m.group());//aa232  ssd445
			System.out.println(m.group(1));//aa232  ssd445
			System.out.println(m.group(2));//aa     ssd
            System.out.println(m.group(3));//232    445 
		}
	}
}
```

* æ­£åˆ™è¡¨è¾¾å¼æ”¹ä¸º `"(([a-z]+)(?:[0-9]+))"`   æ²¡æœ‰ group(3) å› ä¸ºæ˜¯éæ•è·ç»„
* æ­£åˆ™è¡¨è¾¾å¼æ”¹ä¸º `"([a-z]+)([0-9]+)"`  æ²¡æœ‰ group(3)    aa232  - aa  --232



***



#### åº”ç”¨

##### åŸºæœ¬éªŒè¯

```java
public static void main(String[] args){
	System.out.println("a".matches("[abc]"));//trueåˆ¤æ–­aæ˜¯å¦åœ¨abc
    System.out.println("a".matches("[^abc]"));//false åˆ¤æ–­aæ˜¯å¦åœ¨abcä¹‹å¤–çš„
    System.out.println("a".matches("\\d")); //false æ˜¯å¦aæ˜¯æ•´æ•°
    System.out.println("a".matches("\\w")); //true æ˜¯å¦æ˜¯å­—ç¬¦
    System.out.println("ä½ ".matches("\\w")); // false
    System.out.println("aa".matches("\\w"));//false åªèƒ½æ£€éªŒå•ä¸ªå­—ç¬¦
    
    // å¯†ç  å¿…é¡»æ˜¯æ•°å­— å­—æ¯ ä¸‹åˆ’çº¿ è‡³å°‘ 6ä½
	System.out.println("ssds3c".matches("\\w{6,}")); // true
    // éªŒè¯ã€‚å¿…é¡»æ˜¯æ•°å­—å’Œå­—ç¬¦  å¿…é¡»æ˜¯4ä½
    System.out.println("dsd22".matches("[a-zA-Z0-9]{4}")); // false
    System.out.println("A3dy".matches("[a-zA-Z0-9]{4}")); // true
}
```



***



##### éªŒè¯å·ç 

```java
//1å¼€å¤´ ç¬¬äºŒä½æ˜¯2-9çš„æ•°å­—
public static void checkPhone(String phone){
    if(phone.matches("1[3-9]\\d{9}")){
        System.out.println("æ‰‹æœºå·ç æ ¼å¼æ­£ç¡®ï¼");
    } else {.......}
}
//1111@qq.com  zhy@pic.com.cn
public static void checkEmail(String email){
    if(email.matches("\\w{1,}@\\w{1,}(\\.\\w{2,5}){1,2}")){
        System.out.println("é‚®ç®±æ ¼å¼æ­£ç¡®ï¼");
    }// .æ˜¯ä»»æ„å­—ç¬¦ \\.å°±æ˜¯ç‚¹
}
```



***



##### æŸ¥æ‰¾æ›¿æ¢

* `public String[] split(String regex)`ï¼šæŒ‰ç…§æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å†…å®¹è¿›è¡Œåˆ†å‰²å­—ç¬¦ä¸²ï¼Œåå›ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„
* `public String replaceAll(String regex,String newStr)`ï¼šæŒ‰ç…§æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å†…å®¹è¿›è¡Œæ›¿æ¢

```java
//æ•°ç»„åˆ†å‰²
public static void main(String[] args) {
	// 1.splitçš„åŸºç¡€ç”¨æ³•
	String names = "é£æ¸…æ‰¬,å¼ æ— å¿Œ,å‘¨èŠ·è‹¥";
	// ä»¥â€œï¼Œâ€åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„
    String[] nameArrs = names.split(",");

    // 2.splité›†åˆæ­£åˆ™è¡¨è¾¾å¼åšåˆ†å‰²
    String names1 = "é£æ¸…æ‰¬lv434fda324å¼ æ— å¿Œ87632fad2342423å‘¨èŠ·è‹¥";
    // ä»¥åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„å†…å®¹ä¸ºåˆ†å‰²ç‚¹åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„
	String[] nameArrs1 = names1.split("\\w+");
    
	// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å®šä½å‡ºå†…å®¹ï¼Œæ›¿æ¢æˆ/
	System.out.println(names1.replaceAll("\\w+","/"));//é£æ¸…æ‰¬/å¼ æ— å¿Œ/å‘¨èŠ·è‹¥

	String names3 = "é£æ¸…æ‰¬,å¼ æ— å¿Œ,å‘¨èŠ·è‹¥";
	System.out.println(names3.replaceAll(",","-"));//é£æ¸…æ‰¬-å¼ æ— å¿Œ-å‘¨èŠ·è‹¥
}
```



***



##### æœç´¢å·ç 

æ‰¾å‡ºæ‰€æœ‰ 189 å’Œ 132 å¼€å¤´çš„æ‰‹æœºå·

```java
public class RegexDemo {
    public static void main(String[] args) {
        String rs = "189asjk65as1891898777745gkkkk189745612318936457894";
        String regex = "(?=((189|132)\\d{8}))";
        Pattern pattern = Pattern.compile(regex);
        Matcher matcher = pattern.matcher(rs);
        while (matcher.find()) {
            System.out.println(matcher.group(1));
        }
    }
}
```





***





## é›†åˆ

### é›†åˆæ¦‚è¿°

é›†åˆæ˜¯ä¸€ä¸ªå¤§å°å¯å˜çš„å®¹å™¨ï¼Œå®¹å™¨ä¸­çš„æ¯ä¸ªæ•°æ®ç§°ä¸ºä¸€ä¸ªå…ƒç´ 

é›†åˆç‰¹ç‚¹ï¼šç±»å‹å¯ä»¥ä¸ç¡®å®šï¼Œå¤§å°ä¸å›ºå®šï¼›é›†åˆæœ‰å¾ˆå¤šï¼Œä¸åŒçš„é›†åˆç‰¹ç‚¹å’Œä½¿ç”¨åœºæ™¯ä¸åŒ

æ•°ç»„ï¼šç±»å‹å’Œé•¿åº¦ä¸€æ—¦å®šä¹‰å‡ºæ¥å°±éƒ½å›ºå®š

ä½œç”¨ï¼š

* åœ¨å¼€å‘ä¸­ï¼Œå¾ˆå¤šæ—¶å€™å…ƒç´ çš„ä¸ªæ•°æ˜¯ä¸ç¡®å®šçš„
* è€Œä¸”ç»å¸¸è¦è¿›è¡Œå…ƒç´ çš„å¢åˆ è¯¥æŸ¥æ“ä½œï¼Œé›†åˆéƒ½æ˜¯éå¸¸åˆé€‚çš„ï¼Œå¼€å‘ä¸­é›†åˆç”¨çš„æ›´å¤š



***



### å­˜å‚¨ç»“æ„

æ•°æ®ç»“æ„æŒ‡çš„æ˜¯æ•°æ®ä»¥ä»€ä¹ˆæ–¹å¼ç»„ç»‡åœ¨ä¸€èµ·ï¼Œä¸åŒçš„æ•°æ®ç»“æ„ï¼Œå¢åˆ æŸ¥çš„æ€§èƒ½æ˜¯ä¸ä¸€æ ·çš„

æ•°æ®å­˜å‚¨çš„å¸¸ç”¨ç»“æ„æœ‰ï¼šæ ˆã€é˜Ÿåˆ—ã€æ•°ç»„ã€é“¾è¡¨å’Œçº¢é»‘æ ‘

* é˜Ÿåˆ—ï¼ˆqueueï¼‰ï¼šå…ˆè¿›å…ˆå‡ºï¼Œåè¿›åå‡ºã€‚(FIFO first in first out)
  
* æ ˆï¼ˆstackï¼‰ï¼šåè¿›å…ˆå‡ºï¼Œå…ˆè¿›åå‡º ï¼ˆLIFOï¼‰
  
* æ•°ç»„ï¼šæ•°ç»„æ˜¯å†…å­˜ä¸­çš„è¿ç»­å­˜å‚¨åŒºåŸŸï¼Œåˆ†æˆè‹¥å¹²ç­‰åˆ†çš„å°åŒºåŸŸï¼ˆæ¯ä¸ªåŒºåŸŸå¤§å°æ˜¯ä¸€æ ·çš„ï¼‰å…ƒç´ å­˜åœ¨ç´¢å¼•
  
  ç‰¹ç‚¹ï¼š**æŸ¥è¯¢å…ƒç´ å¿«**ï¼ˆæ ¹æ®ç´¢å¼•å¿«é€Ÿè®¡ç®—å‡ºå…ƒç´ çš„åœ°å€ï¼Œç„¶åç«‹å³å»å®šä½ï¼‰ï¼Œ**å¢åˆ å…ƒç´ æ…¢**ï¼ˆåˆ›å»ºæ–°æ•°ç»„ï¼Œè¿ç§»å…ƒç´ ï¼‰

* é“¾è¡¨ï¼šå…ƒç´ ä¸æ˜¯å†…å­˜ä¸­çš„è¿ç»­åŒºåŸŸå­˜å‚¨ï¼Œå…ƒç´ æ˜¯æ¸¸ç¦»å­˜å‚¨çš„ï¼Œæ¯ä¸ªå…ƒç´ ä¼šè®°å½•ä¸‹ä¸ªå…ƒç´ çš„åœ°å€
  ç‰¹ç‚¹ï¼š**æŸ¥è¯¢å…ƒç´ æ…¢ï¼Œå¢åˆ å…ƒç´ å¿«**ï¼ˆé’ˆå¯¹äºé¦–å°¾å…ƒç´ ï¼Œé€Ÿåº¦æå¿«ï¼Œä¸€èˆ¬æ˜¯åŒé“¾è¡¨ï¼‰

* æ ‘ï¼š

  * äºŒå‰æ ‘ï¼šbinary tree æ°¸è¿œåªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ˜¯æ¯ä¸ªç»“ç‚¹ä¸è¶…è¿‡2ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ˆtreeï¼‰ 
  
    ç‰¹ç‚¹ï¼šäºŒå‰æ’åºæ ‘ï¼šå°çš„å·¦è¾¹ï¼Œå¤§çš„å³è¾¹ï¼Œä½†æ˜¯å¯èƒ½æ ‘å¾ˆé«˜ï¼Œæ€§èƒ½å˜å·®ï¼Œä¸ºäº†åšæ’åºå’Œæœç´¢ä¼šè¿›è¡Œå·¦æ—‹å’Œå³æ—‹å®ç°å¹³è¡¡æŸ¥æ‰¾äºŒå‰æ ‘ï¼Œè®©æ ‘çš„é«˜åº¦å·®ä¸å¤§äº1
  
  * çº¢é»‘æ ‘ï¼ˆåŸºäºçº¢é»‘è§„åˆ™å®ç°è‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ï¼‰ï¼šæ ‘ä¿è¯åˆ°äº†å¾ˆçŸ®å°ï¼Œä½†æ˜¯åˆæ’å¥½åºï¼Œæ€§èƒ½æœ€é«˜çš„
  
    ç‰¹ç‚¹ï¼š**çº¢é»‘æ ‘çš„å¢åˆ æŸ¥æ”¹æ€§èƒ½éƒ½å¥½**

å„æ•°æ®ç»“æ„æ—¶é—´å¤æ‚åº¦å¯¹æ¯”ï¼š

![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/æ•°æ®ç»“æ„çš„å¤æ‚åº¦å¯¹æ¯”.png)



å›¾ç‰‡æ¥æºï¼šhttps://www.bigocheatsheet.com/



***



### Collection

#### æ¦‚è¿°

Java ä¸­é›†åˆçš„ä»£è¡¨æ˜¯ Collectionï¼ŒCollection é›†åˆæ˜¯ Java ä¸­é›†åˆçš„ç¥–å®—ç±»

Collection é›†åˆåº•å±‚ä¸ºæ•°ç»„ï¼š`[value1, value2, ....]`

```java
Collectioné›†åˆçš„ä½“ç³»:
                      Collection<E>(æ¥å£)
                 /                         \
          Set<E>(æ¥å£)                    List<E>(æ¥å£)
      /               \                  /             \
 HashSet<E>(å®ç°ç±») TreeSet<>(å®ç°ç±»)  ArrayList<E>(å®ç°ç±»)  LinekdList<>(å®ç°ç±»)
 /
LinkedHashSet<>(å®ç°ç±»)
```

**é›†åˆçš„ç‰¹ç‚¹ï¼š**

* Set ç³»åˆ—é›†åˆï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æ— åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼•çš„
  * HashSetï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æ— åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼•çš„
  * LinkedHashSetï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼•çš„
  * TreeSetï¼šä¸é‡å¤ï¼Œæ— ç´¢å¼•ï¼ŒæŒ‰ç…§å¤§å°é»˜è®¤å‡åºæ’åº
* List ç³»åˆ—é›†åˆï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºï¼Œå¯é‡å¤ï¼Œæœ‰ç´¢å¼•
  * ArrayListï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºï¼Œå¯é‡å¤ï¼Œæœ‰ç´¢å¼•
  * LinekdListï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºï¼Œå¯é‡å¤ï¼Œæœ‰ç´¢å¼•



***



#### API

Collection æ˜¯é›†åˆçš„ç¥–å®—ç±»ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å…¨éƒ¨é›†åˆéƒ½å¯ä»¥ç»§æ‰¿ä½¿ç”¨çš„ï¼Œæ‰€ä»¥è¦å­¦ä¹ å®ƒã€‚

Collection å­ç±»çš„æ„é€ å™¨éƒ½æœ‰å¯ä»¥åŒ…è£…å…¶ä»–å­ç±»çš„æ„é€ æ–¹æ³•ï¼Œå¦‚ï¼š

* `public ArrayList(Collection<? extends E> c)`ï¼šæ„é€ æ–°é›†åˆï¼Œå…ƒç´ æŒ‰ç…§ç”±é›†åˆçš„è¿­ä»£å™¨è¿”å›çš„é¡ºåº

* `public HashSet(Collection<? extends E> c)`ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ çš„æ–°é›†åˆ

Collection API å¦‚ä¸‹ï¼š

* `public boolean add(E e)`ï¼šæŠŠç»™å®šçš„å¯¹è±¡æ·»åŠ åˆ°å½“å‰é›†åˆä¸­ ã€‚
* `public void clear()`ï¼šæ¸…ç©ºé›†åˆä¸­æ‰€æœ‰çš„å…ƒç´ ã€‚
* `public boolean remove(E e)`ï¼šæŠŠç»™å®šçš„å¯¹è±¡åœ¨å½“å‰é›†åˆä¸­åˆ é™¤ã€‚
* `public boolean contains(Object obj)`ï¼šåˆ¤æ–­å½“å‰é›†åˆä¸­æ˜¯å¦åŒ…å«ç»™å®šçš„å¯¹è±¡ã€‚
* `public boolean isEmpty()`ï¼šåˆ¤æ–­å½“å‰é›†åˆæ˜¯å¦ä¸ºç©ºã€‚
* `public int size()`ï¼šè¿”å›é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚
* `public Object[] toArray()`ï¼šæŠŠé›†åˆä¸­çš„å…ƒç´ ï¼Œå­˜å‚¨åˆ°æ•°ç»„ä¸­
* `public boolean addAll(Collection<? extends E> c)`ï¼šå°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°æ­¤é›†åˆ

```java
public class CollectionDemo {
    public static void main(String[] args) {
        Collection<String> sets = new HashSet<>();
        sets.add("MyBatis");
        System.out.println(sets.add("Java"));//true
        System.out.println(sets.add("Java"));//false
        sets.add("Spring");
        sets.add("MySQL");
        System.out.println(sets)//[]æ— åºçš„;
        System.out.println(sets.contains("java"));//true å­˜åœ¨
        Object[] arrs = sets.toArray();
        System.out.println("æ•°ç»„ï¼š"+ Arrays.toString(arrs));
        
        Collection<String> c1 = new ArrayList<>();
        c1.add("java");
        Collection<String> c2 = new ArrayList<>();
        c2.add("ee");
        c1.addAll(c2);// c1:[java,ee]  c2:[ee];
    }
}
```



***



#### éå†

Collection é›†åˆçš„éå†æ–¹å¼æœ‰ä¸‰ç§:

é›†åˆå¯ä»¥ç›´æ¥è¾“å‡ºå†…å®¹ï¼Œå› ä¸ºåº•å±‚é‡å†™äº† toString() æ–¹æ³•

1. è¿­ä»£å™¨
   
   * `public Iterator iterator()`ï¼šè·å–é›†åˆå¯¹åº”çš„è¿­ä»£å™¨ï¼Œç”¨æ¥éå†é›†åˆä¸­çš„å…ƒç´ çš„
   * `E next()`ï¼šè·å–ä¸‹ä¸€ä¸ªå…ƒç´ å€¼
   * `boolean hasNext()`ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œæœ‰è¿”å› true ï¼Œåä¹‹è¿”å› false
   * `default void remove()`ï¼šä»åº•å±‚é›†åˆä¸­åˆ é™¤æ­¤è¿­ä»£å™¨è¿”å›çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè¿™ç§æ–¹æ³•åªèƒ½åœ¨æ¯æ¬¡è°ƒç”¨ next() æ—¶è°ƒç”¨ä¸€æ¬¡
   
2. å¢å¼º for å¾ªç¯ï¼šå¯ä»¥éå†é›†åˆæˆ–è€…æ•°ç»„ï¼Œéå†é›†åˆå®é™…ä¸Šæ˜¯è¿­ä»£å™¨éå†çš„ç®€åŒ–å†™æ³•

   ```java
   for(è¢«éå†é›†åˆæˆ–è€…æ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹ å˜é‡åç§° : è¢«éå†é›†åˆæˆ–è€…æ•°ç»„){
   
   }
   ```

   ç¼ºç‚¹ï¼šéå†æ— æ³•çŸ¥é“éå†åˆ°äº†å“ªä¸ªå…ƒç´ äº†ï¼Œå› ä¸ºæ²¡æœ‰ç´¢å¼•

3. JDK 1.8 å¼€å§‹ä¹‹åçš„æ–°æŠ€æœ¯ Lambda è¡¨è¾¾å¼

   ```java
   public class CollectionDemo {
       public static void main(String[] args) {
           Collection<String> lists = new ArrayList<>();
           lists.add("aa");
           lists.add("bb");
           lists.add("cc");
           System.out.println(lists); // lists = [aa, bb, cc]
   		//è¿­ä»£å™¨æµç¨‹
           // 1.å¾—åˆ°é›†åˆçš„è¿­ä»£å™¨å¯¹è±¡ã€‚
           Iterator<String> it = lists.iterator();
           // 2.ä½¿ç”¨whileå¾ªç¯éå†ã€‚
           while(it.hasNext()){
               String ele = it.next();
               System.out.println(ele);
           }
           
   		//å¢å¼ºfor
           for (String ele : lists) {
               System.out.println(ele);
           }
           //lambdaè¡¨è¾¾å¼
           lists.forEach(s -> {
               System.out.println(s);
           });
       }
   }
   ```

   



***



#### List

##### æ¦‚è¿°

List é›†åˆç»§æ‰¿äº† Collection é›†åˆå…¨éƒ¨çš„åŠŸèƒ½ã€‚

List ç³»åˆ—é›†åˆæœ‰ç´¢å¼•ï¼Œæ‰€ä»¥å¤šäº†å¾ˆå¤šæŒ‰ç…§ç´¢å¼•æ“ä½œå…ƒç´ çš„åŠŸèƒ½ï¼šfor å¾ªç¯éå†ï¼ˆ4 ç§éå†ï¼‰

List ç³»åˆ—é›†åˆï¼š

* ArrayListï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºï¼Œå¯é‡å¤ï¼Œæœ‰ç´¢å¼•

* LinekdListï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºï¼Œå¯é‡å¤ï¼Œæœ‰ç´¢å¼•

  

***



##### ArrayList

###### ä»‹ç»

ArrayList æ·»åŠ çš„å…ƒç´ ï¼Œæ˜¯æœ‰åºï¼Œå¯é‡å¤ï¼Œæœ‰ç´¢å¼•çš„

* `public boolean add(E e)`ï¼šå°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤é›†åˆçš„æœ«å°¾
* `public void add(int index, E element)`ï¼šå°†æŒ‡å®šçš„å…ƒç´ ï¼Œæ·»åŠ åˆ°è¯¥é›†åˆä¸­çš„æŒ‡å®šä½ç½®ä¸Š
* `public E get(int index)`ï¼šè¿”å›é›†åˆä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ 
* `public E remove(int index)`ï¼šç§»é™¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œè¿”å›çš„æ˜¯è¢«ç§»é™¤çš„å…ƒç´ 
* `public E set(int index, E element)`ï¼šç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢é›†åˆä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œè¿”å›æ›´æ–°å‰çš„å…ƒç´ å€¼
* `int indexOf(Object o)`ï¼šè¿”å›åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœä¸åŒ…å«æ­¤å…ƒç´ ï¼Œåˆ™è¿”å› -1

```java
public static void main(String[] args){
    List<String> lists = new ArrayList<>();//å¤šæ€
    lists.add("java1");
    lists.add("java1");//å¯ä»¥é‡å¤
    lists.add("java2");
    for(int i = 0 ; i < lists.size() ; i++ ) {
            String ele = lists.get(i);
            System.out.println(ele);
   }
}
```



***



###### æºç 

ArrayList å®ç°ç±»é›†åˆåº•å±‚**åŸºäºæ•°ç»„å­˜å‚¨æ•°æ®**çš„ï¼ŒæŸ¥è¯¢å¿«ï¼Œå¢åˆ æ…¢ï¼Œæ”¯æŒå¿«é€Ÿéšæœºè®¿é—®

```java
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable{}
```

- `RandomAccess` æ˜¯ä¸€ä¸ªæ ‡å¿—æ¥å£ï¼Œè¡¨æ˜å®ç°è¿™ä¸ªè¿™ä¸ªæ¥å£çš„ List é›†åˆæ˜¯æ”¯æŒ**å¿«é€Ÿéšæœºè®¿é—®**çš„ã€‚åœ¨ `ArrayList` ä¸­ï¼Œæˆ‘ä»¬å³å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚
- `ArrayList` å®ç°äº† `Cloneable` æ¥å£ ï¼Œå³è¦†ç›–äº†å‡½æ•° `clone()`ï¼Œèƒ½è¢«å…‹éš†
- `ArrayList` å®ç°äº† `Serializable ` æ¥å£ï¼Œè¿™æ„å‘³ç€ `ArrayList` æ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“

æ ¸å¿ƒæ–¹æ³•ï¼š

* æ„é€ å‡½æ•°ï¼šä»¥æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»º ArrayList æ—¶ï¼Œå®é™…ä¸Šåˆå§‹åŒ–èµ‹å€¼çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚å½“çœŸæ­£å¯¹æ•°ç»„è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ†é…å®¹é‡ï¼ˆæƒ°æ€§åˆå§‹åŒ–ï¼‰ï¼Œå³å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œ**æ•°ç»„å®¹é‡æ‰©ä¸º 10**

* æ·»åŠ å…ƒç´ ï¼š

  ```java
  // e æ’å…¥çš„å…ƒç´   elementDataåº•å±‚æ•°ç»„   size æ’å…¥çš„ä½ç½®
  public boolean add(E e) {
      ensureCapacityInternal(size + 1);	// Increments modCount!!
      elementData[size++] = e;			// æ’å…¥sizeä½ç½®ï¼Œç„¶ååŠ ä¸€
      return true;
  }
  ```

  å½“ add ç¬¬ 1 ä¸ªå…ƒç´ åˆ° ArrayListï¼Œsize æ˜¯ 0ï¼Œè¿›å…¥ ensureCapacityInternal æ–¹æ³•ï¼Œ

  ```java
  private void ensureCapacityInternal(int minCapacity) {
      ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));
  }
  ```

  ```java
  private static int calculateCapacity(Object[] elementData, int minCapacity) {
      // åˆ¤æ–­elementDataæ˜¯ä¸æ˜¯ç©ºæ•°ç»„
      if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
          // è¿”å›é»˜è®¤å€¼å’Œæœ€å°éœ€æ±‚å®¹é‡æœ€å¤§çš„ä¸€ä¸ª
          return Math.max(DEFAULT_CAPACITY, minCapacity);
      }
      return minCapacity;
  }
  ```

  å¦‚æœéœ€è¦çš„å®¹é‡å¤§äºæ•°ç»„é•¿åº¦ï¼Œè¿›è¡Œæ‰©å®¹ï¼š

  ```java
  // åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹
  private void ensureExplicitCapacity(int minCapacity) {
      modCount++;
      // ç´¢å¼•è¶Šç•Œ
      if (minCapacity - elementData.length > 0)
          // è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†
          grow(minCapacity);
  }
  ```

  æŒ‡å®šç´¢å¼•æ’å…¥ï¼Œ**åœ¨æ—§æ•°ç»„ä¸Šæ“ä½œ**ï¼š

  ```java
  public void add(int index, E element) {
      rangeCheckForAdd(index);
      ensureCapacityInternal(size + 1);  // Increments modCount!!
      // å°†æŒ‡å®šç´¢å¼•åçš„æ•°æ®åç§»
      System.arraycopy(elementData, index, elementData, index + 1, size - index);
      elementData[index] = element;
      size++;
  }
  ```

* æ‰©å®¹ï¼šæ–°å®¹é‡çš„å¤§å°ä¸º `oldCapacity + (oldCapacity >> 1)`ï¼Œ`oldCapacity >> 1` éœ€è¦å–æ•´ï¼Œæ‰€ä»¥æ–°å®¹é‡å¤§çº¦æ˜¯æ—§å®¹é‡çš„ 1.5 å€å·¦å³ï¼Œå³ oldCapacity+oldCapacity/2

  æ‰©å®¹æ“ä½œéœ€è¦è°ƒç”¨ `Arrays.copyOf()`ï¼ˆåº•å±‚ `System.arraycopy()`ï¼‰æŠŠåŸæ•°ç»„æ•´ä¸ªå¤åˆ¶åˆ°**æ–°æ•°ç»„**ä¸­ï¼Œè¿™ä¸ªæ“ä½œä»£ä»·å¾ˆé«˜ï¼Œå› æ­¤æœ€å¥½åœ¨åˆ›å»º ArrayList å¯¹è±¡æ—¶å°±æŒ‡å®šå¤§æ¦‚çš„å®¹é‡å¤§å°ï¼Œå‡å°‘æ‰©å®¹æ“ä½œçš„æ¬¡æ•°

  ```java
  private void grow(int minCapacity) {
      int oldCapacity = elementData.length;
      int newCapacity = oldCapacity + (oldCapacity >> 1);
      //æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡
      if (newCapacity - minCapacity < 0)
  		newCapacity = minCapacity;//ä¸éœ€è¦æ‰©å®¹è®¡ç®—
      //æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å¤§æ•°ç»„å®¹é‡
      if (newCapacity - MAX_ARRAY_SIZE > 0)
          //å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`
          //å¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`
          newCapacity = hugeCapacity(minCapacity);
      elementData = Arrays.copyOf(elementData, newCapacity);
  }
  ```

  MAX_ARRAY_SIZEï¼šè¦åˆ†é…çš„æ•°ç»„çš„æœ€å¤§å¤§å°ï¼Œåˆ†é…æ›´å¤§çš„**å¯èƒ½**ä¼šå¯¼è‡´

  * OutOfMemoryError:Requested array size exceeds VM limitï¼ˆè¯·æ±‚çš„æ•°ç»„å¤§å°è¶…å‡º VM é™åˆ¶ï¼‰
  * OutOfMemoryError: Java heap spaceï¼ˆå †åŒºå†…å­˜ä¸è¶³ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® JVM å‚æ•° -Xmx æ¥è°ƒèŠ‚ï¼‰

* åˆ é™¤å…ƒç´ ï¼šéœ€è¦è°ƒç”¨ System.arraycopy() å°† index+1 åé¢çš„å…ƒç´ éƒ½å¤åˆ¶åˆ° index ä½ç½®ä¸Šï¼Œåœ¨æ—§æ•°ç»„ä¸Šæ“ä½œï¼Œè¯¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼Œå¯ä»¥çœ‹åˆ° ArrayList åˆ é™¤å…ƒç´ çš„ä»£ä»·æ˜¯éå¸¸é«˜çš„

  ```java
  public E remove(int index) {
      rangeCheck(index);
      modCount++;
      E oldValue = elementData(index);
  
      int numMoved = size - index - 1;
      if (numMoved > 0)
          System.arraycopy(elementData, index+1, elementData, index, numMoved);
      elementData[--size] = null; // clear to let GC do its work
  
      return oldValue;
  }
  ```

* åºåˆ—åŒ–ï¼šArrayList åŸºäºæ•°ç»„å¹¶ä¸”å…·æœ‰åŠ¨æ€æ‰©å®¹ç‰¹æ€§ï¼Œå› æ­¤ä¿å­˜å…ƒç´ çš„æ•°ç»„ä¸ä¸€å®šéƒ½ä¼šè¢«ä½¿ç”¨ï¼Œå°±æ²¡å¿…è¦å…¨éƒ¨è¿›è¡Œåºåˆ—åŒ–ã€‚ä¿å­˜å…ƒç´ çš„æ•°ç»„ elementData ä½¿ç”¨ transient ä¿®é¥°ï¼Œè¯¥å…³é”®å­—å£°æ˜æ•°ç»„é»˜è®¤ä¸ä¼šè¢«åºåˆ—åŒ–

  ```java
   transient Object[] elementData;
  ```

* ensureCapacityï¼šå¢åŠ æ­¤å®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘å¯ä»¥å®¹çº³æœ€å°å®¹é‡å‚æ•°æŒ‡å®šçš„å…ƒç´ æ•°ï¼Œå‡å°‘å¢é‡é‡æ–°åˆ†é…çš„æ¬¡æ•°

  ```java
   public void ensureCapacity(int minCapacity) {
       if (minCapacity > elementData.length
           && !(elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA
                && minCapacity <= DEFAULT_CAPACITY)) {
           modCount++;
           grow(minCapacity);
       }
   }
  ```

* **Fail-Fast**ï¼šå¿«é€Ÿå¤±è´¥ï¼ŒmodCount ç”¨æ¥è®°å½• ArrayList **ç»“æ„å‘ç”Ÿå˜åŒ–**çš„æ¬¡æ•°ï¼Œç»“æ„å‘ç”Ÿå˜åŒ–æ˜¯æŒ‡æ·»åŠ æˆ–è€…åˆ é™¤è‡³å°‘ä¸€ä¸ªå…ƒç´ çš„æ“ä½œï¼Œæˆ–è€…æ˜¯è°ƒæ•´å†…éƒ¨æ•°ç»„çš„å¤§å°ï¼Œä»…ä»…åªæ˜¯è®¾ç½®å…ƒç´ çš„å€¼ä¸ç®—ç»“æ„å‘ç”Ÿå˜åŒ–

  åœ¨è¿›è¡Œåºåˆ—åŒ–æˆ–è€…è¿­ä»£ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ¯”è¾ƒæ“ä½œå‰å modCount æ˜¯å¦æ”¹å˜ï¼Œæ”¹å˜äº†æŠ›å‡º ConcurrentModificationException å¼‚å¸¸
  
  ```java
  public Iterator<E> iterator() {
      return new Itr();
  }
  ```
  
  ```java
  private class Itr implements Iterator<E> {
      int cursor;       // index of next element to return
      int lastRet = -1; // index of last element returned; -1 if no such
      int expectedModCount = modCount;
  
      Itr() {}
  
      public boolean hasNext() {
          return cursor != size;
      }
  
     	// è·å–ä¸‹ä¸€ä¸ªå…ƒç´ æ—¶é¦–å…ˆåˆ¤æ–­ç»“æ„æ˜¯å¦å‘ç”Ÿå˜åŒ–
      public E next() {
          checkForComodification();
         	// .....
      }
      // modCount è¢«å…¶ä»–çº¿ç¨‹æ”¹å˜æŠ›å‡ºå¹¶å‘ä¿®æ”¹å¼‚å¸¸
      final void checkForComodification() {
          if (modCount != expectedModCount)
              throw new ConcurrentModificationException();
      }
  	// ã€å…è®¸åˆ é™¤æ“ä½œã€‘
      public void remove() {
          // ...
          checkForComodification();
          // ...
          // åˆ é™¤åé‡ç½® expectedModCount
          expectedModCount = modCount;
      }
  }
  ```
  
  



***



##### Vector

åŒæ­¥ï¼šVector çš„å®ç°ä¸ ArrayList ç±»ä¼¼ï¼Œä½†æ˜¯æ–¹æ³•ä¸Šä½¿ç”¨äº† synchronized è¿›è¡ŒåŒæ­¥

æ„é€ ï¼šé»˜è®¤é•¿åº¦ä¸º 10 çš„æ•°ç»„

æ‰©å®¹ï¼šVector çš„æ„é€ å‡½æ•°å¯ä»¥ä¼ å…¥ capacityIncrement å‚æ•°ï¼Œä½œç”¨æ˜¯åœ¨æ‰©å®¹æ—¶ä½¿å®¹é‡ capacity å¢é•¿ capacityIncrementï¼Œå¦‚æœè¿™ä¸ªå‚æ•°çš„å€¼å°äºç­‰äº 0ï¼ˆé»˜è®¤0ï¼‰ï¼Œæ‰©å®¹æ—¶æ¯æ¬¡éƒ½ä»¤ capacity ä¸ºåŸæ¥çš„ä¸¤å€

å¯¹æ¯” ArrayList

1. Vector æ˜¯åŒæ­¥çš„ï¼Œå¼€é”€æ¯” ArrayList è¦å¤§ï¼Œè®¿é—®é€Ÿåº¦æ›´æ…¢ã€‚æœ€å¥½ä½¿ç”¨ ArrayList è€Œä¸æ˜¯ Vectorï¼Œå› ä¸ºåŒæ­¥æ“ä½œå®Œå…¨å¯ä»¥ç”±ç¨‹åºæ¥æ§åˆ¶

2. Vector æ¯æ¬¡æ‰©å®¹è¯·æ±‚å…¶å¤§å°çš„ 2 å€ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°è®¾ç½®å¢é•¿çš„å®¹é‡ï¼‰ï¼Œè€Œ ArrayList æ˜¯ 1.5 å€

3. åº•å±‚éƒ½æ˜¯ `Object[]` æ•°ç»„å­˜å‚¨



****



##### LinkedList

###### ä»‹ç»

LinkedList ä¹Ÿæ˜¯ List çš„å®ç°ç±»ï¼šåŸºäº**åŒå‘é“¾è¡¨**å®ç°ï¼Œä½¿ç”¨ Node å­˜å‚¨é“¾è¡¨èŠ‚ç‚¹ä¿¡æ¯ï¼Œå¢åˆ æ¯”è¾ƒå¿«ï¼ŒæŸ¥è¯¢æ…¢

LinkedList é™¤äº†æ‹¥æœ‰ List é›†åˆçš„å…¨éƒ¨åŠŸèƒ½è¿˜å¤šäº†å¾ˆå¤šæ“ä½œé¦–å°¾å…ƒç´ çš„ç‰¹æ®ŠåŠŸèƒ½ï¼š

* `public boolean add(E e)`ï¼šå°†æŒ‡å®šå…ƒç´ æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„ç»“å°¾
* `public E poll()`ï¼šæ£€ç´¢å¹¶åˆ é™¤æ­¤åˆ—è¡¨çš„å¤´ï¼ˆç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰
* `public void addFirst(E e)`ï¼šå°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤åˆ—è¡¨çš„å¼€å¤´
* `public void addLast(E e)`ï¼šå°†æŒ‡å®šå…ƒç´ æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„ç»“å°¾
* `public E pop()`ï¼šä»æ­¤åˆ—è¡¨æ‰€è¡¨ç¤ºçš„å †æ ˆå¤„å¼¹å‡ºä¸€ä¸ªå…ƒç´ 
* `public void push(E e)`ï¼šå°†å…ƒç´ æ¨å…¥æ­¤åˆ—è¡¨æ‰€è¡¨ç¤ºçš„å †æ ˆ
* `public int indexOf(Object o)`ï¼šè¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœä¸åŒ…å«è¿”å› -1
* `public int lastIndexOf(Object o)`ï¼šä»å°¾éå†æ‰¾
* ` public boolean remove(Object o)`ï¼šä¸€æ¬¡åªåˆ é™¤ä¸€ä¸ªåŒ¹é…çš„å¯¹è±¡ï¼Œå¦‚æœåˆ é™¤äº†åŒ¹é…å¯¹è±¡è¿”å› true
* `public E remove(int index)`ï¼šåˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ 

```java
public class ListDemo {
    public static void main(String[] args) {
        // 1.ç”¨LinkedListåšä¸€ä¸ªé˜Ÿåˆ—:å…ˆè¿›å…ˆå‡ºï¼Œåè¿›åå‡ºã€‚
        LinkedList<String> queue = new LinkedList<>();
        // å…¥é˜Ÿ
        queue.addLast("1å·");
        queue.addLast("2å·");
        queue.addLast("3å·");
        System.out.println(queue); // [1å·, 2å·, 3å·]
        // å‡ºé˜Ÿ
        System.out.println(queue.removeFirst());//1å·
        System.out.println(queue.removeFirst());//2å·
        System.out.println(queue);//[3å·]

        // åšä¸€ä¸ªæ ˆ å…ˆè¿›åå‡º
        LinkedList<String> stack = new LinkedList<>();
        // å‹æ ˆ
        stack.push("ç¬¬1é¢—å­å¼¹");//addFirst(e);
        stack.push("ç¬¬2é¢—å­å¼¹");
        stack.push("ç¬¬3é¢—å­å¼¹");
        System.out.println(stack); // [ ç¬¬3é¢—å­å¼¹, ç¬¬2é¢—å­å¼¹, ç¬¬1é¢—å­å¼¹]
        // å¼¹æ ˆ
        System.out.println(stack.pop());//removeFirst(); ç¬¬3é¢—å­å¼¹
        System.out.println(stack.pop());
        System.out.println(stack);// [ç¬¬1é¢—å­å¼¹]
    }
}
```



***



###### æºç 

LinkedList æ˜¯ä¸€ä¸ªå®ç°äº† List æ¥å£çš„**åŒç«¯é“¾è¡¨**ï¼Œæ”¯æŒé«˜æ•ˆçš„æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œå¦å¤–ä¹Ÿå®ç°äº† Deque æ¥å£ï¼Œä½¿å¾— LinkedList ç±»ä¹Ÿå…·æœ‰é˜Ÿåˆ—çš„ç‰¹æ€§

![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/LinkedListåº•å±‚ç»“æ„.png)

æ ¸å¿ƒæ–¹æ³•ï¼š

* ä½¿ LinkedList å˜æˆçº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥è°ƒç”¨é™æ€ç±» Collections ç±»ä¸­çš„ synchronizedList æ–¹æ³•ï¼š

  ```java
  List list = Collections.synchronizedList(new LinkedList(...));
  ```

* ç§æœ‰å†…éƒ¨ç±» Nodeï¼šè¿™ä¸ªç±»ä»£è¡¨åŒç«¯é“¾è¡¨çš„èŠ‚ç‚¹ Node

  ```java
  private static class Node<E> {
      E item;
      Node<E> next;
      Node<E> prev;
  
      Node(Node<E> prev, E element, Node<E> next) {
          this.item = element;
          this.next = next;
          this.prev = prev;
      }
  }
  ```

* æ„é€ æ–¹æ³•ï¼šåªæœ‰æ— å‚æ„é€ å’Œç”¨å·²æœ‰çš„é›†åˆåˆ›å»ºé“¾è¡¨çš„æ„é€ æ–¹æ³•

* æ·»åŠ å…ƒç´ ï¼šé»˜è®¤åŠ åˆ°å°¾éƒ¨

  ```java
  public boolean add(E e) {
      linkLast(e);
      return true;
  }
  ```

* è·å–å…ƒç´ ï¼š`get(int index)` æ ¹æ®æŒ‡å®šç´¢å¼•è¿”å›æ•°æ®

  * è·å–å¤´èŠ‚ç‚¹ (index=0)ï¼š`getFirst()ã€element()ã€peek()ã€peekFirst()` è¿™å››ä¸ªè·å–å¤´ç»“ç‚¹æ–¹æ³•çš„åŒºåˆ«åœ¨äºå¯¹é“¾è¡¨ä¸ºç©ºæ—¶çš„å¤„ç†æ–¹å¼ï¼Œæ˜¯æŠ›å‡ºå¼‚å¸¸è¿˜æ˜¯è¿”å›NULLï¼Œå…¶ä¸­ `getFirst() element()` æ–¹æ³•å°†ä¼šåœ¨é“¾è¡¨ä¸ºç©ºæ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸
  * è·å–å°¾èŠ‚ç‚¹ (index=-1)ï¼šgetLast() æ–¹æ³•åœ¨é“¾è¡¨ä¸ºç©ºæ—¶ï¼ŒæŠ›å‡º NoSuchElementExceptionï¼Œè€Œ peekLast() ä¸ä¼šï¼Œåªä¼šè¿”å› null

* åˆ é™¤å…ƒç´ ï¼š

  * remove()ã€removeFirst()ã€pop()ï¼šåˆ é™¤å¤´èŠ‚ç‚¹
  * removeLast()ã€pollLast()ï¼šåˆ é™¤å°¾èŠ‚ç‚¹ï¼ŒremoveLast()åœ¨é“¾è¡¨ä¸ºç©ºæ—¶æŠ›å‡ºNoSuchElementExceptionï¼Œè€ŒpollLast()æ–¹æ³•è¿”å›null

å¯¹æ¯” ArrayList

1. æ˜¯å¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼šArrayList å’Œ LinkedList éƒ½æ˜¯ä¸åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¿è¯çº¿ç¨‹å®‰å…¨
2. åº•å±‚æ•°æ®ç»“æ„ï¼š 
   * Arraylist åº•å±‚ä½¿ç”¨çš„æ˜¯ `Object` æ•°ç»„
   * LinkedList åº•å±‚ä½¿ç”¨çš„æ˜¯åŒå‘é“¾è¡¨æ•°æ®ç»“æ„ï¼ˆJDK1.6 ä¹‹å‰ä¸ºå¾ªç¯é“¾è¡¨ï¼ŒJDK1.7 å–æ¶ˆäº†å¾ªç¯ï¼‰
3. æ’å…¥å’Œåˆ é™¤æ˜¯å¦å—å…ƒç´ ä½ç½®çš„å½±å“ï¼š
   * ArrayList é‡‡ç”¨æ•°ç»„å­˜å‚¨ï¼Œæ‰€ä»¥æ’å…¥å’Œåˆ é™¤å…ƒç´ å—å…ƒç´ ä½ç½®çš„å½±å“
   * LinkedListé‡‡ ç”¨é“¾è¡¨å­˜å‚¨ï¼Œæ‰€ä»¥å¯¹äº`add(E e)`æ–¹æ³•çš„æ’å…¥ï¼Œåˆ é™¤å…ƒç´ ä¸å—å…ƒç´ ä½ç½®çš„å½±å“
4. æ˜¯å¦æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼š
   * LinkedList ä¸æ”¯æŒé«˜æ•ˆçš„éšæœºå…ƒç´ è®¿é—®ï¼ŒArrayList æ”¯æŒ
   * å¿«é€Ÿéšæœºè®¿é—®å°±æ˜¯é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡(å¯¹åº”äº `get(int index)` æ–¹æ³•)
5. å†…å­˜ç©ºé—´å ç”¨ï¼š
   * ArrayList çš„ç©ºé—´æµªè´¹ä¸»è¦ä½“ç°åœ¨åœ¨ list åˆ—è¡¨çš„ç»“å°¾ä¼šé¢„ç•™ä¸€å®šçš„å®¹é‡ç©ºé—´
   * LinkedList çš„ç©ºé—´èŠ±è´¹åˆ™ä½“ç°åœ¨å®ƒçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½éœ€è¦æ¶ˆè€—æ¯” ArrayListæ›´å¤šçš„ç©ºé—´ï¼ˆå› ä¸ºè¦å­˜æ”¾ç›´æ¥åç»§å’Œç›´æ¥å‰é©±ä»¥åŠæ•°æ®ï¼‰



***



#### Set

##### æ¦‚è¿°

Set ç³»åˆ—é›†åˆï¼š

* HashSetï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æ— åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼•çš„
*  LinkedHashSetï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼•çš„
* TreeSetï¼šä¸é‡å¤ï¼Œæ— ç´¢å¼•ï¼ŒæŒ‰ç…§å¤§å°é»˜è®¤å‡åºæ’åº

**æ³¨æ„**ï¼šæ²¡æœ‰ç´¢å¼•ï¼Œä¸èƒ½ä½¿ç”¨æ™®é€š for å¾ªç¯éå†



***



##### HashSet

å“ˆå¸Œå€¼ï¼š

- å“ˆå¸Œå€¼ï¼šJDK æ ¹æ®å¯¹è±¡çš„åœ°å€æˆ–è€…å­—ç¬¦ä¸²æˆ–è€…æ•°å­—è®¡ç®—å‡ºæ¥çš„æ•°å€¼

- è·å–å“ˆå¸Œå€¼ï¼šObject ç±»ä¸­çš„ public int hashCode()

- å“ˆå¸Œå€¼çš„ç‰¹ç‚¹

  - åŒä¸€ä¸ªå¯¹è±¡å¤šæ¬¡è°ƒç”¨ hashCode() æ–¹æ³•è¿”å›çš„å“ˆå¸Œå€¼æ˜¯ç›¸åŒçš„
  - é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸åŒå¯¹è±¡çš„å“ˆå¸Œå€¼æ˜¯ä¸åŒçš„ï¼Œè€Œé‡å†™ hashCode() æ–¹æ³•ï¼Œå¯ä»¥å®ç°è®©ä¸åŒå¯¹è±¡çš„å“ˆå¸Œå€¼ç›¸åŒ

**HashSet åº•å±‚å°±æ˜¯åŸºäº HashMap å®ç°ï¼Œå€¼æ˜¯  PRESENT = new Object()**

Set é›†åˆæ·»åŠ çš„å…ƒç´ æ˜¯æ— åºï¼Œä¸é‡å¤çš„ã€‚

* æ˜¯å¦‚ä½•å»é‡å¤çš„ï¼Ÿ

  ```java
  1.å¯¹äºæœ‰å€¼ç‰¹æ€§çš„ï¼ŒSeté›†åˆå¯ä»¥ç›´æ¥åˆ¤æ–­è¿›è¡Œå»é‡å¤ã€‚
  2.å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹çš„ç±»å¯¹è±¡ï¼ŒSeté›†åˆæ˜¯æŒ‰ç…§å¦‚ä¸‹æµç¨‹è¿›è¡Œæ˜¯å¦é‡å¤çš„åˆ¤æ–­ã€‚
      Seté›†åˆä¼šè®©ä¸¤ä¸¤å¯¹è±¡ï¼Œå…ˆè°ƒç”¨è‡ªå·±çš„hashCode()æ–¹æ³•å¾—åˆ°å½¼æ­¤çš„å“ˆå¸Œå€¼ï¼ˆæ‰€è°“çš„å†…å­˜åœ°å€ï¼‰
      ç„¶åæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å“ˆå¸Œå€¼æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸ç›¸åŒåˆ™ç›´æ¥è®¤ä¸ºä¸¤ä¸ªå¯¹è±¡ä¸é‡å¤ã€‚
      å¦‚æœå“ˆå¸Œå€¼ç›¸åŒï¼Œä¼šç»§ç»­è®©ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œequalsæ¯”è¾ƒå†…å®¹æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒè®¤ä¸ºçœŸçš„é‡å¤äº†
      å¦‚æœä¸ç›¸åŒè®¤ä¸ºä¸é‡å¤ã€‚
  
              Seté›†åˆä¼šå…ˆè®©å¯¹è±¡è°ƒç”¨hashCode()æ–¹æ³•è·å–ä¸¤ä¸ªå¯¹è±¡çš„å“ˆå¸Œå€¼æ¯”è¾ƒ
                 /                     \
              false                    true
              /                          \
          ä¸é‡å¤                        ç»§ç»­è®©ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œequalsæ¯”è¾ƒ
                                         /          \
                                       false        true
                                        /             \
                                      ä¸é‡å¤          é‡å¤äº†
  ```

* Set ç³»åˆ—é›†åˆå…ƒç´ æ— åºçš„æ ¹æœ¬åŸå› 

  Set ç³»åˆ—é›†åˆæ·»åŠ å…ƒç´ æ— åºçš„æ ¹æœ¬åŸå› æ˜¯å› ä¸º**åº•å±‚é‡‡ç”¨äº†å“ˆå¸Œè¡¨å­˜å‚¨å…ƒç´ **ã€‚

  * JDK 1.8 ä¹‹å‰ï¼šå“ˆå¸Œè¡¨ = æ•°ç»„ï¼ˆåˆå§‹å®¹é‡16) + é“¾è¡¨  + ï¼ˆå“ˆå¸Œç®—æ³•ï¼‰
  * JDK 1.8 ä¹‹åï¼šå“ˆå¸Œè¡¨ = æ•°ç»„ï¼ˆåˆå§‹å®¹é‡16) + é“¾è¡¨ + çº¢é»‘æ ‘  + ï¼ˆå“ˆå¸Œç®—æ³•ï¼‰
    * å½“é“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼ 8 ä¸”å½“å‰æ•°ç»„çš„é•¿åº¦ > 64æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œå‡å°‘äº†æŸ¥æ‰¾æ—¶é—´
    * å½“é“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼ 8 ä¸”å½“å‰æ•°ç»„çš„é•¿åº¦ < 64æ—¶ï¼Œæ‰©å®¹

  ![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/HashSetåº•å±‚ç»“æ„å“ˆå¸Œè¡¨.png)

  æ¯ä¸ªå…ƒç´ çš„ hashcode() çš„å€¼è¿›è¡Œå“åº”çš„ç®—æ³•è¿ç®—ï¼Œè®¡ç®—å‡ºçš„å€¼ç›¸åŒçš„å­˜å…¥ä¸€ä¸ªæ•°ç»„å—ä¸­ï¼Œä»¥é“¾è¡¨çš„å½¢å¼å­˜å‚¨ï¼Œå¦‚æœé“¾è¡¨é•¿åº¦è¶…è¿‡8å°±é‡‡å–çº¢é»‘æ ‘å­˜å‚¨ï¼Œæ‰€ä»¥è¾“å‡ºçš„å…ƒç´ æ˜¯æ— åºçš„ã€‚

* å¦‚ä½•è®¾ç½®åªè¦å¯¹è±¡å†…å®¹ä¸€æ ·ï¼Œå°±å¸Œæœ›é›†åˆè®¤ä¸ºé‡å¤ï¼š**é‡å†™ hashCode å’Œ equals æ–¹æ³•**



****



##### Linked

LinkedHashSet ä¸ºä»€ä¹ˆæ˜¯æœ‰åºçš„ï¼Ÿ

LinkedHashSet åº•å±‚ä¾ç„¶æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å…ƒç´ çš„ï¼Œä½†æ˜¯æ¯ä¸ªå…ƒç´ éƒ½é¢å¤–å¸¦ä¸€ä¸ªé“¾æ¥ç»´æŠ¤æ·»åŠ é¡ºåºï¼Œä¸å…‰å¢åˆ æŸ¥å¿«ï¼Œè¿˜æœ‰é¡ºåºï¼Œç¼ºç‚¹æ˜¯å¤šäº†ä¸€ä¸ªå­˜å‚¨é¡ºåºçš„é“¾ä¼š**å å†…å­˜ç©ºé—´**ï¼Œè€Œä¸”ä¸å…è®¸é‡å¤ï¼Œæ— ç´¢å¼•



****



##### TreeSet

TreeSet é›†åˆè‡ªæ’åºçš„æ–¹å¼ï¼š

1. æœ‰å€¼ç‰¹æ€§çš„å…ƒç´ ç›´æ¥å¯ä»¥å‡åºæ’åºï¼ˆæµ®ç‚¹å‹ï¼Œæ•´å‹ï¼‰
2. å­—ç¬¦ä¸²ç±»å‹çš„å…ƒç´ ä¼šæŒ‰ç…§é¦–å­—ç¬¦çš„ç¼–å·æ’åº
3. å¯¹äºè‡ªå®šä¹‰çš„å¼•ç”¨æ•°æ®ç±»å‹ï¼ŒTreeSet é»˜è®¤æ— æ³•æ’åºï¼Œæ‰§è¡Œçš„æ—¶å€™æŠ¥é”™ï¼Œå› ä¸ºä¸çŸ¥é“æ’åºè§„åˆ™

è‡ªå®šä¹‰çš„å¼•ç”¨æ•°æ®ç±»å‹ï¼ŒTreeSet é»˜è®¤æ— æ³•æ’åºï¼Œéœ€è¦å®šåˆ¶æ’åºçš„è§„åˆ™ï¼Œæ–¹æ¡ˆæœ‰ 2 ç§ï¼š

   * ç›´æ¥ä¸º**å¯¹è±¡çš„ç±»**å®ç°æ¯”è¾ƒå™¨è§„åˆ™æ¥å£ Comparableï¼Œé‡å†™æ¯”è¾ƒæ–¹æ³•ï¼š
     
        æ–¹æ³•ï¼š`public int compareTo(Employee o): this æ˜¯æ¯”è¾ƒè€…, o æ˜¯è¢«æ¯”è¾ƒè€…`
        
           * æ¯”è¾ƒè€…å¤§äºè¢«æ¯”è¾ƒè€…ï¼Œè¿”å›æ­£æ•°
           * æ¯”è¾ƒè€…å°äºè¢«æ¯”è¾ƒè€…ï¼Œè¿”å›è´Ÿæ•°
           * æ¯”è¾ƒè€…ç­‰äºè¢«æ¯”è¾ƒè€…ï¼Œè¿”å› 0
        
   * ç›´æ¥ä¸º**é›†åˆ**è®¾ç½®æ¯”è¾ƒå™¨ Comparator å¯¹è±¡ï¼Œé‡å†™æ¯”è¾ƒæ–¹æ³•ï¼š
     
     æ–¹æ³•ï¼š`public int compare(Employee o1, Employee o2): o1 æ¯”è¾ƒè€…, o2 è¢«æ¯”è¾ƒè€…`
     
     * æ¯”è¾ƒè€…å¤§äºè¢«æ¯”è¾ƒè€…ï¼Œè¿”å›æ­£æ•°
     * æ¯”è¾ƒè€…å°äºè¢«æ¯”è¾ƒè€…ï¼Œè¿”å›è´Ÿæ•°
     * æ¯”è¾ƒè€…ç­‰äºè¢«æ¯”è¾ƒè€…ï¼Œè¿”å› 0

æ³¨æ„ï¼šå¦‚æœç±»å’Œé›†åˆéƒ½å¸¦æœ‰æ¯”è¾ƒè§„åˆ™ï¼Œä¼˜å…ˆä½¿ç”¨é›†åˆè‡ªå¸¦çš„æ¯”è¾ƒè§„åˆ™

```java
public class TreeSetDemo{
    public static void main(String[] args){
        Set<Student> students = new TreeSet<>();
		Collections.add(students,s1,s2,s3);
        System.out.println(students);//æŒ‰ç…§å¹´é¾„æ¯”è¾ƒ å‡åº
        
        Set<Student> s = new TreeSet<>(new Comparator<Student>(){
            @Override
            public int compare(Student o1, Student o2) {
                // o1æ¯”è¾ƒè€…   o2è¢«æ¯”è¾ƒè€…
                return o2.getAge() - o1.getAge();//é™åº
            }
        });
    }
}

public class Student implements Comparable<Student>{
    private String name;
    private int age;
    // é‡å†™äº†æ¯”è¾ƒæ–¹æ³•ã€‚
    // e1.compareTo(o)
    // æ¯”è¾ƒè€…ï¼šthis
    // è¢«æ¯”è¾ƒè€…ï¼šo
    // éœ€æ±‚ï¼šæŒ‰ç…§å¹´é¾„æ¯”è¾ƒ å‡åºï¼Œå¹´é¾„ç›¸åŒæŒ‰ç…§å§“å
    @Override
    public int compareTo(Student o) {
        int result = this.age - o.age;
        return result == 0 ? this.getName().compareTo(o.getName):result;
    }
}
```

æ¯”è¾ƒå™¨åŸç†ï¼šåº•å±‚æ˜¯ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºåŸºå‡†ï¼ŒåŠ ä¸€ä¸ªæ–°å…ƒç´ ï¼Œå°±ä¼šå’Œç¬¬ä¸€ä¸ªå…ƒç´ æ¯”ï¼Œå¦‚æœå¤§äºï¼Œå°±ç»§ç»­å’Œå¤§äºçš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œç›´åˆ°é‡åˆ°æ¯”æ–°å…ƒç´ å¤§çš„å…ƒç´ ä¸ºæ­¢ï¼Œæ”¾åœ¨è¯¥ä½ç½®çš„å·¦è¾¹ï¼ˆçº¢é»‘æ ‘ï¼‰




***



#### Queue

Queueï¼šé˜Ÿåˆ—ï¼Œå…ˆè¿›å…ˆå‡ºçš„ç‰¹æ€§

PriorityQueue æ˜¯ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œåº•å±‚å­˜å‚¨ç»“æ„ä¸º Object[]ï¼Œé»˜è®¤å®ç°ä¸ºå°é¡¶å †ï¼Œæ¯æ¬¡å‡ºé˜Ÿæœ€å°çš„å…ƒç´ 

æ„é€ æ–¹æ³•ï¼š

* `public PriorityQueue()`ï¼šæ„é€ é»˜è®¤é•¿åº¦ä¸º 11 çš„é˜Ÿåˆ—ï¼ˆæ•°ç»„ï¼‰

* `public PriorityQueue(Comparator<? super E> comparator)`ï¼šåˆ©ç”¨æ¯”è¾ƒå™¨è‡ªå®šä¹‰å †æ’åºçš„è§„åˆ™

  ```java
  Queue<Integer> pq = new PriorityQueue<>((v1, v2) -> v2 - v1);//å®ç°å¤§é¡¶å †

å¸¸ç”¨ APIï¼š

* `public boolean offer(E e)`ï¼šå°†æŒ‡å®šçš„å…ƒç´ æ’å…¥åˆ°æ­¤ä¼˜å…ˆçº§é˜Ÿåˆ—çš„**å°¾éƒ¨**
* `public E poll() `ï¼šæ£€ç´¢å¹¶åˆ é™¤æ­¤é˜Ÿåˆ—çš„**å¤´å…ƒç´ **ï¼Œå¦‚æœæ­¤é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› null 
* `public E peek()`ï¼šæ£€ç´¢ä½†ä¸åˆ é™¤æ­¤é˜Ÿåˆ—çš„å¤´ï¼Œå¦‚æœæ­¤é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› null
* `public boolean remove(Object o)`ï¼šä»è¯¥é˜Ÿåˆ—ä¸­åˆ é™¤æŒ‡å®šå…ƒç´ ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œåˆ é™¤å…ƒç´  e ä½¿ç”¨ o.equals(e) æ¯”è¾ƒï¼Œå¦‚æœé˜Ÿåˆ—åŒ…å«å¤šä¸ªè¿™æ ·çš„å…ƒç´ ï¼Œåˆ é™¤ç¬¬ä¸€ä¸ª



****



#### Collections

java.utils.Collectionsï¼šé›†åˆ**å·¥å…·ç±»**ï¼ŒCollections å¹¶ä¸å±äºé›†åˆï¼Œæ˜¯ç”¨æ¥æ“ä½œé›†åˆçš„å·¥å…·ç±»

Collections æœ‰å‡ ä¸ªå¸¸ç”¨çš„APIï¼š

* `public static <T> boolean addAll(Collection<? super T> c, T... e)`ï¼šç»™é›†åˆå¯¹è±¡æ‰¹é‡æ·»åŠ å…ƒç´ 
* `public static void shuffle(List<?> list)`ï¼šæ‰“ä¹±é›†åˆé¡ºåº
* `public static <T> void sort(List<T> list)`ï¼šå°†é›†åˆä¸­å…ƒç´ æŒ‰ç…§é»˜è®¤è§„åˆ™æ’åº
* `public static <T> void sort(List<T> list,Comparator<? super T> )`ï¼šé›†åˆä¸­å…ƒç´ æŒ‰ç…§æŒ‡å®šè§„åˆ™æ’åº
* `public static <T> List<T> synchronizedList(List<T> list)`ï¼šè¿”å›ç”±æŒ‡å®š list æ”¯æŒçš„çº¿ç¨‹å®‰å…¨ list
* `public static <T> Set<T> singleton(T o)`ï¼šè¿”å›ä¸€ä¸ªåªåŒ…å«æŒ‡å®šå¯¹è±¡çš„ä¸å¯å˜ç»„

```java
public class CollectionsDemo {
    public static void main(String[] args) {
        Collection<String> names = new ArrayList<>();
        Collections.addAll(names,"å¼ ","ç‹","æ","èµµ");
        
        List<Double> scores = new ArrayList<>();
        Collections.addAll(scores, 98.5, 66.5 , 59.5 , 66.5 , 99.5 );
        Collections.shuffle(scores);
        Collections.sort(scores); // é»˜è®¤å‡åºæ’åºï¼
        System.out.println(scores);
        
        List<Student> students = new ArrayList<>();
        Collections.addAll(students,s1,s2,s3,s4);
        Collections.sort(students,new Comparator<Student>(){
            
        })
    }
}

public class Student{
    private String name;
    private int age;
}
```





***



### Map

#### æ¦‚è¿°

Collection æ˜¯å•å€¼é›†åˆä½“ç³»ï¼ŒMapé›†åˆæ˜¯ä¸€ç§åŒåˆ—é›†åˆï¼Œæ¯ä¸ªå…ƒç´ åŒ…å«ä¸¤ä¸ªå€¼ã€‚

Mapé›†åˆçš„æ¯ä¸ªå…ƒç´ çš„æ ¼å¼ï¼škey=valueï¼ˆé”®å€¼å¯¹å…ƒç´ ï¼‰ï¼ŒMapé›†åˆä¹Ÿè¢«ç§°ä¸ºé”®å€¼å¯¹é›†åˆ

Mapé›†åˆçš„å®Œæ•´æ ¼å¼ï¼š`{key1=value1, key2=value2, key3=value3, ...}`

```
Mapé›†åˆçš„ä½“ç³»ï¼š
        Map<K , V>(æ¥å£,Mapé›†åˆçš„ç¥–å®—ç±»)
       /                      \
      TreeMap<K , V>           HashMap<K , V>(å®ç°ç±»,ç»å…¸çš„ï¼Œç”¨çš„æœ€å¤š)
                                 \
                                  LinkedHashMap<K, V>(å®ç°ç±»)
```

Map é›†åˆçš„ç‰¹ç‚¹ï¼š

1. Map é›†åˆçš„ç‰¹ç‚¹éƒ½æ˜¯ç”±é”®å†³å®šçš„
2. Map é›†åˆçš„é”®æ˜¯æ— åºï¼Œä¸é‡å¤çš„ï¼Œæ— ç´¢å¼•çš„ï¼ˆSetï¼‰
3. Map é›†åˆçš„å€¼æ— è¦æ±‚ï¼ˆListï¼‰
4. Map é›†åˆçš„é”®å€¼å¯¹éƒ½å¯ä»¥ä¸º null
5. Map é›†åˆåé¢é‡å¤çš„é”®å¯¹åº”å…ƒç´ ä¼šè¦†ç›–å‰é¢çš„å…ƒç´ 

HashMapï¼šå…ƒç´ æŒ‰ç…§é”®æ˜¯æ— åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼•ï¼Œå€¼ä¸åšè¦æ±‚

LinkedHashMapï¼šå…ƒç´ æŒ‰ç…§é”®æ˜¯æœ‰åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼•ï¼Œå€¼ä¸åšè¦æ±‚



***



#### å¸¸ç”¨API

Map é›†åˆçš„å¸¸ç”¨ API

* `public V put(K key, V value)`ï¼šæŠŠæŒ‡å®šçš„é”®ä¸å€¼æ·»åŠ åˆ° Map é›†åˆä¸­ï¼Œ**é‡å¤çš„é”®ä¼šè¦†ç›–å‰é¢çš„å€¼å…ƒç´ **
* `public V remove(Object key)`ï¼šæŠŠæŒ‡å®šçš„é”®å¯¹åº”çš„é”®å€¼å¯¹å…ƒç´ åœ¨é›†åˆä¸­åˆ é™¤ï¼Œè¿”å›è¢«åˆ é™¤å…ƒç´ çš„å€¼
* `public V get(Object key)`ï¼šæ ¹æ®æŒ‡å®šçš„é”®ï¼Œåœ¨ Map é›†åˆä¸­è·å–å¯¹åº”çš„å€¼
* `public Set<K> keySet()`ï¼šè·å– Map é›†åˆä¸­æ‰€æœ‰çš„é”®ï¼Œå­˜å‚¨åˆ° **Set é›†åˆ**ä¸­
* `public Collection<V> values()`ï¼šè·å–å…¨éƒ¨å€¼çš„é›†åˆï¼Œå­˜å‚¨åˆ° **Collection é›†åˆ**
* `public Set<Map.Entry<K,V>> entrySet()`ï¼šè·å–Mapé›†åˆä¸­æ‰€æœ‰çš„é”®å€¼å¯¹å¯¹è±¡çš„é›†åˆ
* `public boolean containsKey(Object key)`ï¼šåˆ¤æ–­è¯¥é›†åˆä¸­æ˜¯å¦æœ‰æ­¤é”®

```java
public class MapDemo {
    public static void main(String[] args) {
        Map<String , Integer> maps = new HashMap<>();
        maps.put(.....);
        System.out.println(maps.isEmpty());//false
        Integer value = maps.get("....");//è¿”å›é”®å€¼å¯¹è±¡
        Set<String> keys = maps.keySet();//è·å–Mapé›†åˆä¸­æ‰€æœ‰çš„é”®ï¼Œ
        //Mapé›†åˆçš„é”®æ˜¯æ— åºä¸é‡å¤çš„ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯ä¸€ä¸ªSeté›†åˆ
        Collection<Integer> values = maps.values();
        //Mapé›†åˆçš„å€¼æ˜¯ä¸åšè¦æ±‚çš„ï¼Œå¯èƒ½é‡å¤ï¼Œæ‰€ä»¥å€¼è¦ç”¨Collectioné›†åˆæ¥æ”¶!
    }
}
```



***



#### éå†æ–¹å¼

Mapé›†åˆçš„éå†æ–¹å¼æœ‰ï¼š3ç§ã€‚

1. â€œé”®æ‰¾å€¼â€çš„æ–¹å¼éå†ï¼šå…ˆè·å– Map é›†åˆå…¨éƒ¨çš„é”®ï¼Œå†æ ¹æ®éå†é”®æ‰¾å€¼ã€‚
2. â€œé”®å€¼å¯¹â€çš„æ–¹å¼éå†ï¼šéš¾åº¦è¾ƒå¤§ï¼Œé‡‡ç”¨å¢å¼º for æˆ–è€…è¿­ä»£å™¨
3. JDK 1.8 å¼€å§‹ä¹‹åçš„æ–°æŠ€æœ¯ï¼šforeachï¼Œé‡‡ç”¨ Lambda è¡¨è¾¾å¼

é›†åˆå¯ä»¥ç›´æ¥è¾“å‡ºå†…å®¹ï¼Œå› ä¸ºåº•å±‚é‡å†™äº† toString() æ–¹æ³•

```java
public static void main(String[] args){
    Map<String , Integer> maps = new HashMap<>();
	//(1)é”®æ‰¾å€¼
    Set<String> keys = maps.keySet();
    for(String key : keys) {
        System.out.println(key + "=" + maps.get(key));
    }
    //Iterator<String> iterator = hm.keySet().iterator();
    
    //(2)é”®å€¼å¯¹
    //(2.1)æ™®é€šæ–¹å¼
    Set<Map.Entry<String,Integer>> entries = maps.entrySet();
    for (Map.Entry<String, Integer> entry : entries) {
             System.out.println(entry.getKey() + "=>" + entry.getValue());
    }
    //(2.2)è¿­ä»£å™¨æ–¹å¼
    Iterator<Map.Entry<String, Integer>> iterator = maps.entrySet().iterator();
    while (iterator.hasNext()) {
        Map.Entry<String, Integer> entry = iterator.next();
        System.out.println(entry.getKey() + "=" + entry.getValue());

    }
    //(3) Lamda
    maps.forEach((k,v) -> {
        System.out.println(k + "==>" + v);
    })
}
```



***



#### HashMap

##### åŸºæœ¬ä»‹ç»

HashMap åŸºäºå“ˆå¸Œè¡¨çš„ Map æ¥å£å®ç°ï¼Œæ˜¯ä»¥ key-value å­˜å‚¨å½¢å¼å­˜åœ¨ï¼Œä¸»è¦ç”¨æ¥å­˜æ”¾é”®å€¼å¯¹

ç‰¹ç‚¹ï¼š

* HashMap çš„å®ç°ä¸æ˜¯åŒæ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„
* key æ˜¯å”¯ä¸€ä¸é‡å¤çš„ï¼Œåº•å±‚çš„å“ˆå¸Œè¡¨ç»“æ„ï¼Œä¾èµ– hashCode æ–¹æ³•å’Œ equals æ–¹æ³•ä¿è¯é”®çš„å”¯ä¸€
* keyã€value éƒ½å¯ä»¥ä¸ºnullï¼Œä½†æ˜¯ key ä½ç½®åªèƒ½æ˜¯ä¸€ä¸ªnull
* HashMap ä¸­çš„æ˜ å°„ä¸æ˜¯æœ‰åºçš„ï¼Œå³å­˜å–æ˜¯æ— åºçš„
* **key è¦å­˜å‚¨çš„æ˜¯è‡ªå®šä¹‰å¯¹è±¡ï¼Œéœ€è¦é‡å†™ hashCode å’Œ equals æ–¹æ³•ï¼Œé˜²æ­¢å‡ºç°åœ°å€ä¸åŒå†…å®¹ç›¸åŒçš„ key**

JDK7 å¯¹æ¯” JDK8ï¼š

* 7 = æ•°ç»„ + é“¾è¡¨ï¼Œ8 = æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘
* 7 ä¸­æ˜¯å¤´æ’æ³•ï¼Œå¤šçº¿ç¨‹å®¹æ˜“é€ æˆç¯ï¼Œ8 ä¸­æ˜¯å°¾æ’æ³•
* 7 çš„æ‰©å®¹æ˜¯å…¨éƒ¨æ•°æ®é‡æ–°å®šä½ï¼Œ8 ä¸­æ˜¯ä½ç½®ä¸å˜æˆ–è€…å½“å‰ä½ç½® + æ—§ size å¤§å°æ¥å®ç°
* 7 æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦è¦æ‰©å®¹å†æ’å…¥ï¼Œ8 ä¸­æ˜¯å…ˆæ’å…¥å†çœ‹æ˜¯å¦è¦æ‰©å®¹

åº•å±‚æ•°æ®ç»“æ„ï¼š

* å“ˆå¸Œè¡¨ï¼ˆHash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨ï¼‰ï¼Œæ ¹æ®å…³é”®ç å€¼è€Œç›´æ¥è®¿é—®çš„æ•°æ®ç»“æ„ã€‚é€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ï¼Œè¿™ä¸ªæ˜ å°„å‡½æ•°å«åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„å«åšæ•£åˆ—è¡¨

* JDK1.8 ä¹‹å‰ HashMap ç”±æ•°ç»„+é“¾è¡¨ç»„æˆ

  * æ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“
  * é“¾è¡¨åˆ™æ˜¯ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆ**æ‹‰é“¾æ³•è§£å†³å†²çª**ï¼‰ï¼Œæ‹‰é“¾æ³•å°±æ˜¯å¤´æ’æ³•ï¼Œä¸¤ä¸ªå¯¹è±¡è°ƒç”¨çš„ hashCode æ–¹æ³•è®¡ç®—çš„å“ˆå¸Œç å€¼ï¼ˆé”®çš„å“ˆå¸Œï¼‰ä¸€è‡´å¯¼è‡´è®¡ç®—çš„æ•°ç»„ç´¢å¼•å€¼ç›¸åŒ
  
* JDK1.8 ä»¥å HashMap ç”±**æ•°ç»„+é“¾è¡¨ +çº¢é»‘æ ‘**æ•°æ®ç»“æ„ç»„æˆ

  * è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–
  * å½“é“¾è¡¨é•¿åº¦**è¶…è¿‡ï¼ˆå¤§äºï¼‰é˜ˆå€¼**ï¼ˆæˆ–è€…çº¢é»‘æ ‘çš„è¾¹ç•Œå€¼ï¼Œé»˜è®¤ä¸º 8ï¼‰å¹¶ä¸”å½“å‰æ•°ç»„çš„**é•¿åº¦å¤§äºç­‰äº 64 æ—¶**ï¼Œæ­¤ç´¢å¼•ä½ç½®ä¸Šçš„æ‰€æœ‰æ•°æ®æ”¹ä¸ºçº¢é»‘æ ‘å­˜å‚¨
  * å³ä½¿å“ˆå¸Œå‡½æ•°å–å¾—å†å¥½ï¼Œä¹Ÿå¾ˆéš¾è¾¾åˆ°å…ƒç´ ç™¾åˆ†ç™¾å‡åŒ€åˆ†å¸ƒã€‚å½“ HashMap ä¸­æœ‰å¤§é‡çš„å…ƒç´ éƒ½å­˜æ”¾åˆ°åŒä¸€ä¸ªæ¡¶ä¸­æ—¶ï¼Œå°±ç›¸å½“äºä¸€ä¸ªé•¿çš„å•é“¾è¡¨ï¼Œå‡å¦‚å•é“¾è¡¨æœ‰ n ä¸ªå…ƒç´ ï¼Œéå†çš„**æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)**ï¼Œæ‰€ä»¥ JDK1.8 ä¸­å¼•å…¥äº† çº¢é»‘æ ‘ï¼ˆæŸ¥æ‰¾**æ—¶é—´å¤æ‚åº¦ä¸º O(logn)**ï¼‰æ¥ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ï¼Œä½¿å¾—æŸ¥æ‰¾æ•ˆç‡æ›´é«˜
  
  ![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/HashMapåº•å±‚ç»“æ„.png)



å‚è€ƒè§†é¢‘ï¼šhttps://www.bilibili.com/video/BV1nJ411J7AA



***



##### ç»§æ‰¿å…³ç³»

HashMap ç»§æ‰¿å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/HashMapç»§æ‰¿å…³ç³».bmp)

è¯´æ˜ï¼š

* Cloneable ç©ºæ¥å£ï¼Œè¡¨ç¤ºå¯ä»¥å…‹éš†ï¼Œ åˆ›å»ºå¹¶è¿”å› HashMap å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚
* Serializable åºåˆ—åŒ–æ¥å£ï¼Œå±äºæ ‡è®°æ€§æ¥å£ï¼ŒHashMap å¯¹è±¡å¯ä»¥è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚
* AbstractMap çˆ¶ç±»æä¾›äº† Map å®ç°æ¥å£ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å®ç°æ­¤æ¥å£æ‰€éœ€çš„å·¥ä½œ



***



##### æˆå‘˜å±æ€§

1. åºåˆ—åŒ–ç‰ˆæœ¬å·

   ```java
   private static final long serialVersionUID = 362498820763181265L;
   ```

2. é›†åˆçš„åˆå§‹åŒ–å®¹é‡ï¼ˆ**å¿…é¡»æ˜¯äºŒçš„ n æ¬¡å¹‚** ï¼‰

   ```java
   // é»˜è®¤çš„åˆå§‹å®¹é‡æ˜¯16 -- 1<<4ç›¸å½“äº1*2çš„4æ¬¡æ–¹---1*16
   static final int DEFAULT_INITIAL_CAPACITY = 1 << 4;
   ```

   HashMap æ„é€ æ–¹æ³•æŒ‡å®šé›†åˆçš„åˆå§‹åŒ–å®¹é‡å¤§å°ï¼š

   ```java
   HashMap(int initialCapacity)// æ„é€ ä¸€ä¸ªå¸¦æŒ‡å®šåˆå§‹å®¹é‡å’Œé»˜è®¤åŠ è½½å› å­ (0.75) çš„ç©º HashMap
   ```

   * ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯ 2 çš„ n æ¬¡å¹‚ï¼Ÿç”¨ä½è¿ç®—æ›¿ä»£å–ä½™è®¡ç®—ï¼Œå‡å°‘ rehash çš„ä»£ä»·ï¼ˆç§»åŠ¨çš„èŠ‚ç‚¹å°‘ï¼‰

     HashMap ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œéœ€è¦æ ¹æ® key çš„ hash å€¼ç¡®å®šåœ¨æ•°ç»„ä¸­çš„å…·ä½“ä½ç½®ã€‚ä¸ºäº†å‡å°‘ç¢°æ’ï¼ŒæŠŠæ•°æ®åˆ†é…å‡åŒ€ï¼Œæ¯ä¸ªé“¾è¡¨é•¿åº¦å¤§è‡´ç›¸åŒï¼Œå®ç°è¯¥æ–¹æ³•å°±æ˜¯å–æ¨¡ `hash%length`ï¼Œè®¡ç®—æœºä¸­ç›´æ¥æ±‚ä½™æ•ˆç‡ä¸å¦‚ä½ç§»è¿ç®—ï¼Œ **`hash % length == hash & (length-1)` çš„å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡å¹‚**

     æ•£åˆ—å¹³å‡åˆ†å¸ƒï¼š2 çš„ n æ¬¡æ–¹æ˜¯ 1 åé¢ n ä¸ª 0ï¼Œ2 çš„ n æ¬¡æ–¹ -1 æ˜¯ n ä¸ª 1ï¼Œå¯ä»¥**ä¿è¯æ•£åˆ—çš„å‡åŒ€æ€§**ï¼Œå‡å°‘ç¢°æ’

     ```java
     ä¾‹å¦‚é•¿åº¦ä¸º8æ—¶å€™ï¼Œ3&(8-1)=3  2&(8-1)=2 ï¼Œä¸åŒä½ç½®ä¸Šï¼Œä¸ç¢°æ’ï¼›
     ä¾‹å¦‚é•¿åº¦ä¸º9æ—¶å€™ï¼Œ3&(9-1)=0  2&(9-1)=0 ï¼Œéƒ½åœ¨0ä¸Šï¼Œç¢°æ’äº†ï¼›
     ```
     
   * å¦‚æœè¾“å…¥å€¼ä¸æ˜¯ 2 çš„å¹‚ä¼šæ€ä¹ˆæ ·ï¼Ÿ

     åˆ›å»º HashMap å¯¹è±¡æ—¶ï¼ŒHashMap é€šè¿‡ä½ç§»è¿ç®—å’Œæˆ–è¿ç®—å¾—åˆ°çš„è‚¯å®šæ˜¯ 2 çš„å¹‚æ¬¡æ•°ï¼Œå¹¶ä¸”æ˜¯å¤§äºé‚£ä¸ªæ•°çš„æœ€è¿‘çš„æ•°å­—ï¼Œåº•å±‚é‡‡ç”¨ tableSizeFor() æ–¹æ³•

3. é»˜è®¤çš„è´Ÿè½½å› å­ï¼Œé»˜è®¤å€¼æ˜¯ 0.75 

    ```java
    static final float DEFAULT_LOAD_FACTOR = 0.75f;
    ```

4. é›†åˆæœ€å¤§å®¹é‡ 

    ```java
    // é›†åˆæœ€å¤§å®¹é‡çš„ä¸Šé™æ˜¯ï¼š2çš„30æ¬¡å¹‚
    static final int MAXIMUM_CAPACITY = 1 << 30;// 0100 0000 0000 0000 0000 0000 0000 0000 = 2 ^ 30
    ```

5. å½“é“¾è¡¨çš„å€¼è¶…è¿‡ 8 åˆ™ä¼šè½¬çº¢é»‘æ ‘ï¼ˆJDK1.8 æ–°å¢ï¼‰

    ```java
    // å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å¤§äºè¿™ä¸ªå€¼æ—¶ä¼šè½¬æˆçº¢é»‘æ ‘
    static final int TREEIFY_THRESHOLD = 8;
    ```

    ä¸ºä»€ä¹ˆ Map æ¡¶ä¸­èŠ‚ç‚¹ä¸ªæ•°å¤§äº 8 æ‰è½¬ä¸ºçº¢é»‘æ ‘ï¼Ÿ

    * åœ¨ HashMap ä¸­æœ‰ä¸€æ®µæ³¨é‡Šè¯´æ˜ï¼š**ç©ºé—´å’Œæ—¶é—´çš„æƒè¡¡**

      ```java
      TreeNodeså ç”¨ç©ºé—´å¤§çº¦æ˜¯æ™®é€šèŠ‚ç‚¹çš„ä¸¤å€ï¼Œæ‰€ä»¥æˆ‘ä»¬åªåœ¨ç®±å­åŒ…å«è¶³å¤Ÿçš„èŠ‚ç‚¹æ—¶æ‰ä½¿ç”¨æ ‘èŠ‚ç‚¹ã€‚å½“èŠ‚ç‚¹å˜å°‘(ç”±äºåˆ é™¤æˆ–è°ƒæ•´å¤§å°)æ—¶ï¼Œå°±ä¼šè¢«è½¬æ¢å›æ™®é€šçš„æ¡¶ã€‚åœ¨ä½¿ç”¨åˆ†å¸ƒè‰¯å¥½çš„ç”¨æˆ·hashcodeæ—¶ï¼Œå¾ˆå°‘ä½¿ç”¨æ ‘ç®±ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œåœ¨éšæœºå“ˆå¸Œç ä¸‹ï¼Œç®±å­ä¸­èŠ‚ç‚¹çš„é¢‘ç‡æœä»"æ³Šæ¾åˆ†å¸ƒ"ï¼Œé»˜è®¤è°ƒæ•´é˜ˆå€¼ä¸º0.75ï¼Œå¹³å‡å‚æ•°çº¦ä¸º0.5ï¼Œå°½ç®¡ç”±äºè°ƒæ•´ç²’åº¦çš„å·®å¼‚å¾ˆå¤§ã€‚å¿½ç•¥æ–¹å·®ï¼Œåˆ—è¡¨å¤§å°kçš„é¢„æœŸå‡ºç°æ¬¡æ•°æ˜¯(exp(-0.5)*pow(0.5, k)/factorial(k))
      0:    0.60653066
      1:    0.30326533
      2:    0.07581633
      3:    0.01263606
      4:    0.00157952
      5:    0.00015795
      6:    0.00001316
      7:    0.00000094
      8:    0.00000006
      more: less than 1 in ten million
      ä¸€ä¸ªbinä¸­é“¾è¡¨é•¿åº¦è¾¾åˆ°8ä¸ªå…ƒç´ çš„æ¦‚ç‡ä¸º0.00000006ï¼Œå‡ ä¹æ˜¯ä¸å¯èƒ½äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©8è¿™ä¸ªæ•°å­—
      ```
      
    * å…¶ä»–è¯´æ³•
      çº¢é»‘æ ‘çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦æ˜¯ log(n)ï¼Œå¦‚æœé•¿åº¦ä¸º 8ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º log(8)=3ï¼Œé“¾è¡¨çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º n/2ï¼Œå½“é•¿åº¦ä¸º 8 æ—¶ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º 8/2=4ï¼Œè¿™æ‰æœ‰è½¬æ¢æˆæ ‘çš„å¿…è¦ï¼›é“¾è¡¨é•¿åº¦å¦‚æœæ˜¯å°äºç­‰äº 6ï¼Œ6/2=3ï¼Œè€Œ log(6)=2.6ï¼Œè™½ç„¶é€Ÿåº¦ä¹Ÿå¾ˆå¿«çš„ï¼Œä½†è½¬åŒ–ä¸ºæ ‘ç»“æ„å’Œç”Ÿæˆæ ‘çš„æ—¶é—´å¹¶ä¸çŸ­

6. å½“é“¾è¡¨çš„å€¼å°äº 6 åˆ™ä¼šä»çº¢é»‘æ ‘è½¬å›é“¾è¡¨

    ```java
    // å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å°äºè¿™ä¸ªå€¼æ—¶æ ‘è½¬é“¾è¡¨
    static final int UNTREEIFY_THRESHOLD = 6;
    ```

7. å½“ Map é‡Œé¢çš„æ•°é‡**å¤§äºç­‰äº**è¿™ä¸ªé˜ˆå€¼æ—¶ï¼Œè¡¨ä¸­çš„æ¡¶æ‰èƒ½è¿›è¡Œæ ‘å½¢åŒ– ï¼Œå¦åˆ™æ¡¶å†…å…ƒç´ è¶…è¿‡ 8 æ—¶ä¼šæ‰©å®¹ï¼Œè€Œä¸æ˜¯æ ‘å½¢åŒ–ã€‚ä¸ºäº†é¿å…è¿›è¡Œæ‰©å®¹ã€æ ‘å½¢åŒ–é€‰æ‹©çš„å†²çªï¼Œè¿™ä¸ªå€¼ä¸èƒ½å°äº 4 * TREEIFY_THRESHOLD (8)

    ```java
    // æ¡¶ä¸­ç»“æ„è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯¹åº”çš„æ•°ç»„é•¿åº¦æœ€å°çš„å€¼ 
    static final int MIN_TREEIFY_CAPACITY = 64;
    ```

    åŸå› ï¼šæ•°ç»„æ¯”è¾ƒå°çš„æƒ…å†µä¸‹å˜ä¸ºçº¢é»‘æ ‘ç»“æ„ï¼Œåè€Œä¼šé™ä½æ•ˆç‡ï¼Œçº¢é»‘æ ‘éœ€è¦è¿›è¡Œå·¦æ—‹ï¼Œå³æ—‹ï¼Œå˜è‰²è¿™äº›æ“ä½œæ¥ä¿æŒå¹³è¡¡

8. table ç”¨æ¥åˆå§‹åŒ–ï¼ˆå¿…é¡»æ˜¯äºŒçš„ n æ¬¡å¹‚ï¼‰

    ```java
    // å­˜å‚¨å…ƒç´ çš„æ•°ç»„ 
    transient Node<K,V>[] table;
    ```

 9. HashMap ä¸­**å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°**

    ```java
    // å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°ï¼ŒHashMapä¸­K-Vçš„å®æ—¶æ•°é‡ï¼Œä¸æ˜¯tableæ•°ç»„çš„é•¿åº¦
    transient int size;
    ```

10. è®°å½• HashMap çš„ä¿®æ”¹æ¬¡æ•° 

    ```java
    // æ¯æ¬¡æ‰©å®¹å’Œæ›´æ”¹mapç»“æ„çš„è®¡æ•°å™¨
     transient int modCount;  
    ```

11. è°ƒæ•´å¤§å°ä¸‹ä¸€ä¸ªå®¹é‡çš„å€¼è®¡ç®—æ–¹å¼ä¸ºï¼šå®¹é‡ * è´Ÿè½½å› å­ï¼Œå®¹é‡æ˜¯æ•°ç»„çš„é•¿åº¦

     ```java
     // ä¸´ç•Œå€¼ï¼Œå½“å®é™…å¤§å°(å®¹é‡*è´Ÿè½½å› å­)è¶…è¿‡ä¸´ç•Œå€¼æ—¶ï¼Œä¼šè¿›è¡Œæ‰©å®¹
     int threshold;
     ```

12. **å“ˆå¸Œè¡¨çš„åŠ è½½å› å­**

    ```java
     final float loadFactor;
    ```
    
    * åŠ è½½å› å­çš„æ¦‚è¿°
    
      loadFactor åŠ è½½å› å­ï¼Œæ˜¯ç”¨æ¥è¡¡é‡ HashMap æ»¡çš„ç¨‹åº¦ï¼Œè¡¨ç¤º HashMap çš„ç–å¯†ç¨‹åº¦ï¼Œå½±å“ hash æ“ä½œåˆ°åŒä¸€ä¸ªæ•°ç»„ä½ç½®çš„æ¦‚ç‡ï¼Œè®¡ç®— HashMap çš„å®æ—¶åŠ è½½å› å­çš„æ–¹æ³•ä¸º **size/capacity**ï¼Œè€Œä¸æ˜¯å ç”¨æ¡¶çš„æ•°é‡å»é™¤ä»¥ capacityï¼Œcapacity æ˜¯æ¡¶çš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯ table çš„é•¿åº¦ length
    
      å½“ HashMap å®¹çº³çš„å…ƒç´ å·²ç»è¾¾åˆ°æ•°ç»„é•¿åº¦çš„ 75% æ—¶ï¼Œè¡¨ç¤º HashMap æ‹¥æŒ¤éœ€è¦æ‰©å®¹ï¼Œè€Œæ‰©å®¹è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° rehashã€å¤åˆ¶æ•°æ®ç­‰æ“ä½œï¼Œéå¸¸æ¶ˆè€—æ€§èƒ½ï¼Œæ‰€ä»¥å¼€å‘ä¸­å°½é‡å‡å°‘æ‰©å®¹çš„æ¬¡æ•°ï¼Œé€šè¿‡åˆ›å»º HashMap é›†åˆå¯¹è±¡æ—¶æŒ‡å®šåˆå§‹å®¹é‡æ¥é¿å…
    
      ```java
      HashMap(int initialCapacity, float loadFactor)//æ„é€ æŒ‡å®šåˆå§‹å®¹é‡å’ŒåŠ è½½å› å­çš„ç©ºHashMap
      ```
    
    * ä¸ºä»€ä¹ˆåŠ è½½å› å­è®¾ç½®ä¸º 0.75ï¼Œåˆå§‹åŒ–ä¸´ç•Œå€¼æ˜¯ 12ï¼Ÿ
    
      loadFactor å¤ªå¤§å¯¼è‡´æŸ¥æ‰¾å…ƒç´ æ•ˆç‡ä½ï¼Œå­˜æ”¾çš„æ•°æ®æ‹¥æŒ¤ï¼Œå¤ªå°å¯¼è‡´æ•°ç»„çš„åˆ©ç”¨ç‡ä½ï¼Œå­˜æ”¾çš„æ•°æ®ä¼šå¾ˆåˆ†æ•£ã€‚loadFactor çš„é»˜è®¤å€¼ä¸º **0.75f æ˜¯å®˜æ–¹ç»™å‡ºçš„ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¸´ç•Œå€¼**
    
    * threshold è®¡ç®—å…¬å¼ï¼šcapacityï¼ˆæ•°ç»„é•¿åº¦é»˜è®¤16ï¼‰ * loadFactorï¼ˆé»˜è®¤ 0.75ï¼‰ã€‚å½“ size >= threshold çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±è¦è€ƒè™‘å¯¹æ•°ç»„çš„ resizeï¼ˆæ‰©å®¹ï¼‰ï¼Œè¿™å°±æ˜¯è¡¡é‡æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å¢çš„ä¸€ä¸ªæ ‡å‡†ï¼Œ æ‰©å®¹åçš„ HashMap å®¹é‡æ˜¯ä¹‹å‰å®¹é‡çš„**ä¸¤å€**



***



##### æ„é€ æ–¹æ³•

* æ„é€ ä¸€ä¸ªç©ºçš„ HashMap ï¼Œ**é»˜è®¤åˆå§‹å®¹é‡ï¼ˆ16ï¼‰å’Œé»˜è®¤è´Ÿè½½å› å­ï¼ˆ0.75ï¼‰**

  ```java
  public HashMap() {
  	this.loadFactor = DEFAULT_LOAD_FACTOR; 
  	// å°†é»˜è®¤çš„åŠ è½½å› å­0.75èµ‹å€¼ç»™loadFactorï¼Œå¹¶æ²¡æœ‰åˆ›å»ºæ•°ç»„
  }
  ```

* æ„é€ ä¸€ä¸ªå…·æœ‰æŒ‡å®šçš„åˆå§‹å®¹é‡å’Œé»˜è®¤è´Ÿè½½å› å­ï¼ˆ0.75ï¼‰HashMap

  ```java
  // æŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ„é€ å‡½æ•°
  public HashMap(int initialCapacity) {
      this(initialCapacity, DEFAULT_LOAD_FACTOR);
  }
  ```

* æ„é€ ä¸€ä¸ªå…·æœ‰æŒ‡å®šçš„åˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­çš„ HashMap

  ```java
  public HashMap(int initialCapacity, float loadFactor) {
      // è¿›è¡Œåˆ¤æ–­
      // å°†æŒ‡å®šçš„åŠ è½½å› å­èµ‹å€¼ç»™HashMapæˆå‘˜å˜é‡çš„è´Ÿè½½å› å­loadFactor
      this.loadFactor = loadFactor;
    	// æœ€åè°ƒç”¨äº†tableSizeFor
      this.threshold = tableSizeFor(initialCapacity);
  }
  ```

  * å¯¹äº `this.threshold = tableSizeFor(initialCapacity)` 

    JDK8 ä»¥åçš„æ„é€ æ–¹æ³•ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹ table è¿™ä¸ªæˆå‘˜å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œtable çš„åˆå§‹åŒ–è¢«æ¨è¿Ÿåˆ°äº† put æ–¹æ³•ä¸­ï¼Œåœ¨ put æ–¹æ³•ä¸­ä¼šå¯¹ threshold é‡æ–°è®¡ç®—
  
* åŒ…å«å¦ä¸€ä¸ª `Map` çš„æ„é€ å‡½æ•° 

  ```java
  // æ„é€ ä¸€ä¸ªæ˜ å°„å…³ç³»ä¸æŒ‡å®š Map ç›¸åŒçš„æ–° HashMap
  public HashMap(Map<? extends K, ? extends V> m) {
      // è´Ÿè½½å› å­loadFactorå˜ä¸ºé»˜è®¤çš„è´Ÿè½½å› å­0.75
      this.loadFactor = DEFAULT_LOAD_FACTOR;
      putMapEntries(m, false);
  }
  ```

  putMapEntries æºç åˆ†æï¼š

  ```java
  final void putMapEntries(Map<? extends K, ? extends V> m, boolean evict) {
      //è·å–å‚æ•°é›†åˆçš„é•¿åº¦
      int s = m.size();
      if (s > 0) {
          //åˆ¤æ–­å‚æ•°é›†åˆçš„é•¿åº¦æ˜¯å¦å¤§äº0
          if (table == null) {  // åˆ¤æ–­tableæ˜¯å¦å·²ç»åˆå§‹åŒ–
              // pre-size
              // æœªåˆå§‹åŒ–ï¼Œsä¸ºmçš„å®é™…å…ƒç´ ä¸ªæ•°
              float ft = ((float)s / loadFactor) + 1.0F;
              int t = ((ft < (float)MAXIMUM_CAPACITY) ?
                       (int)ft : MAXIMUM_CAPACITY);
              // è®¡ç®—å¾—åˆ°çš„tå¤§äºé˜ˆå€¼ï¼Œåˆ™åˆå§‹åŒ–é˜ˆå€¼
              if (t > threshold)
                  threshold = tableSizeFor(t);
          }
          // å·²åˆå§‹åŒ–ï¼Œå¹¶ä¸”må…ƒç´ ä¸ªæ•°å¤§äºé˜ˆå€¼ï¼Œè¿›è¡Œæ‰©å®¹å¤„ç†
          else if (s > threshold)
              resize();
          // å°†mä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³HashMapä¸­
          for (Map.Entry<? extends K, ? extends V> e : m.entrySet()) {
              K key = e.getKey();
              V value = e.getValue();
              putVal(hash(key), key, value, false, evict);
          }
      }
  }
  ```

  `float ft = ((float)s / loadFactor) + 1.0F` è¿™ä¸€è¡Œä»£ç ä¸­ä¸ºä»€ä¹ˆè¦åŠ  1.0F ï¼Ÿ

  s / loadFactor çš„ç»“æœæ˜¯å°æ•°ï¼ŒåŠ  1.0F ç›¸å½“äºæ˜¯å¯¹å°æ•°åšä¸€ä¸ªå‘ä¸Šå–æ•´ä»¥å°½å¯èƒ½çš„ä¿è¯æ›´å¤§å®¹é‡ï¼Œæ›´å¤§çš„å®¹é‡èƒ½å¤Ÿå‡å°‘ resize çš„è°ƒç”¨æ¬¡æ•°ï¼Œè¿™æ ·å¯ä»¥å‡å°‘æ•°ç»„çš„æ‰©å®¹



***



##### æˆå‘˜æ–¹æ³•

* hash()ï¼šHashMap æ˜¯æ”¯æŒ Key ä¸ºç©ºçš„ï¼›HashTable æ˜¯ç›´æ¥ç”¨ Key æ¥è·å– HashCodeï¼Œkey ä¸ºç©ºä¼šæŠ›å¼‚å¸¸

  * &ï¼ˆæŒ‰ä½ä¸è¿ç®—ï¼‰ï¼šç›¸åŒçš„äºŒè¿›åˆ¶æ•°ä½ä¸Šï¼Œéƒ½æ˜¯ 1 çš„æ—¶å€™ï¼Œç»“æœä¸º 1ï¼Œå¦åˆ™ä¸ºé›¶
  
  * ^ï¼ˆæŒ‰ä½å¼‚æˆ–è¿ç®—ï¼‰ï¼šç›¸åŒçš„äºŒè¿›åˆ¶æ•°ä½ä¸Šï¼Œæ•°å­—ç›¸åŒï¼Œç»“æœä¸º 0ï¼Œä¸åŒä¸º 1ï¼Œ**ä¸è¿›ä½åŠ æ³•**
  
    0 1 ç›¸äº’åš & | ^ è¿ç®—ï¼Œç»“æœå‡ºç° 0 å’Œ 1 çš„æ•°é‡åˆ†åˆ«æ˜¯ 3:1ã€1:3ã€1:1ï¼Œæ‰€ä»¥å¼‚æˆ–æ˜¯æœ€å¹³å‡çš„
  
  ```java
  static final int hash(Object key) {
      int h;
      // 1ï¼‰å¦‚æœkeyç­‰äºnullï¼šå¯ä»¥çœ‹åˆ°å½“keyç­‰äºnullçš„æ—¶å€™ä¹Ÿæ˜¯æœ‰å“ˆå¸Œå€¼çš„ï¼Œè¿”å›çš„æ˜¯0
      // 2ï¼‰å¦‚æœkeyä¸ç­‰äºnullï¼šé¦–å…ˆè®¡ç®—å‡ºkeyçš„hashCodeèµ‹å€¼ç»™h,ç„¶åä¸hæ— ç¬¦å·å³ç§»16ä½åçš„äºŒè¿›åˆ¶è¿›è¡ŒæŒ‰ä½å¼‚æˆ–
      return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
  }
  ```
  
  è®¡ç®— hash çš„æ–¹æ³•ï¼šå°† hashCode æ— ç¬¦å·å³ç§» 16 ä½ï¼Œé«˜ 16bit å’Œä½ 16bit åšå¼‚æˆ–ï¼Œæ‰°åŠ¨è¿ç®—
  
  åŸå› ï¼šå½“æ•°ç»„é•¿åº¦å¾ˆå°ï¼Œå‡è®¾æ˜¯ 16ï¼Œé‚£ä¹ˆ n-1 å³ä¸º 1111 ï¼Œè¿™æ ·çš„å€¼å’Œ hashCode() ç›´æ¥åšæŒ‰ä½ä¸æ“ä½œï¼Œå®é™…ä¸Šåªä½¿ç”¨äº†å“ˆå¸Œå€¼çš„å 4 ä½ã€‚å¦‚æœå½“å“ˆå¸Œå€¼çš„é«˜ä½å˜åŒ–å¾ˆå¤§ï¼Œä½ä½å˜åŒ–å¾ˆå°ï¼Œå°±å¾ˆå®¹æ˜“é€ æˆå“ˆå¸Œå†²çªäº†ï¼Œæ‰€ä»¥è¿™é‡Œ**æŠŠé«˜ä½ä½éƒ½åˆ©ç”¨èµ·æ¥ï¼Œè®©é«˜16 ä½ä¹Ÿå‚ä¸è¿ç®—**ï¼Œä»è€Œè§£å†³äº†è¿™ä¸ªé—®é¢˜
  
  å“ˆå¸Œå†²çªçš„å¤„ç†æ–¹å¼ï¼š
  
  * å¼€æ”¾å®šå€æ³•ï¼šçº¿æ€§æ¢æŸ¥æ³•ï¼ˆThreadLocalMap ä½¿ç”¨ï¼‰ï¼Œå¹³æ–¹æ¢æŸ¥æ³•ï¼ˆi + 1^2ã€i - 1^2ã€i + 2^2â€¦â€¦ï¼‰ã€åŒé‡æ•£åˆ—ï¼ˆå¤šä¸ªå“ˆå¸Œå‡½æ•°ï¼‰
  * é“¾åœ°å€æ³•ï¼šæ‹‰é“¾æ³•
  
* put()ï¼šjdk1.8 å‰æ˜¯å¤´æ’æ³• (é“¾åœ°å€æ³•)ï¼Œå¤šçº¿ç¨‹ä¸‹æ‰©å®¹å‡ºç°å¾ªç¯é“¾è¡¨ï¼Œjdk1.8 ä»¥åå¼•å…¥çº¢é»‘æ ‘ï¼Œæ’å…¥æ–¹æ³•å˜æˆå°¾æ’æ³•

  ç¬¬ä¸€æ¬¡è°ƒç”¨ put æ–¹æ³•æ—¶åˆ›å»ºæ•°ç»„ Node[] tableï¼Œå› ä¸ºæ•£åˆ—è¡¨è€—è´¹å†…å­˜ï¼Œä¸ºäº†é˜²æ­¢å†…å­˜æµªè´¹ï¼Œæ‰€ä»¥**å»¶è¿Ÿåˆå§‹åŒ–**

  å­˜å‚¨æ•°æ®æ­¥éª¤ï¼ˆå­˜å‚¨è¿‡ç¨‹ï¼‰ï¼š

  1. å…ˆé€šè¿‡ hash å€¼è®¡ç®—å‡º key æ˜ å°„åˆ°å“ªä¸ªæ¡¶ï¼Œå“ˆå¸Œå¯»å€
  2. å¦‚æœæ¡¶ä¸Šæ²¡æœ‰ç¢°æ’å†²çªï¼Œåˆ™ç›´æ¥æ’å…¥
  3. å¦‚æœå‡ºç°ç¢°æ’å†²çªï¼šå¦‚æœè¯¥æ¡¶ä½¿ç”¨çº¢é»‘æ ‘å¤„ç†å†²çªï¼Œåˆ™è°ƒç”¨çº¢é»‘æ ‘çš„æ–¹æ³•æ’å…¥æ•°æ®ï¼›å¦åˆ™é‡‡ç”¨ä¼ ç»Ÿçš„é“¾å¼æ–¹æ³•æ’å…¥ï¼Œå¦‚æœé“¾çš„é•¿åº¦è¾¾åˆ°ä¸´ç•Œå€¼ï¼Œåˆ™æŠŠé“¾è½¬å˜ä¸ºçº¢é»‘æ ‘
  4. å¦‚æœæ•°ç»„ä½ç½®ç›¸åŒï¼Œé€šè¿‡ equals æ¯”è¾ƒå†…å®¹æ˜¯å¦ç›¸åŒï¼šç›¸åŒåˆ™æ–°çš„ value è¦†ç›–æ—§ valueï¼Œä¸ç›¸åŒåˆ™å°†æ–°çš„é”®å€¼å¯¹æ·»åŠ åˆ°å“ˆå¸Œè¡¨ä¸­
  5. æœ€ååˆ¤æ–­ size æ˜¯å¦å¤§äºé˜ˆå€¼ thresholdï¼Œåˆ™è¿›è¡Œæ‰©å®¹

  ```java
  public V put(K key, V value) {
      return putVal(hash(key), key, value, false, true);
  }
  ```
  
  putVal() æ–¹æ³•ä¸­ key åœ¨è¿™é‡Œæ‰§è¡Œäº†ä¸€ä¸‹ hash()ï¼Œåœ¨ putVal å‡½æ•°ä¸­ä½¿ç”¨åˆ°äº†ä¸Šè¿° hash å‡½æ•°è®¡ç®—çš„å“ˆå¸Œå€¼ï¼š
  
  ```java
  final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) {
    	//ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
    	if ((p = tab[i = (n - 1) & hash]) == null){//è¿™é‡Œçš„nè¡¨ç¤ºæ•°ç»„é•¿åº¦16
    		//.....
        } else {
            if (e != null) { // existing mapping for key
                V oldValue = e.value;
                //onlyIfAbsenté»˜è®¤ä¸ºfalseï¼Œæ‰€ä»¥å¯ä»¥è¦†ç›–å·²ç»å­˜åœ¨çš„æ•°æ®ï¼Œå¦‚æœä¸ºtrueè¯´æ˜ä¸èƒ½è¦†ç›–
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                afterNodeAccess(e);
                // å¦‚æœè¿™é‡Œå…è®¸è¦†ç›–ï¼Œå°±ç›´æ¥è¿”å›äº†
                return oldValue;
            }
        }
      // å¦‚æœæ˜¯æ·»åŠ æ“ä½œï¼ŒmodCount ++ï¼Œå¦‚æœä¸æ˜¯æ›¿æ¢ï¼Œä¸ä¼šèµ°è¿™é‡Œçš„é€»è¾‘ï¼ŒmodCountç”¨æ¥è®°å½•é€»è¾‘çš„å˜åŒ–
      ++modCount;
      // æ•°é‡å¤§äºæ‰©å®¹é˜ˆå€¼
      if (++size > threshold)
          resize();
      afterNodeInsertion(evict);
      return null;
  }
  ```
  
    * `(n - 1) & hash`ï¼šè®¡ç®—ä¸‹æ ‡ä½ç½®
  
    <img src="https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/HashMap-putValå“ˆå¸Œè¿ç®—.png" style="zoom: 67%;" />
  
    * ä½™æ•°æœ¬è´¨æ˜¯ä¸æ–­åšé™¤æ³•ï¼ŒæŠŠå‰©ä½™çš„æ•°å‡å»ï¼Œè¿ç®—æ•ˆç‡è¦æ¯”ä½è¿ç®—ä½

  

* treeifyBin()

  èŠ‚ç‚¹æ·»åŠ å®Œæˆä¹‹ååˆ¤æ–­æ­¤æ—¶èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¦å¤§äº TREEIFY_THRESHOLD ä¸´ç•Œå€¼ 8ï¼Œå¦‚æœå¤§äºåˆ™å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œè½¬æ¢çº¢é»‘æ ‘çš„æ–¹æ³• treeifyBinï¼Œæ•´ä½“ä»£ç å¦‚ä¸‹ï¼š

  ```java
  if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st
     //è½¬æ¢ä¸ºçº¢é»‘æ ‘ tabè¡¨ç¤ºæ•°ç»„å  hashè¡¨ç¤ºå“ˆå¸Œå€¼
     treeifyBin(tab, hash);
  ```

  1. å¦‚æœå½“å‰æ•°ç»„ä¸ºç©ºæˆ–è€…æ•°ç»„çš„é•¿åº¦å°äºè¿›è¡Œæ ‘å½¢åŒ–çš„é˜ˆ MIN_TREEIFY_CAPACITY = 64 å°±å»æ‰©å®¹ï¼Œè€Œä¸æ˜¯å°†èŠ‚ç‚¹å˜ä¸ºçº¢é»‘æ ‘
  2. å¦‚æœæ˜¯æ ‘å½¢åŒ–éå†æ¡¶ä¸­çš„å…ƒç´ ï¼Œåˆ›å»ºç›¸åŒä¸ªæ•°çš„æ ‘å½¢èŠ‚ç‚¹ï¼Œå¤åˆ¶å†…å®¹ï¼Œå»ºç«‹èµ·è”ç³»ï¼Œç±»ä¼¼å•å‘é“¾è¡¨è½¬æ¢ä¸ºåŒå‘é“¾è¡¨
  3. è®©æ¡¶ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å³æ•°ç»„ä¸­çš„å…ƒç´ æŒ‡å‘æ–°å»ºçš„çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œä»¥åè¿™ä¸ªæ¡¶é‡Œçš„å…ƒç´ å°±æ˜¯çº¢é»‘æ ‘è€Œä¸æ˜¯é“¾è¡¨æ•°æ®ç»“æ„äº†

* tableSizeFor()ï¼šåˆ›å»º HashMap æŒ‡å®šå®¹é‡æ—¶ï¼ŒHashMap é€šè¿‡ä½ç§»è¿ç®—å’Œæˆ–è¿ç®—å¾—åˆ°æ¯”æŒ‡å®šåˆå§‹åŒ–å®¹é‡å¤§çš„æœ€å°çš„ 2 çš„ n æ¬¡å¹‚
  
  ```java
  static final int tableSizeFor(int cap) {//int cap = 10
      int n = cap - 1;
      n |= n >>> 1;
      n |= n >>> 2;
      n |= n >>> 4;
      n |= n >>> 8;
      n |= n >>> 16;
      return (n < 0) ? 1 : (n >= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
  }
  ```
  
  åˆ†æç®—æ³•ï¼š
  
  1. `int n = cap - 1`ï¼šé˜²æ­¢ cap å·²ç»æ˜¯ 2 çš„å¹‚ã€‚å¦‚æœ cap å·²ç»æ˜¯ 2 çš„å¹‚ï¼Œ ä¸æ‰§è¡Œå‡ 1 æ“ä½œï¼Œåˆ™æ‰§è¡Œå®Œåé¢çš„æ— ç¬¦å·å³ç§»æ“ä½œä¹‹åï¼Œè¿”å›çš„ capacity å°†æ˜¯è¿™ä¸ª cap çš„ 2 å€
  2. n=0 ï¼ˆcap-1 ä¹‹åï¼‰ï¼Œåˆ™ç»è¿‡åé¢çš„å‡ æ¬¡æ— ç¬¦å·å³ç§»ä¾ç„¶æ˜¯ 0ï¼Œè¿”å›çš„ capacity æ˜¯ 1ï¼Œæœ€åæœ‰ n+1
  3. |ï¼ˆæŒ‰ä½æˆ–è¿ç®—ï¼‰ï¼šç›¸åŒçš„äºŒè¿›åˆ¶æ•°ä½ä¸Šï¼Œéƒ½æ˜¯ 0 çš„æ—¶å€™ï¼Œç»“æœä¸º 0ï¼Œå¦åˆ™ä¸º 1
  4. æ ¸å¿ƒæ€æƒ³ï¼š**æŠŠæœ€é«˜ä½æ˜¯ 1 çš„ä½ä»¥åŠå³è¾¹çš„ä½å…¨éƒ¨ç½® 1**ï¼Œç»“æœåŠ  1 åå°±æ˜¯å¤§äºæŒ‡å®šå®¹é‡çš„æœ€å°çš„ 2 çš„ n æ¬¡å¹‚
  
  ä¾‹å¦‚åˆå§‹åŒ–çš„å€¼ä¸º 10ï¼š
  
  * ç¬¬ä¸€æ¬¡å³ç§»
  
    ```java
    int n = cap - 1;//cap=10  n=9
    n |= n >>> 1;
    00000000 00000000 00000000 00001001 //9
    00000000 00000000 00000000 00000100 //9å³ç§»ä¹‹åå˜ä¸º4
    --------------------------------------------------
    00000000 00000000 00000000 00001101 //æŒ‰ä½æˆ–ä¹‹åæ˜¯13
    //ä½¿å¾—nçš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ä¸æœ€é«˜ä½çš„1ç´§é‚»çš„å³è¾¹ä¸€ä½ä¸º1
    ```
  
  * ç¬¬äºŒæ¬¡å³ç§»
  
    ```java
    n |= n >>> 2;//né€šè¿‡ç¬¬ä¸€æ¬¡å³ç§»å˜ä¸ºäº†ï¼šn=13
    00000000 00000000 00000000 00001101  // 13
    00000000 00000000 00000000 00000011  // 13å³ç§»ä¹‹åå˜ä¸º3
    -------------------------------------------------
    00000000 00000000 00000000 00001111	 //æŒ‰ä½æˆ–ä¹‹åæ˜¯15
    //æ— ç¬¦å·å³ç§»ä¸¤ä½ï¼Œä¼šå°†æœ€é«˜ä½ä¸¤ä¸ªè¿ç»­çš„1å³ç§»ä¸¤ä½ï¼Œç„¶åå†ä¸åŸæ¥çš„nåšæˆ–æ“ä½œï¼Œè¿™æ ·nçš„äºŒè¿›åˆ¶è¡¨ç¤ºçš„é«˜ä½ä¸­ä¼šæœ‰4ä¸ªè¿ç»­çš„1
    ```
  
    æ³¨æ„ï¼šå®¹é‡æœ€å¤§æ˜¯ 32bit çš„æ­£æ•°ï¼Œå› æ­¤æœ€å `n |= n >>> 16`ï¼Œæœ€å¤šæ˜¯ 32 ä¸ª 1ï¼ˆä½†æ˜¯è¿™å·²ç»æ˜¯è´Ÿæ•°äº†ï¼‰ã€‚åœ¨æ‰§è¡Œ tableSizeFor ä¹‹å‰ï¼Œå¯¹ initialCapacity åšäº†åˆ¤æ–­ï¼Œå¦‚æœå¤§äº MAXIMUM_CAPACITY(2 ^ 30)ï¼Œåˆ™å– MAXIMUM_CAPACITYï¼›å¦‚æœå°äº MAXIMUM_CAPACITY(2 ^ 30)ï¼Œä¼šæ‰§è¡Œç§»ä½æ“ä½œï¼Œæ‰€ä»¥ç§»ä½æ“ä½œä¹‹åï¼Œæœ€å¤§ 30 ä¸ª 1ï¼ŒåŠ  1 ä¹‹åå¾— 2 ^ 30
  
  * å¾—åˆ°çš„ capacity è¢«èµ‹å€¼ç»™äº† threshold
  
    ```java
    this.threshold = tableSizeFor(initialCapacity);//initialCapacity=10
    ```
  
  * JDK 11
  
    ```java
    static final int tableSizeFor(int cap) {
        //æ— ç¬¦å·å³ç§»ï¼Œé«˜ä½è¡¥0
    	//-1è¡¥ç : 11111111 11111111 11111111 11111111
        int n = -1 >>> Integer.numberOfLeadingZeros(cap - 1);
        return (n < 0) ? 1 : (n >= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
    }
    //è¿”å›æœ€é«˜ä½ä¹‹å‰çš„0çš„ä½æ•°
    public static int numberOfLeadingZeros(int i) {
        if (i <= 0)
            return i == 0 ? 32 : 0;
        // å¦‚æœi>0ï¼Œé‚£ä¹ˆå°±è¡¨æ˜åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸­å…¶è‡³å°‘æœ‰ä¸€ä½ä¸º1
        int n = 31;
        // içš„æœ€é«˜ä½1åœ¨é«˜16ä½ï¼ŒæŠŠiå³ç§»16ä½ï¼Œè®©æœ€é«˜ä½1è¿›å…¥ä½16ä½ç»§ç»­é€’è¿›åˆ¤æ–­
        if (i >= 1 << 16) { n -= 16; i >>>= 16; }
        if (i >= 1 <<  8) { n -=  8; i >>>=  8; }
        if (i >= 1 <<  4) { n -=  4; i >>>=  4; }
        if (i >= 1 <<  2) { n -=  2; i >>>=  2; }
        return n - (i >>> 1);
    }
    ```
  
    
  
* resize()ï¼š

  å½“ HashMap ä¸­çš„**å…ƒç´ ä¸ªæ•°**è¶…è¿‡ `(æ•°ç»„é•¿åº¦)*loadFactor(è´Ÿè½½å› å­)` æˆ–è€…é“¾è¡¨è¿‡é•¿æ—¶ï¼ˆé“¾è¡¨é•¿åº¦ > 8ï¼Œæ•°ç»„é•¿åº¦ < 64ï¼‰ï¼Œå°±ä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œåˆ›å»ºæ–°çš„æ•°ç»„ï¼Œä¼´éšä¸€æ¬¡é‡æ–° hash åˆ†é…ï¼Œå¹¶ä¸”éå† hash è¡¨ä¸­æ‰€æœ‰çš„å…ƒç´ éå¸¸è€—æ—¶ï¼Œæ‰€ä»¥è¦å°½é‡é¿å… resize

  æ‰©å®¹æœºåˆ¶ä¸ºæ‰©å®¹ä¸ºåŸæ¥å®¹é‡çš„ 2 å€ï¼š

  ```java
  if (oldCap > 0) {
      if (oldCap >= MAXIMUM_CAPACITY) {
          // ä»¥å‰çš„å®¹é‡å·²ç»æ˜¯æœ€å¤§å®¹é‡äº†ï¼Œè¿™æ—¶è°ƒå¤§ æ‰©å®¹é˜ˆå€¼ threshold
          threshold = Integer.MAX_VALUE;
          return oldTab;
      }
      else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&
               oldCap >= DEFAULT_INITIAL_CAPACITY)
          newThr = oldThr << 1; // double threshold
  }
  else if (oldThr > 0) // åˆå§‹åŒ–çš„thresholdèµ‹å€¼ç»™newCap
      newCap = oldThr;
  else { 
      newCap = DEFAULT_INITIAL_CAPACITY;
      newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
  }
  ```

  HashMap åœ¨è¿›è¡Œæ‰©å®¹åï¼ŒèŠ‚ç‚¹**è¦ä¹ˆå°±åœ¨åŸæ¥çš„ä½ç½®ï¼Œè¦ä¹ˆå°±è¢«åˆ†é…åˆ°"åŸä½ç½®+æ—§å®¹é‡"çš„ä½ç½®**

  åˆ¤æ–­ï¼še.hash ä¸ oldCap å¯¹åº”çš„æœ‰æ•ˆé«˜ä½ä¸Šçš„å€¼æ˜¯ 1ï¼Œå³å½“å‰æ•°ç»„é•¿åº¦ n äºŒè¿›åˆ¶ä¸º 1 çš„ä½ä¸º x ä½ï¼Œå¦‚æœ key çš„å“ˆå¸Œå€¼ x ä½ä¹Ÿä¸º 1ï¼Œåˆ™æ‰©å®¹åçš„ç´¢å¼•ä¸º now + n

  æ³¨æ„ï¼šè¿™é‡Œè¦æ±‚**æ•°ç»„é•¿åº¦ 2 çš„å¹‚**

  ![](https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/HashMap-resizeæ‰©å®¹.png)

  æ™®é€šèŠ‚ç‚¹ï¼šæŠŠæ‰€æœ‰èŠ‚ç‚¹åˆ†æˆé«˜ä½ä½ä¸¤ä¸ªé“¾è¡¨ï¼Œè½¬ç§»åˆ°æ•°ç»„

  ```java
  // éå†æ‰€æœ‰çš„èŠ‚ç‚¹
  do {
      next = e.next;
      // oldCap æ—§æ•°ç»„å¤§å°ï¼Œ2 çš„ n æ¬¡å¹‚
      if ((e.hash & oldCap) == 0) {
          if (loTail == null)
              loHead = e;	//æŒ‡å‘ä½ä½é“¾è¡¨å¤´èŠ‚ç‚¹
          else
              loTail.next = e;
          loTail = e;		//æŒ‡å‘ä½ä½é“¾è¡¨å°¾èŠ‚ç‚¹
      }
      else {
          if (hiTail == null)
              hiHead = e;
          else
              hiTail.next = e;
          hiTail = e;
      }
  } while ((e = next) != null);
  
  if (loTail != null) {
      loTail.next = null;	// ä½ä½é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½åœ¨åŸå“ˆå¸Œè¡¨ä¸­æŒ‡å‘å…¶ä»–èŠ‚ç‚¹ï¼Œéœ€è¦æ–­å¼€
      newTab[j] = loHead;
  }
  ```

  çº¢é»‘æ ‘èŠ‚ç‚¹ï¼šæ‰©å®¹æ—¶ split æ–¹æ³•ä¼šå°†æ ‘**æ‹†æˆé«˜ä½å’Œä½ä½ä¸¤ä¸ªé“¾è¡¨**ï¼Œåˆ¤æ–­é•¿åº¦æ˜¯å¦å°äºç­‰äº 6

  ```java
  //å¦‚æœä½ä½é“¾è¡¨é¦–èŠ‚ç‚¹ä¸ä¸ºnullï¼Œè¯´æ˜æœ‰è¿™ä¸ªé“¾è¡¨å­˜åœ¨
  if (loHead != null) {
      //å¦‚æœé“¾è¡¨ä¸‹çš„å…ƒç´ å°äºç­‰äº6
      if (lc <= UNTREEIFY_THRESHOLD)
          //é‚£å°±ä»çº¢é»‘æ ‘è½¬é“¾è¡¨äº†ï¼Œä½ä½é“¾è¡¨ï¼Œè¿ç§»åˆ°æ–°æ•°ç»„ä¸­ä¸‹æ ‡ä¸å˜ï¼Œè¿˜æ˜¯ç­‰äºåŸæ•°ç»„åˆ°ä¸‹æ ‡
          tab[index] = loHead.untreeify(map);
      else {
          //ä½ä½é“¾è¡¨ï¼Œè¿ç§»åˆ°æ–°æ•°ç»„ä¸­ä¸‹æ ‡ä¸å˜ï¼ŒæŠŠä½ä½é“¾è¡¨æ•´ä¸ªèµ‹å€¼åˆ°è¿™ä¸ªä¸‹æ ‡ä¸‹
          tab[index] = loHead;
          //å¦‚æœé«˜ä½é¦–èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œè¯´æ˜åŸæ¥çš„çº¢é»‘æ ‘å·²ç»è¢«æ‹†åˆ†æˆä¸¤ä¸ªé“¾è¡¨äº†
          if (hiHead != null)
              //éœ€è¦æ„å»ºæ–°çš„çº¢é»‘æ ‘äº†
              loHead.treeify(tab);
      }
  }
  ```

â€‹	

* remove()ï¼šåˆ é™¤æ˜¯é¦–å…ˆå…ˆæ‰¾åˆ°å…ƒç´ çš„ä½ç½®ï¼Œå¦‚æœæ˜¯é“¾è¡¨å°±éå†é“¾è¡¨æ‰¾åˆ°å…ƒç´ ä¹‹ååˆ é™¤ã€‚å¦‚æœæ˜¯ç”¨çº¢é»‘æ ‘å°±éå†æ ‘ç„¶åæ‰¾åˆ°ä¹‹ååšåˆ é™¤ï¼Œæ ‘å°äº 6 çš„æ—¶å€™é€€åŒ–ä¸ºé“¾è¡¨
  
  ```java
   final Node<K,V> removeNode(int hash, Object key, Object value,
                              boolean matchValue, boolean movable) {
       Node<K,V>[] tab; Node<K,V> p; int n, index;
       // èŠ‚ç‚¹æ•°ç»„tabä¸ä¸ºç©ºã€æ•°ç»„é•¿åº¦nå¤§äº0ã€æ ¹æ®hashå®šä½åˆ°çš„èŠ‚ç‚¹å¯¹è±¡pï¼Œ
       // è¯¥èŠ‚ç‚¹ä¸ºæ ‘çš„æ ¹èŠ‚ç‚¹æˆ–é“¾è¡¨çš„é¦–èŠ‚ç‚¹ï¼‰ä¸ä¸ºç©ºï¼Œä»è¯¥èŠ‚ç‚¹på‘ä¸‹éå†ï¼Œæ‰¾åˆ°é‚£ä¸ªå’ŒkeyåŒ¹é…çš„èŠ‚ç‚¹å¯¹è±¡
       if ((tab = table) != null && (n = tab.length) > 0 &&
           (p = tab[index = (n - 1) & hash]) != null) {
           Node<K,V> node = null, e; K k; V v;//ä¸´æ—¶å˜é‡ï¼Œå‚¨å­˜è¦è¿”å›çš„èŠ‚ç‚¹ä¿¡æ¯
           //keyå’Œvalueéƒ½ç›¸ç­‰ï¼Œç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹
           if (p.hash == hash &&
               ((k = p.key) == key || (key != null && key.equals(k))))
               node = p;
           
           else if ((e = p.next) != null) {
               //å¦‚æœæ˜¯æ ‘èŠ‚ç‚¹ï¼Œè°ƒç”¨getTreeNodeæ–¹æ³•ä»æ ‘ç»“æ„ä¸­æŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹
               if (p instanceof TreeNode)
                   node = ((TreeNode<K,V>)p).getTreeNode(hash, key);
               //éå†é“¾è¡¨
               else {
                   do {
                       //eèŠ‚ç‚¹çš„é”®æ˜¯å¦å’Œkeyç›¸ç­‰ï¼ŒeèŠ‚ç‚¹å°±æ˜¯è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼Œèµ‹å€¼ç»™nodeå˜é‡
                       if (e.hash == hash &&
                           ((k = e.key) == key ||
                            (key != null && key.equals(k)))) {
                           node = e;
                           //è·³å‡ºå¾ªç¯
                           break;
                       }
                       p = e;//æŠŠå½“å‰èŠ‚ç‚¹pæŒ‡å‘e ç»§ç»­éå†
                   } while ((e = e.next) != null);
               }
           }
           //å¦‚æœnodeä¸ä¸ºç©ºï¼Œè¯´æ˜æ ¹æ®keyåŒ¹é…åˆ°äº†è¦åˆ é™¤çš„èŠ‚ç‚¹
           //å¦‚æœä¸éœ€è¦å¯¹æ¯”valueå€¼æˆ–è€…å¯¹æ¯”valueå€¼ä½†æ˜¯valueå€¼ä¹Ÿç›¸ç­‰ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤
           if (node != null && (!matchValue || (v = node.value) == value ||
                                (value != null && value.equals(v)))) {
               if (node instanceof TreeNode)
                   ((TreeNode<K,V>)node).removeTreeNode(this, tab, movable);
               else if (node == p)//nodeæ˜¯é¦–èŠ‚ç‚¹
                   tab[index] = node.next;
               else	//nodeä¸æ˜¯é¦–èŠ‚ç‚¹
                   p.next = node.next;
               ++modCount;
               --size;
               //LinkedHashMap
               afterNodeRemoval(node);
               return node;
           }
       }
       return null;
   }
  ```
  
  
  
* get()

  1. é€šè¿‡ hash å€¼è·å–è¯¥ key æ˜ å°„åˆ°çš„æ¡¶

  2. æ¡¶ä¸Šçš„ key å°±æ˜¯è¦æŸ¥æ‰¾çš„ keyï¼Œåˆ™ç›´æ¥æ‰¾åˆ°å¹¶è¿”å›

  3. æ¡¶ä¸Šçš„ key ä¸æ˜¯è¦æ‰¾çš„ keyï¼Œåˆ™æŸ¥çœ‹åç»­çš„èŠ‚ç‚¹ï¼š

     * å¦‚æœåç»­èŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œé€šè¿‡è°ƒç”¨çº¢é»‘æ ‘çš„æ–¹æ³•æ ¹æ® key è·å– value

     * å¦‚æœåç»­èŠ‚ç‚¹æ˜¯é“¾è¡¨èŠ‚ç‚¹ï¼Œåˆ™é€šè¿‡å¾ªç¯éå†é“¾è¡¨æ ¹æ® key è·å– value 

  4. çº¢é»‘æ ‘èŠ‚ç‚¹è°ƒç”¨çš„æ˜¯ getTreeNode æ–¹æ³•é€šè¿‡æ ‘å½¢èŠ‚ç‚¹çš„ find æ–¹æ³•è¿›è¡ŒæŸ¥

     * æŸ¥æ‰¾çº¢é»‘æ ‘ï¼Œä¹‹å‰æ·»åŠ æ—¶å·²ç»ä¿è¯è¿™ä¸ªæ ‘æ˜¯æœ‰åºçš„ï¼Œå› æ­¤æŸ¥æ‰¾æ—¶å°±æ˜¯æŠ˜åŠæŸ¥æ‰¾ï¼Œæ•ˆç‡æ›´é«˜ã€‚
     * è¿™é‡Œå’Œæ’å…¥æ—¶ä¸€æ ·ï¼Œå¦‚æœå¯¹æ¯”èŠ‚ç‚¹çš„å“ˆå¸Œå€¼ç›¸ç­‰å¹¶ä¸”é€šè¿‡ equals åˆ¤æ–­å€¼ä¹Ÿç›¸ç­‰ï¼Œå°±ä¼šåˆ¤æ–­ key ç›¸ç­‰ï¼Œç›´æ¥è¿”å›ï¼Œä¸ç›¸ç­‰å°±ä»å­æ ‘ä¸­é€’å½’æŸ¥æ‰¾

  5. æ—¶é—´å¤æ‚åº¦ O(1)

     * è‹¥ä¸ºæ ‘ï¼Œåˆ™åœ¨æ ‘ä¸­é€šè¿‡ key.equals(k) æŸ¥æ‰¾ï¼Œ**O(logn)** 
     * è‹¥ä¸ºé“¾è¡¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­é€šè¿‡ key.equals(k) æŸ¥æ‰¾ï¼Œ**O(n)**



****



##### å¹¶å‘å¼‚å¸¸

HashMap å’Œ ArrayList ä¸€æ ·ï¼Œå†…éƒ¨é‡‡ç”¨ modCount ç”¨æ¥è®°å½•é›†åˆç»“æ„å‘ç”Ÿå˜åŒ–çš„æ¬¡æ•°ï¼Œç»“æ„å‘ç”Ÿå˜åŒ–æ˜¯æŒ‡æ·»åŠ æˆ–è€…åˆ é™¤è‡³å°‘ä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰æ“ä½œï¼Œæˆ–è€…æ˜¯è°ƒæ•´å†…éƒ¨æ•°ç»„çš„å¤§å°ï¼Œä»…ä»…åªæ˜¯è®¾ç½®å…ƒç´ çš„å€¼ä¸ç®—ç»“æ„å‘ç”Ÿå˜åŒ–

åœ¨è¿›è¡Œåºåˆ—åŒ–æˆ–è€…è¿­ä»£ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ¯”è¾ƒæ“ä½œå‰å modCount æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœ**å…¶ä»–çº¿ç¨‹æ­¤æ—¶ä¿®æ”¹äº†é›†åˆå†…éƒ¨çš„ç»“æ„**ï¼Œå°±ä¼šç›´æ¥æŠ›å‡º ConcurrentModificationException å¼‚å¸¸

```java
HashMap map = new HashMap();
Iterator iterator = map.keySet().iterator();
```

```java
final class KeySet extends AbstractSet<K> {
    // åº•å±‚è·å–çš„æ˜¯ KeyIterator
	public final Iterator<K> iterator()     { 
        return new KeyIterator(); 
    }
}
final class KeyIterator extends HashIterator implements Iterator<K> {
    // å›è°ƒ HashMap.HashIterator#nextNode
    public final K next() { 
        return nextNode().key; 
    }
}
```

```java
abstract class HashIterator {
    Node<K,V> next;        // next entry to return
    Node<K,V> current;     // current entry
    int expectedModCount;  // for ã€fast-failã€‘ï¼Œå¿«é€Ÿå¤±è´¥
    int index;             // current slot

    HashIterator() {
        // æŠŠå½“å‰ map çš„æ•°é‡èµ‹å€¼ç»™ expectedModCountï¼Œè¿­ä»£æ—¶åˆ¤æ–­
        expectedModCount = modCount;
        Node<K,V>[] t = table;
        current = next = null;
        index = 0;
        if (t != null && size > 0) { // advance to first entry
            do {} while (index < t.length && (next = t[index++]) == null);
        }
    }

    public final boolean hasNext() {
        return next != null;
    }
	// iterator.next() ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°
    final Node<K,V> nextNode() {
        Node<K,V>[] t;
        Node<K,V> e = next;
        // è¿™é‡Œä¼šåˆ¤æ–­ é›†åˆçš„ç»“æ„æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå˜åŒ–å modCount ä¼šæ”¹å˜ï¼Œç›´æ¥æŠ›å‡ºå¹¶å‘å¼‚å¸¸
        if (modCount != expectedModCount)
            throw new ConcurrentModificationException();
        if (e == null)
            throw new NoSuchElementException();
        if ((next = (current = e).next) == null && (t = table) != null) {
            do {} while (index < t.length && (next = t[index++]) == null);
        }
        return e;
    }
	// è¿­ä»£å™¨å…è®¸åˆ é™¤é›†åˆçš„å…ƒç´ ï¼Œã€åˆ é™¤åä¼šé‡ç½® expectedModCount = modCountã€‘
    public final void remove() {
        Node<K,V> p = current;
        if (p == null)
            throw new IllegalStateException();
        if (modCount != expectedModCount)
            throw new ConcurrentModificationException();
        current = null;
        K key = p.key;
        removeNode(hash(key), key, null, false, false);
        // åŒæ­¥expectedModCount
        expectedModCount = modCount;
    }
}
```





***



#### LinkedMap

##### åŸç†åˆ†æ

LinkedHashMap æ˜¯ HashMap çš„å­ç±»

* ä¼˜ç‚¹ï¼šæ·»åŠ çš„å…ƒç´ æŒ‰ç…§é”®æœ‰åºä¸é‡å¤çš„ï¼Œæœ‰åºçš„åŸå› æ˜¯åº•å±‚ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨

* ç¼ºç‚¹ï¼šä¼šå ç”¨ä¸€äº›å†…å­˜ç©ºé—´

å¯¹æ¯” Setï¼š

* HashSet é›†åˆç›¸å½“äºæ˜¯ HashMap é›†åˆçš„é”®ï¼Œä¸å¸¦å€¼
* LinkedHashSet é›†åˆç›¸å½“äºæ˜¯ LinkedHashMap é›†åˆçš„é”®ï¼Œä¸å¸¦å€¼
* åº•å±‚åŸç†å®Œå…¨ä¸€æ ·ï¼Œéƒ½æ˜¯åŸºäºå“ˆå¸Œè¡¨æŒ‰ç…§é”®å­˜å‚¨æ•°æ®çš„ï¼Œåªæ˜¯ Map å¤šäº†ä¸€ä¸ªé”®çš„å€¼

æºç è§£æï¼š

* **å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨**ï¼Œç”¨æ¥ç»´æŠ¤æ’å…¥é¡ºåºæˆ–è€… LRU é¡ºåº

  ```java
  transient LinkedHashMap.Entry<K,V> head;
  transient LinkedHashMap.Entry<K,V> tail;
  ```

* accessOrder å†³å®šäº†é¡ºåºï¼Œé»˜è®¤ä¸º false ç»´æŠ¤çš„æ˜¯æ’å…¥é¡ºåºï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ï¼Œtrue ä¸ºè®¿é—®é¡ºåºï¼ˆ**LRU é¡ºåº**ï¼‰

  ```java
  final boolean accessOrder;
  ```

* ç»´æŠ¤é¡ºåºçš„å‡½æ•°

  ```java
  void afterNodeAccess(Node<K,V> p) {}
  void afterNodeInsertion(boolean evict) {}
  ```

* put()

  ```java
  // è°ƒç”¨çˆ¶ç±»HashMapçš„putæ–¹æ³•
  public V put(K key, V value) {
      return putVal(hash(key), key, value, false, true);
  }
  final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict)
  â†’ afterNodeInsertion(evict);// evictä¸ºtrue
  ```

  afterNodeInsertionæ–¹æ³•ï¼Œå½“ removeEldestEntry() æ–¹æ³•è¿”å› true æ—¶ä¼šç§»é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨é¦–éƒ¨èŠ‚ç‚¹ first

  ```java
  void afterNodeInsertion(boolean evict) {
      LinkedHashMap.Entry<K,V> first;
      // evict åªæœ‰åœ¨æ„å»º Map çš„æ—¶å€™æ‰ä¸º falseï¼Œè¿™é‡Œä¸º true
      if (evict && (first = head) != null && removeEldestEntry(first)) {
          K key = first.key;
          removeNode(hash(key), key, null, false, true);//ç§»é™¤å¤´èŠ‚ç‚¹
      }
  }
  ```

  removeEldestEntry() é»˜è®¤ä¸º falseï¼Œå¦‚æœéœ€è¦è®©å®ƒä¸º trueï¼Œéœ€è¦ç»§æ‰¿ LinkedHashMap å¹¶ä¸”è¦†ç›–è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼Œåœ¨å®ç° LRU çš„ç¼“å­˜ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œé€šè¿‡ç§»é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯ç¼“å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¹¶ä¸”ç¼“å­˜çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®

  ```java
  protected boolean removeEldestEntry(Map.Entry<K,V> eldest) {
      return false;
  }
  ```

* get()

  å½“ä¸€ä¸ªèŠ‚ç‚¹è¢«è®¿é—®æ—¶ï¼Œå¦‚æœ accessOrder ä¸º trueï¼Œåˆ™ä¼šå°†è¯¥èŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´æŒ‡å®šä¸º LRU é¡ºåºä¹‹åï¼Œåœ¨æ¯æ¬¡è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹æ—¶ä¼šå°†è¿™ä¸ªèŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ï¼Œé‚£ä¹ˆé“¾è¡¨é¦–éƒ¨å°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹

  ```java
  public V get(Object key) {
      Node<K,V> e;
      if ((e = getNode(hash(key), key)) == null)
          return null;
      if (accessOrder)
          afterNodeAccess(e);
      return e.value;
  }
  ```

  ```java
  void afterNodeAccess(Node<K,V> e) {
      LinkedHashMap.Entry<K,V> last;
      if (accessOrder && (last = tail) != e) {
          // å‘ä¸‹è½¬å‹
          LinkedHashMap.Entry<K,V> p =
              (LinkedHashMap.Entry<K,V>)e, b = p.before, a = p.after;
          p.after = null;
          // åˆ¤æ–­ p æ˜¯å¦æ˜¯é¦–èŠ‚ç‚¹
          if (b == null)
              //æ˜¯å¤´èŠ‚ç‚¹ è®©påç»§èŠ‚ç‚¹æˆä¸ºå¤´èŠ‚ç‚¹
              head = a;
          else
              //ä¸æ˜¯å¤´èŠ‚ç‚¹ è®©pçš„å‰é©±èŠ‚ç‚¹çš„nextæŒ‡å‘pçš„åç»§èŠ‚ç‚¹ï¼Œç»´æŠ¤é“¾è¡¨çš„è¿æ¥
              b.after = a;
          // åˆ¤æ–­pæ˜¯å¦æ˜¯å°¾èŠ‚ç‚¹
          if (a != null)
              // ä¸æ˜¯å°¾èŠ‚ç‚¹ è®©påç»§èŠ‚ç‚¹æŒ‡å‘pçš„å‰é©±èŠ‚ç‚¹
              a.before = b;
          else
              // æ˜¯å°¾èŠ‚ç‚¹ è®©lastæŒ‡å‘pçš„å‰é©±èŠ‚ç‚¹
              last = b;
          // åˆ¤æ–­lastæ˜¯å¦æ˜¯ç©º
          if (last == null)
              // lastä¸ºç©ºè¯´æ˜pæ˜¯å°¾èŠ‚ç‚¹æˆ–è€…åªæœ‰pä¸€ä¸ªèŠ‚ç‚¹
              head = p;
          else {
              // lastå’Œpç›¸äº’è¿æ¥
              p.before = last;
              last.after = p;
          }
          tail = p;
          ++modCount;
      }
  }
  ```

* remove()
  
  ```java
  //è°ƒç”¨HashMapçš„removeæ–¹æ³•
  final Node<K,V> removeNode(int hash, Object key, Object value,boolean matchValue, boolean movable)
  â†’ afterNodeRemoval(node);
  ```
  
  å½“ HashMap åˆ é™¤ä¸€ä¸ªé”®å€¼å¯¹æ—¶è°ƒç”¨ï¼Œä¼šæŠŠåœ¨ HashMap ä¸­åˆ é™¤çš„é‚£ä¸ªé”®å€¼å¯¹ä¸€å¹¶ä»é“¾è¡¨ä¸­åˆ é™¤
  
  ```java
  void afterNodeRemoval(Node<K,V> e) {
      LinkedHashMap.Entry<K,V> p =
          (LinkedHashMap.Entry<K,V>)e, b = p.before, a = p.after;
      // è®©pèŠ‚ç‚¹ä¸å‰é©±èŠ‚ç‚¹å’Œåç»§èŠ‚ç‚¹æ–­å¼€é“¾æ¥
      p.before = p.after = null;
      // åˆ¤æ–­pæ˜¯å¦æ˜¯å¤´èŠ‚ç‚¹
      if (b == null)
          // pæ˜¯å¤´èŠ‚ç‚¹ è®©headæŒ‡å‘pçš„åç»§èŠ‚ç‚¹
          head = a;
      else
          // pä¸æ˜¯å¤´èŠ‚ç‚¹ è®©pçš„å‰é©±èŠ‚ç‚¹çš„nextæŒ‡å‘pçš„åç»§èŠ‚ç‚¹ï¼Œç»´æŠ¤é“¾è¡¨çš„è¿æ¥
          b.after = a;
      // åˆ¤æ–­pæ˜¯å¦æ˜¯å°¾èŠ‚ç‚¹ï¼Œæ˜¯å°±è®©tailæŒ‡å‘pçš„å‰é©±èŠ‚ç‚¹ï¼Œä¸æ˜¯å°±è®©p.afteræŒ‡å‘å‰é©±èŠ‚ç‚¹ï¼ŒåŒå‘
      if (a == null)
          tail = b;
      else
          a.before = b;
  }
  ```



***



##### LRU

ä½¿ç”¨ LinkedHashMap å®ç°çš„ä¸€ä¸ª LRU ç¼“å­˜ï¼š

- è®¾å®šæœ€å¤§ç¼“å­˜ç©ºé—´ MAX_ENTRIES ä¸º 3
- ä½¿ç”¨ LinkedHashMap çš„æ„é€ å‡½æ•°å°† accessOrder è®¾ç½®ä¸º trueï¼Œå¼€å¯ LRU é¡ºåº
- è¦†ç›– removeEldestEntry() æ–¹æ³•å®ç°ï¼Œåœ¨èŠ‚ç‚¹å¤šäº MAX_ENTRIES å°±ä¼šå°†æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ç§»é™¤

```java
public static void main(String[] args) {
    LRUCache<Integer, String> cache = new LRUCache<>();
    cache.put(1, "a");
    cache.put(2, "b");
    cache.put(3, "c");
    cache.get(1);//æŠŠ1æ”¾å…¥å°¾éƒ¨
    cache.put(4, "d");
    System.out.println(cache.keySet());//[3, 1, 4]åªèƒ½å­˜3ä¸ªï¼Œç§»é™¤2
}

class LRUCache<K, V> extends LinkedHashMap<K, V> {
    private static final int MAX_ENTRIES = 3;

    protected boolean removeEldestEntry(Map.Entry eldest) {
        return size() > MAX_ENTRIES;
    }

    LRUCache() {
        super(MAX_ENTRIES, 0.75f, true);
    }
}
```



***



#### TreeMap

TreeMap å®ç°äº† SotredMap æ¥å£ï¼Œæ˜¯æœ‰åºä¸å¯é‡å¤çš„é”®å€¼å¯¹é›†åˆï¼ŒåŸºäºçº¢é»‘æ ‘ï¼ˆRed-Black treeï¼‰å®ç°ï¼Œæ¯ä¸ª key-value éƒ½ä½œä¸ºä¸€ä¸ªçº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ„é€  TreeMap æ²¡æœ‰æŒ‡å®šæ¯”è¾ƒå™¨ï¼Œåˆ™æ ¹æ® key æ‰§è¡Œè‡ªç„¶æ’åºï¼ˆé»˜è®¤å‡åºï¼‰ï¼Œå¦‚æœæŒ‡å®šäº†æ¯”è¾ƒå™¨åˆ™æŒ‰ç…§æ¯”è¾ƒå™¨æ¥è¿›è¡Œæ’åº

TreeMap é›†åˆæŒ‡å®šå¤§å°è§„åˆ™æœ‰ 2 ç§æ–¹å¼ï¼š

* ç›´æ¥ä¸ºå¯¹è±¡çš„ç±»å®ç°æ¯”è¾ƒå™¨è§„åˆ™æ¥å£ Comparableï¼Œé‡å†™æ¯”è¾ƒæ–¹æ³•
* ç›´æ¥ä¸ºé›†åˆè®¾ç½®æ¯”è¾ƒå™¨ Comparator å¯¹è±¡ï¼Œé‡å†™æ¯”è¾ƒæ–¹æ³•

è¯´æ˜ï¼šTreeSet é›†åˆçš„åº•å±‚æ˜¯åŸºäº TreeMapï¼Œåªæ˜¯é”®çš„é™„å±å€¼ä¸ºç©ºå¯¹è±¡è€Œå·²

æˆå‘˜å±æ€§ï¼š

* Entry èŠ‚ç‚¹

  ```java
   static final class Entry<K,V> implements Map.Entry<K,V> {
       K key;
       V value;
       Entry<K,V> left;		//å·¦å­©å­èŠ‚ç‚¹
       Entry<K,V> right;		//å³å­©å­èŠ‚ç‚¹
       Entry<K,V> parent;		//çˆ¶èŠ‚ç‚¹
       boolean color = BLACK;	//èŠ‚ç‚¹çš„é¢œè‰²ï¼Œåœ¨çº¢é»‘æ ‘ä¸­åªæœ‰ä¸¤ç§é¢œè‰²ï¼Œçº¢è‰²å’Œé»‘è‰²
   }
  ```

* compare()

  ```java
  //å¦‚æœcomparatorä¸ºnullï¼Œé‡‡ç”¨comparable.compartToè¿›è¡Œæ¯”è¾ƒï¼Œå¦åˆ™é‡‡ç”¨æŒ‡å®šæ¯”è¾ƒå™¨æ¯”è¾ƒå¤§å°
  final int compare(Object k1, Object k2) {
      return comparator == null ? ((Comparable<? super K>)k1).compareTo((K)k2)
          : comparator.compare((K)k1, (K)k2);
  }
  ```



å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/weixin_33991727/article/details/91518677



***



#### WeakMap

WeakHashMap æ˜¯åŸºäºå¼±å¼•ç”¨çš„ï¼Œå†…éƒ¨çš„ Entry ç»§æ‰¿ WeakReferenceï¼Œè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åœ¨**ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶ä¼šè¢«å›æ”¶**ï¼Œå¹¶ä¸”æ„é€ æ–¹æ³•ä¼ å…¥å¼•ç”¨é˜Ÿåˆ—ï¼Œç”¨æ¥åœ¨æ¸…ç†å¯¹è±¡å®Œæˆä»¥åæ¸…ç†å¼•ç”¨

```java
private static class Entry<K,V> extends WeakReference<Object> implements Map.Entry<K,V> {
    Entry(Object key, V value, ReferenceQueue<Object> queue, int hash, Entry<K,V> next) {
        super(key, queue);
        this.value = value;
        this.hash  = hash;
        this.next  = next;
    }
}
```

WeakHashMap ä¸»è¦ç”¨æ¥å®ç°ç¼“å­˜ï¼Œä½¿ç”¨ WeakHashMap æ¥å¼•ç”¨ç¼“å­˜å¯¹è±¡ï¼Œç”± JVM å¯¹è¿™éƒ¨åˆ†ç¼“å­˜è¿›è¡Œå›æ”¶

Tomcat ä¸­çš„ ConcurrentCache ä½¿ç”¨äº† WeakHashMap æ¥å®ç°ç¼“å­˜åŠŸèƒ½ï¼ŒConcurrentCache é‡‡å–åˆ†ä»£ç¼“å­˜ï¼š

* ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡æ”¾å…¥ eden ä¸­ï¼Œeden ä½¿ç”¨ ConcurrentHashMap å®ç°ï¼Œä¸ç”¨æ‹…å¿ƒä¼šè¢«å›æ”¶ï¼ˆä¼Šç”¸å›­ï¼‰

* ä¸å¸¸ç”¨çš„å¯¹è±¡æ”¾å…¥ longtermï¼Œlongterm ä½¿ç”¨ WeakHashMap å®ç°ï¼Œè¿™äº›è€å¯¹è±¡ä¼šè¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶

* å½“è°ƒç”¨ get() æ–¹æ³•æ—¶ï¼Œä¼šå…ˆä» eden åŒºè·å–ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯å†åˆ° longterm è·å–ï¼Œå½“ä» longterm è·å–åˆ°å°±æŠŠå¯¹è±¡æ”¾å…¥ eden ä¸­ï¼Œä»è€Œä¿è¯ç»å¸¸è¢«è®¿é—®çš„èŠ‚ç‚¹ä¸å®¹æ˜“è¢«å›æ”¶

* å½“è°ƒç”¨ put() æ–¹æ³•æ—¶ï¼Œå¦‚æœ eden çš„å¤§å°è¶…è¿‡äº† sizeï¼Œé‚£ä¹ˆå°±å°† eden ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ”¾å…¥ longterm ä¸­ï¼Œåˆ©ç”¨è™šæ‹Ÿæœºå›æ”¶æ‰ä¸€éƒ¨åˆ†ä¸ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡

  ```java
  public final class ConcurrentCache<K, V> {
      private final int size;
      private final Map<K, V> eden;
      private final Map<K, V> longterm;
  
      public ConcurrentCache(int size) {
          this.size = size;
          this.eden = new ConcurrentHashMap<>(size);
          this.longterm = new WeakHashMap<>(size);
      }
  
      public V get(K k) {
          V v = this.eden.get(k);
          if (v == null) {
              v = this.longterm.get(k);
              if (v != null)
                  this.eden.put(k, v);
          }
          return v;
      }
  
      public void put(K k, V v) {
          if (this.eden.size() >= size) {
              this.longterm.putAll(this.eden);
              this.eden.clear();
          }
          this.eden.put(k, v);
      }
  }





***



### æ³›å‹

#### æ¦‚è¿°

æ³›å‹ï¼ˆGenericï¼‰ï¼š

* æ³›å‹å°±æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼š<æ•°æ®ç±»å‹>
* æ³›å‹å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µçº¦æŸåªèƒ½æ“ä½œæŸç§æ•°æ®ç±»å‹ã€‚

æ³¨æ„ï¼š

* JDK 1.7 å¼€å§‹ä¹‹åï¼Œæ³›å‹åé¢çš„ç”³æ˜å¯ä»¥çœç•¥ä¸å†™
* **æ³›å‹å’Œé›†åˆéƒ½åªèƒ½æ”¯æŒå¼•ç”¨æ•°æ®ç±»å‹ï¼Œä¸æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹**

```java
ArrayList<Object> lists = new ArrayList<>(); 
lists.add(99.9);
lists.add('a');
lists.add("Java");
ArrayList<Integer> list = new ArrayList<>();
lists1.add(10);
lists1.add(20);
```

ä¼˜ç‚¹ï¼šæ³›å‹åœ¨ç¼–è¯‘é˜¶æ®µçº¦æŸäº†æ“ä½œçš„æ•°æ®ç±»å‹ï¼Œä»è€Œä¸ä¼šå‡ºç°ç±»å‹è½¬æ¢å¼‚å¸¸ï¼Œä½“ç°çš„æ˜¯ Java çš„ä¸¥è°¨æ€§å’Œè§„èŒƒæ€§



****



#### è‡ªå®šä¹‰

##### æ³›å‹ç±»

æ³›å‹ç±»ï¼šä½¿ç”¨äº†æ³›å‹å®šä¹‰çš„ç±»å°±æ˜¯æ³›å‹ç±»

æ³›å‹ç±»æ ¼å¼ï¼š

```java
ä¿®é¥°ç¬¦ class ç±»å<æ³›å‹å˜é‡>{

}
æ³›å‹å˜é‡å»ºè®®ä½¿ç”¨ E , T , K , V
```

```java
public class GenericDemo {
    public static void main(String[] args) {
        MyArrayList<String> list = new MyArrayList<String>();
        MyArrayList<Integer> list1 = new MyArrayList<Integer>();
        list.add("è‡ªå®šä¹‰æ³›å‹ç±»");
    }
}
class MyArrayList<E>{
	public void add(E e){}
    public void remove(E e){}
}
```



****



##### æ³›å‹æ–¹æ³•

æ³›å‹æ–¹æ³•ï¼šå®šä¹‰äº†æ³›å‹çš„æ–¹æ³•å°±æ˜¯æ³›å‹æ–¹æ³•

æ³›å‹æ–¹æ³•çš„å®šä¹‰æ ¼å¼ï¼š

```java
ä¿®é¥°ç¬¦ <æ³›å‹å˜é‡> è¿”å›å€¼ç±»å‹ æ–¹æ³•åç§°(å½¢å‚åˆ—è¡¨){

}
```

æ–¹æ³•å®šä¹‰äº†æ˜¯ä»€ä¹ˆæ³›å‹å˜é‡ï¼Œåé¢å°±åªèƒ½ç”¨ä»€ä¹ˆæ³›å‹å˜é‡ã€‚

æ³›å‹ç±»çš„æ ¸å¿ƒæ€æƒ³ï¼šæŠŠå‡ºç°æ³›å‹å˜é‡çš„åœ°æ–¹å…¨éƒ¨æ›¿æ¢æˆä¼ è¾“çš„çœŸå®æ•°æ®ç±»å‹

```java
public class GenericDemo {
    public static void main(String[] args) {
        Integer[] num = {10 , 20 , 30 , 40 , 50};
        String s1 = arrToString(nums);
     
        String[] name = {"å¼ ä¸‰","æå››","ç‹äº”"};
        String s2 = arrToString(names);
    }

    public static <T> String arrToString(T[] arr){
        --------------
    }
}
```



è‡ªå®šä¹‰æ³›å‹æ¥å£

æ³›å‹æ¥å£ï¼šä½¿ç”¨äº†æ³›å‹å®šä¹‰çš„æ¥å£å°±æ˜¯æ³›å‹æ¥å£ã€‚

æ³›å‹æ¥å£çš„æ ¼å¼ï¼š

```java
ä¿®é¥°ç¬¦ interface æ¥å£åç§°<æ³›å‹å˜é‡>{

}
```

```java
public class GenericDemo {
    public static void main(String[] args) {
        Data d = new StudentData();
        d.add(new Student());
        ................
    }
}

public interface Data<E>{
    void add(E e);
    void delete(E e);
    void update(E e);
    E query(int index);
}
class Student{}
class StudentData implements Data<Student>{é‡å†™æ‰€æœ‰æ–¹æ³•}
```



****



#### é€šé…ç¬¦

é€šé…ç¬¦ï¼šï¼Ÿ

* ? å¯ä»¥ç”¨åœ¨ä½¿ç”¨æ³›å‹çš„æ—¶å€™ä»£è¡¨ä¸€åˆ‡ç±»å‹
* Eã€Tã€Kã€V æ˜¯åœ¨å®šä¹‰æ³›å‹çš„æ—¶å€™ä½¿ç”¨ä»£è¡¨ä¸€åˆ‡ç±»å‹

æ³›å‹çš„ä¸Šä¸‹é™ï¼š

* ? extends Carï¼šé‚£ä¹ˆ ? å¿…é¡»æ˜¯ Car æˆ–è€…å…¶å­ç±»ï¼ˆæ³›å‹çš„ä¸Šé™ï¼‰
* ? super  Carï¼šé‚£ä¹ˆ ? å¿…é¡»æ˜¯ Car æˆ–è€…å…¶çˆ¶ç±»ï¼ˆæ³›å‹çš„ä¸‹é™ï¼Œä¸æ˜¯å¾ˆå¸¸è§ï¼‰

```java
//éœ€æ±‚ï¼šå¼€å‘ä¸€ä¸ªæå“é£è½¦çš„æ¸¸æˆï¼Œæ‰€æœ‰çš„æ±½è½¦éƒ½èƒ½ä¸€èµ·å‚ä¸æ¯”èµ›ã€‚
public class GenericDemo {
    public static void main(String[] args) {
        ArrayList<BMW> bmws = new ArrayList<>();
        ArrayList<AD> ads = new ArrayList<>();
        ArrayList<Dog> dogs = new ArrayList<>();
        run(bmws);
        //run(dogs);
    }
    //public static void run(ArrayList<?> car){}//è¿™æ · douå¯¹è±¡ä¹Ÿèƒ½è¿›å…¥
    public static void run(ArrayList<? extends Car> car){}
}

class Car{}
class BMW extends Car{}
class AD extends Car{}
class Dog{}
```





***





## å¼‚å¸¸

### åŸºæœ¬ä»‹ç»

å¼‚å¸¸ï¼šç¨‹åºåœ¨ç¼–è¯‘æˆ–è€…æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼ŒJava ä¸ºå¸¸è§çš„ä»£ç å¼‚å¸¸éƒ½è®¾è®¡ä¸€ä¸ªç±»æ¥ä»£è¡¨

é”™è¯¯ï¼šError ï¼Œç¨‹åºå‘˜æ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œåªèƒ½é‡å¯ç³»ç»Ÿï¼Œæ¯”å¦‚å†…å­˜å¥”æºƒï¼ŒJVM æœ¬èº«çš„å¥”æºƒ

Java ä¸­å¼‚å¸¸ç»§æ‰¿çš„æ ¹ç±»æ˜¯ï¼šThrowable

```
å¼‚å¸¸çš„ä½“ç³»:
         Throwable(æ ¹ç±»ï¼Œä¸æ˜¯å¼‚å¸¸ç±»)
      /              \
    Error           Exceptionï¼ˆå¼‚å¸¸ï¼Œéœ€è¦ç ”ç©¶å’Œå¤„ç†ï¼‰
                    /            \
                   ç¼–è¯‘æ—¶å¼‚å¸¸     RuntimeException(è¿è¡Œæ—¶å¼‚å¸¸)
```

Exception å¼‚å¸¸çš„åˆ†ç±»:

* ç¼–è¯‘æ—¶å¼‚å¸¸ï¼šç»§æ‰¿è‡ª Exception çš„å¼‚å¸¸æˆ–è€…å…¶å­ç±»ï¼Œç¼–è¯‘é˜¶æ®µå°±ä¼šæŠ¥é”™
* è¿è¡Œæ—¶å¼‚å¸¸ï¼šç»§æ‰¿è‡ª RuntimeException çš„å¼‚å¸¸æˆ–è€…å…¶å­ç±»ï¼Œç¼–è¯‘é˜¶æ®µæ˜¯ä¸ä¼šå‡ºé”™çš„ï¼Œåœ¨è¿è¡Œé˜¶æ®µå‡ºé”™



***



### å¤„ç†è¿‡ç¨‹

å¼‚å¸¸çš„äº§ç”Ÿé»˜è®¤çš„å¤„ç†è¿‡ç¨‹è§£æï¼šï¼ˆè‡ªåŠ¨å¤„ç†çš„è¿‡ç¨‹ï¼‰

1. é»˜è®¤ä¼šåœ¨å‡ºç°å¼‚å¸¸çš„ä»£ç é‚£é‡Œè‡ªåŠ¨çš„åˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼šArithmeticExceptionï¼ˆç®—æœ¯å¼‚å¸¸ï¼‰
2. å¼‚å¸¸ä¼šä»æ–¹æ³•ä¸­å‡ºç°çš„ç‚¹è¿™é‡ŒæŠ›å‡ºç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…æœ€ç»ˆæŠ›å‡ºç»™ JVM è™šæ‹Ÿæœº
3. è™šæ‹Ÿæœºæ¥æ”¶åˆ°å¼‚å¸¸å¯¹è±¡åï¼Œå…ˆåœ¨æ§åˆ¶å°ç›´æ¥è¾“å‡º**å¼‚å¸¸æ ˆ**ä¿¡æ¯æ•°æ®
4. ç›´æ¥ä»å½“å‰æ‰§è¡Œçš„å¼‚å¸¸ç‚¹ç»ˆæ­¢å½“å‰ç¨‹åº
5. åç»­ä»£ç æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ï¼Œå› ä¸ºç¨‹åºå·²ç»æ­»äº¡

```java
public class ExceptionDemo {
    public static void main(String[] args) {
        System.out.println("ç¨‹åºå¼€å§‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚");
        chu( 10 ,0 );
        System.out.println("ç¨‹åºç»“æŸã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚");//ä¸æ‰§è¡Œ
    }
    public static void chu(int a , int b){
        int c = a / b ;// å‡ºç°äº†è¿è¡Œæ—¶å¼‚å¸¸,è‡ªåŠ¨åˆ›å»ºå¼‚å¸¸å¯¹è±¡ï¼šArithmeticException
        System.out.println("ç»“æœæ˜¯ï¼š"+c);
    }
}
```



***



### ç¼–è¯‘å¼‚å¸¸

#### åŸºæœ¬ä»‹ç»

ç¼–è¯‘æ—¶å¼‚å¸¸ï¼šç»§æ‰¿è‡ª Exception çš„å¼‚å¸¸æˆ–è€…å…¶å­ç±»ï¼Œæ²¡æœ‰ç»§æ‰¿ RuntimeExceptionï¼Œç¼–è¯‘æ—¶å¼‚å¸¸æ˜¯ç¼–è¯‘é˜¶æ®µå°±ä¼šæŠ¥é”™

ç¼–è¯‘æ—¶å¼‚å¸¸çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼šåœ¨ç¼–è¯‘é˜¶æ®µå°±çˆ†å‡ºä¸€ä¸ªé”™è¯¯ï¼Œç›®çš„åœ¨äºæé†’ï¼Œè¯·æ£€æŸ¥å¹¶æ³¨æ„ä¸è¦å‡º BUG

```java
public static void main(String[] args) throws ParseException {
	String date = "2015-01-12 10:23:21";
	SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
	Date d = sdf.parse(date);
	System.out.println(d);
}
```



****



#### å¤„ç†æœºåˆ¶

##### throws

åœ¨å‡ºç°ç¼–è¯‘æ—¶å¼‚å¸¸çš„åœ°æ–¹å±‚å±‚æŠŠå¼‚å¸¸æŠ›å‡ºå»ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…æœ€ç»ˆæŠ›å‡ºç»™ JVM è™šæ‹Ÿæœºï¼ŒJVM è™šæ‹Ÿæœºè¾“å‡ºå¼‚å¸¸ä¿¡æ¯ï¼Œç›´æ¥ç»ˆæ­¢æ‰ç¨‹åºï¼Œè¿™ç§æ–¹å¼ä¸é»˜è®¤æ–¹å¼æ˜¯ä¸€æ ·çš„

**Exception æ˜¯å¼‚å¸¸æœ€é«˜ç±»å‹å¯ä»¥æŠ›å‡ºä¸€åˆ‡å¼‚å¸¸**

```java
public static void main(String[] args) throws Exception {
    System.out.println("ç¨‹åºå¼€å§‹ã€‚ã€‚ã€‚ã€‚");
    String s = "2013-03-23 10:19:23";
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    Date date = sdf.parse(s);
    System.out.println("ç¨‹åºç»“æŸã€‚ã€‚ã€‚ã€‚ã€‚");
}
```



***



##### try/catch

å¯ä»¥å¤„ç†å¼‚å¸¸ï¼Œå¹¶ä¸”å‡ºç°å¼‚å¸¸åä»£ç ä¹Ÿä¸ä¼šæ­»äº¡

* æ•è·å¼‚å¸¸å’Œå¤„ç†å¼‚å¸¸çš„æ ¼å¼ï¼š**æ•è·å¤„ç†**

  ```java
  try{
    // ç›‘è§†å¯èƒ½å‡ºç°å¼‚å¸¸çš„ä»£ç ï¼
  }catch(å¼‚å¸¸ç±»å‹1 å˜é‡){
    // å¤„ç†å¼‚å¸¸
  }catch(å¼‚å¸¸ç±»å‹2 å˜é‡){
    // å¤„ç†å¼‚å¸¸
  }...finall{
  //èµ„æºé‡Šæ”¾
  }
  ```

* ç›‘è§†æ•è·å¤„ç†å¼‚å¸¸å†™æ³•ï¼šException å¯ä»¥æ•è·å¤„ç†ä¸€åˆ‡å¼‚å¸¸ç±»å‹
  
  ```java
  try{
      // å¯èƒ½å‡ºç°å¼‚å¸¸çš„ä»£ç ï¼
  }catch (Exception e){
      e.printStackTrace(); // **ç›´æ¥æ‰“å°å¼‚å¸¸æ ˆä¿¡æ¯**
  }
  ```

**Throwableæˆå‘˜æ–¹æ³•:**

* `public String getMessage()`ï¼šè¿”å›æ­¤ throwable çš„è¯¦ç»†æ¶ˆæ¯å­—ç¬¦ä¸²
* `public String toString()`ï¼šè¿”å›æ­¤å¯æŠ›å‡ºçš„ç®€çŸ­æè¿°
* `public void printStackTrace()`ï¼šæŠŠå¼‚å¸¸çš„é”™è¯¯ä¿¡æ¯è¾“å‡ºåœ¨æ§åˆ¶å°

```java
public static void main(String[] args) {
    System.out.println("ç¨‹åºå¼€å§‹ã€‚ã€‚ã€‚ã€‚");
    try {
        String s = "2013-03-23 10:19:23";
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        Date date = sdf.parse(s);
        InputStream is = new FileInputStream("D:/meinv.png");
    } catch (Exception e) {
        e.printStackTrace();
    }
    System.out.println("ç¨‹åºç»“æŸã€‚ã€‚ã€‚ã€‚ã€‚");
}
```



***



##### è§„èŒƒåšæ³•

åœ¨å‡ºç°å¼‚å¸¸çš„åœ°æ–¹æŠŠå¼‚å¸¸ä¸€å±‚ä¸€å±‚çš„æŠ›å‡ºç»™æœ€å¤–å±‚è°ƒç”¨è€…ï¼Œæœ€å¤–å±‚è°ƒç”¨è€…é›†ä¸­æ•è·å¤„ç†

```java
public class ExceptionDemo{
	public static void main(String[] args){
        System.out.println("ç¨‹åºå¼€å§‹ã€‚ã€‚ã€‚ã€‚");
        try {
            parseDate("2013-03-23 10:19:23");
        }catch (Exception e){
            e.printStackTrace();
        }
        System.out.println("ç¨‹åºç»“æŸã€‚ã€‚ã€‚ã€‚");
    }
    public static void parseDate(String time) throws Exception{...}
}
```



***



### è¿è¡Œå¼‚å¸¸

#### åŸºæœ¬ä»‹ç»

ç»§æ‰¿è‡ª RuntimeException çš„å¼‚å¸¸æˆ–è€…å…¶å­ç±»ï¼Œç¼–è¯‘é˜¶æ®µæ˜¯ä¸ä¼šå‡ºé”™çš„ï¼Œæ˜¯åœ¨è¿è¡Œæ—¶é˜¶æ®µå¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œè¿è¡Œæ—¶å¼‚å¸¸ç¼–è¯‘é˜¶æ®µå¯ä»¥å¤„ç†ä¹Ÿå¯ä»¥ä¸å¤„ç†ï¼Œä»£ç ç¼–è¯‘éƒ½èƒ½é€šè¿‡

**å¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸**ï¼š

1. æ•°ç»„ç´¢å¼•è¶Šç•Œå¼‚å¸¸ï¼šArrayIndexOutOfBoundsException
2. ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼šNullPointerExceptionï¼Œç›´æ¥è¾“å‡ºæ²¡é—®é¢˜ï¼Œè°ƒç”¨ç©ºæŒ‡é’ˆçš„å˜é‡çš„åŠŸèƒ½å°±ä¼šæŠ¥é”™
3. ç±»å‹è½¬æ¢å¼‚å¸¸ï¼šClassCastException
4. è¿­ä»£å™¨éå†æ²¡æœ‰æ­¤å…ƒç´ å¼‚å¸¸ï¼šNoSuchElementException
5. ç®—æœ¯å¼‚å¸¸ï¼ˆæ•°å­¦æ“ä½œå¼‚å¸¸ï¼‰ï¼šArithmeticException
6. æ•°å­—è½¬æ¢å¼‚å¸¸ï¼šNumberFormatException

```java
public class ExceptionDemo {
    public static void main(String[] args) {
        System.out.println("ç¨‹åºå¼€å§‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚");
        // 1.æ•°ç»„ç´¢å¼•è¶Šç•Œå¼‚å¸¸: ArrayIndexOutOfBoundsExceptionã€‚
        int[] arrs = {10 ,20 ,30};
        System.out.println(arrs[3]); //å‡ºç°äº†æ•°ç»„ç´¢å¼•è¶Šç•Œå¼‚å¸¸ã€‚ä»£ç åœ¨æ­¤å¤„ç›´æ¥æ‰§è¡Œæ­»äº¡ï¼

        // 2.ç©ºæŒ‡é’ˆå¼‚å¸¸ : NullPointerExceptionã€‚
        String name = null ;
        System.out.println(name); // ç›´æ¥è¾“å‡ºæ²¡æœ‰é—®é¢˜
        System.out.println(name.length());//å‡ºç°äº†ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ä»£ç ç›´æ¥æ‰§è¡Œæ­»äº¡ï¼

        /** 3.ç±»å‹è½¬æ¢å¼‚å¸¸ï¼šClassCastExceptionã€‚ */
        Object o = "é½å¤©å¤§åœ£";
        Integer s = (Integer) o;  // æ­¤å¤„å‡ºç°äº†ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚ä»£ç åœ¨æ­¤å¤„ç›´æ¥æ‰§è¡Œæ­»äº¡ï¼

        /** 5.æ•°å­¦æ“ä½œå¼‚å¸¸ï¼šArithmeticExceptionã€‚ */
        int c = 10 / 0 ; // æ­¤å¤„å‡ºç°äº†æ•°å­¦æ“ä½œå¼‚å¸¸ã€‚ä»£ç åœ¨æ­¤å¤„ç›´æ¥æ‰§è¡Œæ­»äº¡ï¼

        /** 6.æ•°å­—è½¬æ¢å¼‚å¸¸ï¼š NumberFormatExceptionã€‚ */
        String num = "23aa";
        Integer it = Integer.valueOf(num); //å‡ºç°äº†æ•°å­—è½¬æ¢å¼‚å¸¸ã€‚ä»£ç åœ¨æ­¤å¤„æ‰§è¡Œæ­»äº¡ï¼

        System.out.println("ç¨‹åºç»“æŸã€‚ã€‚ã€‚ã€‚ã€‚ã€‚");
    }
}
```



****



#### å¤„ç†æœºåˆ¶

è¿è¡Œæ—¶å¼‚å¸¸åœ¨ç¼–è¯‘é˜¶æ®µæ˜¯ä¸ä¼šæŠ¥é”™ï¼Œåœ¨è¿è¡Œé˜¶æ®µæ‰ä¼šå‡ºé”™ï¼Œè¿è¡Œæ—¶å‡ºé”™äº†ç¨‹åºè¿˜æ˜¯ä¼šåœæ­¢ï¼Œè¿è¡Œæ—¶å¼‚å¸¸ä¹Ÿå»ºè®®è¦å¤„ç†ï¼Œè¿è¡Œæ—¶å¼‚å¸¸æ˜¯è‡ªåŠ¨å¾€å¤–æŠ›å‡ºçš„ï¼Œä¸éœ€è¦æ‰‹å·¥æŠ›å‡º

**è¿è¡Œæ—¶å¼‚å¸¸çš„å¤„ç†è§„èŒƒ**ï¼šç›´æ¥åœ¨æœ€å¤–å±‚æ•è·å¤„ç†å³å¯ï¼Œåº•å±‚ä¼šè‡ªåŠ¨æŠ›å‡º

```java
public class ExceptionDemo{
    public static void main(String[] args){
        System.out.println("ç¨‹åºå¼€å§‹ã€‚ã€‚ã€‚ã€‚");
        try{
            chu(10 / 0);//ArithmeticException: / by zero
            System.out.println("æ“ä½œæˆåŠŸï¼");//æ²¡è¾“å‡º
        }catch (Exception e){
            e.printStackTrace();
            System.out.println("æ“ä½œå¤±è´¥ï¼");//è¾“å‡ºäº†
        }
        System.out.println("ç¨‹åºç»“æŸã€‚ã€‚ã€‚ã€‚");//è¾“å‡ºäº†
    }
    
    public static void chu(int a , int b)  { System.out.println( a / b );}
}
```



***



### Finally

ç”¨åœ¨æ•è·å¤„ç†çš„å¼‚å¸¸æ ¼å¼ä¸­çš„ï¼Œæ”¾åœ¨æœ€åé¢

```java
try{
    // å¯èƒ½å‡ºç°å¼‚å¸¸çš„ä»£ç ï¼
}catch(Exception e){
    e.printStackTrace();
}finally{
    // æ— è®ºä»£ç æ˜¯å‡ºç°å¼‚å¸¸è¿˜æ˜¯æ­£å¸¸æ‰§è¡Œï¼Œæœ€ç»ˆä¸€å®šè¦æ‰§è¡Œè¿™é‡Œçš„ä»£ç ï¼ï¼
}
try: 1æ¬¡ã€‚
catchï¼š0-Næ¬¡  (å¦‚æœæœ‰finallyé‚£ä¹ˆcatchå¯ä»¥æ²¡æœ‰!!)
finally: 0-1æ¬¡
```

**finally çš„ä½œç”¨**ï¼šå¯ä»¥åœ¨ä»£ç æ‰§è¡Œå®Œæ¯•ä»¥åè¿›è¡Œèµ„æºçš„é‡Šæ”¾æ“ä½œ

èµ„æºï¼šèµ„æºéƒ½æ˜¯å®ç°äº† Closeable æ¥å£çš„ï¼Œéƒ½è‡ªå¸¦ close() å…³é—­æ–¹æ³•

æ³¨æ„ï¼šå¦‚æœåœ¨ finally ä¸­å‡ºç°äº† returnï¼Œä¼šåæ‰å¼‚å¸¸

```java
public class FinallyDemo {
    public static void main(String[] args) {
        System.out.println(chu());//ä¸€å®šä¼šè¾“å‡º finally,ä¼˜å…ˆçº§æ¯”returné«˜
    }

    public static int chu(){
        try{
            int a = 10 / 2 ;
            return a ;
        }catch (Exception e){
            e.printStackTrace();
            return -1;
        }finally {
            System.out.println("=====finallyè¢«æ‰§è¡Œ");
            //return 111; // ä¸å»ºè®®åœ¨finallyä¸­å†™returnï¼Œä¼šè¦†ç›–å‰é¢æ‰€æœ‰çš„returnå€¼!
        }
    }
    public static void test(){
        InputStream is = null;
        try{
            is = new FileInputStream("D:/cang.png");
        }catch (Exception e){
            e.printStackTrace();
        }finally {
            System.out.println("==finallyè¢«æ‰§è¡Œ===");
            // å›æ”¶èµ„æºã€‚ç”¨äºåœ¨ä»£ç æ‰§è¡Œå®Œæ¯•ä»¥åè¿›è¡Œèµ„æºçš„å›æ”¶æ“ä½œï¼
            try {
                if(is!=null)is.close();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
}
```



***



### è‡ªå®šä¹‰

è‡ªå®šä¹‰å¼‚å¸¸:

* è‡ªå®šä¹‰ç¼–è¯‘æ—¶å¼‚å¸¸ï¼šå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ç±»ç»§æ‰¿ Exceptionï¼Œé‡å†™æ„é€ å™¨ï¼Œåœ¨å‡ºç°å¼‚å¸¸çš„åœ°æ–¹ç”¨ throw new è‡ªå®šä¹‰å¯¹è±¡æŠ›å‡º
* è‡ªå®šä¹‰è¿è¡Œæ—¶å¼‚å¸¸ï¼šå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ç±»ç»§æ‰¿ RuntimeExceptionï¼Œé‡å†™æ„é€ å™¨ï¼Œåœ¨å‡ºç°å¼‚å¸¸çš„åœ°æ–¹ç”¨ throw new è‡ªå®šä¹‰å¯¹è±¡æŠ›å‡º

throwsï¼šç”¨åœ¨æ–¹æ³•ä¸Šï¼Œç”¨äºæŠ›å‡ºæ–¹æ³•ä¸­çš„å¼‚å¸¸

throw:  ç”¨åœ¨å‡ºç°å¼‚å¸¸çš„åœ°æ–¹ï¼Œåˆ›å»ºå¼‚å¸¸å¯¹è±¡ä¸”ç«‹å³ä»æ­¤å¤„æŠ›å‡º

```java
//éœ€æ±‚ï¼šè®¤ä¸ºå¹´é¾„å°äº0å²ï¼Œå¤§äº200å²å°±æ˜¯ä¸€ä¸ªå¼‚å¸¸ã€‚
public class ExceptionDemo {
    public static void main(String[] args) {
        try {
            checkAge(101);
        } catch (AgeIllegalException e) {
            e.printStackTrace();
        }
    }

    public static void checkAge(int age) throws ItheimaAgeIllegalException {
        if(age < 0 || age > 200){//å¹´é¾„åœ¨0-200ä¹‹é—´
            throw new AgeIllegalException("/ age is illegal!");
            //throw new AgeIllegalRuntimeException("/ age is illegal!");
        }else{
            System.out.println("å¹´é¾„æ˜¯ï¼š" + age);
        }
    }
}

public class AgeIllegalException extends Exception{
    Alt + Insert->Constructor 
}//ç¼–è¯‘æ—¶å¼‚å¸¸
public class AgeIllegalRuntimeException extends RuntimeException{
	public AgeIllegalRuntimeException() {
    }

    public AgeIllegalRuntimeException(String message) {
        super(message);
    }
}//è¿è¡Œæ—¶å¼‚å¸¸
```



***



### å¤„ç†è§„èŒƒ

å¼‚å¸¸çš„è¯­æ³•æ³¨æ„ï¼š

1. è¿è¡Œæ—¶å¼‚å¸¸è¢«æŠ›å‡ºå¯ä»¥ä¸å¤„ç†ï¼Œå¯ä»¥è‡ªåŠ¨æŠ›å‡ºï¼›**ç¼–è¯‘æ—¶å¼‚å¸¸å¿…é¡»å¤„ç†**ï¼›æŒ‰ç…§è§„èŒƒéƒ½åº”è¯¥å¤„ç†
2. **é‡å†™æ–¹æ³•ç”³æ˜æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå­ç±»æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹å¿…é¡»æ˜¯çˆ¶ç±»æŠ›å‡ºå¼‚å¸¸ç±»å‹æˆ–ä¸ºå…¶å­ç±»å‹**
3. æ–¹æ³•é»˜è®¤éƒ½å¯ä»¥è‡ªåŠ¨æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œ throws RuntimeException å¯ä»¥çœç•¥ä¸å†™
4. å½“å¤šå¼‚å¸¸å¤„ç†æ—¶ï¼Œæ•è·å¤„ç†ï¼Œå‰é¢çš„å¼‚å¸¸ç±»ä¸èƒ½æ˜¯åé¢å¼‚å¸¸ç±»çš„çˆ¶ç±»
5. åœ¨ try/catch åå¯ä»¥è¿½åŠ  finally ä»£ç å—ï¼Œå…¶ä¸­çš„ä»£ç ä¸€å®šä¼šè¢«æ‰§è¡Œï¼Œé€šå¸¸ç”¨äºèµ„æºå›æ”¶æ“ä½œ

å¼‚å¸¸çš„ä½œç”¨ï¼š

1. å¯ä»¥å¤„ç†ä»£ç é—®é¢˜ï¼Œé˜²æ­¢ç¨‹åºå‡ºç°å¼‚å¸¸åçš„æ­»äº¡

2. æé«˜äº†ç¨‹åºçš„å¥å£®æ€§å’Œå®‰å…¨æ€§

```java
public class Demo{
    public static void main(String[] args){
        //è¯·è¾“å…¥ä¸€ä¸ªåˆæ³•çš„å¹´é¾„
        while(true){
            try{
                Scanner sc = new Scanner(System.in);
                System.out.println("è¯·æ‚¨è¾“å…¥æ‚¨çš„å¹´å¹´é¾„ï¼š");
                int age = sc.nextInt();
                System.out.println("å¹´é¾„ï¼š"+age);
                break;
            }catch(Exception e){
                System.err.println("æ‚¨çš„å¹´é¾„æ˜¯çè¾“å…¥çš„ï¼");
            }
        }
    }
}
```





***





## Î»

### lambda

#### åŸºæœ¬ä»‹ç»

Lambda è¡¨è¾¾å¼æ˜¯ JDK1.8 å¼€å§‹ä¹‹åçš„æ–°æŠ€æœ¯ï¼Œæ˜¯ä¸€ç§ä»£ç çš„æ–°è¯­æ³•ï¼Œä¸€ç§ç‰¹æ®Šå†™æ³•

ä½œç”¨ï¼šä¸ºäº†ç®€åŒ–åŒ¿åå†…éƒ¨ç±»çš„ä»£ç å†™æ³•

Lambda è¡¨è¾¾å¼çš„æ ¼å¼ï¼š

```java
(åŒ¿åå†…éƒ¨ç±»è¢«é‡å†™æ–¹æ³•çš„å½¢å‚åˆ—è¡¨) -> {
	//è¢«é‡å†™æ–¹æ³•çš„æ–¹æ³•ä½“ä»£ç 
}
```

Lambda è¡¨è¾¾å¼å¹¶ä¸èƒ½ç®€åŒ–æ‰€æœ‰åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•ï¼Œåªèƒ½ç®€åŒ–**å‡½æ•°å¼æ¥å£çš„åŒ¿åå†…éƒ¨ç±»**

ç®€åŒ–æ¡ä»¶ï¼šé¦–å…ˆå¿…é¡»æ˜¯æ¥å£ï¼Œæ¥å£ä¸­åªèƒ½æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•

@FunctionalInterface å‡½æ•°å¼æ¥å£æ³¨è§£ï¼šä¸€æ—¦æŸä¸ªæ¥å£åŠ ä¸Šäº†è¿™ä¸ªæ³¨è§£ï¼Œè¿™ä¸ªæ¥å£åªèƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•



***



#### ç®€åŒ–æ–¹æ³•

Lambda è¡¨è¾¾å¼çš„çœç•¥å†™æ³•ï¼ˆè¿›ä¸€æ­¥åœ¨ Lambda è¡¨è¾¾å¼çš„åŸºç¡€ä¸Šç»§ç»­ç®€åŒ–ï¼‰

* å¦‚æœ Lambda è¡¨è¾¾å¼çš„æ–¹æ³•ä½“ä»£ç åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¯ä»¥çœç•¥å¤§æ‹¬å·ä¸å†™ï¼ŒåŒæ—¶è¦çœç•¥åˆ†å·ï¼›å¦‚æœè¿™è¡Œä»£ç æ˜¯ return è¯­å¥ï¼Œå¿…é¡»çœç•¥ return ä¸å†™
* å‚æ•°ç±»å‹å¯ä»¥çœç•¥ä¸å†™
* å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°ç±»å‹å¯ä»¥çœç•¥ï¼ŒåŒæ—¶ `()` ä¹Ÿå¯ä»¥çœç•¥

```java
List<String> names = new ArrayList<>();
names.add("a");
names.add("b");
names.add("c");

names.forEach(new Consumer<String>() {
    @Override
    public void accept(String s) {
        System.out.println(s);
    }
});

names.forEach((String s) -> {
        System.out.println(s);
});

names.forEach((s) -> {
    System.out.println(s);
});

names.forEach(s -> {
    System.out.println(s);
});

names.forEach(s -> System.out.println(s) );
```



***



#### å¸¸ç”¨ç®€åŒ–

Comparator

```java
public class CollectionsDemo {
    public static void main(String[] args) {
        List<Student> lists = new ArrayList<>();//...s1 s2 s3
        Collections.addAll(lists , s1 , s2 , s3);
        Collections.sort(lists, new Comparator<Student>() {
            @Override
            public int compare(Student s1, Student s2) {
                return s1.getAge() - s2.getAge();
            }
        });
        
        // ç®€åŒ–å†™æ³•
        Collections.sort(lists ,(Student t1, Student t2) -> {
                return t1.getAge() - t2.getAge();
        });
        // å‚æ•°ç±»å‹å¯ä»¥çœç•¥,æœ€ç®€å•çš„
        Collections.sort(lists ,(t1,t2) -> t1.getAge()-t2.getAge());
    }
}
```





***



### æ–¹æ³•å¼•ç”¨

#### åŸºæœ¬ä»‹ç»

æ–¹æ³•å¼•ç”¨ï¼šæ–¹æ³•å¼•ç”¨æ˜¯ä¸ºäº†è¿›ä¸€æ­¥ç®€åŒ– Lambda è¡¨è¾¾å¼çš„å†™æ³•

æ–¹æ³•å¼•ç”¨çš„æ ¼å¼ï¼šç±»å‹æˆ–è€…å¯¹è±¡::å¼•ç”¨çš„æ–¹æ³•

å…³é”®è¯­æ³•æ˜¯ï¼š`::`

```java
lists.forEach( s -> System.out.println(s));
// æ–¹æ³•å¼•ç”¨ï¼
lists.forEach(System.out::println);
```



***



#### é™æ€æ–¹æ³•

å¼•ç”¨æ ¼å¼ï¼š`ç±»å::é™æ€æ–¹æ³•`

ç®€åŒ–æ­¥éª¤ï¼šå®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼ŒæŠŠéœ€è¦ç®€åŒ–çš„ä»£ç æ”¾åˆ°ä¸€ä¸ªé™æ€æ–¹æ³•ä¸­å»

é™æ€æ–¹æ³•å¼•ç”¨çš„æ³¨æ„äº‹é¡¹ï¼šè¢«å¼•ç”¨çš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨è¦å’Œå‡½æ•°å¼æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸€è‡´,æ‰èƒ½å¼•ç”¨ç®€åŒ–

```java
//å®šä¹‰é›†åˆåŠ å…¥å‡ ä¸ªStudentå…ƒç´ 
// ä½¿ç”¨é™æ€æ–¹æ³•è¿›è¡Œç®€åŒ–ï¼
Collections.sort(lists, (o1, o2) -> Student.compareByAge(o1 , o2));
// å¦‚æœå‰åå‚æ•°æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”æ–¹æ³•æ˜¯é™æ€æ–¹æ³•ï¼Œæ—¢å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•å¼•ç”¨
Collections.sort(lists, Student::compareByAge);

public class Student {
    private String name ;
    private int age ;

    public static int compareByAge(Student o1 , Student o2){
        return  o1.getAge() - o2.getAge();
    }
}
```



***



#### å®ä¾‹æ–¹æ³•

å¼•ç”¨æ ¼å¼ï¼š`å¯¹è±¡::å®ä¾‹æ–¹æ³•`

ç®€åŒ–æ­¥éª¤ï¼šå®šä¹‰ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼ŒæŠŠéœ€è¦çš„ä»£ç æ”¾åˆ°å®ä¾‹æ–¹æ³•ä¸­å»

å®ä¾‹æ–¹æ³•å¼•ç”¨çš„æ³¨æ„äº‹é¡¹ï¼šè¢«å¼•ç”¨çš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨è¦å’Œå‡½æ•°å¼æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸€è‡´ã€‚

```java
public class MethodDemo {
    public static void main(String[] args) {
        List<String> lists = new ArrayList<>();
        lists.add("java1");
        lists.add("java2");
        lists.add("java3");
        // å¯¹è±¡æ˜¯ System.out = new PrintStream();
        // å®ä¾‹æ–¹æ³•ï¼šprintln()
        // å‰åå‚æ•°æ­£å¥½éƒ½æ˜¯ä¸€ä¸ª
        lists.forEach(s -> System.out.println(s));
        lists.forEach(System.out::println);
    }
}
```



***



#### ç‰¹å®šç±»å‹

ç‰¹å®šç±»å‹ï¼šStringï¼Œä»»ä½•ç±»å‹

å¼•ç”¨æ ¼å¼ï¼š`ç‰¹å®šç±»å‹::æ–¹æ³•`

æ³¨æ„äº‹é¡¹ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°åˆ—è¡¨ä¸­çš„å½¢å‚ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºäº†åé¢çš„æ–¹æ³•çš„è°ƒç”¨è€…ï¼Œå¹¶ä¸”å…¶ä½™å‚æ•°ä½œä¸ºåé¢æ–¹æ³•çš„å½¢å‚ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ç‰¹å®šç±»å‹æ–¹æ³•å¼•ç”¨äº†

```java
public class MethodDemo{
    public static void main(String[] args) {
        String[] strs = new String[]{"James", "AA", "John",
                "Patricia","Dlei" , "Robert","Boom", "Cao" ,"black" ,
                "Michael", "Linda","cao","after","sa"};

        // public static <T> void sort(T[] a, Comparator<? super T> c)
        // éœ€æ±‚ï¼šæŒ‰ç…§å…ƒç´ çš„é¦–å­—ç¬¦(å¿½ç•¥å¤§å°å†™)å‡åºæ’åºï¼ï¼ï¼
        Arrays.sort(strs, new Comparator<String>() {
            @Override
            public int compare(String s1, String s2) {
                return s1.compareToIgnoreCase(s2);//æŒ‰ç…§å…ƒç´ çš„é¦–å­—ç¬¦(å¿½ç•¥å¤§å°å†™)
            }
        });

        Arrays.sort(strs, ( s1,  s2 ) ->  s1.compareToIgnoreCase(s2));

        // ç‰¹å®šç±»å‹çš„æ–¹æ³•å¼•ç”¨ï¼š
        Arrays.sort(strs,  String::compareToIgnoreCase);
        System.out.println(Arrays.toString(strs));
    }
}
```



***



#### æ„é€ å™¨

æ ¼å¼ï¼š`ç±»å::new`

æ³¨æ„äº‹é¡¹ï¼šå‰åå‚æ•°ä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œåˆåœ¨åˆ›å»ºå¯¹è±¡ï¼Œå°±å¯ä»¥ä½¿ç”¨æ„é€ å™¨å¼•ç”¨

```java
public class ConstructorDemo {
    public static void main(String[] args) {
        List<String> lists = new ArrayList<>();
        lists.add("java1");
        lists.add("java2");
        lists.add("java3");

        // é›†åˆé»˜è®¤åªèƒ½è½¬æˆObjectç±»å‹çš„æ•°ç»„ã€‚
        Object[] objs = lists.toArray();

        // æˆ‘ä»¬æƒ³æŒ‡å®šè½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹çš„æ•°ç»„ï¼æœ€æ–°çš„å†™æ³•å¯ä»¥ç»“åˆæ„é€ å™¨å¼•ç”¨å®ç° 
        String[] strs = lists.toArray(new IntFunction<String[]>() {
            @Override
            public String[] apply(int value) {
                return new String[value];
            }
        });
        String[] strs1 = lists.toArray(s -> new String[s]);
        String[] strs2 = lists.toArray(String[]::new);

        System.out.println("Stringç±»å‹çš„æ•°ç»„ï¼š"+ Arrays.toString(strs2));
    }
}
```





***





## I/O

### Stream

#### æ¦‚è¿°

Stream æµå…¶å®å°±æ˜¯ä¸€æ ¹ä¼ é€å¸¦ï¼Œå…ƒç´ åœ¨ä¸Šé¢å¯ä»¥è¢« Stream æµæ“ä½œ

* å¯ä»¥è§£å†³å·²æœ‰é›†åˆç±»åº“æˆ–è€…æ•°ç»„ API çš„å¼Šç«¯
* Stream æµç®€åŒ–é›†åˆå’Œæ•°ç»„çš„æ“ä½œ
* é“¾å¼ç¼–ç¨‹

```java
list.stream().filter(new Predicate<String>() {
            @Override
            public boolean test(String s) {
                return s.startsWith("å¼ ");
            }
        });

list.stream().filter(s -> s.startsWith("å¼ "));
```



***



#### è·å–æµ

é›†åˆè·å– Stream æµç”¨ï¼š`default Stream<E> stream()`

æ•°ç»„ï¼šArrays.stream(æ•°ç»„)   /  Stream.of(æ•°ç»„);

```java
// Collectioné›†åˆè·å–Streamæµã€‚
Collection<String> c = new ArrayList<>();
Stream<String> listStream = c.stream();

// Mapé›†åˆè·å–æµ
// å…ˆè·å–é”®çš„Streamæµã€‚
Stream<String> keysStream = map.keySet().stream();
// åœ¨è·å–å€¼çš„Streamæµ
Stream<Integer> valuesStream = map.values().stream();
// è·å–é”®å€¼å¯¹çš„Streamæµï¼ˆkey=valueï¼š Map.Entry<String,Integer>ï¼‰
Stream<Map.Entry<String,Integer>> keyAndValues = map.entrySet().stream();

//æ•°ç»„è·å–æµ
String[] arr = new String[]{"Java", "JavaEE" ,"Spring Boot"};
Stream<String> arrStream1 = Arrays.stream(arr);
Stream<String> arrStream2 = Stream.of(arr);
```



****



#### å¸¸ç”¨API

| æ–¹æ³•å                                                    | è¯´æ˜                                                     |
| --------------------------------------------------------- | -------------------------------------------------------- |
| void forEach(Consumer<? super T> action)                  | é€ä¸€å¤„ç†ï¼ˆéå†ï¼‰                                         |
| long count                                                | è¿”å›æµä¸­çš„å…ƒç´ æ•°                                         |
| Stream<T> filter(Predicate<? super T> predicate)          | ç”¨äºå¯¹æµä¸­çš„æ•°æ®è¿›è¡Œè¿‡æ»¤                                 |
| Stream<T> limit(long maxSize)                             | è¿”å›æ­¤æµä¸­çš„å…ƒç´ ç»„æˆçš„æµï¼Œæˆªå–å‰æŒ‡å®šå‚æ•°ä¸ªæ•°çš„æ•°æ®       |
| Stream<T> skip(long n)                                    | è·³è¿‡æŒ‡å®šå‚æ•°ä¸ªæ•°çš„æ•°æ®ï¼Œè¿”å›ç”±è¯¥æµçš„å‰©ä½™å…ƒç´ ç»„æˆçš„æµ     |
| <R> Stream<R> map(Function<? super T,? extends R> mapper) | åŠ å·¥æ–¹æ³•ï¼Œå°†å½“å‰æµä¸­çš„ T ç±»å‹æ•°æ®è½¬æ¢ä¸ºå¦ä¸€ç§ R ç±»å‹çš„æµ |
| static <T> Stream<T> concat(Stream a, Stream b)           | åˆå¹¶ a å’Œ b ä¸¤ä¸ªæµä¸ºä¸€ä¸ªï¼Œè°ƒç”¨ `Stream.concat(s1,s2)`    |
| Stream<T> distinct()                                      | è¿”å›ç”±è¯¥æµçš„ä¸åŒå…ƒç´ ç»„æˆçš„æµ                             |

```java
public class StreamDemo {
    public static void main(String[] args) {
        List<String> list = new ArrayList<>();
        list.add("å¼ æ— å¿Œ"); list.add("å‘¨èŠ·è‹¥"); list.add("èµµæ•");
        list.add("å¼ ä¸‰"); list.add("å¼ ä¸‰ä¸°"); list.add("å¼ ");
        //å–ä»¥å¼ å¼€å¤´å¹¶ä¸”åå­—æ˜¯ä¸‰ä½æ•°çš„
        list.stream().filter(s -> s.startsWith("å¼ ")
                .filter(s -> s.length == 3).forEach(System.out::println);
        //ç»Ÿè®¡æ•°é‡
		long count = list.stream().filter(s -> s.startsWith("å¼ ")
                .filter(s -> s.length == 3).count();
		//å–å‰ä¸¤ä¸ª
		list.stream().filter(s -> s.length == 3).limit(2).forEach(...);
		//è·³è¿‡å‰ä¸¤ä¸ª
		list.stream().filter(s -> s.length == 3).skip(2).forEach(...);

		// éœ€æ±‚ï¼šæŠŠåç§°éƒ½åŠ ä¸Šâ€œå¼ ä¸‰çš„:+xxxâ€
		list.stream().map(s -> "å¼ ä¸‰çš„" + s).forEach(System.out::println);
		// éœ€æ±‚ï¼šæŠŠåç§°éƒ½åŠ å·¥å‚å­¦ç”Ÿå¯¹è±¡æ”¾ä¸Šå»!!
		// list.stream().map(name -> new Student(name));
		list.stream.map(Student::new).forEach(System.out::println);
                                          	
		//æ•°ç»„æµ
		Stream<Integer> s1 = Stream.of(10,20,30,40,50);
		//é›†åˆæµ
		Stream<String> s2 = list.stream();
		//åˆå¹¶æµ
		Stream<Object> s3 = Stream.concat(s1,s2);
		s3.forEach(System.out::println);
    }
}
class Student{
    private String name;
    //......
}                                          
```



***



#### ç»ˆç»“æ–¹æ³•

ç»ˆç»“æ–¹æ³•ï¼šStream è°ƒç”¨äº†ç»ˆç»“æ–¹æ³•ï¼Œæµçš„æ“ä½œå°±å…¨éƒ¨ç»ˆç»“ï¼Œä¸èƒ½ç»§ç»­ä½¿ç”¨ï¼Œå¦‚ foreachï¼Œcount æ–¹æ³•ç­‰

éç»ˆç»“æ–¹æ³•ï¼šæ¯æ¬¡è°ƒç”¨å®Œæˆä»¥åè¿”å›ä¸€ä¸ªæ–°çš„æµå¯¹è±¡ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œæ”¯æŒ**é“¾å¼ç¼–ç¨‹**

```java
// foreachç»ˆç»“æ–¹æ³•
list.stream().filter(s -> s.startsWith("å¼ "))
    .filter(s -> s.length() == 3).forEach(System.out::println);
```



***



#### æ”¶é›†æµ

æ”¶é›† Streamï¼šæŠŠ Stream æµçš„æ•°æ®è½¬å›åˆ°é›†åˆä¸­å»

* Stream æµï¼šå·¥å…·
* é›†åˆï¼šç›®çš„

Stream æ”¶é›†æ–¹æ³•ï¼š`R collect(Collector collector)` æŠŠç»“æœæ”¶é›†åˆ°é›†åˆä¸­

Collectors æ–¹æ³•ï¼š

* `public static <T> Collector toList()`ï¼šæŠŠå…ƒç´ æ”¶é›†åˆ° List é›†åˆä¸­
* `public static <T> Collector toSet()`ï¼šæŠŠå…ƒç´ æ”¶é›†åˆ° Set é›†åˆä¸­
* `public static  Collector toMap(Function keyMapper,Function valueMapper)`ï¼šæŠŠå…ƒç´ æ”¶é›†åˆ° Map é›†åˆä¸­
* `Object[] toArray()`ï¼šæŠŠå…ƒç´ æ”¶é›†æ•°ç»„ä¸­
* `public static Collector groupingBy(Function<? super T, ? extends K> classifier)`ï¼šåˆ†ç»„

```java
public static void main(String[] args) {
	List<String> list = new ArrayList<>();
	Stream<String> stream = list.stream().filter(s -> s.startsWith("å¼ "));    
    //æŠŠstreamæµè½¬æ¢æˆSeté›†åˆã€‚
    Set<String> set = stream.collect(Collectors.toSet());
    
    //æŠŠstreamæµè½¬æ¢æˆListé›†åˆã€‚
    //é‡æ–°å®šä¹‰ï¼Œå› ä¸ºèµ„æºå·²ç»è¢«å…³é—­äº†
    Stream<String> stream1 = list.stream().filter(s -> s.startsWith("å¼ "));
    List<String> list = stream.collect(Collectors.toList());
    
    //æŠŠstreamæµè½¬æ¢æˆæ•°ç»„ã€‚
    Stream<String> stream2 = list.stream().filter(s -> s.startsWith("å¼ "));
    Object[] arr = stream2.toArray();
    // å¯ä»¥å€Ÿç”¨æ„é€ å™¨å¼•ç”¨ç”³æ˜è½¬æ¢æˆçš„æ•°ç»„ç±»å‹ï¼ï¼ï¼
    String[] arr1 = stream2.toArray(String[]::new);
}
```



***



### File

#### æ–‡ä»¶ç±»

File ç±»ï¼šä»£è¡¨æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶å¯¹è±¡ï¼Œæ˜¯ç”¨æ¥æ“ä½œæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶å¯¹è±¡çš„ï¼Œåˆ é™¤æ–‡ä»¶ï¼Œè·å–æ–‡ä»¶ä¿¡æ¯ï¼Œåˆ›å»ºæ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹ï¼‰ï¼Œå¹¿ä¹‰æ¥è¯´æ“ä½œç³»ç»Ÿè®¤ä¸ºæ–‡ä»¶åŒ…å«ï¼ˆæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼‰

File ç±»æ„é€ å™¨ï¼š

* `public File(String pathname)`ï¼šæ ¹æ®è·¯å¾„è·å–æ–‡ä»¶å¯¹è±¡
* `public File(String parent , String child)`ï¼šæ ¹æ®çˆ¶è·¯å¾„å’Œæ–‡ä»¶åç§°è·å–æ–‡ä»¶å¯¹è±¡

File ç±»åˆ›å»ºæ–‡ä»¶å¯¹è±¡çš„æ ¼å¼ï¼š

* `File f = new File("ç»å¯¹è·¯å¾„/ç›¸å¯¹è·¯å¾„");`
  * ç»å¯¹è·¯å¾„ï¼šä»ç£ç›˜çš„çš„ç›˜ç¬¦ä¸€è·¯èµ°åˆ°ç›®çš„ä½ç½®çš„è·¯å¾„
    * ç»å¯¹è·¯å¾„ä¾èµ–å…·ä½“çš„ç¯å¢ƒï¼Œä¸€æ—¦è„±ç¦»ç¯å¢ƒï¼Œä»£ç å¯èƒ½å‡ºé”™
    * ä¸€èˆ¬æ˜¯å®šä½æŸä¸ªæ“ä½œç³»ç»Ÿä¸­çš„æŸä¸ªæ–‡ä»¶å¯¹è±¡
  * **ç›¸å¯¹è·¯å¾„**ï¼šä¸å¸¦ç›˜ç¬¦çš„ï¼ˆé‡ç‚¹ï¼‰
    * é»˜è®¤æ˜¯ç›´æ¥ç›¸å¯¹åˆ°å·¥ç¨‹ç›®å½•ä¸‹å¯»æ‰¾æ–‡ä»¶çš„ã€‚
    * ç›¸å¯¹è·¯å¾„åªèƒ½ç”¨äºå¯»æ‰¾å·¥ç¨‹ä¸‹çš„æ–‡ä»¶ï¼Œå¯ä»¥è·¨å¹³å°

* `File f = new File("æ–‡ä»¶å¯¹è±¡/æ–‡ä»¶å¤¹å¯¹è±¡")` å¹¿ä¹‰æ¥è¯´ï¼šæ–‡ä»¶æ˜¯åŒ…å«æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„

```java
public class FileDemo{
    public static void main(String[] args) {
        // 1.åˆ›å»ºæ–‡ä»¶å¯¹è±¡ï¼šä½¿ç”¨ç»å¯¹è·¯å¾„
        // æ–‡ä»¶è·¯å¾„åˆ†éš”ç¬¦ï¼š
        //      -- a.ä½¿ç”¨æ­£æ–œæ ï¼š /
        //      -- b.ä½¿ç”¨åæ–œæ ï¼š \\
        //      -- c.ä½¿ç”¨åˆ†éš”ç¬¦API:File.separator
        //File f1 = new File("D:"+File.separator+"it"+File.separator
		//+"å›¾ç‰‡èµ„æº"+File.separator+"beautiful.jpg");
        File f1 = new File("D:\\seazean\\å›¾ç‰‡èµ„æº\\beautiful.jpg");
        System.out.println(f1.length()); // è·å–æ–‡ä»¶çš„å¤§å°ï¼Œå­—èŠ‚å¤§å°

        // 2.åˆ›å»ºæ–‡ä»¶å¯¹è±¡ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„
        File f2 = new File("Day09Demo/src/dlei.txt");
        System.out.println(f2.length());

        // 3.åˆ›å»ºæ–‡ä»¶å¯¹è±¡ï¼šä»£è¡¨æ–‡ä»¶å¤¹ã€‚
        File f3 = new File("D:\\it\\å›¾ç‰‡èµ„æº");
        System.out.println(f3.exists());// åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼ï¼
    }
}
```



***



#### å¸¸ç”¨API

##### å¸¸ç”¨æ–¹æ³•

| æ–¹æ³•                           | è¯´æ˜                                   |
| ------------------------------ | -------------------------------------- |
| String getAbsolutePath()       | è¿”å›æ­¤ File çš„ç»å¯¹è·¯å¾„åå­—ç¬¦ä¸²         |
| String getPath()               | è·å–åˆ›å»ºæ–‡ä»¶å¯¹è±¡çš„æ—¶å€™ç”¨çš„è·¯å¾„         |
| String getName()               | è¿”å›ç”±æ­¤ File è¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•çš„åç§°   |
| long length()                  | è¿”å›ç”±æ­¤ File è¡¨ç¤ºçš„æ–‡ä»¶çš„é•¿åº¦ï¼ˆå¤§å°ï¼‰ |
| long length(FileFilter filter) | æ–‡ä»¶è¿‡æ»¤å™¨                             |

```java
public class FileDemo {
    public static void main(String[] args) {
        // 1.ç»å¯¹è·¯å¾„åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¯¹è±¡
        File f1 = new File("E:/å›¾ç‰‡/test.jpg");
        // a.è·å–å®ƒçš„ç»å¯¹è·¯å¾„ã€‚
        System.out.println(f1.getAbsolutePath());
        // b.è·å–æ–‡ä»¶å®šä¹‰çš„æ—¶å€™ä½¿ç”¨çš„è·¯å¾„ã€‚
        System.out.println(f1.getPath());
        // c.è·å–æ–‡ä»¶çš„åç§°ï¼šå¸¦åç¼€ã€‚
        System.out.println(f1.getName());
        // d.è·å–æ–‡ä»¶çš„å¤§å°ï¼šå­—èŠ‚ä¸ªæ•°ã€‚
        System.out.println(f1.length());
        System.out.println("------------------------");

        // 2.ç›¸å¯¹è·¯å¾„
        File f2 = new File("Demo/src/test.txt");
        // a.è·å–å®ƒçš„ç»å¯¹è·¯å¾„ã€‚
        System.out.println(f2.getAbsolutePath());
        // b.è·å–æ–‡ä»¶å®šä¹‰çš„æ—¶å€™ä½¿ç”¨çš„è·¯å¾„ã€‚
        System.out.println(f2.getPath());
        // c.è·å–æ–‡ä»¶çš„åç§°ï¼šå¸¦åç¼€ã€‚
        System.out.println(f2.getName());
        // d.è·å–æ–‡ä»¶çš„å¤§å°ï¼šå­—èŠ‚ä¸ªæ•°ã€‚
        System.out.println(f2.length());
    }
}

```



***



##### åˆ¤æ–­æ–¹æ³•

æ–¹æ³•åˆ—è¡¨ï¼š

* `boolean exists()`ï¼šæ­¤ File è¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å®é™…å­˜åœ¨
* `boolean isDirectory()`ï¼šæ­¤ File è¡¨ç¤ºçš„æ˜¯å¦ä¸ºç›®å½•
* `boolean isFile()`ï¼šæ­¤ File è¡¨ç¤ºçš„æ˜¯å¦ä¸ºæ–‡ä»¶

```java
File f = new File("Demo/src/test.txt");
// a.åˆ¤æ–­æ–‡ä»¶è·¯å¾„æ˜¯å¦å­˜åœ¨
System.out.println(f.exists()); // true
// b.åˆ¤æ–­æ–‡ä»¶å¯¹è±¡æ˜¯å¦æ˜¯æ–‡ä»¶,æ˜¯æ–‡ä»¶è¿”å›true ,åä¹‹
System.out.println(f.isFile()); // true
// c.åˆ¤æ–­æ–‡ä»¶å¯¹è±¡æ˜¯å¦æ˜¯æ–‡ä»¶å¤¹,æ˜¯æ–‡ä»¶å¤¹è¿”å›true ,åä¹‹
System.out.println(f.isDirectory()); // false
```



****



##### åˆ›å»ºåˆ é™¤

æ–¹æ³•åˆ—è¡¨ï¼š

* `boolean createNewFile()`ï¼šå½“ä¸”ä»…å½“å…·æœ‰è¯¥åç§°çš„æ–‡ä»¶å°šä¸å­˜åœ¨æ—¶ï¼Œ åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºæ–‡ä»¶
* `boolean delete()`ï¼šåˆ é™¤ç”±æ­¤ File è¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•ï¼ˆåªèƒ½åˆ é™¤ç©ºç›®å½•ï¼‰
* `boolean mkdir()`ï¼šåˆ›å»ºç”±æ­¤ File è¡¨ç¤ºçš„ç›®å½•ï¼ˆåªèƒ½åˆ›å»ºä¸€çº§ç›®å½•ï¼‰
* `boolean mkdirs()`ï¼šå¯ä»¥åˆ›å»ºå¤šçº§ç›®å½•ï¼ˆå»ºè®®ä½¿ç”¨ï¼‰

```java
public class FileDemo {
    public static void main(String[] args) throws IOException {
        File f = new File("Demo/src/test.txt");
        // a.åˆ›å»ºæ–°æ–‡ä»¶ï¼Œåˆ›å»ºæˆåŠŸè¿”å›true ,åä¹‹
        System.out.println(f.createNewFile());

        // b.åˆ é™¤æ–‡ä»¶æˆ–è€…ç©ºæ–‡ä»¶å¤¹
        System.out.println(f.delete());
        // ä¸èƒ½åˆ é™¤éç©ºæ–‡ä»¶å¤¹ï¼Œåªèƒ½åˆ é™¤ç©ºæ–‡ä»¶å¤¹
        File f1 = new File("E:/it/aaaaa");
        System.out.println(f1.delete());

        // c.åˆ›å»ºä¸€çº§ç›®å½•
        File f2 = new File("E:/bbbb");
        System.out.println(f2.mkdir());

        // d.åˆ›å»ºå¤šçº§ç›®å½•
        File f3 = new File("D:/it/e/a/d/ds/fas/fas/fas/fas/fas/fas");
        System.out.println(f3.mkdirs());
    }
}
```



***



#### éå†ç›®å½•

- `public String[] list()`ï¼šè·å–å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„ä¸€çº§æ–‡ä»¶åç§°åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ä¸­å»è¿”å›
- `public File[] listFiles()`ï¼šè·å–å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„ä¸€çº§æ–‡ä»¶å¯¹è±¡åˆ°ä¸€ä¸ª**æ–‡ä»¶å¯¹è±¡æ•°ç»„**ä¸­å»è¿”å›ï¼ˆ**é‡ç‚¹**ï¼‰
- `public long lastModified`ï¼šè¿”å›æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶ä¸Šæ¬¡ä¿®æ”¹çš„æ—¶é—´

```java
public class FileDemo {
    public static void main(String[] args) {
        File dir = new File("D:\\seazean");
        // a.è·å–å½“å‰ç›®å½•å¯¹è±¡ä¸‹çš„å…¨éƒ¨ä¸€çº§æ–‡ä»¶åç§°åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„è¿”å›ã€‚
        String[] names = dir.list();
        for (String name : names) {
            System.out.println(name);
        }
        // b.è·å–å½“å‰ç›®å½•å¯¹è±¡ä¸‹çš„å…¨éƒ¨ä¸€çº§æ–‡ä»¶å¯¹è±¡åˆ°ä¸€ä¸ªFileç±»å‹çš„æ•°ç»„è¿”å›ã€‚
        File[] files = dir.listFiles();
        for (File file : files) {
            System.out.println(file.getAbsolutePath());
        }

        // c
        File f1 = new File("D:\\å›¾ç‰‡èµ„æº\\beautiful.jpg");
        long time = f1.lastModified(); // æœ€åä¿®æ”¹æ—¶é—´ï¼
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        System.out.println(sdf.format(time));
    }
}
```



***



#### æ–‡ä»¶æœç´¢

é€’å½’å®ç°æ–‡ä»¶æœç´¢ï¼ˆéè§„å¾‹é€’å½’ï¼‰

* å®šä¹‰ä¸€ä¸ªæ–¹æ³•ç”¨äºåšæœç´¢
* è¿›å…¥æ–¹æ³•ä¸­è¿›è¡Œä¸šåŠ¡æœç´¢åˆ†æ

```java
/**
 * å»æŸä¸ªç›®å½•ä¸‹æœç´¢æŸä¸ªæ–‡ä»¶
 * @param dir æœç´¢æ–‡ä»¶çš„ç›®å½•ã€‚
 * @param fileName æœç´¢æ–‡ä»¶çš„åç§°ã€‚
 */
public static void searchFiles(File dir , String fileName){
    // 1.åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥è·¯å¾„ï¼Œæ˜¯å¦æ˜¯æ–‡ä»¶å¤¹
    if(dir.exists() && dir.isDirectory()){
        // 2.æå–å½“å‰ç›®å½•ä¸‹çš„å…¨éƒ¨ä¸€çº§æ–‡ä»¶å¯¹è±¡
        File files = dir.listFiles();// å¯èƒ½æ˜¯null/ä¹Ÿå¯èƒ½æ˜¯ç©ºé›†åˆ[]
        // 3.åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€çº§æ–‡ä»¶å¯¹è±¡,åˆ¤æ–­æ˜¯å¦ä¸ä¸ºç©ºç›®å½•
        if(files != null && files.length > 0){
            // 4.åˆ¤æ–­ä¸€çº§æ–‡ä»¶å¯¹è±¡
            for(File file : files){
                // 5.åˆ¤æ–­fileæ˜¯æ–‡ä»¶è¿˜æ˜¯æ–‡ä»¶å¤¹
                if(file.isFile()){
                    // 6.åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯å¦ä¸ºæˆ‘è¦æ‰¾çš„æ–‡ä»¶å¯¹è±¡
                    if(f.getName().contains(fileName)){//æ¨¡ç³ŠæŸ¥æ‰¾
                        sout(f.getAbsolutePath());
                        try {
                            // å¯åŠ¨å®ƒï¼ˆæ‹“å±•ï¼‰
                            Runtime r = Runtime.getRuntime();
                            r.exec(f.getAbsolutePath());
                        } catch (IOException e) {
                            e.printStackTrace();
                        }
                    }
                } else {
                    // 7.è¯¥æ–‡ä»¶æ˜¯æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹è¦é€’å½’è¿›å…¥ç»§ç»­å¯»æ‰¾
                    searchFiles(file,fileName)
                }
            }
        }
    }
}
```



***



### Character

å­—ç¬¦é›†ï¼šä¸ºå­—ç¬¦ç¼–åˆ¶çš„ä¸€å¥—ç¼–å·è§„åˆ™

è®¡ç®—æœºçš„åº•å±‚æ˜¯ä¸èƒ½ç›´æ¥å­˜å‚¨å­—ç¬¦çš„ï¼Œåªèƒ½å­˜å‚¨äºŒè¿›åˆ¶ 010101

ASCII ç¼–ç ï¼š8 ä¸ªå¼€å…³ä¸€ç»„å°±å¯ä»¥ç¼–ç å­—ç¬¦ï¼Œ1 ä¸ªå­—èŠ‚ 2^8 = 256ï¼Œ ä¸€ä¸ªå­—èŠ‚å­˜å‚¨ä¸€ä¸ªå­—ç¬¦å®Œå…¨å¤Ÿç”¨ï¼Œè‹±æ–‡å’Œæ•°å­—åœ¨åº•å±‚å­˜å‚¨éƒ½æ˜¯é‡‡ç”¨ 1 ä¸ªå­—èŠ‚å­˜å‚¨çš„

```
a  97
b  98

A  65
B  66

0  48
1  49
```

ä¸­å›½äººï¼šä¸­å›½äººæœ‰ 9 ä¸‡å·¦å³å­—ç¬¦ï¼Œ2 ä¸ªå­—èŠ‚ç¼–ç ä¸€ä¸ªä¸­æ–‡å­—ç¬¦ï¼Œ1 ä¸ªå­—èŠ‚ç¼–ç ä¸€ä¸ªè‹±æ–‡å­—ç¬¦ï¼Œè¿™å¥—ç¼–ç å«ï¼šGBK ç¼–ç ï¼Œå…¼å®¹ ASCII ç¼–ç è¡¨

ç¾å›½äººï¼šæ”¶é›†å…¨çƒæ‰€æœ‰çš„å­—ç¬¦ï¼Œç»Ÿä¸€ç¼–å·ï¼Œè¿™å¥—ç¼–ç å« Unicode ç¼–ç ï¼ˆä¸‡å›½ç ï¼‰ï¼Œä¸€ä¸ªè‹±æ–‡ç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ï¼ˆå«ç¹ä½“ï¼‰ç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œä¸­æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚

* UTF-8 æ˜¯å˜ç§å½¢å¼ï¼Œä¹Ÿå¿…é¡»å…¼å®¹ ASCII ç¼–ç è¡¨
* UTF-8 ä¸€ä¸ªä¸­æ–‡ä¸€èˆ¬å  3 ä¸ªå­—èŠ‚ï¼Œä¸­æ–‡æ ‡ç‚¹å  3 ä¸ªï¼Œè‹±æ–‡å­—æ¯å’Œæ•°å­— 1 ä¸ªå­—èŠ‚

ç¼–ç å‰ä¸ç¼–ç åçš„ç¼–ç é›†å¿…é¡»ä¸€è‡´æ‰ä¸ä¼šä¹±ç 



***



### IOStream

#### æ¦‚è¿°

IO è¾“å…¥è¾“å‡ºæµï¼šè¾“å…¥/è¾“å‡ºæµ

* Inputï¼šè¾“å…¥
* Outputï¼šè¾“å‡º

å¼•å…¥ï¼šFile ç±»åªèƒ½æ“ä½œæ–‡ä»¶å¯¹è±¡æœ¬èº«ï¼Œä¸èƒ½è¯»å†™æ–‡ä»¶å¯¹è±¡çš„å†…å®¹ï¼Œè¯»å†™æ•°æ®å†…å®¹ï¼Œåº”è¯¥ä½¿ç”¨ IO æµ

IO æµæ˜¯ä¸€ä¸ªæ°´æµæ¨¡å‹ï¼šIO ç†è§£æˆæ°´ç®¡ï¼ŒæŠŠæ•°æ®ç†è§£æˆæ°´æµ

IO æµçš„åˆ†ç±»ï¼š

* æŒ‰ç…§æµçš„æ–¹å‘åˆ†ä¸ºï¼šè¾“å…¥æµï¼Œè¾“å‡ºæµã€‚
  * è¾“å‡ºæµï¼šä»¥å†…å­˜ä¸ºåŸºå‡†ï¼ŒæŠŠå†…å­˜ä¸­çš„æ•°æ®**å†™å‡ºåˆ°ç£ç›˜æ–‡ä»¶**æˆ–è€…ç½‘ç»œä»‹è´¨ä¸­å»çš„æµç§°ä¸ºè¾“å‡ºæµ
  * è¾“å…¥æµï¼šä»¥å†…å­˜ä¸ºåŸºå‡†ï¼ŒæŠŠç£ç›˜æ–‡ä»¶ä¸­çš„æ•°æ®æˆ–è€…ç½‘ç»œä¸­çš„æ•°æ®**è¯»å…¥åˆ°å†…å­˜**ä¸­çš„æµç§°ä¸ºè¾“å…¥æµ
* æŒ‰ç…§æµçš„å†…å®¹åˆ†ä¸ºï¼šå­—èŠ‚æµï¼Œå­—ç¬¦æµ
  * å­—èŠ‚æµï¼šæµä¸­çš„æ•°æ®çš„æœ€å°å•ä½æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å­—èŠ‚ï¼Œè¿™ä¸ªæµå°±æ˜¯å­—èŠ‚æµ
  * å­—ç¬¦æµï¼šæµä¸­çš„æ•°æ®çš„æœ€å°å•ä½æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å­—ç¬¦ï¼Œè¿™ä¸ªæµå°±æ˜¯å­—ç¬¦æµï¼ˆ**é’ˆå¯¹äºæ–‡æœ¬å†…å®¹**ï¼‰

æµå¤§ä½“åˆ†ä¸ºå››å¤§ç±»ï¼šå­—èŠ‚è¾“å…¥æµã€å­—èŠ‚è¾“å‡ºæµã€å­—ç¬¦è¾“å…¥æµã€å­—ç¬¦è¾“å‡ºæµ

```java
IO æµçš„ä½“ç³»ï¼š
        å­—èŠ‚æµ                                   å­—ç¬¦æµ
  å­—èŠ‚è¾“å…¥æµ              å­—èŠ‚è¾“å‡ºæµ            å­—ç¬¦è¾“å…¥æµ         å­—ç¬¦è¾“å‡ºæµ
InputStream           OutputStream          Reader            Writer   (æŠ½è±¡ç±»)
FileInputStream       FileOutputStream      FileReader        FileWriter(å®ç°ç±»)
BufferedInputStream  BufferedOutputStream  BufferedReader   BufferedWriter(å®ç°ç±»ç¼“å†²æµ)
                                           InputStreamReader OutputStreamWriter
ObjectInputStream     ObjectOutputStream
```



****



#### å­—èŠ‚æµ

##### å­—èŠ‚è¾“å…¥

FileInputStream æ–‡ä»¶å­—èŠ‚è¾“å…¥æµï¼šä»¥å†…å­˜ä¸ºåŸºå‡†ï¼ŒæŠŠç£ç›˜æ–‡ä»¶ä¸­çš„æ•°æ®æŒ‰ç…§å­—èŠ‚çš„å½¢å¼è¯»å…¥åˆ°å†…å­˜ä¸­çš„æµ

æ„é€ æ–¹æ³•ï¼š

* `public FileInputStream(File path)`ï¼šåˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å…¥æµç®¡é“ä¸æºæ–‡ä»¶å¯¹è±¡æ¥é€š
* `public FileInputStream(String pathName)`ï¼šåˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å…¥æµç®¡é“ä¸æ–‡ä»¶è·¯å¾„å¯¹æ¥ï¼Œåº•å±‚å®è´¨ä¸Šåˆ›å»º File å¯¹è±¡ 

æ–¹æ³•ï¼š

* `public int read()`ï¼šæ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚è¿”å›ï¼Œè¯»å–å®Œæ¯•ä¼šè¿”å› -1
* `public int read(byte[] buffer)`ï¼šä»å­—èŠ‚è¾“å…¥æµä¸­è¯»å–å­—èŠ‚åˆ°å­—èŠ‚æ•°ç»„ä¸­å»ï¼Œè¿”å›è¯»å–çš„å­—èŠ‚æ•°é‡ï¼Œæ²¡æœ‰å­—èŠ‚å¯è¯»è¿”å› -1ï¼Œ**byte ä¸­æ–°è¯»å–çš„æ•°æ®é»˜è®¤æ˜¯è¦†ç›–åŸæ•°æ®**ï¼Œæ„é€  String éœ€è¦è®¾å®šé•¿åº¦
* `public String(byte[] bytes,int offset,int length)`ï¼šæ„é€ æ–°çš„ String
* `public long transferTo(OutputStream out) `ï¼šä»è¾“å…¥æµä¸­è¯»å–æ‰€æœ‰å­—èŠ‚ï¼Œå¹¶æŒ‰è¯»å–çš„é¡ºåºï¼Œå°†å­—èŠ‚å†™å…¥ç»™å®šçš„è¾“å‡ºæµ

```java
public class FileInputStreamDemo01 {
    public static void main(String[] args) throws Exception {
        // 1.åˆ›å»ºæ–‡ä»¶å¯¹è±¡å®šä½dlei01.txt
        File file = new File("Demo/src/dlei01.txt");
        // 2.åˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å…¥æµç®¡é“ä¸æºæ–‡ä»¶æ¥é€š
        InputStream is = new FileInputStream(file);
        // 3.è¯»å–ä¸€ä¸ªå­—èŠ‚çš„ç¼–å·è¿”å›ï¼Œè¯»å–å®Œæ¯•è¿”å›-1
		//int code1 = is.read(); // è¯»å–ä¸€æ»´æ°´ï¼Œä¸€ä¸ªå­—èŠ‚
		//System.out.println((char)code1);

        // 4.ä½¿ç”¨whileè¯»å–å­—èŠ‚æ•°
        // å®šä¹‰ä¸€ä¸ªæ•´æ•°å˜é‡å­˜å‚¨å­—èŠ‚
        int ch = 0 ;
        while((ch = is.read())!= -1){
            System.out.print((char) ch);
        }
    }
}
```

ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚è¯»å–è‹±æ–‡å’Œæ•°å­—æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯è¯»å–ä¸­æ–‡è¾“å‡ºæ— æ³•é¿å…ä¹±ç ï¼Œå› ä¸ºä¼šæˆªæ–­ä¸­æ–‡çš„å­—èŠ‚ã€‚ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚çš„è¯»å–æ•°æ®ï¼Œæ€§èƒ½ä¹Ÿè¾ƒå·®ï¼Œæ‰€ä»¥**ç¦æ­¢ä½¿ç”¨ä¸Šé¢çš„æ–¹æ¡ˆ**

é‡‡å–ä¸‹é¢çš„æ–¹æ¡ˆï¼š

```java
public static void main(String[] args) throws Exception {
    //ç®€åŒ–å†™æ³•ï¼Œåº•å±‚å®è´¨ä¸Šåˆ›å»ºäº†Fileå¯¹è±¡
    InputStream is = new FileInputStream("Demo/src/test.txt");
    byte[] buffer = new byte[3];//å¼€å‘ä¸­ä½¿ç”¨byte[1024]
    int len;
    while((len = is.read(buffer)) !=-1){
        // è¯»å–äº†å¤šå°‘å°±å€’å‡ºå¤šå°‘ï¼
        String rs = new String(buffer, 0, len);
        System.out.print(rs);
    }
}
```

```java
File f = new File("Demo/src/test.txt");
InputStream is = new FileInputStream(f);
// è¯»å–å…¨éƒ¨çš„
byte[] buffer = is.readAllBytes();
String rs = new String(buffer);
System.out.println(rs);
```



****



##### å­—èŠ‚è¾“å‡º

FileOutputStream æ–‡ä»¶å­—èŠ‚è¾“å‡ºæµï¼šä»¥å†…å­˜ä¸ºåŸºå‡†ï¼ŒæŠŠå†…å­˜ä¸­çš„æ•°æ®ï¼ŒæŒ‰ç…§å­—èŠ‚çš„å½¢å¼å†™å‡ºåˆ°ç£ç›˜æ–‡ä»¶ä¸­å»

æ„é€ æ–¹æ³•ï¼š

* `public FileOutputStream(File file)`ï¼šåˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å‡ºæµç®¡é“é€šå‘ç›®æ ‡æ–‡ä»¶å¯¹è±¡
* `public FileOutputStream(String file) `ï¼šåˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å‡ºæµç®¡é“é€šå‘ç›®æ ‡æ–‡ä»¶è·¯å¾„
* `public FileOutputStream(File file, boolean append)` : åˆ›å»ºä¸€ä¸ªè¿½åŠ æ•°æ®çš„å­—èŠ‚è¾“å‡ºæµç®¡é“åˆ°ç›®æ ‡æ–‡ä»¶å¯¹è±¡
* `public FileOutputStream(String file, boolean append)` : åˆ›å»ºä¸€ä¸ªè¿½åŠ æ•°æ®çš„å­—èŠ‚è¾“å‡ºæµç®¡é“é€šå‘ç›®æ ‡æ–‡ä»¶è·¯å¾„

APIï¼š

* `public void write(int a)`ï¼šå†™ä¸€ä¸ªå­—èŠ‚å‡ºå» 
* `public void write(byte[] buffer)`ï¼šå†™ä¸€ä¸ªå­—èŠ‚æ•°ç»„å‡ºå»
* `public void write(byte[] buffer , int pos , int len)`ï¼šå†™ä¸€ä¸ªå­—èŠ‚æ•°ç»„çš„ä¸€éƒ¨åˆ†å‡ºå»ï¼Œä» pos ä½ç½®ï¼Œå†™å‡º len é•¿åº¦

* FileOutputStream å­—èŠ‚è¾“å‡ºæµæ¯æ¬¡å¯åŠ¨å†™æ•°æ®çš„æ—¶å€™éƒ½ä¼šå…ˆæ¸…ç©ºä¹‹å‰çš„å…¨éƒ¨æ•°æ®ï¼Œé‡æ–°å†™å…¥ï¼š
  * `OutputStream os = new FileOutputStream("Demo/out05")`ï¼šè¦†ç›–æ•°æ®ç®¡é“
  * `OutputStream os = new FileOutputStream("Demo/out05" , true)`ï¼šè¿½åŠ æ•°æ®çš„ç®¡é“ 

è¯´æ˜ï¼š

* å­—èŠ‚è¾“å‡ºæµåªèƒ½å†™å­—èŠ‚å‡ºå»ï¼Œå­—èŠ‚è¾“å‡ºæµé»˜è®¤æ˜¯**è¦†ç›–**æ•°æ®ç®¡é“
* æ¢è¡Œç”¨ï¼š**os.write("\r\n".getBytes())**
* å…³é—­å’Œåˆ·æ–°ï¼šåˆ·æ–°æµå¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œå…³é—­åŒ…å«åˆ·æ–°æ•°æ®ä½†æ˜¯æµå°±ä¸èƒ½ä½¿ç”¨äº†

```java
OutputStream os = new FileOutputStream("Demo/out05");
os.write(97);//a
os.write('b');
os.write("\r\n".getBytes());
os.write("æˆ‘çˆ±Java".getBytes());
os.close();
```



##### æ–‡ä»¶å¤åˆ¶

å­—èŠ‚æ˜¯è®¡ç®—æœºä¸­ä¸€åˆ‡æ–‡ä»¶çš„ç»„æˆï¼Œæ‰€ä»¥å­—èŠ‚æµé€‚åˆåšä¸€åˆ‡æ–‡ä»¶çš„å¤åˆ¶

```java
public class CopyDemo01 {
    public static void main(String[] args) {
        InputStream is = null ;
        OutputStream os = null ;
        try{
            //ï¼ˆ1ï¼‰åˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å…¥æµç®¡é“ä¸æºæ–‡ä»¶æ¥é€šã€‚
            is = new FileInputStream("D:\\seazean\\å›¾ç‰‡èµ„æº\\test.jpg");
            //ï¼ˆ2ï¼‰åˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å‡ºæµä¸ç›®æ ‡æ–‡ä»¶æ¥é€šã€‚
            os = new FileOutputStream("D:\\seazean\\test.jpg");
            //ï¼ˆ3ï¼‰åˆ›å»ºä¸€ä¸ªå­—èŠ‚æ•°ç»„ä½œä¸ºæ¡¶
            byte buffer = new byte[1024];
            //ï¼ˆ4ï¼‰ä»å­—èŠ‚è¾“å…¥æµç®¡é“ä¸­è¯»å–æ•°æ®ï¼Œå†™å‡ºåˆ°å­—èŠ‚è¾“å‡ºæµç®¡é“å³å¯
            int len = 0;
            while((len = is.read(buffer)) != -1){
                os.write(buffer,0,len);
            }
            System.out.println("å¤åˆ¶å®Œæˆï¼");
        }catch (Exception e){
            e.printStackTrace();
        } finally {
            /**ï¼ˆ5ï¼‰å…³é—­èµ„æºï¼ */
            try{
                if(os!=null)os.close();
                if(is!=null)is.close();
            }catch (Exception e){
                e.printStackTrace();
            }
        }
    }
}
```



***



#### å­—ç¬¦æµ

##### å­—ç¬¦è¾“å…¥

FileReaderï¼šæ–‡ä»¶å­—ç¬¦è¾“å…¥æµï¼Œä»¥å†…å­˜ä¸ºåŸºå‡†ï¼ŒæŠŠç£ç›˜æ–‡ä»¶çš„æ•°æ®ä»¥å­—ç¬¦çš„å½¢å¼è¯»å…¥åˆ°å†…å­˜ï¼Œè¯»å–æ–‡æœ¬æ–‡ä»¶å†…å®¹åˆ°å†…å­˜ä¸­å»

æ„é€ å™¨ï¼š

* `public FileReader(File file)`ï¼šåˆ›å»ºä¸€ä¸ªå­—ç¬¦è¾“å…¥æµä¸æºæ–‡ä»¶å¯¹è±¡æ¥é€šã€‚
*  `public FileReader(String filePath)`ï¼šåˆ›å»ºä¸€ä¸ªå­—ç¬¦è¾“å…¥æµä¸æºæ–‡ä»¶è·¯å¾„æ¥é€šã€‚

æ–¹æ³•ï¼š

* `public int read()`ï¼šè¯»å–ä¸€ä¸ªå­—ç¬¦çš„ç¼–å·è¿”å›ï¼Œè¯»å–å®Œæ¯•è¿”å› -1
* `public int read(char[] buffer)`ï¼šè¯»å–ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œè¯»å–å¤šå°‘ä¸ªå°±è¿”å›å¤šå°‘ä¸ªï¼Œè¯»å–å®Œæ¯•è¿”å› -1

ç»“è®ºï¼š

* å­—ç¬¦æµä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„è¯»å–æ–‡æœ¬å†…å®¹è¾“å‡ºï¼Œå¯ä»¥è§£å†³ä¸­æ–‡è¯»å–è¾“å‡ºä¹±ç çš„é—®é¢˜ï¼Œé€‚åˆæ“ä½œæ–‡æœ¬æ–‡ä»¶ï¼Œä½†æ˜¯ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„è¯»å–æ–‡æœ¬å†…å®¹æ€§èƒ½è¾ƒå·®
* å­—ç¬¦æµæŒ‰ç…§**å­—ç¬¦æ•°ç»„å¾ªç¯è¯»å–æ•°æ®**ï¼Œå¯ä»¥è§£å†³ä¸­æ–‡è¯»å–è¾“å‡ºä¹±ç çš„é—®é¢˜ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿè¾ƒå¥½

**å­—ç¬¦æµä¸èƒ½å¤åˆ¶å›¾ç‰‡ï¼Œè§†é¢‘ç­‰ç±»å‹çš„æ–‡ä»¶**ã€‚å­—ç¬¦æµåœ¨è¯»å–å®Œäº†å­—èŠ‚æ•°æ®åå¹¶æ²¡æœ‰ç›´æ¥å¾€ç›®çš„åœ°å†™ï¼Œè€Œæ˜¯å…ˆæŸ¥ç¼–ç è¡¨ï¼ŒæŸ¥åˆ°å¯¹åº”çš„æ•°æ®å°±å°†è¯¥æ•°æ®å†™å…¥ç›®çš„åœ°ã€‚å¦‚æœæŸ¥ä¸åˆ°ï¼Œåˆ™ç è¡¨ä¼šå°†ä¸€äº›æœªçŸ¥åŒºåŸŸä¸­çš„æ•°æ®å» map è¿™äº›å­—èŠ‚æ•°æ®ï¼Œç„¶åå†™åˆ°ç›®çš„åœ°ï¼Œè¿™æ ·çš„è¯å°±é€ æˆäº†æºæ•°æ®å’Œç›®çš„æ•°æ®çš„ä¸ä¸€è‡´ã€‚

```java
public class FileReaderDemo01{//å­—ç¬¦
    public static void main(String[] args) throws Exception {
        // åˆ›å»ºä¸€ä¸ªå­—ç¬¦è¾“å…¥æµç®¡é“ä¸æºæ–‡ä»¶è·¯å¾„æ¥é€š
        Reader fr = new FileReader("Demo/src/test.txt");
        int ch;
        while((ch = fr.read()) != -1){
            System.out.print((char)ch);
        }
    }
}
public class FileReaderDemo02 {//å­—ç¬¦æ•°ç»„
    public static void main(String[] args) throws Exception {
        Reader fr = new FileReader("Demo/src/test.txt");
        
        char[] buffer = new char[1024];
        int len;
        while((len = fr.read(buffer)) != -1) {
            System.out.print(new String(buffer, 0 , len));
        }
    }
}
```



***



##### å­—ç¬¦è¾“å‡º

FileWriterï¼šæ–‡ä»¶å­—ç¬¦è¾“å‡ºæµï¼Œä»¥å†…å­˜ä¸ºåŸºå‡†ï¼ŒæŠŠå†…å­˜ä¸­çš„æ•°æ®æŒ‰ç…§å­—ç¬¦çš„å½¢å¼å†™å‡ºåˆ°ç£ç›˜æ–‡ä»¶ä¸­å»

æ„é€ å™¨ï¼š

* `public FileWriter(File file)`ï¼šåˆ›å»ºä¸€ä¸ªå­—ç¬¦è¾“å‡ºæµç®¡é“é€šå‘ç›®æ ‡æ–‡ä»¶å¯¹è±¡ï¼ˆè¦†ç›–æ•°æ®ç®¡é“ï¼‰
* `public FileWriter(String filePath)`ï¼šåˆ›å»ºä¸€ä¸ªå­—ç¬¦è¾“å‡ºæµç®¡é“é€šå‘ç›®æ ‡æ–‡ä»¶è·¯å¾„
* `public FileWriter(File file, boolean append)`ï¼šåˆ›å»ºä¸€ä¸ªè¿½åŠ æ•°æ®çš„å­—ç¬¦è¾“å‡ºæµç®¡é“é€šå‘æ–‡ä»¶å¯¹è±¡ï¼ˆè¿½åŠ æ•°æ®ç®¡é“ï¼‰
* `public FileWriter(String filePath, boolean append)`ï¼šåˆ›å»ºä¸€ä¸ªè¿½åŠ æ•°æ®çš„å­—ç¬¦è¾“å‡ºæµç®¡é“é€šå‘ç›®æ ‡æ–‡ä»¶è·¯å¾„

æ–¹æ³•ï¼š

* `public void write(int c)`ï¼šå†™ä¸€ä¸ªå­—ç¬¦å‡ºå»
* `public void write(char[] buffer)`ï¼šå†™ä¸€ä¸ªå­—ç¬¦æ•°ç»„å‡ºå»
* `public void write(String c, int pos, int len)`ï¼šå†™å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†å‡ºå»
* `public void write(char[] buffer, int pos, int len)`ï¼šå†™å­—ç¬¦æ•°ç»„çš„ä¸€éƒ¨åˆ†å‡ºå»
* `fw.write("\r\n")`ï¼šæ¢è¡Œ

è¯»å†™å­—ç¬¦æ–‡ä»¶æ•°æ®å»ºè®®ä½¿ç”¨å­—ç¬¦æµ

```java
Writer fw = new FileWriter("Demo/src/test.txt");
fw.write(97);   // å­—ç¬¦a
fw.write('b');  // å­—ç¬¦b
fw.write("Javaæ˜¯æœ€ä¼˜ç¾çš„è¯­è¨€ï¼");
fw.write("\r\n");
fw.close;
```



****



#### ç¼“å†²æµ

##### åŸºæœ¬ä»‹ç»

ç¼“å†²æµå¯ä»¥æé«˜å­—èŠ‚æµå’Œå­—ç¬¦æµçš„è¯»å†™æ•°æ®çš„æ€§èƒ½

ç¼“å†²æµåˆ†ä¸ºå››ç±»ï¼š

* BufferedInputStreamï¼šå­—èŠ‚ç¼“å†²è¾“å…¥æµï¼Œå¯ä»¥æé«˜å­—èŠ‚è¾“å…¥æµè¯»æ•°æ®çš„æ€§èƒ½
* BufferedOutStreamï¼šå­—èŠ‚ç¼“å†²è¾“å‡ºæµï¼Œå¯ä»¥æé«˜å­—èŠ‚è¾“å‡ºæµå†™æ•°æ®çš„æ€§èƒ½
* BufferedReaderï¼šå­—ç¬¦ç¼“å†²è¾“å…¥æµï¼Œå¯ä»¥æé«˜å­—ç¬¦è¾“å…¥æµè¯»æ•°æ®çš„æ€§èƒ½
* BufferedWriterï¼šå­—ç¬¦ç¼“å†²è¾“å‡ºæµï¼Œå¯ä»¥æé«˜å­—ç¬¦è¾“å‡ºæµå†™æ•°æ®çš„æ€§èƒ½



***



##### å­—èŠ‚ç¼“å†²è¾“å…¥

å­—èŠ‚ç¼“å†²è¾“å…¥æµï¼šBufferedInputStream

ä½œç”¨ï¼šå¯ä»¥æŠŠä½çº§çš„å­—èŠ‚è¾“å…¥æµåŒ…è£…æˆä¸€ä¸ªé«˜çº§çš„ç¼“å†²å­—èŠ‚è¾“å…¥æµç®¡é“ï¼Œæé«˜å­—èŠ‚è¾“å…¥æµè¯»æ•°æ®çš„æ€§èƒ½

æ„é€ å™¨ï¼š`public BufferedInputStream(InputStream in)`

åŸç†ï¼šç¼“å†²å­—èŠ‚è¾“å…¥æµç®¡é“è‡ªå¸¦äº†ä¸€ä¸ª 8KB çš„ç¼“å†²æ± ï¼Œæ¯æ¬¡å¯ä»¥ç›´æ¥å€Ÿç”¨æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½æœ€å¤šæå– 8KB çš„æ•°æ®åˆ°ç¼“å†²æ± ä¸­å»ï¼Œä»¥åæˆ‘ä»¬ç›´æ¥ä»ç¼“å†²æ± è¯»å–æ•°æ®ï¼Œæ‰€ä»¥æ€§èƒ½è¾ƒå¥½

```java
public class BufferedInputStreamDemo01 {
    public static void main(String[] args) throws Exception {
        // 1.å®šä¹‰ä¸€ä¸ªä½çº§çš„å­—èŠ‚è¾“å…¥æµä¸æºæ–‡ä»¶æ¥é€š
        InputStream is = new FileInputStream("Demo/src/test.txt");
        // 2.æŠŠä½çº§çš„å­—èŠ‚è¾“å…¥æµåŒ…è£…æˆä¸€ä¸ªé«˜çº§çš„ç¼“å†²å­—èŠ‚è¾“å…¥æµã€‚
        BufferInputStream bis = new BufferInputStream(is);
        // 3.å®šä¹‰ä¸€ä¸ªå­—èŠ‚æ•°ç»„æŒ‰ç…§å¾ªç¯è¯»å–ã€‚
        byte[] buffer = new byte[1024];
        int len;
        while((len = bis.read(buffer)) != -1){
            String rs = new String(buffer, 0 , len);
            System.out.print(rs);
        }
    }
}
```



***



##### å­—èŠ‚ç¼“å†²è¾“å‡º

å­—èŠ‚ç¼“å†²è¾“å‡ºæµï¼šBufferedOutputStream

ä½œç”¨ï¼šå¯ä»¥æŠŠä½çº§çš„å­—èŠ‚è¾“å‡ºæµåŒ…è£…æˆä¸€ä¸ªé«˜çº§çš„ç¼“å†²å­—èŠ‚è¾“å‡ºæµï¼Œä»è€Œæé«˜å†™æ•°æ®çš„æ€§èƒ½

æ„é€ å™¨ï¼š`public BufferedOutputStream(OutputStream os)`

åŸç†ï¼šç¼“å†²å­—èŠ‚è¾“å‡ºæµè‡ªå¸¦äº† 8KB ç¼“å†²æ± ,æ•°æ®å°±ç›´æ¥å†™å…¥åˆ°ç¼“å†²æ± ä¸­å»ï¼Œæ€§èƒ½æé«˜äº†

```java
public class BufferedOutputStreamDemo02 {
    public static void main(String[] args) throws Exception {
        // 1.å†™ä¸€ä¸ªåŸå§‹çš„å­—èŠ‚è¾“å‡ºæµ
        OutputStream os = new FileOutputStream("Demo/src/test.txt");
        // 2.æŠŠä½çº§çš„å­—èŠ‚è¾“å‡ºæµåŒ…è£…æˆä¸€ä¸ªé«˜çº§çš„ç¼“å†²å­—èŠ‚è¾“å‡ºæµ
        BufferedOutputStream bos =  new BufferedOutputStream(os);
        // 3.å†™æ•°æ®å‡ºå»
        bos.write('a');
        bos.write(100);
        bos.write("æˆ‘çˆ±ä¸­å›½".getBytes());
        bos.close();
    }
}

```



##### å­—èŠ‚æµæ€§èƒ½

åˆ©ç”¨å­—èŠ‚æµçš„å¤åˆ¶ç»Ÿè®¡å„ç§å†™æ³•å½¢å¼ä¸‹ç¼“å†²æµçš„æ€§èƒ½æ‰§è¡Œæƒ…å†µ

å¤åˆ¶æµï¼š

* ä½¿ç”¨ä½çº§çš„å­—èŠ‚æµæŒ‰ç…§ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚çš„å½¢å¼å¤åˆ¶æ–‡ä»¶
* ä½¿ç”¨ä½çº§çš„å­—èŠ‚æµæŒ‰ç…§ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚æ•°ç»„çš„å½¢å¼å¤åˆ¶æ–‡ä»¶
* ä½¿ç”¨é«˜çº§çš„ç¼“å†²å­—èŠ‚æµæŒ‰ç…§ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚çš„å½¢å¼å¤åˆ¶æ–‡ä»¶
* ä½¿ç”¨é«˜çº§çš„ç¼“å†²å­—èŠ‚æµæŒ‰ç…§ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚æ•°ç»„çš„å½¢å¼å¤åˆ¶æ–‡ä»¶

é«˜çº§çš„ç¼“å†²å­—èŠ‚æµæŒ‰ç…§ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚æ•°ç»„çš„å½¢å¼å¤åˆ¶æ–‡ä»¶ï¼Œæ€§èƒ½æœ€é«˜ï¼Œå»ºè®®ä½¿ç”¨



****



##### å­—ç¬¦ç¼“å†²è¾“å…¥

å­—ç¬¦ç¼“å†²è¾“å…¥æµï¼šBufferedReader

ä½œç”¨ï¼šå­—ç¬¦ç¼“å†²è¾“å…¥æµæŠŠå­—ç¬¦è¾“å…¥æµåŒ…è£…æˆé«˜çº§çš„ç¼“å†²å­—ç¬¦è¾“å…¥æµï¼Œå¯ä»¥æé«˜å­—ç¬¦è¾“å…¥æµè¯»æ•°æ®çš„æ€§èƒ½ã€‚

æ„é€ å™¨ï¼š`public BufferedReader(Reader reader)`

åŸç†ï¼šç¼“å†²å­—ç¬¦è¾“å…¥æµé»˜è®¤ä¼šæœ‰ä¸€ä¸ª 8K çš„å­—ç¬¦ç¼“å†²æ± ,å¯ä»¥æé«˜è¯»å­—ç¬¦çš„æ€§èƒ½

æŒ‰ç…§è¡Œè¯»å–æ•°æ®çš„åŠŸèƒ½ï¼š`public String readLine()`  è¯»å–ä¸€è¡Œæ•°æ®è¿”å›ï¼Œè¯»å–å®Œæ¯•è¿”å› null

```java
public static void main(String[] args) throws Exception {
    // 1.å®šä¹‰ä¸€ä¸ªåŸå§‹çš„å­—ç¬¦è¾“å…¥æµè¯»å–æºæ–‡ä»¶
    Reader fr = new FileReader("Demo/src/test.txt");
    // 2.æŠŠä½çº§çš„å­—ç¬¦è¾“å…¥æµç®¡é“åŒ…è£…æˆä¸€ä¸ªé«˜çº§çš„ç¼“å†²å­—ç¬¦è¾“å…¥æµç®¡é“
    BufferedReader br = new BufferedReader(fr);
    // å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡å­˜å‚¨æ¯è¡Œæ•°æ®
    String line;
    while((line = br.readLine()) != null){
        System.out.println(line);
    }
    br.close();
    //æ·˜æ±°æ•°ç»„å¾ªç¯è¯»å–
    //char[] buffer = new char[1024];
    //int len;
    //while((len = br.read(buffer)) != -1){
    //System.out.println(new String(buffer , 0 , len));
}
```



***



##### å­—ç¬¦ç¼“å†²è¾“å‡º

ç¬¦ç¼“å†²è¾“å‡ºæµï¼šBufferedWriter

ä½œç”¨ï¼šæŠŠä½çº§çš„å­—ç¬¦è¾“å‡ºæµåŒ…è£…æˆä¸€ä¸ªé«˜çº§çš„ç¼“å†²å­—ç¬¦è¾“å‡ºæµï¼Œæé«˜å†™å­—ç¬¦æ•°æ®çš„æ€§èƒ½ã€‚

æ„é€ å™¨ï¼š`public BufferedWriter(Writer writer)`

 åŸç†ï¼šé«˜çº§çš„å­—ç¬¦ç¼“å†²è¾“å‡ºæµå¤šäº†ä¸€ä¸ª 8K çš„å­—ç¬¦ç¼“å†²æ± ï¼Œå†™æ•°æ®æ€§èƒ½æå¤§æé«˜äº†

å­—ç¬¦ç¼“å†²è¾“å‡ºæµå¤šäº†ä¸€ä¸ªæ¢è¡Œçš„ç‰¹æœ‰åŠŸèƒ½ï¼š`public void newLine()`  **æ–°å»ºä¸€è¡Œ**

```java
public static void main(String[] args) throws Exception {
    Writer fw = new FileWriter("Demo/src/test.txt",true);//è¿½åŠ 
    BufferedWriter bw = new BufferedWriter(fw);
    
    bw.write("æˆ‘çˆ±å­¦ä¹ Java");
    bw.newLine();//æ¢è¡Œ
    bw.close();
}
```



***



##### é«˜æ•ˆåŸå› 

å­—ç¬¦å‹ç¼“å†²æµé«˜æ•ˆçš„åŸå› ï¼šï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰

* BufferedReaderï¼šæ¯æ¬¡è°ƒç”¨ read æ–¹æ³•ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ä»ç£ç›˜ä¸­è¯»å–äº† 8192ï¼ˆ**8k**ï¼‰ä¸ªå­—ç¬¦ï¼Œå­˜å‚¨åˆ°è¯¥ç±»å‹å¯¹è±¡çš„ç¼“å†²åŒºæ•°ç»„ä¸­ï¼Œå°†å…¶ä¸­ä¸€ä¸ªè¿”å›ç»™è°ƒç”¨è€…ï¼Œå†æ¬¡è°ƒç”¨ read æ–¹æ³•æ—¶ï¼Œå°±ä¸éœ€è¦è®¿é—®ç£ç›˜ï¼Œç›´æ¥ä»ç¼“å†²åŒºä¸­æ‹¿å‡ºä¸€ä¸ªæ•°æ®å³å¯ï¼Œæå‡äº†æ•ˆç‡
* BufferedWriterï¼šæ¯æ¬¡è°ƒç”¨ write æ–¹æ³•ï¼Œä¸ä¼šç›´æ¥å°†å­—ç¬¦åˆ·æ–°åˆ°æ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯å­˜å‚¨åˆ°å­—ç¬¦æ•°ç»„ä¸­ï¼Œç­‰å­—ç¬¦æ•°ç»„å†™æ»¡äº†ï¼Œæ‰ä¸€æ¬¡æ€§åˆ·æ–°åˆ°æ–‡ä»¶ä¸­ï¼Œå‡å°‘äº†å’Œç£ç›˜äº¤äº’çš„æ¬¡æ•°ï¼Œæå‡äº†æ•ˆç‡

å­—èŠ‚å‹ç¼“å†²æµé«˜æ•ˆçš„åŸå› ï¼š

* BufferedInputStreamï¼šåœ¨è¯¥ç±»å‹ä¸­å‡†å¤‡äº†ä¸€ä¸ªæ•°ç»„ï¼Œå­˜å‚¨å­—èŠ‚ä¿¡æ¯ï¼Œå½“å¤–ç•Œè°ƒç”¨ read() æ–¹æ³•æƒ³è·å–ä¸€ä¸ªå­—èŠ‚çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡ä»æ–‡ä»¶ä¸­ä¸€æ¬¡æ€§è¯»å–äº† 8192 ä¸ªå­—èŠ‚åˆ°æ•°ç»„ä¸­ï¼Œåªè¿”å›äº†ç¬¬ä¸€ä¸ªå­—èŠ‚ç»™è°ƒç”¨è€…ã€‚å°†æ¥è°ƒç”¨è€…å†æ¬¡è°ƒç”¨ read æ–¹æ³•æ—¶ï¼Œå½“å‰å¯¹è±¡å°±ä¸éœ€è¦å†æ¬¡è®¿é—®ç£ç›˜ï¼Œåªéœ€è¦ä»æ•°ç»„ä¸­å–å‡ºä¸€ä¸ªå­—èŠ‚è¿”å›ç»™è°ƒç”¨è€…å³å¯ï¼Œç”±äºè¯»å–çš„æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥é€Ÿåº¦éå¸¸å¿«ã€‚å½“ 8192 ä¸ªå­—èŠ‚å…¨éƒ½è¯»å–å®Œæˆä¹‹åï¼Œå†éœ€è¦è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå°±å¾—è®©è¯¥å¯¹è±¡åˆ°æ–‡ä»¶ä¸­è¯»å–ä¸‹ä¸€ä¸ª 8192 ä¸ªå­—èŠ‚
* BufferedOutputStreamï¼šåœ¨è¯¥ç±»å‹ä¸­å‡†å¤‡äº†ä¸€ä¸ªæ•°ç»„ï¼Œå­˜å‚¨å­—èŠ‚ä¿¡æ¯ï¼Œå½“å¤–ç•Œè°ƒç”¨ write æ–¹æ³•æƒ³å†™å‡ºä¸€ä¸ªå­—èŠ‚çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡ç›´æ¥å°†è¿™ä¸ªå­—èŠ‚å­˜å‚¨åˆ°äº†è‡ªå·±çš„æ•°ç»„ä¸­ï¼Œè€Œä¸åˆ·æ–°åˆ°æ–‡ä»¶ä¸­ã€‚ä¸€ç›´åˆ°è¯¥æ•°ç»„æ‰€æœ‰ 8192 ä¸ªä½ç½®å…¨éƒ½å æ»¡ï¼Œè¯¥å¯¹è±¡æ‰æŠŠè¿™ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰æ•°æ®ä¸€æ¬¡æ€§å†™å‡ºåˆ°ç›®æ ‡æ–‡ä»¶ä¸­ã€‚å¦‚æœæœ€åä¸€æ¬¡å¾ªç¯æ²¡æœ‰å°†æ•°ç»„å†™æ»¡ï¼Œæœ€ç»ˆåœ¨å…³é—­æµå¯¹è±¡çš„æ—¶å€™ï¼Œä¹Ÿä¼šå°†è¯¥æ•°ç»„ä¸­çš„æ•°æ®åˆ·æ–°åˆ°æ–‡ä»¶ä¸­ã€‚ 



æ³¨æ„ï¼š**å­—èŠ‚æµå’Œå­—ç¬¦æµï¼Œéƒ½æ˜¯è£…æ»¡æ—¶è‡ªåŠ¨å†™å‡ºï¼Œæˆ–è€…æ²¡æ»¡æ—¶æ‰‹åŠ¨ flush å†™å‡ºï¼Œæˆ– close æ—¶åˆ·æ–°å†™å‡º**



***



#### è½¬æ¢æµ

##### ä¹±ç é—®é¢˜

å­—ç¬¦æµè¯»å–ï¼š

```
ä»£ç ç¼–ç             æ–‡ä»¶ç¼–ç          ä¸­æ–‡æƒ…å†µã€‚
UTF-8              UTF-8           ä¸ä¹±ç !
GBK                GBK             ä¸ä¹±ç !
UTF-8              GBK             ä¹±ç !
```

* å¦‚æœä»£ç ç¼–ç å’Œè¯»å–çš„æ–‡ä»¶ç¼–ç ä¸€è‡´ï¼Œå­—ç¬¦æµè¯»å–çš„æ—¶å€™ä¸ä¼šä¹±ç 
* å¦‚æœä»£ç ç¼–ç å’Œè¯»å–çš„æ–‡ä»¶ç¼–ç ä¸ä¸€è‡´ï¼Œå­—ç¬¦æµè¯»å–çš„æ—¶å€™ä¼šä¹±ç 



***



##### å­—ç¬¦è¾“å…¥

å­—ç¬¦è¾“å…¥è½¬æ¢æµï¼šInputStreamReader

ä½œç”¨ï¼šè§£å†³å­—ç¬¦æµè¯»å–ä¸åŒç¼–ç çš„ä¹±ç é—®é¢˜ï¼ŒæŠŠåŸå§‹çš„**å­—èŠ‚æµ**æŒ‰ç…§é»˜è®¤çš„ç¼–ç æˆ–æŒ‡å®šçš„ç¼–ç **è½¬æ¢æˆå­—ç¬¦è¾“å…¥æµ**

æ„é€ å™¨ï¼š

* `public InputStreamReader(InputStream is)`ï¼šä½¿ç”¨å½“å‰ä»£ç é»˜è®¤ç¼–ç  UTF-8 è½¬æ¢æˆå­—ç¬¦æµ
* `public InputStreamReader(InputStream is, String charset)`ï¼šæŒ‡å®šç¼–ç æŠŠå­—èŠ‚æµè½¬æ¢æˆå­—ç¬¦æµ

```java
public class InputStreamReaderDemo{
    public static void main(String[] args) throws Exception {
        // 1.æå–GBKæ–‡ä»¶çš„åŸå§‹å­—èŠ‚æµ
        InputStream is = new FileInputStream("D:\\seazean\\Netty.txt");
        // 2.æŠŠåŸå§‹å­—èŠ‚è¾“å…¥æµé€šè¿‡è½¬æ¢æµï¼Œè½¬æ¢æˆ å­—ç¬¦è¾“å…¥è½¬æ¢æµInputStreamReader
        InputStreamReader isr = new InputStreamReader(is, "GBK"); 
        // 3.åŒ…è£…æˆç¼“å†²æµ
        BufferedReader br = new BufferedReader(isr);
        //å¾ªç¯è¯»å–
        String line;
        while((line = br.readLine()) != null){
            System.out.println(line);
        }
    }
}
```



***



##### å­—ç¬¦è¾“å‡º

å­—ç¬¦è¾“å‡ºè½¬æ¢æµï¼šOutputStreamWriter

ä½œç”¨ï¼šå¯ä»¥æŒ‡å®šç¼–ç **æŠŠå­—èŠ‚è¾“å‡ºæµè½¬æ¢æˆå­—ç¬¦è¾“å‡ºæµ**ï¼Œå¯ä»¥æŒ‡å®šå†™å‡ºå»çš„å­—ç¬¦çš„ç¼–ç 

æ„é€ å™¨ï¼š

* `public OutputStreamWriter(OutputStream os)`ï¼šç”¨é»˜è®¤ç¼–ç  UTF-8 æŠŠå­—èŠ‚è¾“å‡ºæµè½¬æ¢æˆå­—ç¬¦è¾“å‡ºæµ
* `public OutputStreamWriter(OutputStream os, String charset)`ï¼šæŒ‡å®šç¼–ç æŠŠå­—èŠ‚è¾“å‡ºæµè½¬æ¢æˆ

```Java
OutputStream os = new FileOutputStream("Demo/src/test.txt");
OutputStreamWriter osw = new OutputStreamWriter(os,"GBK");
osw.write("æˆ‘åœ¨å­¦ä¹ Java");   
osw.close();
```



****



#### åºåˆ—åŒ–

##### åŸºæœ¬ä»‹ç»

å¯¹è±¡åºåˆ—åŒ–ï¼šæŠŠ Java å¯¹è±¡è½¬æ¢æˆå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼Œå°†å¯¹è±¡å†™å…¥åˆ° IO æµä¸­ï¼Œå¯¹è±¡ => æ–‡ä»¶ä¸­

å¯¹è±¡ååºåˆ—åŒ–ï¼šæŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸º Java å¯¹è±¡çš„è¿‡ç¨‹ï¼Œä» IO æµä¸­æ¢å¤å¯¹è±¡ï¼Œæ–‡ä»¶ä¸­ => å¯¹è±¡

transient å…³é”®å­—ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œå°†ä¸å‚ä¸åºåˆ—åŒ–



***



##### åºåˆ—åŒ–

å¯¹è±¡åºåˆ—åŒ–æµï¼ˆå¯¹è±¡å­—èŠ‚è¾“å‡ºæµï¼‰ï¼šObjectOutputStream

ä½œç”¨ï¼šæŠŠå†…å­˜ä¸­çš„ Java å¯¹è±¡æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶ä¸­å»

æ„é€ å™¨ï¼š`public ObjectOutputStream(OutputStream out)`

åºåˆ—åŒ–æ–¹æ³•ï¼š`public final void writeObject(Object obj)`

æ³¨æ„ï¼šå¯¹è±¡å¦‚æœæƒ³å‚ä¸åºåˆ—åŒ–ï¼Œå¯¹è±¡å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ **implements Serializable** ï¼Œå¦åˆ™åºåˆ—åŒ–å¤±è´¥

```java
public class SerializeDemo01 {
    public static void main(String[] args) throws Exception {
        // 1.åˆ›å»ºUserç”¨æˆ·å¯¹è±¡
        User user = new User("seazean","980823","ä¸ƒåä¸€");
        // 2.åˆ›å»ºä½çº§çš„å­—èŠ‚è¾“å‡ºæµé€šå‘ç›®æ ‡æ–‡ä»¶
        OutputStream os = new FileOutputStream("Demo/src/obj.dat");
        // 3.æŠŠä½çº§çš„å­—èŠ‚è¾“å‡ºæµåŒ…è£…æˆé«˜çº§çš„å¯¹è±¡å­—èŠ‚è¾“å‡ºæµ ObjectOutputStream
        ObjectOutputStream oos = new ObjectOutputStream(os);
        // 4.é€šè¿‡å¯¹è±¡å­—èŠ‚è¾“å‡ºæµåºåˆ—åŒ–å¯¹è±¡ï¼š
        oos.writeObject(user);
        // 5.é‡Šæ”¾èµ„æº
        oos.close();
        System.out.println("åºåˆ—åŒ–å¯¹è±¡æˆåŠŸ~~~~");
    }
}

class User implements Serializable {
    // åŠ å…¥åºåˆ—ç‰ˆæœ¬å·
    private static final long serialVersionUID = 1L;

    private String loginName;
    private transient String passWord;
    private String userName;
    // get+set
}
```

```java
// åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®
ByteArrayOutputStream bos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(bos);
oos.writeObject(obj);	// å°†è¯¥å¯¹è±¡åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®
oos.flush();
byte[] bytes = bos.toByteArray();
```





****



##### ååºåˆ—

å¯¹è±¡ååºåˆ—åŒ–ï¼ˆå¯¹è±¡å­—èŠ‚è¾“å…¥æµï¼‰ï¼šObjectInputStream

ä½œç”¨ï¼šè¯»å–åºåˆ—åŒ–çš„å¯¹è±¡æ–‡ä»¶æ¢å¤åˆ° Java å¯¹è±¡ä¸­

æ„é€ å™¨ï¼š`public ObjectInputStream(InputStream is)`

æ–¹æ³•ï¼š`public final Object readObject()`

åºåˆ—åŒ–ç‰ˆæœ¬å·ï¼š`private static final long serialVersionUID = 2L`

æ³¨æ„ï¼šåºåˆ—åŒ–ä½¿ç”¨çš„ç‰ˆæœ¬å·å’Œååºåˆ—åŒ–ä½¿ç”¨çš„ç‰ˆæœ¬å·ä¸€è‡´æ‰å¯ä»¥æ­£å¸¸ååºåˆ—åŒ–ï¼Œå¦åˆ™æŠ¥é”™

```java
public class SerializeDemo02 {
    public static void main(String[] args) throws Exception {
        InputStream is = new FileInputStream("Demo/src/obj.dat");
        ObjectInputStream ois = new ObjectInputStream(is);
        User user = (User)ois.readObject();//ååºåˆ—åŒ–
        System.out.println(user);
        System.out.println("ååºåˆ—åŒ–å®Œæˆï¼");
    }
}
class User implements Serializable {
    // åŠ å…¥åºåˆ—ç‰ˆæœ¬å·
    private static final long serialVersionUID = 1L;
    //........
}
```



****



#### æ‰“å°æµ

æ‰“å°æµ PrintStream / PrintWriter

æ‰“å°æµçš„ä½œç”¨ï¼š

* å¯ä»¥æ–¹ä¾¿ï¼Œå¿«é€Ÿçš„å†™æ•°æ®å‡ºå»ï¼Œå¯ä»¥å®ç°æ‰“å°ä»€ä¹ˆç±»å‹ï¼Œå°±æ˜¯ä»€ä¹ˆç±»å‹
* PrintStream/PrintWriter ä¸å…‰å¯ä»¥æ‰“å°æ•°æ®ï¼Œè¿˜å¯ä»¥å†™å­—èŠ‚æ•°æ®å’Œå­—ç¬¦æ•°æ®å‡ºå»
* **System.out.print() åº•å±‚åŸºäºæ‰“å°æµå®ç°çš„** 

æ„é€ å™¨ï¼š

* `public PrintStream(OutputStream os)`
* `public PrintStream(String filepath)`

System ç±»ï¼š

* `public static void setOut(PrintStream out)`ï¼šè®©ç³»ç»Ÿçš„è¾“å‡ºæµå‘æ‰“å°æµ

```java
public class PrintStreamDemo01 {
    public static void main(String[] args) throws Exception {
        PrintStream ps = new  PrintStream("Demo/src/test.txt");
        ps.println(ä»»ä½•ç±»å‹çš„æ•°æ®);
        ps.print(ä¸æ¢è¡Œ);
        ps.write("æˆ‘çˆ±ä½ ".getBytes());
        ps.close();
    }
}
public class PrintStreamDemo02 {
    public static void main(String[] args) throws Exception {
        System.out.println("==seazean0==");
        PrintStream ps = new PrintStream("Demo/src/log.txt");
        System.setOut(ps); // è®©ç³»ç»Ÿçš„è¾“å‡ºæµå‘æ‰“å°æµ
		//ä¸è¾“å‡ºåœ¨æ§åˆ¶å°ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶é‡Œ
        System.out.println("==seazean1==");
        System.out.println("==seazean2==");
    }
}
```



***



### Close

try-with-resourcesï¼š

```java
try(
    // è¿™é‡Œåªèƒ½æ”¾ç½®èµ„æºå¯¹è±¡ï¼Œç”¨å®Œä¼šè‡ªåŠ¨è°ƒç”¨close()å…³é—­
){

}catch(Exception e){
 	e.printStackTrace();
}
```

èµ„æºç±»ä¸€å®šæ˜¯å®ç°äº† Closeable æ¥å£ï¼Œå®ç°è¿™ä¸ªæ¥å£çš„ç±»å°±æ˜¯èµ„æº

æœ‰ close() æ–¹æ³•ï¼Œtry-with-resources ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒçš„ close() å…³é—­èµ„æº

```java
try(
	/** ï¼ˆ1ï¼‰åˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å…¥æµç®¡é“ä¸æºæ–‡ä»¶æ¥é€šã€‚ */
	InputStream is  = new FileInputStream("D:\\seazean\\å›¾ç‰‡èµ„æº\\meinv.jpg");
	/** ï¼ˆ2ï¼‰åˆ›å»ºä¸€ä¸ªå­—èŠ‚è¾“å‡ºæµä¸ç›®æ ‡æ–‡ä»¶æ¥é€šã€‚*/
	OutputStream os = new FileOutputStream("D:\\seazean\\meimei.jpg");
	/** ï¼ˆ5ï¼‰å…³é—­èµ„æºï¼æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ */
){
	byte[] buffer = new byte[1024];
	int len = 0;
	while((len = is.read(buffer)) != -1){
		os.write(buffer, 0 , len);
	}
	System.out.println("å¤åˆ¶å®Œæˆï¼");
}catch (Exception e){
	e.printStackTrace();
}
```



***



### Properties

Propertiesï¼šå±æ€§é›†å¯¹è±¡ã€‚å°±æ˜¯ä¸€ä¸ª Map é›†åˆï¼Œä¸€ä¸ªé”®å€¼å¯¹é›†åˆ

æ ¸å¿ƒä½œç”¨ï¼šProperties ä»£è¡¨çš„æ˜¯ä¸€ä¸ªå±æ€§æ–‡ä»¶ï¼Œå¯ä»¥æŠŠé”®å€¼å¯¹æ•°æ®å­˜å…¥åˆ°ä¸€ä¸ªå±æ€§æ–‡ä»¶

å±æ€§æ–‡ä»¶ï¼šåç¼€æ˜¯ `.properties` ç»“å°¾çš„æ–‡ä»¶ï¼Œé‡Œé¢çš„å†…å®¹éƒ½æ˜¯ key=value

Properties æ–¹æ³•ï¼š

| æ–¹æ³•å                                       | è¯´æ˜                                          |
| -------------------------------------------- | --------------------------------------------- |
| Object setProperty(String key, String value) | è®¾ç½®é›†åˆçš„é”®å’Œå€¼ï¼Œåº•å±‚è°ƒç”¨ Hashtable æ–¹æ³• put |
| String getProperty(String key)               | ä½¿ç”¨æ­¤å±æ€§åˆ—è¡¨ä¸­æŒ‡å®šçš„é”®æœç´¢å±æ€§              |
| Set<String>   stringPropertyNames()          | æ‰€æœ‰é”®çš„åç§°çš„é›†åˆ                            |
| synchronized void load(Reader r)             | ä»è¾“å…¥å­—ç¬¦æµè¯»å–å±æ€§åˆ—è¡¨ï¼ˆé”®å’Œå…ƒç´ å¯¹ï¼‰        |
| synchronized void load(InputStream in)       | åŠ è½½å±æ€§æ–‡ä»¶çš„æ•°æ®åˆ°å±æ€§é›†å¯¹è±¡ä¸­å»            |
| void store(Writer w, String comments)        | å°†æ­¤å±æ€§åˆ—è¡¨(é”®å’Œå…ƒç´ å¯¹)å†™å…¥ Properties è¡¨    |
| void store(OutputStream os, String comments) | ä¿å­˜æ•°æ®åˆ°å±æ€§æ–‡ä»¶ä¸­å»                        |

````java
public class PropertiesDemo01 {
    public static void main(String[] args) throws Exception {
        // a.åˆ›å»ºä¸€ä¸ªå±æ€§é›†å¯¹è±¡ï¼šPropertiesçš„å¯¹è±¡ã€‚
        Properties properties = new Properties();//{}
        properties.setProperty("admin" , "123456");
        // b.æŠŠå±æ€§é›†å¯¹è±¡çš„æ•°æ®å­˜å…¥åˆ°å±æ€§æ–‡ä»¶ä¸­å»ï¼ˆé‡ç‚¹ï¼‰
        OutputStream os = new FileOutputStream("Demo/src/users.properties");
        properties.store(os,"i am very happy!!æˆ‘ä¿å­˜äº†ç”¨æˆ·æ•°æ®!");
        //å‚æ•°ä¸€ï¼šè¢«ä¿å­˜æ•°æ®çš„è¾“å‡ºç®¡é“
        //å‚æ•°äºŒï¼šä¿å­˜å¿ƒå¾—ã€‚å°±æ˜¯å¯¹è±¡ä¿å­˜çš„æ•°æ®è¿›è¡Œè§£é‡Šè¯´æ˜ï¼
    }
}
````

````java
public class PropertiesDemo02 {
    public static void main(String[] args) throws Exception {
        Properties properties = new Properties();//åº•å±‚åŸºäºmapé›†åˆ
        properties.load(new FileInputStream("Demo/src/users.properties"));
        System.out.println(properties);
        System.out.println(properties.getProperty("admin"));
        
		Set<String> set = properties.stringPropertyNames();
        for (String s : set) {
            String value = properties.getProperty(s);
            System.out.println(s + value);
        }
    }
}
````



***



### RandomIO

RandomAccessFile ç±»ï¼šè¯¥ç±»çš„å®ä¾‹æ”¯æŒè¯»å–å’Œå†™å…¥éšæœºè®¿é—®æ–‡ä»¶

æ„é€ å™¨ï¼š

* `RandomAccessFile(File file, String mode)`ï¼šåˆ›å»ºéšæœºè®¿é—®æ–‡ä»¶æµï¼Œä» File å‚æ•°æŒ‡å®šçš„æ–‡ä»¶è¯»å–ï¼Œå¯é€‰æ‹©å†™å…¥
* `RandomAccessFile(String name, String mode)`ï¼šåˆ›å»ºéšæœºè®¿é—®æ–‡ä»¶æµï¼Œä»æŒ‡å®šåç§°æ–‡ä»¶è¯»å–ï¼Œå¯é€‰æ‹©å†™å…¥æ–‡ä»¶

å¸¸ç”¨æ–¹æ³•ï¼š

* `public void seek(long pos)`ï¼šè®¾ç½®æ–‡ä»¶æŒ‡é’ˆåç§»ï¼Œä»è¯¥æ–‡ä»¶å¼€å¤´æµ‹é‡ï¼Œå‘ç”Ÿä¸‹ä¸€æ¬¡è¯»å–æˆ–å†™å…¥(æ’å…¥+è¦†ç›–)
* `public void write(byte[] b)`ï¼šä»æŒ‡å®šçš„å­—èŠ‚æ•°ç»„å†™å…¥ b.length ä¸ªå­—èŠ‚åˆ°è¯¥æ–‡ä»¶
* `public int read(byte[] b)`ï¼šä»è¯¥æ–‡ä»¶è¯»å–æœ€å¤š b.length ä¸ªå­—èŠ‚çš„æ•°æ®åˆ°å­—èŠ‚æ•°ç»„

```java
public static void main(String[] args) throws Exception {
    RandomAccessFile rf = new RandomAccessFile(new File(),"rw");
    rf.write("hello world".getBytes());
    rf.seek(5);//helloxxxxld
    rf.write("xxxx".getBytes());
    rf.close();
}
```



***



### Commons

commons-io æ˜¯ apache æä¾›çš„ä¸€ç»„æœ‰å…³ IO æ“ä½œçš„ç±»åº“ï¼Œå¯ä»¥æé«˜ IO åŠŸèƒ½å¼€å‘çš„æ•ˆç‡

commons-io å·¥å…·åŒ…æä¾›äº†å¾ˆå¤šæœ‰å…³ IO æ“ä½œçš„ç±»ï¼š

| åŒ…                                  | åŠŸèƒ½æè¿°                                        |
| ----------------------------------- | :---------------------------------------------- |
| org.apache.commons.io               | æœ‰å…³ Streamsã€Readersã€Writersã€Files çš„å·¥å…·ç±»  |
| org.apache.commons.io.input         | è¾“å…¥æµç›¸å…³çš„å®ç°ç±»ï¼ŒåŒ…å« Reader å’Œ InputStream  |
| org.apache.commons.io.output        | è¾“å‡ºæµç›¸å…³çš„å®ç°ç±»ï¼ŒåŒ…å« Writer å’Œ OutputStream |
| org.apache.commons.io.serialization | åºåˆ—åŒ–ç›¸å…³çš„ç±»                                  |

IOUtils å’Œ FileUtils å¯ä»¥æ–¹ä¾¿çš„å¤åˆ¶æ–‡ä»¶å’Œæ–‡ä»¶å¤¹

```java
public class CommonsIODemo01 {
    public static void main(String[] args) throws Exception {
        // 1.å®Œæˆæ–‡ä»¶å¤åˆ¶ï¼
        IOUtils.copy(new FileInputStream("Demo/src/books.xml"), 
                     new FileOutputStream("Demo/new.xml"));
        // 2.å®Œæˆæ–‡ä»¶å¤åˆ¶åˆ°æŸä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼
        FileUtils.copyFileToDirectory(new File("Demo/src/books.xml"),
                                      new File("D:/it"));
        // 3.å®Œæˆæ–‡ä»¶å¤¹å¤åˆ¶åˆ°æŸä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼
        FileUtils.copyDirectoryToDirectory(new File("D:\\it\\å›¾ç‰‡æœåŠ¡å™¨") ,
                                           new File("D:\\"));

        //  Javaä»1.7å¼€å§‹æä¾›äº†ä¸€äº›nio, è‡ªå·±ä¹Ÿæœ‰ä¸€è¡Œä»£ç å®Œæˆå¤åˆ¶çš„æŠ€æœ¯ã€‚
        Files.copy(Paths.get("Demo/src/books.xml")
                , new FileOutputStream("Demo/new11.txt"));
    }
}
```





***





## åå°„

### æµ‹è¯•æ¡†æ¶

å•å…ƒæµ‹è¯•çš„ç»å…¸æ¡†æ¶ï¼šJunitï¼Œæ˜¯ Java è¯­è¨€ç¼–å†™çš„ç¬¬ä¸‰æ–¹å•å…ƒæµ‹è¯•æ¡†æ¶

å•å…ƒæµ‹è¯•ï¼š
* å•å…ƒï¼šåœ¨ Java ä¸­ï¼Œä¸€ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•å…ƒ
*  å•å…ƒæµ‹è¯•ï¼šJunit ç¼–å†™çš„ä¸€å°æ®µä»£ç ï¼Œç”¨æ¥å¯¹æŸä¸ªç±»ä¸­çš„æŸä¸ªæ–¹æ³•è¿›è¡ŒåŠŸèƒ½æµ‹è¯•æˆ–ä¸šåŠ¡é€»è¾‘æµ‹è¯•	

Junit å•å…ƒæµ‹è¯•æ¡†æ¶çš„ä½œç”¨ï¼š

* ç”¨æ¥å¯¹ç±»ä¸­çš„æ–¹æ³•åŠŸèƒ½è¿›è¡Œæœ‰ç›®çš„çš„æµ‹è¯•ï¼Œä»¥ä¿è¯ç¨‹åºçš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§
* èƒ½å¤Ÿ**ç‹¬ç«‹çš„**æµ‹è¯•æŸä¸ªæ–¹æ³•æˆ–è€…æ‰€æœ‰æ–¹æ³•çš„é¢„æœŸæ­£ç¡®æ€§

æµ‹è¯•æ–¹æ³•æ³¨æ„äº‹é¡¹ï¼š**å¿…é¡»æ˜¯ public ä¿®é¥°çš„ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œæ²¡æœ‰å‚æ•°ï¼Œä½¿ç”¨æ³¨è§£@Testä¿®é¥°**

Junitå¸¸ç”¨æ³¨è§£ï¼ˆJunit 4.xxxx ç‰ˆæœ¬ï¼‰ï¼Œ@Test æµ‹è¯•æ–¹æ³•ï¼š

* @Beforeï¼šç”¨æ¥ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡
* @Afterï¼šç”¨æ¥ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œä¸€æ¬¡
* @BeforeClassï¼šç”¨æ¥é™æ€ä¿®é¥°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹å‰**åª**æ‰§è¡Œä¸€æ¬¡
* @AfterClassï¼šç”¨æ¥é™æ€ä¿®é¥°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹å**åª**æ‰§è¡Œä¸€æ¬¡

Junit å¸¸ç”¨æ³¨è§£ï¼ˆJunit5.xxxx ç‰ˆæœ¬ï¼‰ï¼Œ@Test æµ‹è¯•æ–¹æ³•ï¼š

* @BeforeEachï¼šç”¨æ¥ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡
* @AfterEachï¼šç”¨æ¥ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œä¸€æ¬¡
* @BeforeAllï¼šç”¨æ¥é™æ€ä¿®é¥°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹å‰åªæ‰§è¡Œä¸€æ¬¡
* @AfterAllï¼šç”¨æ¥é™æ€ä¿®é¥°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹ååªæ‰§è¡Œä¸€æ¬¡

ä½œç”¨ï¼š

* å¼€å§‹æ‰§è¡Œçš„æ–¹æ³•ï¼šåˆå§‹åŒ–èµ„æº
* æ‰§è¡Œå®Œä¹‹åçš„æ–¹æ³•ï¼šé‡Šæ”¾èµ„æº

```java
public class UserService {
    public String login(String loginName , String passWord){
        if("admin".equals(loginName)&&"123456".equals(passWord)){
            return "success";
        }
        return "ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ï¼";
    }
    public void chu(int a , int b){
        System.out.println(a / b);
    }
}
```

```java
//æµ‹è¯•æ–¹æ³•çš„è¦æ±‚ï¼š1.å¿…é¡»publicä¿®é¥° 2.æ²¡æœ‰è¿”å›å€¼æ²¡æœ‰å‚æ•° 3. å¿…é¡»ä½¿æ³¨è§£@Testä¿®é¥°
public class UserServiceTest {
     // @Beforeï¼šç”¨æ¥ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡ã€‚
    @Before
    public void before(){
        System.out.println("===before===");
    }
    // @Afterï¼šç”¨æ¥ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œä¸€æ¬¡ã€‚
    @After
    public void after(){
        System.out.println("===after===");
    }
    // @BeforeClassï¼šç”¨æ¥é™æ€ä¿®é¥°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹å‰åªæ‰§è¡Œä¸€æ¬¡ã€‚
    @BeforeClass
    public static void beforeClass(){
        System.out.println("===beforeClass===");
    }
    // @AfterClassï¼šç”¨æ¥é™æ€ä¿®é¥°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹ååªæ‰§è¡Œä¸€æ¬¡ã€‚
    @AfterClass
    public static void afterClass(){
        System.out.println("===afterClass===");
    }
    @Test
    public void testLogin(){
        UserService userService = new UserService();
        String rs = userService.login("admin","123456");
        /**æ–­è¨€é¢„æœŸç»“æœçš„æ­£ç¡®æ€§ã€‚
         * å‚æ•°ä¸€ï¼šæµ‹è¯•å¤±è´¥çš„æç¤ºä¿¡æ¯ã€‚
         * å‚æ•°äºŒï¼šæœŸæœ›å€¼ã€‚
         * å‚æ•°ä¸‰ï¼šå®é™…å€¼
         */
        Assert.assertEquals("ç™»å½•ä¸šåŠ¡åŠŸèƒ½æ–¹æ³•æœ‰é”™è¯¯ï¼Œè¯·æ£€æŸ¥ï¼","success",rs);
    }
    @Test
    public void testChu(){
        UserService userService = new UserService();
        userService.chu(10 , 0);
    }
}
```





****



### ä»‹ç»åå°„

åå°„æ˜¯æŒ‡å¯¹äºä»»ä½•ä¸€ä¸ªç±»ï¼Œåœ¨"è¿è¡Œçš„æ—¶å€™"éƒ½å¯ä»¥ç›´æ¥å¾—åˆ°è¿™ä¸ªç±»å…¨éƒ¨æˆåˆ†

* æ„é€ å™¨å¯¹è±¡ï¼šConstructor
* æˆå‘˜å˜é‡å¯¹è±¡ï¼šField

* æˆå‘˜æ–¹æ³•å¯¹è±¡ï¼šMethod

æ ¸å¿ƒæ€æƒ³ï¼šåœ¨è¿è¡Œæ—¶è·å–ç±»ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡ï¼Œç„¶åè§£æç±»ä¸­çš„å…¨éƒ¨æˆåˆ†

åå°„æä¾›äº†ä¸€ä¸ª Class ç±»å‹ï¼šHelloWorld.java â†’ javac â†’ HelloWorld.class

* `Class c = HelloWorld.class` 

æ³¨æ„ï¼šåå°„æ˜¯å·¥ä½œåœ¨**è¿è¡Œæ—¶**çš„æŠ€æœ¯ï¼Œåªæœ‰è¿è¡Œä¹‹åæ‰ä¼šæœ‰ class ç±»å¯¹è±¡

ä½œç”¨ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶å¾—åˆ°ä¸€ä¸ªç±»çš„å…¨éƒ¨æˆåˆ†ç„¶åæ“ä½œï¼Œç ´åå°è£…æ€§ï¼Œä¹Ÿå¯ä»¥ç ´åæ³›å‹çš„çº¦æŸæ€§ã€‚

åå°„çš„ä¼˜ç‚¹ï¼š

- å¯æ‰©å±•æ€§ï¼šåº”ç”¨ç¨‹åºå¯ä»¥åˆ©ç”¨å…¨é™å®šååˆ›å»ºå¯æ‰©å±•å¯¹è±¡çš„å®ä¾‹ï¼Œæ¥ä½¿ç”¨æ¥è‡ªå¤–éƒ¨çš„ç”¨æˆ·è‡ªå®šä¹‰ç±»
- ç±»æµè§ˆå™¨å’Œå¯è§†åŒ–å¼€å‘ç¯å¢ƒï¼šä¸€ä¸ªç±»æµè§ˆå™¨éœ€è¦å¯ä»¥æšä¸¾ç±»çš„æˆå‘˜ï¼Œå¯è§†åŒ–å¼€å‘ç¯å¢ƒï¼ˆå¦‚ IDEï¼‰å¯ä»¥ä»åˆ©ç”¨åå°„ä¸­å¯ç”¨çš„ç±»å‹ä¿¡æ¯ä¸­å—ç›Šï¼Œä»¥å¸®åŠ©ç¨‹åºå‘˜ç¼–å†™æ­£ç¡®çš„ä»£ç 
- è°ƒè¯•å™¨å’Œæµ‹è¯•å·¥å…·ï¼š è°ƒè¯•å™¨éœ€è¦èƒ½å¤Ÿæ£€æŸ¥ä¸€ä¸ªç±»é‡Œçš„ç§æœ‰æˆå‘˜ï¼Œæµ‹è¯•å·¥å…·å¯ä»¥åˆ©ç”¨åå°„æ¥è‡ªåŠ¨åœ°è°ƒç”¨ç±»é‡Œå®šä¹‰çš„å¯è¢«å‘ç°çš„ API å®šä¹‰ï¼Œä»¥ç¡®ä¿ä¸€ç»„æµ‹è¯•ä¸­æœ‰è¾ƒé«˜çš„ä»£ç è¦†ç›–ç‡

åå°„çš„ç¼ºç‚¹ï¼š

- **æ€§èƒ½å¼€é”€**ï¼šåå°„æ¶‰åŠäº†åŠ¨æ€ç±»å‹çš„è§£æï¼Œæ‰€ä»¥ JVM æ— æ³•å¯¹è¿™äº›ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œåå°„æ“ä½œçš„æ•ˆç‡è¦æ¯”é‚£äº›éå°„æ“ä½œä½å¾—å¤šï¼Œåº”è¯¥é¿å…åœ¨ç»å¸¸è¢«æ‰§è¡Œçš„ä»£ç æˆ–å¯¹æ€§èƒ½è¦æ±‚å¾ˆé«˜çš„ç¨‹åºä¸­ä½¿ç”¨åå°„
- å®‰å…¨é™åˆ¶ï¼šä½¿ç”¨åå°„æŠ€æœ¯è¦æ±‚ç¨‹åºå¿…é¡»åœ¨ä¸€ä¸ªæ²¡æœ‰å®‰å…¨é™åˆ¶çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œå¦‚æœä¸€ä¸ªç¨‹åºå¿…é¡»åœ¨æœ‰å®‰å…¨é™åˆ¶çš„ç¯å¢ƒä¸­è¿è¡Œ
- å†…éƒ¨æš´éœ²ï¼šç”±äºåå°„å…è®¸ä»£ç æ‰§è¡Œä¸€äº›åœ¨æ­£å¸¸æƒ…å†µä¸‹ä¸è¢«å…è®¸çš„æ“ä½œï¼ˆæ¯”å¦‚è®¿é—®ç§æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨åå°„å¯èƒ½ä¼šå¯¼è‡´æ„æ–™ä¹‹å¤–çš„å‰¯ä½œç”¨ï¼Œè¿™å¯èƒ½å¯¼è‡´ä»£ç åŠŸèƒ½å¤±è°ƒå¹¶ç ´åå¯ç§»æ¤æ€§ã€‚åå°„ä»£ç ç ´åäº†æŠ½è±¡æ€§ï¼Œå› æ­¤å½“å¹³å°å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œä»£ç çš„è¡Œä¸ºå°±æœ‰å¯èƒ½ä¹Ÿéšç€å˜åŒ–



***



### è·å–å…ƒç´ 

#### è·å–ç±»

åå°„æŠ€æœ¯çš„ç¬¬ä¸€æ­¥æ˜¯å…ˆå¾—åˆ° Class ç±»å¯¹è±¡ï¼Œæœ‰ä¸‰ç§æ–¹å¼è·å–ï¼š

* ç±»å.class
* ç±»çš„å¯¹è±¡.getClass()
* Class.forName("ç±»çš„å…¨é™å")ï¼š`public static Class<?> forName(String className) `

Class ç±»ä¸‹çš„æ–¹æ³•ï¼š

| æ–¹æ³•                   | ä½œç”¨                                                         |
| ---------------------- | ------------------------------------------------------------ |
| String getSimpleName() | è·å¾—ç±»åå­—ç¬¦ä¸²ï¼šç±»å                                         |
| String getName()       | è·å¾—ç±»å…¨åï¼šåŒ…å+ç±»å                                        |
| T newInstance()        | åˆ›å»º Class å¯¹è±¡å…³è”ç±»çš„å¯¹è±¡ï¼Œåº•å±‚æ˜¯è°ƒç”¨æ— å‚æ•°æ„é€ å™¨ï¼Œå·²ç»è¢«æ·˜æ±° |

```java
public class ReflectDemo{
    public static void main(String[] args) throws Exception {
        // åå°„çš„ç¬¬ä¸€æ­¥æ°¸è¿œæ˜¯å…ˆå¾—åˆ°ç±»çš„Classæ–‡ä»¶å¯¹è±¡: å­—èŠ‚ç æ–‡ä»¶ã€‚
        // 1.ç±»å.class
        Class c1 = Student.class;
        System.out.println(c1);//class _03åå°„_è·å–Classç±»å¯¹è±¡.Student

        // 2.å¯¹è±¡.getClass()
        Student swk = new Student();
        Class c2 = swk.getClass();
        System.out.println(c2);

        // 3.Class.forName("ç±»çš„å…¨é™å")
        // ç›´æ¥å»åŠ è½½è¯¥ç±»çš„classæ–‡ä»¶ã€‚
        Class c3 = Class.forName("_03åå°„_è·å–Classç±»å¯¹è±¡.Student");
        System.out.println(c3);

        System.out.println(c1.getSimpleName()); // è·å–ç±»åæœ¬èº«ï¼ˆç®€åï¼‰Student
        System.out.println(c1.getName()); //è·å–ç±»çš„å…¨é™å_03åå°„_è·å–Classç±»å¯¹è±¡.Student
    }
}
class Student{}
```



***



#### è·å–æ„é€ 

è·å–æ„é€ å™¨çš„ APIï¼š

* Constructor getConstructor(Class... parameterTypes)ï¼šæ ¹æ®å‚æ•°åŒ¹é…è·å–æŸä¸ªæ„é€ å™¨ï¼Œåªèƒ½æ‹¿ public ä¿®é¥°çš„æ„é€ å™¨
* Constructor getDeclaredConstructor(Class... parameterTypes)ï¼šæ ¹æ®å‚æ•°åŒ¹é…è·å–æŸä¸ªæ„é€ å™¨ï¼Œåªè¦ç”³æ˜å°±å¯ä»¥å®šä½ï¼Œä¸å…³å¿ƒæƒé™ä¿®é¥°ç¬¦
* Constructor[] getConstructors()ï¼šè·å–æ‰€æœ‰çš„æ„é€ å™¨ï¼Œåªèƒ½æ‹¿ public ä¿®é¥°çš„æ„é€ å™¨
* Constructor[] getDeclaredConstructors()ï¼šè·å–æ‰€æœ‰æ„é€ å™¨ï¼Œåªè¦ç”³æ˜å°±å¯ä»¥å®šä½ï¼Œä¸å…³å¿ƒæƒé™ä¿®é¥°ç¬¦

Constructor çš„å¸¸ç”¨ APIï¼š

| æ–¹æ³•                              | ä½œç”¨                                    |
| --------------------------------- | --------------------------------------- |
| T newInstance(Object... initargs) | åˆ›å»ºå¯¹è±¡ï¼Œæ³¨å…¥æ„é€ å™¨éœ€è¦çš„æ•°æ®          |
| void setAccessible(true)          | ä¿®æ”¹è®¿é—®æƒé™ï¼Œtrue æ”»ç ´æƒé™ï¼ˆæš´åŠ›åå°„ï¼‰ |
| String getName()                  | ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›æ­¤æ„é€ å‡½æ•°çš„åç§°        |
| int getParameterCount()           | è¿”å›å‚æ•°æ•°é‡                            |
| Class<?>[] getParameterTypes      | è¿”å›å‚æ•°ç±»å‹æ•°ç»„                        |

```java
public class TestStudent01 {
    @Test
    public void getDeclaredConstructors(){
        // a.åå°„ç¬¬ä¸€æ­¥å…ˆå¾—åˆ°Classç±»å¯¹è±¡
        Class c = Student.class ;
        // b.å®šä½å…¨éƒ¨æ„é€ å™¨ï¼Œåªè¦ç”³æ˜äº†å°±å¯ä»¥æ‹¿åˆ°
        Constructor[] cons = c.getDeclaredConstructors();
        // c.éå†è¿™äº›æ„é€ å™¨
        for (Constructor con : cons) {
            System.out.println(con.getName()+"->"+con.getParameterCount());
        }
    }
    @Test
    public void getDeclaredConstructor() throws Exception {
        // a.åå°„ç¬¬ä¸€æ­¥å…ˆå¾—åˆ°Classç±»å¯¹è±¡
        Class c = Student.class ;
        // b.å®šä½æŸä¸ªæ„é€ å™¨ï¼Œæ ¹æ®å‚æ•°åŒ¹é…ï¼Œåªè¦ç”³æ˜äº†å°±å¯ä»¥è·å–
        //Constructor con = c.getDeclaredConstructor(); // å¯ä»¥æ‹¿åˆ°ï¼å®šä½æ— å‚æ•°æ„é€ å™¨ï¼
        Constructor con = c.getDeclaredConstructor(String.class, int.class); //æœ‰å‚æ•°çš„ï¼!
        // c.æ„é€ å™¨åç§°å’Œå‚æ•°
        System.out.println(con.getName()+"->"+con.getParameterCount());
    }
}
```

```java
public class Student {
    private String name ;
    private int age ;
    private Student(){
        System.out.println("æ— å‚æ•°æ„é€ å™¨è¢«æ‰§è¡Œ~~~~");
    }
    public Student(String name, int age) {
        System.out.println("æœ‰å‚æ•°æ„é€ å™¨è¢«æ‰§è¡Œ~~~~");
        this.name = name;
        this.age = age;
    }
}
```

```java
//æµ‹è¯•æ–¹æ³•
public class TestStudent02 {
    // 1.è°ƒç”¨æ— å‚æ•°æ„é€ å™¨å¾—åˆ°ä¸€ä¸ªç±»çš„å¯¹è±¡è¿”å›ã€‚
    @Test
    public void createObj01() throws Exception {
        // a.åå°„ç¬¬ä¸€æ­¥æ˜¯å…ˆå¾—åˆ°Classç±»å¯¹è±¡
        Class c = Student.class ;
        // b.å®šä½æ— å‚æ•°æ„é€ å™¨å¯¹è±¡
        Constructor constructor = c.getDeclaredConstructor();
        // c.æš´åŠ›æ‰“å¼€ç§æœ‰æ„é€ å™¨çš„è®¿é—®æƒé™
        constructor.setAccessible(true);
        // d.é€šè¿‡æ— å‚æ•°æ„é€ å™¨åˆå§‹åŒ–å¯¹è±¡è¿”å›
        Student swk = (Student) constructor.newInstance(); // æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨æ— å‚æ•°æ„é€ å™¨çš„ï¼
        System.out.println(swk);//Student{name='null', age=0}
    }

    // 2.è°ƒç”¨æœ‰å‚æ•°æ„é€ å™¨å¾—åˆ°ä¸€ä¸ªç±»çš„å¯¹è±¡è¿”å›ã€‚
    @Test
    public void createObj02() throws Exception {
        // a.åå°„ç¬¬ä¸€æ­¥æ˜¯å…ˆå¾—åˆ°Classç±»å¯¹è±¡
        Class c = Student.class ;
        // b.å®šä½æœ‰å‚æ•°æ„é€ å™¨å¯¹è±¡
        Constructor constructor = c.getDeclaredConstructor(String.class , int.class);
        // c.é€šè¿‡æ— å‚æ•°æ„é€ å™¨åˆå§‹åŒ–å¯¹è±¡è¿”å›
        Student swk = (Student) constructor.newInstance("å­™æ‚Ÿç©º",500); // æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨æœ‰å‚æ•°æ„é€ å™¨çš„ï¼
        System.out.println(swk);//Student{name='å­™æ‚Ÿç©º', age=500}
    }
}


```



***



#### è·å–å˜é‡

è·å– Field æˆå‘˜å˜é‡ APIï¼š

* Field getField(String name)ï¼šæ ¹æ®æˆå‘˜å˜é‡åè·å¾—å¯¹åº” Field å¯¹è±¡ï¼Œåªèƒ½è·å¾— public ä¿®é¥°
* Field getDeclaredField(String name)ï¼šæ ¹æ®æˆå‘˜å˜é‡åè·å¾—å¯¹åº” Field å¯¹è±¡ï¼Œæ‰€æœ‰ç”³æ˜çš„å˜é‡
* Field[] getFields()ï¼šè·å¾—æ‰€æœ‰çš„æˆå‘˜å˜é‡å¯¹åº”çš„ Field å¯¹è±¡ï¼Œåªèƒ½è·å¾— public çš„
* Field[] getDeclaredFields()ï¼šè·å¾—æ‰€æœ‰çš„æˆå‘˜å˜é‡å¯¹åº”çš„ Field å¯¹è±¡ï¼Œåªè¦ç”³æ˜äº†å°±å¯ä»¥å¾—åˆ° 

Field çš„æ–¹æ³•ï¼šç»™æˆå‘˜å˜é‡èµ‹å€¼å’Œå–å€¼

| æ–¹æ³•                               | ä½œç”¨                                                        |
| ---------------------------------- | ----------------------------------------------------------- |
| void set(Object obj, Object value) | ç»™å¯¹è±¡æ³¨å…¥æŸä¸ªæˆå‘˜å˜é‡æ•°æ®ï¼Œ**obj æ˜¯å¯¹è±¡**ï¼Œvalue æ˜¯å€¼      |
| Object get(Object obj)             | è·å–æŒ‡å®šå¯¹è±¡çš„æˆå‘˜å˜é‡çš„å€¼ï¼Œ**obj æ˜¯å¯¹è±¡**ï¼Œæ²¡æœ‰å¯¹è±¡ä¸º null |
| void setAccessible(true)           | æš´åŠ›åå°„ï¼Œè®¾ç½®ä¸ºå¯ä»¥ç›´æ¥è®¿é—®ç§æœ‰ç±»å‹çš„å±æ€§                  |
| Class getType()                    | è·å–å±æ€§çš„ç±»å‹ï¼Œè¿”å› Class å¯¹è±¡                             |
| String getName()                   | è·å–å±æ€§çš„åç§°                                              |

```Java
public class FieldDemo {
    //è·å–å…¨éƒ¨æˆå‘˜å˜é‡
    @Test
    public void getDeclaredFields(){
        // a.å…ˆè·å–classç±»å¯¹è±¡
        Class c = Dog.class;
        // b.è·å–å…¨éƒ¨ç”³æ˜çš„æˆå‘˜å˜é‡å¯¹è±¡
        Field[] fields = c.getDeclaredFields();
        for (Field field : fields) {
            System.out.println(field.getName()+"->"+field.getType());
        }
    }
    //è·å–æŸä¸ªæˆå‘˜å˜é‡
    @Test
    public void getDeclaredField() throws Exception {
        // a.å…ˆè·å–classç±»å¯¹è±¡
        Class c = Dog.class;
        // b.å®šä½æŸä¸ªæˆå‘˜å˜é‡å¯¹è±¡ :æ ¹æ®åç§°å®šä½ï¼ï¼
        Field ageF = c.getDeclaredField("age");
        System.out.println(ageF.getName()+"->"+ageF.getType());
    }
}
```

```java
public class Dog {
    private String name;
    private int age ;
    private String color ;
    public static String school;
    public static final String SCHOOL_1 = "å® ç‰©å­¦æ ¡";

    public Dog() {
    }

    public Dog(String name, int age, String color) {
        this.name = name;
        this.age = age;
        this.color = color;
    }
}
```

```java
//æµ‹è¯•æ–¹æ³•
public class FieldDemo02 {
    @Test
    public void setField() throws Exception {
        // a.åå°„çš„ç¬¬ä¸€æ­¥è·å–Classç±»å¯¹è±¡
        Class c = Dog.class ;
        // b.å®šä½nameæˆå‘˜å˜é‡
        Field name = c.getDeclaredField("name");
        // c.ä¸ºè¿™ä¸ªæˆå‘˜å˜é‡èµ‹å€¼ï¼
        Dog d = new Dog();
        name.setAccessible(true);
        name.set(d,"æ³°è¿ª");
        System.out.println(d);//Dog{name='æ³°è¿ª', age=0, color='null'}
        // d.è·å–æˆå‘˜å˜é‡çš„å€¼
        String value = name.get(d)+"";
        System.out.println(value);//æ³°è¿ª
    }
}
```



***



#### è·å–æ–¹æ³•

è·å– Method æ–¹æ³• APIï¼š

* Method getMethod(String name,Class...args)ï¼šæ ¹æ®æ–¹æ³•åå’Œå‚æ•°ç±»å‹è·å¾—æ–¹æ³•å¯¹è±¡ï¼Œpublic ä¿®é¥°
* Method getDeclaredMethod(String name,Class...args)ï¼šæ ¹æ®æ–¹æ³•åå’Œå‚æ•°ç±»å‹è·å¾—æ–¹æ³•å¯¹è±¡ï¼ŒåŒ…æ‹¬ private
* Method[] getMethods()ï¼šè·å¾—ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•å¯¹è±¡è¿”å›æ•°ç»„ï¼Œåªèƒ½è·å¾— public ä¿®é¥°ä¸”åŒ…å«çˆ¶ç±»çš„
* Method[] getDeclaredMethods()ï¼šè·å¾—ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•å¯¹è±¡ï¼Œè¿”å›æ•°ç»„ï¼Œåªè·å¾—æœ¬ç±»ç”³æ˜çš„æ–¹æ³•

Method å¸¸ç”¨ APIï¼š

* public Object invoke(Object obj, Object... args)ï¼šä½¿ç”¨æŒ‡å®šçš„å‚æ•°è°ƒç”¨ç”±æ­¤æ–¹æ³•å¯¹è±¡ï¼Œobj å¯¹è±¡å

```java
public class MethodDemo{
    //è·å¾—ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•å¯¹è±¡
    @Test
    public void getDeclaredMethods(){
        // a.å…ˆè·å–classç±»å¯¹è±¡
        Class c = Dog.class ;
        // b.è·å–å…¨éƒ¨ç”³æ˜çš„æ–¹æ³•!
        Method[] methods = c.getDeclaredMethods();
        // c.éå†è¿™äº›æ–¹æ³•
        for (Method method : methods) {
            System.out.println(method.getName()+"->"
                    + method.getParameterCount()+"->" + method.getReturnType());
        }
    }
    @Test
    public void getDeclardMethod() throws Exception {
        Class c = Dog.class;
        Method run = c.getDeclaredMethod("run");
        // c.è§¦å‘æ–¹æ³•æ‰§è¡Œ!
        Dog d = new Dog();
        Object o = run.invoke(d);
        System.out.println(o);// å¦‚æœæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œç»“æœæ˜¯null
        
		//å‚æ•°ä¸€ï¼šæ–¹æ³•åç§°   å‚æ•°äºŒï¼šæ–¹æ³•çš„å‚æ•°ä¸ªæ•°å’Œç±»å‹(å¯å˜å‚æ•°ï¼)
        Method eat = c.getDeclaredMethod("eat",String.class);
        eat.setAccessible(true); // æš´åŠ›åå°„ï¼
        
       	//å‚æ•°ä¸€ï¼šè¢«è§¦å‘æ–¹æ³•æ‰€åœ¨çš„å¯¹è±¡  å‚æ•°äºŒï¼šæ–¹æ³•éœ€è¦çš„å…¥å‚å€¼
        Object o1 = eat.invoke(d,"è‚‰");
        System.out.println(o1);// å¦‚æœæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œç»“æœæ˜¯null
    }
}

public class Dog {
    private String name ;
    public Dog(){
    }
    public void run(){System.out.println("ç‹—è·‘çš„è´¼å¿«~~");}
	private void eat(){System.out.println("ç‹—åƒéª¨å¤´");}
	private void eat(String name){System.out.println("ç‹—åƒ"+name);}
	public static void inAddr(){System.out.println("åœ¨å‰å±±åŒºæœ‰ä¸€åªå•èº«ç‹—ï¼");}
}
```



***



### æš´åŠ›æ”»å‡»

æ³›å‹åªèƒ½å·¥ä½œåœ¨ç¼–è¯‘é˜¶æ®µï¼Œè¿è¡Œé˜¶æ®µæ³›å‹å°±æ¶ˆå¤±äº†ï¼Œåå°„å·¥ä½œåœ¨è¿è¡Œæ—¶é˜¶æ®µ

1. åå°„å¯ä»¥ç ´åé¢å‘å¯¹è±¡çš„å°è£…æ€§ï¼ˆæš´åŠ›åå°„ï¼‰
2. åŒæ—¶å¯ä»¥ç ´åæ³›å‹çš„çº¦æŸæ€§

```java
public class ReflectDemo {
    public static void main(String[] args) throws Exception {
        List<Double> scores = new ArrayList<>();
        scores.add(99.3);
        scores.add(199.3);
        scores.add(89.5);
        // æ‹“å±•ï¼šé€šè¿‡åå°„æš´åŠ›çš„æ³¨å…¥ä¸€ä¸ªå…¶ä»–ç±»å‹çš„æ•°æ®è¿›å»ã€‚
        // a.å…ˆå¾—åˆ°é›†åˆå¯¹è±¡çš„Classæ–‡ä»¶å¯¹è±¡
        Class c = scores.getClass();
        // b.ä»ArrayListçš„Classå¯¹è±¡ä¸­å®šä½addæ–¹æ³•
        Method add = c.getDeclaredMethod("add", Object.class);
        // c.è§¦å‘scoresé›†åˆå¯¹è±¡ä¸­çš„addæ‰§è¡Œï¼ˆè¿è¡Œé˜¶æ®µï¼Œæ³›å‹ä¸èƒ½çº¦æŸäº†ï¼‰
        add.invoke(scores, "å­—ç¬¦ä¸²");
        System.out.println(scores);
    }
}
```

 



***





## æ³¨è§£

### æ¦‚å¿µ

æ³¨è§£ï¼šç±»çš„ç»„æˆéƒ¨åˆ†ï¼Œå¯ä»¥ç»™ç±»æºå¸¦ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œæä¾›ä¸€ç§å®‰å…¨çš„ç±»ä¼¼æ³¨é‡Šæ ‡è®°çš„æœºåˆ¶ï¼Œç”¨æ¥å°†ä»»ä½•ä¿¡æ¯æˆ–å…ƒæ•°æ®ï¼ˆmetadataï¼‰ä¸ç¨‹åºå…ƒç´ ï¼ˆç±»ã€æ–¹æ³•ã€æˆå‘˜å˜é‡ç­‰ï¼‰è¿›è¡Œå…³è”

* æ³¨è§£æ˜¯ç»™ç¼–è¯‘å™¨æˆ– JVM çœ‹çš„ï¼Œç¼–è¯‘å™¨æˆ– JVM å¯ä»¥æ ¹æ®æ³¨è§£æ¥å®Œæˆå¯¹åº”çš„åŠŸèƒ½
* æ³¨è§£ç±»ä¼¼ä¿®é¥°ç¬¦ï¼Œåº”ç”¨äºåŒ…ã€ç±»å‹ã€æ„é€ æ–¹æ³•ã€æ–¹æ³•ã€æˆå‘˜å˜é‡ã€å‚æ•°åŠæœ¬åœ°å˜é‡çš„å£°æ˜è¯­å¥ä¸­
* **çˆ¶ç±»ä¸­çš„æ³¨è§£æ˜¯ä¸èƒ½è¢«å­ç±»ç»§æ‰¿çš„**

æ³¨è§£ä½œç”¨ï¼š

* æ ‡è®°
* æ¡†æ¶æŠ€æœ¯å¤šåŠéƒ½æ˜¯åœ¨ä½¿ç”¨æ³¨è§£å’Œåå°„ï¼Œéƒ½æ˜¯å±äºæ¡†æ¶çš„åº•å±‚åŸºç¡€æŠ€æœ¯
* åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ ¼å¼æ£€æŸ¥ï¼Œæ¯”å¦‚æ–¹æ³•é‡å†™çº¦æŸ @Overrideã€å‡½æ•°å¼æ¥å£çº¦æŸ @FunctionalInterface.



***



### æ³¨è§£æ ¼å¼

å®šä¹‰æ ¼å¼ï¼šè‡ªå®šä¹‰æ³¨è§£ç”¨ @interface å…³é”®å­—ï¼Œæ³¨è§£é»˜è®¤å¯ä»¥æ ‡è®°å¾ˆå¤šåœ°æ–¹

```java
ä¿®é¥°ç¬¦ @interface æ³¨è§£å{
     // æ³¨è§£å±æ€§
}
```

ä½¿ç”¨æ³¨è§£çš„æ ¼å¼ï¼š@æ³¨è§£å

```java
@Book
@MyTest
public class MyBook {
    //æ–¹æ³•å˜é‡éƒ½å¯ä»¥æ³¨è§£
}

@interface Book{
}
@interface MyTest{
}
```



***



### æ³¨è§£å±æ€§

#### æ™®é€šå±æ€§

æ³¨è§£å¯ä»¥æœ‰å±æ€§ï¼Œ**å±æ€§åå¿…é¡»å¸¦ ()**ï¼Œåœ¨ç”¨æ³¨è§£çš„æ—¶å€™ï¼Œå±æ€§å¿…é¡»èµ‹å€¼ï¼Œé™¤éå±æ€§æœ‰é»˜è®¤å€¼

å±æ€§çš„æ ¼å¼ï¼š

* æ ¼å¼ 1ï¼šæ•°æ®ç±»å‹ å±æ€§å()
* æ ¼å¼ 2ï¼šæ•°æ®ç±»å‹ å±æ€§å() default é»˜è®¤å€¼

å±æ€§é€‚ç”¨çš„æ•°æ®ç±»å‹:

* å…«ç§æ•°æ®æ•°æ®ç±»å‹ï¼ˆintï¼Œshortï¼Œlongï¼Œdoubleï¼Œbyteï¼Œcharï¼Œbooleanï¼Œfloatï¼‰å’Œ Stringã€Class
* ä»¥ä¸Šç±»å‹çš„æ•°ç»„å½¢å¼éƒ½æ”¯æŒ

```java
@MyBook(name="ã€Šç²¾é€šJavaåŸºç¡€ã€‹",authors = {"æ’­ä»”","Dlei","æ’­å¦"} , price = 99.9 )
public class AnnotationDemo01 {
    @MyBook(name="ã€Šç²¾é€šMySQLæ•°æ®åº“å…¥é—¨åˆ°åˆ åº“è·‘è·¯ã€‹",authors = {"å°ç™½","å°é»‘"} ,
     					price = 19.9 , address = "åŒ—äº¬")
    public static void main(String[] args) {
    }
}
// è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£
@interface MyBook{
    String name();
    String[] authors(); // æ•°ç»„
    double price();
    String address() default "æ­¦æ±‰";
}

```



***



#### ç‰¹æ®Šå±æ€§

æ³¨è§£çš„ç‰¹æ®Šå±æ€§åç§°ï¼švalue

* å¦‚æœåªæœ‰ä¸€ä¸ª value å±æ€§çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ value å±æ€§çš„æ—¶å€™å¯ä»¥çœç•¥ value åç§°ä¸å†™
* å¦‚æœæœ‰å¤šä¸ªå±æ€§ï¼Œä¸”å¤šä¸ªå±æ€§æ²¡æœ‰é»˜è®¤å€¼ï¼Œé‚£ä¹ˆ value æ˜¯ä¸èƒ½çœç•¥çš„

```java
//@Book("/deleteBook.action")
@Book(value = "/deleteBook.action" , age = 12)
public class AnnotationDemo01{
}

@interface Book{
    String value();
    int age() default 10;
}
```



***



### å…ƒæ³¨è§£

å…ƒæ³¨è§£æ˜¯ sun å…¬å¸æä¾›çš„ï¼Œç”¨æ¥æ³¨è§£è‡ªå®šä¹‰æ³¨è§£

å…ƒæ³¨è§£æœ‰å››ä¸ªï¼š

* @Targetï¼šçº¦æŸè‡ªå®šä¹‰æ³¨è§£å¯ä»¥æ ‡è®°çš„èŒƒå›´ï¼Œé»˜è®¤å€¼ä¸ºä»»ä½•å…ƒç´ ï¼Œè¡¨ç¤ºè¯¥æ³¨è§£ç”¨äºä»€ä¹ˆåœ°æ–¹ï¼Œå¯ç”¨å€¼å®šä¹‰åœ¨ ElementType ç±»ä¸­ï¼š

  - `ElementType.CONSTRUCTOR`ï¼šç”¨äºæè¿°æ„é€ å™¨
  - `ElementType.FIELD`ï¼šæˆå‘˜å˜é‡ã€å¯¹è±¡ã€å±æ€§ï¼ˆåŒ…æ‹¬ enum å®ä¾‹ï¼‰
  - `ElementType.LOCAL_VARIABLE`ï¼šç”¨äºæè¿°å±€éƒ¨å˜é‡
  - `ElementType.METHOD`ï¼šç”¨äºæè¿°æ–¹æ³•
  - `ElementType.PACKAGE`ï¼šç”¨äºæè¿°åŒ…
  - `ElementType.PARAMETER`ï¼šç”¨äºæè¿°å‚æ•°
  - `ElementType.TYPE`ï¼šç”¨äºæè¿°ç±»ã€æ¥å£ï¼ˆåŒ…æ‹¬æ³¨è§£ç±»å‹ï¼‰æˆ– enum å£°æ˜
  
* @Retentionï¼šå®šä¹‰è¯¥æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸï¼Œç”³æ˜æ³¨è§£çš„ä½œç”¨èŒƒå›´ï¼šç¼–è¯‘æ—¶ï¼Œè¿è¡Œæ—¶ï¼Œå¯ä½¿ç”¨çš„å€¼å®šä¹‰åœ¨ RetentionPolicy æšä¸¾ç±»ä¸­ï¼š

  - `RetentionPolicy.SOURCE`ï¼šåœ¨ç¼–è¯‘é˜¶æ®µä¸¢å¼ƒï¼Œè¿™äº›æ³¨è§£åœ¨ç¼–è¯‘ç»“æŸä¹‹åå°±ä¸å†æœ‰ä»»ä½•æ„ä¹‰ï¼Œåªä½œç”¨åœ¨æºç é˜¶æ®µï¼Œç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ä¸­ä¸å­˜åœ¨ï¼Œ`@Override`ã€`@SuppressWarnings` éƒ½å±äºè¿™ç±»æ³¨è§£
  - `RetentionPolicy.CLASS`ï¼šåœ¨ç±»åŠ è½½æ—¶ä¸¢å¼ƒï¼Œåœ¨å­—èŠ‚ç æ–‡ä»¶çš„å¤„ç†ä¸­æœ‰ç”¨ï¼Œè¿è¡Œé˜¶æ®µä¸å­˜åœ¨ï¼Œé»˜è®¤å€¼
  - `RetentionPolicy.RUNTIME` : å§‹ç»ˆä¸ä¼šä¸¢å¼ƒï¼Œè¿è¡ŒæœŸä¹Ÿä¿ç•™è¯¥æ³¨è§£ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åå°„æœºåˆ¶è¯»å–è¯¥æ³¨è§£çš„ä¿¡æ¯ï¼Œè‡ªå®šä¹‰çš„æ³¨è§£é€šå¸¸ä½¿ç”¨è¿™ç§æ–¹å¼
  
* @Inheritedï¼šè¡¨ç¤ºä¿®é¥°çš„è‡ªå®šä¹‰æ³¨è§£å¯ä»¥è¢«å­ç±»ç»§æ‰¿

* @Documentedï¼šè¡¨ç¤ºæ˜¯å¦å°†è‡ªå®šä¹‰çš„æ³¨è§£ä¿¡æ¯æ·»åŠ åœ¨ Java æ–‡æ¡£ä¸­

```java
public class AnnotationDemo01{
    // @MyTest // åªèƒ½æ³¨è§£æ–¹æ³•
    private String name;

    @MyTest
    public static void main( String[] args) {
    }
}
@Target(ElementType.METHOD) // ç”³æ˜åªèƒ½æ³¨è§£æ–¹æ³•
@Retention(RetentionPolicy.RUNTIME) // ç”³æ˜æ³¨è§£ä»å†™ä»£ç ä¸€ç›´åˆ°è¿è¡Œè¿˜åœ¨ï¼Œæ°¸è¿œå­˜æ´»ï¼ï¼
@interface MyTest{
}
```



***



### æ³¨è§£è§£æ

å¼€å‘ä¸­ç»å¸¸è¦çŸ¥é“ä¸€ä¸ªç±»çš„æˆåˆ†ä¸Šé¢åˆ°åº•æœ‰å“ªäº›æ³¨è§£ï¼Œæ³¨è§£æœ‰å“ªäº›å±æ€§æ•°æ®ï¼Œè¿™éƒ½éœ€è¦è¿›è¡Œæ³¨è§£çš„è§£æ

æ³¨è§£è§£æç›¸å…³çš„æ¥å£ï¼š

* Annotationï¼šæ³¨è§£ç±»å‹ï¼Œè¯¥ç±»æ˜¯æ‰€æœ‰æ³¨è§£çš„çˆ¶ç±»ï¼Œæ³¨è§£éƒ½æ˜¯ä¸€ä¸ª Annotation çš„å¯¹è±¡
* AnnotatedElementï¼šè¯¥æ¥å£å®šä¹‰äº†ä¸æ³¨è§£è§£æç›¸å…³çš„æ–¹æ³•
* Classã€Methodã€Fieldã€Constructor ç±»æˆåˆ†ï¼šå®ç° AnnotatedElement æ¥å£ï¼Œæ‹¥æœ‰è§£ææ³¨è§£çš„èƒ½åŠ›

Class ç±» API ï¼š

* `Annotation[] getDeclaredAnnotations()`ï¼šè·å¾—å½“å‰å¯¹è±¡ä¸Šä½¿ç”¨çš„æ‰€æœ‰æ³¨è§£ï¼Œè¿”å›æ³¨è§£æ•°ç»„
* `T getDeclaredAnnotation(Class<T> annotationClass)`ï¼šæ ¹æ®æ³¨è§£ç±»å‹è·å¾—å¯¹åº”æ³¨è§£å¯¹è±¡
* `T getAnnotation(Class<T> annotationClass)`ï¼šæ ¹æ®æ³¨è§£ç±»å‹è·å¾—å¯¹åº”æ³¨è§£å¯¹è±¡
* `boolean isAnnotationPresent(Class<Annotation> class)`ï¼šåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä½¿ç”¨äº†æŒ‡å®šçš„æ³¨è§£
* `boolean isAnnotation()`ï¼šæ­¤ Class å¯¹è±¡æ˜¯å¦è¡¨ç¤ºæ³¨é‡Šç±»å‹

æ³¨è§£åŸç†ï¼šæ³¨è§£æœ¬è´¨æ˜¯**ç‰¹æ®Šæ¥å£**ï¼Œç»§æ‰¿äº† `Annotation` ï¼Œå…¶å…·ä½“å®ç°ç±»æ˜¯ Java è¿è¡Œæ—¶ç”Ÿæˆçš„**åŠ¨æ€ä»£ç†ç±»**ï¼Œé€šè¿‡åå°„è·å–æ³¨è§£æ—¶ï¼Œè¿”å›çš„æ˜¯è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†å¯¹è±¡ `$Proxy1`ï¼Œé€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨è‡ªå®šä¹‰æ³¨è§£ï¼ˆæ¥å£ï¼‰çš„æ–¹æ³•ï¼Œå›è°ƒ `AnnotationInvocationHandler` çš„ `invoke` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šä» `memberValues`  è¿™ä¸ª Map ä¸­æ‰¾å‡ºå¯¹åº”çš„å€¼ï¼Œè€Œ `memberValues` çš„æ¥æºæ˜¯ Java å¸¸é‡æ± 

è§£ææ³¨è§£æ•°æ®çš„åŸç†ï¼šæ³¨è§£åœ¨å“ªä¸ªæˆåˆ†ä¸Šï¼Œå°±å…ˆæ‹¿å“ªä¸ªæˆåˆ†å¯¹è±¡ï¼Œæ¯”å¦‚æ³¨è§£ä½œç”¨åœ¨ç±»ä¸Šï¼Œåˆ™è¦è¯¥ç±»çš„ Class å¯¹è±¡ï¼Œå†æ¥æ‹¿ä¸Šé¢çš„æ³¨è§£

```java
public class AnnotationDemo{
    @Test
    public void parseClass() {
        // 1.å®šä½Classç±»å¯¹è±¡
        Class c = BookStore.class;
        // 2.åˆ¤æ–­è¿™ä¸ªç±»ä¸Šæ˜¯å¦ä½¿ç”¨äº†æŸä¸ªæ³¨è§£
        if(c.isAnnotationPresent(Book.class)){
            // 3.è·å–è¿™ä¸ªæ³¨è§£å¯¹è±¡
            Book b = (Book)c.getDeclarAnnotation(Book.class);
            System.out.println(book.value());
            System.out.println(book.price());
            System.out.println(Arrays.toString(book.authors()));
        }
    }
    @Test
    public void parseMethod() throws Exception {
        Class c = BookStore.class;
        Method run = c.getDeclaredMethod("run");
        if(run.isAnnotationPresent(Book.class)){
            Book b = (Book)run.getDeclaredAnnotation(Book.class);
           	sout(ä¸Šé¢çš„ä¸‰ä¸ª);
        }
    }
}

@Book(value = "ã€ŠJavaåŸºç¡€åˆ°ç²¾é€šã€‹", price = 99.5, authors = {"æ³¢ä»”","æ³¢å¦"})
class BookStore{
    @Book(value = "ã€ŠMybatisæŒä¹…å±‚æ¡†æ¶ã€‹", price = 199.5, authors = {"dlei","æ’­å®¢"})
    public void run(){
    }
}
@Target({ElementType.TYPE,ElementType.METHOD}) // ç±»å’Œæˆå‘˜æ–¹æ³•ä¸Šä½¿ç”¨
@Retention(RetentionPolicy.RUNTIME) // æ³¨è§£æ°¸ä¹…å­˜æ´»
@interface Book{
    String value();
    double price() default 100;
    String[] authors();
}
```



***



### æ³¨è§£æ¨¡æ‹Ÿ

æ³¨è§£æ¨¡æ‹Ÿå†™ä¸€ä¸ª Junit æ¡†æ¶çš„åŸºæœ¬ä½¿ç”¨

1. å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ MyTestï¼Œåªèƒ½æ³¨è§£æ–¹æ³•ï¼Œå­˜æ´»èŒƒå›´ä¸€ç›´éƒ½åœ¨ã€‚
2. å®šä¹‰è‹¥å¹²ä¸ªæ–¹æ³•ï¼Œåªè¦æœ‰ @MyTest æ³¨è§£çš„æ–¹æ³•å°±èƒ½è¢«è§¦å‘æ‰§è¡Œï¼Œæ²¡æœ‰è¿™ä¸ªæ³¨è§£çš„æ–¹æ³•ä¸èƒ½æ‰§è¡Œï¼ï¼

```java
public class TestDemo{
    @MyTest
    public void test01(){System.out.println("===test01===");}
    public void test02(){System.out.println("===test02===");}
    @MyTest
    public void test03(){System.out.println("===test03===");}
    @MyTest
    public void test04(){System.out.println("===test04===");}
    
    public static void main(String[] args) throws Exception {
        TestDemo t = new TestDemo();
        Class c = TestDemo.class;
        Method[] methods = c.getDeclaredMethods();
        for (Method method : methods) {
            if(method.isAnnotationPresent(MyTest.class)){
                method.invoke(t);
            }
        }
    }
}

@Target(ElementType.METHOD) // åªèƒ½æ³¨è§£æ–¹æ³•ï¼
@Retention(RetentionPolicy.RUNTIME) // ä¸€ç›´éƒ½æ´»ç€
@interface MyTest{
}
```





****





## XML

### æ¦‚è¿°

XMLä»‹ç»ï¼š

- XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensibleÂ MarkupÂ Languageï¼‰
- XML æ˜¯ä¸€ç§**æ ‡è®°è¯­è¨€**ï¼Œå¾ˆç±»ä¼¼ HTMLï¼ŒHTMLæ–‡ä»¶ä¹Ÿæ˜¯XMLæ–‡æ¡£
- XML çš„è®¾è®¡å®—æ—¨æ˜¯**ä¼ è¾“æ•°æ®**ï¼Œè€Œéæ˜¾ç¤ºæ•°æ®
- XML æ ‡ç­¾æ²¡æœ‰è¢«é¢„å®šä¹‰ï¼Œéœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾
- XML è¢«è®¾è®¡ä¸ºå…·æœ‰è‡ªæˆ‘æè¿°æ€§ï¼Œæ˜“äºé˜…è¯»
- XML æ˜¯Â W3C çš„æ¨èæ ‡å‡†

**XML ä¸ HTML çš„åŒºåˆ«**ï¼š

* XML ä¸æ˜¯ HTML çš„æ›¿ä»£ï¼ŒXML å’Œ HTML ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡
* XML è¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ï¼›XMlæ ‡ç­¾å¯è‡ªå®šä¹‰ï¼Œä¾¿äºé˜…è¯»
* HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ï¼›HTMLæ ‡ç­¾è¢«é¢„è®¾å¥½ï¼Œä¾¿äºæµè§ˆå™¨è¯†åˆ«
* HTML æ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“ä¿¡æ¯



****



### åˆ›å»º

person.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<person id="110">
	<age>18</age>		<!--å¹´é¾„-->
	<name>å¼ ä¸‰</name>	  <!--å§“å-->
	<sex/>				<!--æ€§åˆ«-->
</person>
```



***



### ç»„æˆ

XML æ–‡ä»¶ä¸­å¸¸è§çš„ç»„æˆå…ƒç´ æœ‰:æ–‡æ¡£å£°æ˜ã€å…ƒç´ ã€å±æ€§ã€æ³¨é‡Šã€è½¬ä¹‰å­—ç¬¦ã€å­—ç¬¦åŒºã€‚æ–‡ä»¶åç¼€åä¸º xml

* **æ–‡æ¡£å£°æ˜** 
  `<?xml version="1.0" encoding="utf-8" standalone="yes" ?>`ï¼Œæ–‡æ¡£å£°æ˜å¿…é¡»åœ¨ç¬¬ä¸€è¡Œï¼Œä»¥ `<?xml` å¼€å¤´ï¼Œä»¥ `?>` ç»“æŸï¼Œ
  
  * versionï¼šæŒ‡å®š XML æ–‡æ¡£ç‰ˆæœ¬ã€‚å¿…é¡»å±æ€§ï¼Œè¿™é‡Œä¸€èˆ¬é€‰æ‹© 1.0
  * encondingï¼šæŒ‡å®šå½“å‰æ–‡æ¡£çš„ç¼–ç ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯ utf-8
  * standaloneï¼šè¯¥å±æ€§ä¸æ˜¯å¿…é¡»çš„ï¼Œæè¿° XML æ–‡ä»¶æ˜¯å¦ä¾èµ–å…¶ä»–çš„ xml æ–‡ä»¶ï¼Œå–å€¼ä¸º yes/no
  
* **å…ƒç´ **        
  
  * æ ¼å¼ 1ï¼š`<person></person> ` 
  * æ ¼å¼ 2ï¼š`<person/>`
  * æ™®é€šå…ƒç´ çš„ç»“æ„ç”±å¼€å§‹æ ‡ç­¾ã€å…ƒç´ ä½“ã€ç»“æŸæ ‡ç­¾ç»„æˆ
  * æ ‡ç­¾ç”±ä¸€å¯¹å°–æ‹¬å·å’Œåˆæ³•æ ‡è¯†ç¬¦ç»„æˆï¼Œæ ‡ç­¾å¿…é¡»æˆå¯¹å‡ºç°ã€‚ç‰¹æ®Šçš„æ ‡ç­¾å¯ä»¥ä¸æˆå¯¹ï¼Œå¿…é¡»æœ‰ç»“æŸæ ‡è®° </>
  
* å…ƒç´ ä½“ï¼šå¯ä»¥æ˜¯å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼š``<person><name>å¼ ä¸‰</name></person>``
  * ç©ºå…ƒç´ ï¼šç©ºå…ƒç´ åªæœ‰æ ‡ç­¾ï¼Œè€Œæ²¡æœ‰ç»“æŸæ ‡ç­¾ï¼Œä½†**å…ƒç´ å¿…é¡»è‡ªå·±é—­åˆ**ï¼Œä¾‹å¦‚ï¼š``<sex/>``
  * å…ƒç´ å‘½åï¼šåŒºåˆ†å¤§å°å†™ã€ä¸èƒ½ä½¿ç”¨ç©ºæ ¼å†’å·ã€ä¸å»ºè®®ç”¨ XMLã€xmlã€Xml ç­‰å¼€å¤´
  * å¿…é¡»å­˜åœ¨ä¸€ä¸ªæ ¹æ ‡ç­¾ï¼Œæœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ª
  
* **å±æ€§**ï¼š`<name id="1" desc="é«˜å¯Œå¸…">`
  
  * å±æ€§æ˜¯å…ƒç´ çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¿…é¡»å‡ºç°åœ¨å…ƒç´ çš„å¼€å§‹æ ‡ç­¾ä¸­
  * å±æ€§çš„å®šä¹‰æ ¼å¼ï¼š`å±æ€§å=â€œå±æ€§å€¼â€`ï¼Œå…¶ä¸­å±æ€§å€¼å¿…é¡»ä½¿ç”¨å•å¼•æˆ–åŒå¼•å·æ‹¬èµ·æ¥
  * ä¸€ä¸ªå…ƒç´ å¯ä»¥æœ‰ 0~N ä¸ªå±æ€§ï¼Œä½†ä¸€ä¸ªå…ƒç´ ä¸­ä¸èƒ½å‡ºç°åŒåå±æ€§
  * å±æ€§åä¸èƒ½ä½¿ç”¨ç©ºæ ¼ , ä¸è¦ä½¿ç”¨å†’å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œä¸”å¿…é¡»ä»¥å­—æ¯å¼€å¤´

* **æ³¨é‡Š**ï¼š<!--æ³¨é‡Šå†…å®¹-->
  XMLçš„æ³¨é‡Šä¸HTMLç›¸åŒï¼Œæ—¢ä»¥ `<!--` å¼€å§‹ï¼Œ`-->` ç»“æŸã€‚
  
* **è½¬ä¹‰å­—ç¬¦**
  XML ä¸­çš„è½¬ä¹‰å­—ç¬¦ä¸ HTML ä¸€æ ·ã€‚å› ä¸ºå¾ˆå¤šç¬¦å·å·²ç»è¢«æ–‡æ¡£ç»“æ„æ‰€ä½¿ç”¨ï¼Œæ‰€ä»¥åœ¨å…ƒç´ ä½“æˆ–å±æ€§å€¼ä¸­æƒ³ä½¿ç”¨è¿™äº›ç¬¦å·å°±å¿…é¡»ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ï¼ˆä¹Ÿå«å®ä½“å­—ç¬¦ï¼‰ï¼Œä¾‹å¦‚ï¼š">"ã€"<"ã€"'"ã€"""ã€"&"
  XML ä¸­ä»…æœ‰å­—ç¬¦ < å’Œ & æ˜¯éæ³•çš„ã€‚çœç•¥å·ã€å¼•å·å’Œå¤§äºå·æ˜¯åˆæ³•çš„ï¼ŒæŠŠå®ƒä»¬æ›¿æ¢ä¸ºå®ä½“å¼•ç”¨

  | å­—ç¬¦ | é¢„å®šä¹‰çš„è½¬ä¹‰å­—ç¬¦ |  è¯´æ˜  |
  | :--: | :--------------: | :----: |
  |  <   |     ``&lt;``     |  å°äº  |
  |  >   |    `` &gt;``     |  å¤§äº  |
  |  "   |   `` &quot;``    | åŒå¼•å· |
  |  '   |   `` &apos;``    | å•å¼•å· |
  |  &   |    `` &amp;``    |  å’Œå·  |

* **å­—ç¬¦åŒº**

  ```xml
  <![CDATA[
  	æ–‡æœ¬æ•°æ®
  ]]>
  ```
  
  * CDATA æŒ‡çš„æ˜¯ä¸åº”ç”± XML è§£æå™¨è¿›è¡Œè§£æçš„æ–‡æœ¬æ•°æ®ï¼ˆUnparsed Character Dataï¼‰
* CDATA éƒ¨åˆ†ç”± "<![CDATA[" å¼€å§‹ï¼Œç”± "]]>" ç»“æŸï¼›
  * å¤§é‡çš„è½¬ä¹‰å­—ç¬¦åœ¨xmlæ–‡æ¡£ä¸­æ—¶ï¼Œä¼šä½¿XMLæ–‡æ¡£çš„å¯è¯»æ€§å¤§å¹…åº¦é™ä½ã€‚è¿™æ—¶ä½¿ç”¨CDATAæ®µå°±ä¼šå¥½ä¸€äº›
  
  * è§„åˆ™ï¼š
     * CDATA éƒ¨åˆ†ä¸èƒ½åŒ…å«å­—ç¬¦ä¸² ]]>ï¼Œä¹Ÿä¸å…è®¸åµŒå¥—çš„ CDATA éƒ¨åˆ†
     * æ ‡è®° CDATA éƒ¨åˆ†ç»“å°¾çš„ ]]> ä¸èƒ½åŒ…å«ç©ºæ ¼æˆ–æŠ˜è¡Œ
  
  ```xml
  <?xml version="1.0" encoding="UTF-8" ?>
  <?xml-stylesheet type="text/css" href="../css/xml.css" ?>
  <!-- 7.å¤„ç†æŒ‡ä»¤ï¼šå¯¼å…¥å¤–éƒ¨çš„cssæ ·å¼æ§åˆ¶xmlçš„ç•Œé¢æ•ˆæœï¼Œæ²¡æœ‰å•¥ç”¨ï¼Œxmlä¸æ˜¯ä¸ºäº†å±•ç¤ºå¥½çœ‹çš„ï¼-->
  <!-- 1.ç”³æ˜ æŠ¬å¤´ å¿…é¡»åœ¨ç¬¬ä¸€è¡Œ-->
  <!-- 2.æ³¨é‡Šï¼Œæœ¬å¤„å°±æ˜¯æ³¨é‡Šï¼Œå¿…é¡»ç”¨å‰åå°–æ‹¬å·å›´èµ·æ¥ -->
  <!-- 3.æ ‡ç­¾ï¼ˆå…ƒç´ ï¼‰ï¼Œæ³¨æ„ä¸€ä¸ªXMLæ–‡ä»¶åªèƒ½æœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾-->
  <student>
      <!-- 4.å±æ€§ä¿¡æ¯ï¼šid , desc-->
      <name id="1" desc="é«˜å¯Œå¸…">è¥¿é—¨åº†</name>
      <age>32</age>
      <!-- 5.å®ä½“å­—ç¬¦ï¼šåœ¨xmlæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å†™å°äºå·ï¼Œç­‰ä¸€äº›ç‰¹æ®Šå­—ç¬¦
          ä¼šä¸xmlæ–‡ä»¶æœ¬èº«çš„å†…å®¹å†²çªæŠ¥é”™ï¼Œæ­¤æ—¶å¿…é¡»ç”¨è½¬ä¹‰çš„å®ä½“å­—ç¬¦ã€‚
      -->
      <sql>
         <!-- select * from student where age < 18 && age > 10; -->
          select * from student where age &lt; 18 &amp;&amp; age &gt; 10;
      </sql>
      <!-- 6.å­—ç¬¦æ•°æ®åŒºï¼šåœ¨xmlæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å†™å°äºå·ï¼Œç­‰ä¸€äº›ç‰¹æ®Šå­—ç¬¦
          ä¼šä¸xmlæ–‡ä»¶æœ¬èº«çš„å†…å®¹å†²çªæŠ¥é”™ï¼Œæ­¤æ—¶å¿…é¡»ç”¨è½¬ä¹‰çš„å®ä½“å­—ç¬¦
          æˆ–è€…ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨å­—ç¬¦æ•°æ®åŒºï¼Œé‡Œé¢çš„å†…å®¹å¯ä»¥éšä¾¿äº†ï¼
          -->
      <sql2>
          <![CDATA[
               select * from student where age < 18 && age > 10;
          ]]>
      </sql2>
  </student>
  ```
  
  

****



### çº¦æŸ

#### DTD

##### DTD å®šä¹‰

DTD æ˜¯æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDocument Type Definitionï¼‰ã€‚DTD å¯ä»¥å®šä¹‰åœ¨ XML æ–‡æ¡£ä¸­å‡ºç°çš„å…ƒç´ ã€è¿™äº›å…ƒç´ å‡ºç°çš„æ¬¡åºã€å®ƒä»¬å¦‚ä½•ç›¸äº’åµŒå¥—ä»¥åŠ XML æ–‡æ¡£ç»“æ„çš„å…¶å®ƒè¯¦ç»†ä¿¡æ¯ã€‚

DTD è§„åˆ™ï¼š

* çº¦æŸå…ƒç´ çš„åµŒå¥—å±‚çº§

  ```dtd
  <!ELEMENT çˆ¶æ ‡ç­¾ ï¼ˆå­æ ‡ç­¾1ï¼Œå­æ ‡ç­¾2ï¼Œâ€¦ï¼‰>
  ```

* çº¦æŸå…ƒç´ ä½“é‡Œé¢çš„æ•°æ®
  
* è¯­æ³•
  
     ```dtd
     <!ELEMENT æ ‡ç­¾åå­— æ ‡ç­¾ç±»å‹>
  ```
  
* åˆ¤æ–­å…ƒç´ 
           ç®€å•å…ƒç´ ï¼šæ²¡æœ‰å­å…ƒç´ ã€‚
           å¤æ‚å…ƒç´ ï¼šæœ‰å­å…ƒç´ çš„å…ƒç´ ï¼›
   
   * æ ‡ç­¾ç±»å‹
   
  | æ ‡ç­¾ç±»å‹ | ä»£ç å†™æ³•  | è¯´æ˜                 |
  | -------- | --------- | -------------------- |
  | PCDATA   | (#PCDATA) | è¢«è§£é‡Šçš„å­—ç¬¦ä¸²æ•°æ®   |
  | EMPTY    | EMPTY     | å³ç©ºå…ƒç´ ï¼Œä¾‹å¦‚\<hr/> |
  | ANY      | ANY       | å³ä»»æ„ç±»å‹           |
  
   * ä»£ç 
  
     ```dtd
  <!ELEMENT persons (person+)>   	<!--çº¦æŸäººä»¬è‡³å°‘ä¸€ä¸ªäºº-->
     <!ELEMENT person (name,age)>	<!--çº¦æŸå…ƒç´ äººçš„å­å…ƒç´ å¿…é¡»ä¸ºå§“åã€å¹´é¾„ï¼Œå¹¶ä¸”æŒ‰é¡ºåº-->
     <!ELEMENT name (#PCDATA)>		<!--"å§“å"å…ƒç´ ä½“ä¸ºå­—ç¬¦ä¸²æ•°æ®-->
     <!ELEMENT age ANY>       		<!--"å¹´é¾„"å…ƒç´ ä½“ä¸ºä»»æ„ç±»å‹-->
     ```
  
   * æ•°é‡è¯
  
     | æ•°é‡è¯ç¬¦å· | å«ä¹‰                         |
     | ---------- | ---------------------------- |
     | ç©º         | è¡¨ç¤ºå…ƒç´ å‡ºç°ä¸€æ¬¡             |
     | *          | è¡¨ç¤ºå…ƒç´ å¯ä»¥å‡ºç°0åˆ°å¤šä¸ª      |
     | +          | è¡¨ç¤ºå…ƒç´ å¯ä»¥å‡ºç°è‡³å°‘1ä¸ª      |
     | ?          | è¡¨ç¤ºå…ƒç´ å¯ä»¥æ˜¯0æˆ–1ä¸ª         |
     | ,          | è¡¨ç¤ºå…ƒç´ éœ€è¦æŒ‰ç…§é¡ºåºæ˜¾ç¤º     |
     | \|         | è¡¨ç¤ºå…ƒç´ éœ€è¦é€‰æ‹©å…¶ä¸­çš„æŸä¸€ä¸ª |
  
     
  
* å±æ€§å£°æ˜

   * è¯­æ³•

     ```dtd
     <!ATTLIST æ ‡ç­¾åç§° 
     		å±æ€§åç§°1 å±æ€§ç±»å‹1 å±æ€§è¯´æ˜1
     		å±æ€§åç§°2 å±æ€§ç±»å‹2 å±æ€§è¯´æ˜2
     		â€¦
     >
     ```

   * å±æ€§ç±»å‹

     | å±æ€§ç±»å‹   | å«ä¹‰                                                         |
     | ---------- | ------------------------------------------------------------ |
     | CDATA      | ä»£è¡¨å±æ€§æ˜¯æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œ eg:<!ATTLIST å±æ€§å CDATA å±æ€§è¯´æ˜>   |
     | ID         | ä»£ç è¯¥å±æ€§å€¼å”¯ä¸€ï¼Œä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œ eg:<!ATTLIST å±æ€§å ID å±æ€§è¯´æ˜> |
     | ENUMERATED | ä»£è¡¨å±æ€§å€¼åœ¨æŒ‡å®šèŒƒå›´å†…è¿›è¡Œæšä¸¾ Eg:<!ATTLISTå±æ€§å (ç¤¾ç§‘ç±»\|å·¥ç¨‹ç±»\|æ•™è‚²ç±») "ç¤¾ç§‘ç±»"> "ç¤¾ç§‘ç±»"æ˜¯é»˜è®¤å€¼ï¼Œå±æ€§å¦‚æœä¸è®¾ç½®é»˜è®¤å€¼å°±æ˜¯"ç¤¾ç§‘ç±»" |

   * å±æ€§è¯´æ˜

     | å±æ€§è¯´æ˜  | å«ä¹‰                                                        |
     | --------- | ----------------------------------------------------------- |
     | #REQUIRED | ä»£è¡¨å±æ€§æ˜¯å¿…é¡»æœ‰çš„                                          |
     | #IMPLIED  | ä»£è¡¨å±æ€§å¯æœ‰å¯æ—                                             |
     | #FIXED    | ä»£è¡¨å±æ€§ä¸ºå›ºå®šå€¼ï¼Œå®ç°æ–¹å¼ï¼šbook_info CDATA #FIXED "å›ºå®šå€¼" |

   * ä»£ç 

     ```dtd
     <!ATTLIST ä¹¦									<!--è®¾ç½®"ä¹¦"å…ƒç´ çš„çš„å±æ€§åˆ—è¡¨-->
     	id ID #REQUIRED						 <!--"id"å±æ€§å€¼ä¸ºå¿…é¡»æœ‰-->
     	ç¼–å· CDATA #IMPLIED				    <!--"ç¼–å·"å±æ€§å¯æœ‰å¯æ— -->
     	å‡ºç‰ˆç¤¾ (æ¸…å|åŒ—å¤§|ä¼ æ™ºæ’­å®¢) "ä¼ æ™ºæ’­å®¢" <!--"å‡ºç‰ˆç¤¾"å±æ€§å€¼æ˜¯æšä¸¾å€¼ï¼Œé»˜è®¤ä¸ºâ€œä¼ æ™ºæ’­å®¢â€-->
     	type CDATA #FIXED "IT"            <!--"type"å±æ€§ä¸ºæ–‡æœ¬å­—ç¬¦ä¸²å¹¶ä¸”å›ºå®šå€¼ä¸º"IT"-->
     >
     <!ATTLIST person id CDATA #REQUIRED>  <!--idæ˜¯æ–‡æœ¬å­—ç¬¦ä¸²å¿…é¡»æœ‰-->
     ```
   
     

****



##### DTD å¼•å…¥

* å¼•å…¥æœ¬åœ° dtd

  ```dtd
  <!DOCTYPE æ ¹å…ƒç´ åç§° SYSTEM â€˜DTDæ–‡ä»¶çš„è·¯å¾„'>
  ```

* åœ¨ xml æ–‡ä»¶å†…éƒ¨å¼•å…¥

  ```dtd
  <!DOCTYPE æ ¹å…ƒç´ åç§° [ dtdæ–‡ä»¶å†…å®¹ ]>
  ```

* å¼•å…¥ç½‘ç»œ dtd

  ```dtd
  <!DOCTYPE æ ¹å…ƒç´ çš„åç§° PUBLIC "DTDæ–‡ä»¶åç§°" "DTDæ–‡æ¡£çš„URL">
  ```

```dtd
<!--è¿™æ˜¯persondtd.dtdæ–‡ä»¶ä¸­çš„å†…å®¹,å·²ç»æå‰å†™å¥½-->
<!ELEMENT persons (person)>
<!ELEMENT person (name,age)>
<!ELEMENT name (#PCDATA)>
<!ELEMENT age (#PCDATA)>
```

```xml
<!--å¼•å…¥æœ¬åœ°DTD-->
<!DOCTYPE persons SYSTEM 'persondtd.dtd'>
<persons>
    <person>
        <name>å¼ ä¸‰</name>
        <age>23</age>
    </person>

</persons>
```

```xml-dtd
<!--å†…éƒ¨å¼•å…¥DTD-->
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE persons [
        <!ELEMENT persons (person)>
        <!ELEMENT person (name,age)>
        <!ELEMENT name (#PCDATA)>
        <!ELEMENT age (#PCDATA)>
        ]>

<persons>
    <person>
        <name>å¼ ä¸‰</name>
        <age>23</age>
    </person>
</persons>
```

```dtd
<!--å¼•å…¥ç½‘ç»œDTD--><?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE persons PUBLIC "dtdæ–‡ä»¶çš„åç§°" "dtdæ–‡æ¡£çš„URL">

<persons>
    <person>
        <name>å¼ ä¸‰</name>
        <age>23</age>
    </person>
</persons>
```



***



##### DTD å®ç°

persondtd.dtd æ–‡ä»¶

```dtd
<!ELEMENT persons (person+)>   	<!--çº¦æŸäººä»¬è‡³å°‘ä¸€ä¸ªäºº-->
<!ELEMENT person (name,age)>	<!--çº¦æŸå…ƒç´ äººçš„å­å…ƒç´ å¿…é¡»ä¸ºå§“åã€å¹´é¾„ï¼Œå¹¶ä¸”æŒ‰é¡ºåº-->
<!ELEMENT name (#PCDATA)>		<!--"å§“å"å…ƒç´ ä½“ä¸ºå­—ç¬¦ä¸²æ•°æ®-->
<!ELEMENT age ANY>       		<!--"å¹´é¾„"å…ƒç´ ä½“ä¸ºä»»æ„ç±»å‹-->
<!ATTLIST person id CDATA #REQUIRED>  <!--idæ˜¯æ–‡æœ¬å­—ç¬¦ä¸²å¿…é¡»æœ‰-->
```

```xml-dtd
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE persons SYSTEM 'persondtd.dtd'>

<persons>
    <person id="001">
        <name>å¼ ä¸‰</name>
        <age>23</age>
    </person>

    <person id = "002">
        <name>å¼ ä¸‰</name>
        <age>23</age>
    </person>
</persons>
```



***



#### Schema

##### XSD å®šä¹‰

1. Schema è¯­è¨€ä¹Ÿå¯ä½œä¸º XSDï¼ˆXML Schema Definitionï¼‰
2. Schema çº¦æŸæ–‡ä»¶æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª XML æ–‡ä»¶ï¼Œç¬¦åˆ XML çš„è¯­æ³•ï¼Œè¿™ä¸ªæ–‡ä»¶çš„åç¼€å .xsd
3. ä¸€ä¸ª XML ä¸­å¯ä»¥å¼•ç”¨å¤šä¸ª Schema çº¦æŸæ–‡ä»¶ï¼Œå¤šä¸ª Schema ä½¿ç”¨åç§°ç©ºé—´åŒºåˆ†ï¼ˆåç§°ç©ºé—´ç±»ä¼¼äº Java åŒ…åï¼‰
4. dtd é‡Œé¢å…ƒç´ ç±»å‹çš„å–å€¼æ¯”è¾ƒå•ä¸€å¸¸è§çš„æ˜¯ PCDATA ç±»å‹ï¼Œä½†æ˜¯åœ¨ Schema é‡Œé¢å¯ä»¥æ”¯æŒå¾ˆå¤šä¸ªæ•°æ®ç±»å‹
5. **Schema æ–‡ä»¶çº¦æŸ XML æ–‡ä»¶çš„åŒæ—¶ä¹Ÿè¢«åˆ«çš„æ–‡ä»¶çº¦æŸç€**



***



##### XSD è§„åˆ™

1. åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„åç¼€åä¸º .xsd
2. å®šä¹‰æ–‡æ¡£å£°æ˜
3. schema æ–‡ä»¶çš„æ ¹æ ‡ç­¾ä¸ºï¼š <schema>
4. åœ¨ <schema> ä¸­å®šä¹‰å±æ€§ï¼š
   * xmlns=http://www.w3.org/2001/XMLSchema
   * ä»£è¡¨å½“å‰æ–‡ä»¶æ—¶çº¦æŸåˆ«äººçš„ï¼ŒåŒæ—¶è¿™ä¸ªæ–‡ä»¶ä¹Ÿå¯¹è¯¥ Schema è¿›è¡Œçº¦æŸ
5. åœ¨<schema>ä¸­å®šä¹‰å±æ€§ ï¼š
   * targetNamespace = å”¯ä¸€çš„ url åœ°å€ï¼ŒæŒ‡å®šå½“å‰è¿™ä¸ª schema æ–‡ä»¶çš„åç§°ç©ºé—´ã€‚
   * **åç§°ç©ºé—´**ï¼šå½“å…¶ä»– xml ä½¿ç”¨è¯¥ schema æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥æ­¤ç©ºé—´
6. åœ¨<schema>ä¸­å®šä¹‰å±æ€§ ï¼š
   * elementFormDefault="qualifiedâ€œï¼Œè¡¨ç¤ºå½“å‰ schema æ–‡ä»¶æ˜¯ä¸€ä¸ªè´¨é‡è‰¯å¥½çš„æ–‡ä»¶ã€‚
7. é€šè¿‡ element å®šä¹‰å…ƒç´ 
8. **åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯ç®€å•å…ƒç´ è¿˜æ˜¯å¤æ‚å…ƒç´ **

person.xsd

```scheme
<?xml version="1.0" encoding="UTF-8" ?>
<schema
    xmlns="http://www.w3.org/2001/XMLSchema"     <!--æœ¬æ–‡ä»¶æ˜¯çº¦æŸåˆ«äººçš„ï¼Œä¹Ÿè¢«çº¦æŸ-->
    targetNamespace="http://www.seazean.cn/javase"<!--è‡ªå·±çš„åç§°ç©ºé—´-->
    elementFormDefault="qualified"				  <!--æœ¬æ–‡ä»¶æ˜¯è´¨é‡å¥½çš„-->
>

    <element name="persons">    		  <!--å®šä¹‰personså¤æ‚å…ƒç´ -->
        <complexType>           		  <!--å¤æ‚çš„å…ƒç´ -->
            <sequence>					  <!--é‡Œé¢çš„å…ƒç´ å¿…é¡»æŒ‰ç…§é¡ºåºå®šä¹‰-->
                <element name = "person"> <!--å®šä¹‰personå¤æ‚å…ƒç´ -->
                    <complexType>
                        <sequence>
                            <!--å®šä¹‰nameå’Œageç®€å•å…ƒç´ -->
                            <element name = "name" type = "string"></element>
                            <element name = "age" type = "string"></element>
                        </sequence>
                    </complexType>
                </element>
            </sequence>
        </complexType>
    </element>
    
</schema>
```



****



##### XSD å¼•å…¥

1. åœ¨æ ¹æ ‡ç­¾ä¸Šå®šä¹‰å±æ€§ xmlns="http://www.w3.org/2001/XMLSchema-instance"
2. **é€šè¿‡ xmlns å¼•å…¥çº¦æŸæ–‡ä»¶çš„åç§°ç©ºé—´**
3. ç»™æŸä¸€ä¸ª xmlns å±æ€§æ·»åŠ ä¸€ä¸ªæ ‡è¯†ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„åç§°ç©ºé—´ï¼Œæ ¼å¼ä¸º `xmlns:æ ‡è¯†="åç§°ç©ºé—´url"` ï¼Œæ ‡è¯†å¯ä»¥æ˜¯ä»»æ„çš„ï¼Œä½†æ˜¯ä¸€èˆ¬å–å€¼éƒ½æ˜¯ xsi
4. é€šè¿‡ xsi:schemaLocation æŒ‡å®šåç§°ç©ºé—´æ‰€å¯¹åº”çš„çº¦æŸæ–‡ä»¶è·¯å¾„ï¼Œæ ¼å¼ä¸º `xsi:schemaLocation = "åç§°ç©ºé—´url æ–‡ä»¶è·¯å¾„`

```scheme
<?xml version="1.0" encoding="UTF-8" ?>
<persons
	xmlms:xis="http://www.w3.org/2001/XMLSchema-instance" <!--è¢«åˆ«äººçº¦æŸ-->
    xmlns="http://www.seazean.cn/javase"                  <!--çº¦æŸæ–‡ä»¶çš„åç§°ç©ºé—´-->
    xsi:schemaLocation="http://www.seazean.cn/javase person.xsd"
>

 <person>
        <name>å¼ ä¸‰</name>
        <age>23</age>
    </person>

</persons>
```



****



##### XSD å±æ€§

```scheme
<?xml version="1.0" encoding="UTF-8" ?>
<schema
    xmlns="http://www.w3.org/2001/XMLSchema"
    targetNamespace="http://www.seazean.cn/javase"
    elementFormDefault="qualified"
>

    <!--å®šä¹‰personså¤æ‚å…ƒç´ -->
    <element name="persons">
        <complexType>
            <sequence>
                <!--å®šä¹‰personå¤æ‚å…ƒç´ -->
                <element name = "person">
                    <complexType>
                        <sequence>
                            <!--å®šä¹‰nameå’Œageç®€å•å…ƒç´ -->
                            <element name = "name" type = "string"></element>
                            <element name = "age" type = "string"></element>
                        </sequence>
                        <!--å®šä¹‰çš„ä½ç½®æ˜¯sequenceçš„å¤–é¢ï¼ŒcomplexTypeçš„é‡Œé¢-->
                        <!--å®šä¹‰å±æ€§ï¼Œrequired( å¿…é¡»çš„)/optional( å¯é€‰çš„)-->
                        <attribute name="id" type="string" use="required">		
						</attribute>
                    </complexType>
                    
                </element>
            </sequence>
        </complexType>
    </element>
    
</schema>

<?xml version="1.0" encoding="UTF-8" ?>
<persons
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.seazean.cn/javase"
    xsi:schemaLocation="http://www.seazean.cn/javase person.xsd"
>
    <person id="001">
        <name>å¼ ä¸‰</name>
        <age>23</age>
    </person>

</persons>
```



***



### Dom4J

#### è§£æ

XML è§£æå°±æ˜¯ä» XML ä¸­è·å–åˆ°æ•°æ®ï¼ŒDOM æ˜¯è§£ææ€æƒ³

DOMï¼ˆDocument Object Modelï¼‰ï¼šæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ŒæŠŠæ–‡æ¡£çš„å„ä¸ªç»„æˆéƒ¨åˆ†çœ‹åšæˆå¯¹åº”çš„å¯¹è±¡ï¼ŒæŠŠ XML æ–‡ä»¶å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ï¼Œåœ¨å†…å­˜ä¸­å½¢æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œå†è·å–å¯¹åº”çš„å€¼

Dom4J å®ç°ï¼š
* Dom4J è§£æå™¨æ„é€ æ–¹æ³•ï¼š`SAXReader saxReader = new SAXReader()`

* SAXReader å¸¸ç”¨ APIï¼š

  * `public Document read(File file)`ï¼šReads a Document from the given File
  * `public Document read(InputStream in)`ï¼šReads a Document from the given stream using SAX

* Java Class ç±» APIï¼š
  
  * `public InputStream getResourceAsStream(String path)`ï¼šåŠ è½½æ–‡ä»¶æˆä¸ºä¸€ä¸ªå­—èŠ‚è¾“å…¥æµè¿”å›



****



#### æ ¹å…ƒç´ 

Document æ–¹æ³•ï¼š`Element getRootElement()` è·å–æ ¹å…ƒç´ 

```java
// éœ€æ±‚ï¼šè§£æbooks.xmlæ–‡ä»¶æˆä¸ºä¸€ä¸ªDocumentæ–‡æ¡£æ ‘å¯¹è±¡ï¼Œå¾—åˆ°æ ¹å…ƒç´ å¯¹è±¡ã€‚
public class Dom4JDemo {
    public static void main(String[] args) throws Exception {
        // 1.åˆ›å»ºä¸€ä¸ªdom4jçš„è§£æå™¨å¯¹è±¡ï¼šä»£è¡¨æ•´ä¸ªdom4jæ¡†æ¶ã€‚
        SAXReader saxReader = new SAXReader();
        // 2.ç¬¬ä¸€ç§æ–¹å¼ï¼ˆç®€å•ï¼‰ï¼šé€šè¿‡è§£æå™¨å¯¹è±¡å»åŠ è½½xmlæ–‡ä»¶æ•°æ®ï¼Œæˆä¸ºä¸€ä¸ªDocumentæ–‡æ¡£æ ‘å¯¹è±¡ã€‚
        //Document document = saxReader.read(new File("Day13Demo/src/books.xml"));
        
        // 3.ç¬¬äºŒç§æ–¹å¼ï¼ˆä»£ç å¤šç‚¹ï¼‰å…ˆæŠŠxmlæ–‡ä»¶è¯»æˆä¸€ä¸ªå­—èŠ‚è¾“å…¥æµ
        // è¿™é‡Œçš„â€œ/â€æ˜¯ç›´æ¥å»srcç±»è·¯å¾„ä¸‹å¯»æ‰¾æ–‡ä»¶ã€‚
        InputStream is = Dom4JDemo01.class.getResourceAsStream("/books.xml");
        Document document = saxReader.read(is);
        System.out.println(document);
		//org.dom4j.tree.DefaultDocument@27a5f880 [Document: name null]
		// 4.ä»documentæ–‡æ¡£æ ‘å¯¹è±¡ä¸­æå–æ ¹å…ƒç´ å¯¹è±¡
        Element root = document.getRootElement();
        System.out.println(root.getName());//books
    }
}
```

```xml
<?xml version="1.0" encoding="UTF-8"?>
<books>
    <book id="0001" desc="ç¬¬ä¸€æœ¬ä¹¦">
        <name>  JavaWebå¼€å‘æ•™ç¨‹</name>
        <author>    å¼ å­ç¥¥</author>
        <sale>100.00å…ƒ   </sale>
    </book>
    <book id="0002">
        <name>ä¸‰å›½æ¼”ä¹‰</name>
        <author>ç½—è´¯ä¸­</author>
        <sale>100.00å…ƒ</sale>
    </book>
    <user>
    </user>
</books>

```



****



#### å­å…ƒç´ 

Element å…ƒç´ çš„ API:

* String getName()ï¼šå–å…ƒç´ çš„åç§°ã€‚
* List<Element> elements()ï¼šè·å–å½“å‰å…ƒç´ ä¸‹çš„å…¨éƒ¨å­å…ƒç´ ï¼ˆä¸€çº§ï¼‰
* List<Element> elements(String name)ï¼šè·å–å½“å‰å…ƒç´ ä¸‹çš„æŒ‡å®šåç§°çš„å…¨éƒ¨å­å…ƒç´ ï¼ˆä¸€çº§ï¼‰
* Element element(String name)ï¼šè·å–å½“å‰å…ƒç´ ä¸‹çš„æŒ‡å®šåç§°çš„æŸä¸ªå­å…ƒç´ ï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªï¼ˆä¸€çº§ï¼‰

```java
public class Dom4JDemo {
    public static void main(String[] args) throws Exception {
        SAXReader saxReader = new SAXReader();
        Document document = saxReader.read(new File("Day13Demo/src/books.xml"));
        // 3.è·å–æ ¹å…ƒç´ å¯¹è±¡
        Element root = document.getRootElement();
        System.out.println(root.getName());

        // 4.è·å–æ ¹å…ƒç´ ä¸‹çš„å…¨éƒ¨å­å…ƒç´ 
        List<Element> sonElements = root.elements();
        for (Element sonElement : sonElements) {
            System.out.println(sonElement.getName());
        }
        // 5.è·å–æ ¹æºä¸‹çš„å…¨éƒ¨bookå­å…ƒç´ 
        List<Element> sonElements1 = root.elements("book");
        for (Element sonElement : sonElements1) {
            System.out.println(sonElement.getName());
        }
        
        // 6.è·å–æ ¹æºä¸‹çš„æŒ‡å®šçš„æŸä¸ªå…ƒç´ 
        Element son = root.element("user");
        System.out.println(son.getName());
        // é»˜è®¤ä¼šæå–ç¬¬ä¸€ä¸ªåç§°ä¸€æ ·çš„å­å…ƒç´ å¯¹è±¡è¿”å›ï¼
        Element son1 = root.element("book");
        System.out.println(son1.attributeValue("id"));
    }
}

```



***



#### å±æ€§

Element å…ƒç´ çš„ APIï¼š

* List<Attribute> attributes()ï¼šè·å–å…ƒç´ çš„å…¨éƒ¨å±æ€§å¯¹è±¡
* Attribute attribute(String name)ï¼šæ ¹æ®åç§°è·å–æŸä¸ªå…ƒç´ çš„å±æ€§å¯¹è±¡
* String attributeValue(String var)ï¼šç›´æ¥è·å–æŸä¸ªå…ƒç´ çš„æŸä¸ªå±æ€§åç§°çš„å€¼

Attribute å¯¹è±¡çš„ APIï¼š

* String getName()ï¼šè·å–å±æ€§åç§°
* String getValue()ï¼šè·å–å±æ€§å€¼

```java
public class Dom4JDemo {
    public static void main(String[] args) throws Exception {
        SAXReader saxReader = new SAXReader();
        Document document = saxReader.read(new File("Day13Demo/src/books.xml"));
        Element root = document.getRootElement();
        // 4.è·å–bookå­å…ƒç´ 
        Element bookEle = root.element("book");

        // 5.è·å–bookå…ƒç´ çš„å…¨éƒ¨å±æ€§å¯¹è±¡
        List<Attribute> attributes = bookEle.attributes();
        for (Attribute attribute : attributes) {
            System.out.println(attribute.getName()+"->"+attribute.getValue());
        }

        // 6.è·å–Bookå…ƒç´ çš„æŸä¸ªå±æ€§å¯¹è±¡
        Attribute descAttr = bookEle.attribute("desc");
        System.out.println(descAttr.getName()+"->"+descAttr.getValue());

        // 7.å¯ä»¥ç›´æ¥è·å–å…ƒç´ çš„å±æ€§å€¼
        System.out.println(bookEle.attributeValue("id"));
        System.out.println(bookEle.attributeValue("desc"));
    }
}
```



***



#### æ–‡æœ¬

Elementï¼š

* String elementText(String name)ï¼šå¯ä»¥ç›´æ¥è·å–å½“å‰å…ƒç´ çš„å­å…ƒç´ çš„æ–‡æœ¬å†…å®¹
* String elementTextTrim(String name)ï¼šå»å‰åç©ºæ ¼,ç›´æ¥è·å–å½“å‰å…ƒç´ çš„å­å…ƒç´ çš„æ–‡æœ¬å†…å®¹
* String getText()ï¼šç›´æ¥è·å–å½“å‰å…ƒç´ çš„æ–‡æœ¬å†…å®¹
* String getTextTrim()ï¼šå»å‰åç©ºæ ¼,ç›´æ¥è·å–å½“å‰å…ƒç´ çš„æ–‡æœ¬å†…å®¹

```java
public class Dom4JDemo {
    public static void main(String[] args) throws Exception {
        SAXReader saxReader = new SAXReader();
        Document document = saxReader.read(new File("Day13Demo/src/books.xml"));
        Element root = document.getRootElement();
        // 4.å¾—åˆ°ç¬¬ä¸€ä¸ªå­å…ƒç´ book
        Element bookEle = root.element("book");

        // 5.ç›´æ¥æ‹¿åˆ°å½“å‰bookå…ƒç´ ä¸‹çš„å­å…ƒç´ æ–‡æœ¬å€¼
        System.out.println(bookEle.elementText("name"));
        System.out.println(bookEle.elementTextTrim("name")); // å»å‰åç©ºæ ¼
        System.out.println(bookEle.elementText("author"));
        System.out.println(bookEle.elementTextTrim("author")); // å»å‰åç©ºæ ¼
        System.out.println(bookEle.elementText("sale"));
        System.out.println(bookEle.elementTextTrim("sale")); // å»å‰åç©ºæ ¼

        // 6.å…ˆè·å–åˆ°å­å…ƒç´ å¯¹è±¡ï¼Œå†è·å–è¯¥æ–‡æœ¬å€¼
        Element bookNameEle = bookEle.element("name");
        System.out.println(bookNameEle.getText());
        System.out.println(bookNameEle.getTextTrim());// å»å‰åç©ºæ ¼
    }
}
```





****



### XPath

Dom4J å¯ä»¥ç”¨äºè§£ææ•´ä¸ª XML çš„æ•°æ®ï¼Œä½†æ˜¯å¦‚æœè¦æ£€ç´¢ XML ä¸­çš„æŸäº›ä¿¡æ¯ï¼Œå»ºè®®ä½¿ç”¨ XPath

XPath å¸¸ç”¨APIï¼š

* List<Node> selectNodes(String var1) : æ£€ç´¢å‡ºä¸€æ‰¹èŠ‚ç‚¹é›†åˆ
* Node selectSingleNode(String var1) : æ£€ç´¢å‡ºä¸€ä¸ªèŠ‚ç‚¹è¿”å›

XPath æä¾›çš„å››ç§æ£€ç´¢æ•°æ®çš„å†™æ³•ï¼š

1. ç»å¯¹è·¯å¾„ï¼š/æ ¹å…ƒç´ /å­å…ƒç´ /å­å…ƒç´ 
2. ç›¸å¯¹è·¯å¾„ï¼š./å­å…ƒç´ /å­å…ƒç´  (.ä»£è¡¨äº†å½“å‰å…ƒç´ )
3. å…¨æ–‡æœç´¢ï¼š
   * //å…ƒç´ ï¼šåœ¨å…¨æ–‡æ‰¾è¿™ä¸ªå…ƒç´ 
   * //å…ƒç´ 1/å…ƒç´ 2ï¼šåœ¨å…¨æ–‡æ‰¾å…ƒç´ 1ä¸‹é¢çš„ä¸€çº§å…ƒç´  2
   *  //å…ƒç´ 1//å…ƒç´ 2ï¼šåœ¨å…¨æ–‡æ‰¾å…ƒç´ 1ä¸‹é¢çš„å…¨éƒ¨å…ƒç´  2
4. å±æ€§æŸ¥æ‰¾ï¼š
   * //@å±æ€§åç§°ï¼šåœ¨å…¨æ–‡æ£€ç´¢å±æ€§å¯¹è±¡
   * //å…ƒç´ [@å±æ€§åç§°]ï¼šåœ¨å…¨æ–‡æ£€ç´¢åŒ…å«è¯¥å±æ€§çš„å…ƒç´ å¯¹è±¡
   * //å…ƒç´ [@å±æ€§åç§°=å€¼]ï¼šåœ¨å…¨æ–‡æ£€ç´¢åŒ…å«è¯¥å±æ€§çš„å…ƒç´ ä¸”å±æ€§å€¼ä¸ºè¯¥å€¼çš„å…ƒç´ å¯¹è±¡

```java
public class XPathDemo {
    public static void main(String[] args) throws Exception {
        SAXReader saxReader = new SAXReader();
        InputStream is = XPathDemo.class.getResourceAsStream("/Contact.xml");
        Document document = saxReader.read(is);
        //1.ä½¿ç”¨ç»å¯¹è·¯å¾„å®šä½å…¨éƒ¨çš„nameåç§°
        List<Node> nameNodes1 = document.selectNodes("/contactList/contact/name");
        for (Node nameNode : nameNodes) {
            System.out.println(nameNode.getText());
        }
        
        //2.ç›¸å¯¹è·¯å¾„ã€‚ä»æ ¹å…ƒç´ å¼€å§‹æ£€ç´¢ï¼Œ.ä»£è¡¨å¾ˆæ ¹å…ƒç´ 
        List<Node> nameNodes2 = root.selectNodes("./contact/name");
        
        //3.1 åœ¨å…¨æ–‡ä¸­æ£€ç´¢nameèŠ‚ç‚¹
        List<Node> nameNodes3 = root.selectNodes("//name");//å…¨éƒ¨çš„
        //3.2 åœ¨å…¨æ–‡ä¸­æ£€ç´¢æ‰€æœ‰contactä¸‹çš„æ‰€æœ‰nameèŠ‚ç‚¹  //åŒ…æ‹¬sqlï¼Œä¸å¤–é¢çš„
        List<Node> nameNodes3 = root.selectNodes("//contact//name");
        //3.3 åœ¨å…¨æ–‡ä¸­æ£€ç´¢æ‰€æœ‰contactä¸‹çš„ç›´æ¥nameèŠ‚ç‚¹
        List<Node> nameNodes3 = root.selectNodes("//contact/name");//ä¸åŒ…æ‹¬sqlå’Œå¤–é¢
        
        //4.1 æ£€ç´¢å…¨éƒ¨å±æ€§å¯¹è±¡
        List<Node> attributes1 = root.selectNodes("//@id");//åŒ…æ‹¬sql4
        //4.2 åœ¨å…¨æ–‡æ£€ç´¢åŒ…å«è¯¥å±æ€§çš„å…ƒç´ å¯¹è±¡
        List<Node> attributes1 = root.selectNodes("//contact[@id]");
        //4.3 åœ¨å…¨æ–‡æ£€ç´¢åŒ…å«è¯¥å±æ€§çš„å…ƒç´ ä¸”å±æ€§å€¼ä¸ºè¯¥å€¼çš„å…ƒç´ å¯¹è±¡
        Node nodeEle = document.selectSingleNode("//contact[@id=2]");
        Element ele = (Element)nodeEle;
        System.out.println(ele.elementTextTrim("name"));//xi
    }
}
```

```xml
<?xml version="1.0" encoding="UTF-8"?>
<contactList>
<contact id="1">
    <name>å°ç™½</name>
    <gender>å¥³</gender>
    <email>bai@seazean.cn</email>
</contact>
<contact id="2">
    <name>å°é»‘</name>
    <gender>ç”·</gender>
    <email>hei@seazean.cn</email>
    <sql id="sql4">
        <name>sqlè¯­å¥</name>
    </sql>
</contact>
<contact id="3">
    <name>å°è™</name>
    <gender>ç”·</gender>
    <email>hu@seazean.cn</email>
</contact>
<contact></contact>
<name>å¤–é¢çš„åç§°</name>
</contactList>
```





****





## SDP

### å•ä¾‹æ¨¡å¼

#### åŸºæœ¬ä»‹ç»

å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Java ä¸­æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼

å•ä¾‹è®¾è®¡æ¨¡å¼åˆ†ç±»ä¸¤ç§ï¼š

* é¥¿æ±‰å¼ï¼šç±»åŠ è½½å°±ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»º	

* æ‡’æ±‰å¼ï¼šç±»åŠ è½½ä¸ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»ºï¼Œè€Œæ˜¯é¦–æ¬¡ä½¿ç”¨è¯¥å¯¹è±¡æ—¶æ‰ä¼šåˆ›å»º



***



#### é¥¿æ±‰å¼

é¥¿æ±‰å¼åœ¨ç±»åŠ è½½çš„è¿‡ç¨‹å¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»ºï¼Œ**è™šæ‹Ÿæœºä¼šä¿è¯ç±»åŠ è½½çš„çº¿ç¨‹å®‰å…¨**ï¼Œä½†æ˜¯å¦‚æœåªæ˜¯ä¸ºäº†åŠ è½½è¯¥ç±»ä¸éœ€è¦å®ä¾‹ï¼Œåˆ™ä¼šé€ æˆå†…å­˜çš„æµªè´¹

* é™æ€å˜é‡çš„æ–¹å¼ï¼š

  ```java
  public final class Singleton {
      // ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
      // åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡
      private static final Singleton instance = new Singleton();
      // å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          return instance;
      }
      
      // è§£å†³åºåˆ—åŒ–é—®é¢˜
      protected Object readResolve() {
      	return INSTANCE;
      }
  }
  ```

  * åŠ  final ä¿®é¥°ï¼Œæ‰€ä»¥ä¸ä¼šè¢«å­ç±»ç»§æ‰¿ï¼Œé˜²æ­¢å­ç±»ä¸­ä¸é€‚å½“çš„è¡Œä¸ºè¦†ç›–çˆ¶ç±»çš„æ–¹æ³•ï¼Œç ´åäº†å•ä¾‹

  * é˜²æ­¢ååºåˆ—åŒ–ç ´åå•ä¾‹çš„æ–¹å¼ï¼š

    * å¯¹å•ä¾‹å£°æ˜ transientï¼Œç„¶åå®ç° readObject(ObjectInputStream in) æ–¹æ³•ï¼Œå¤ç”¨åŸæ¥çš„å•ä¾‹

      æ¡ä»¶ï¼šè®¿é—®æƒé™ä¸º private/protectedã€è¿”å›å€¼å¿…é¡»æ˜¯ Objectã€å¼‚å¸¸å¯ä»¥ä¸æŠ›

    * å®ç° readResolve() æ–¹æ³•ï¼Œå½“ JVM ä»å†…å­˜ä¸­ååºåˆ—åŒ–åœ°ç»„è£…ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨ readResolve æ–¹æ³•è¿”å›åŸæ¥å•ä¾‹

  * æ„é€ æ–¹æ³•è®¾ç½®ä¸ºç§æœ‰ï¼Œé˜²æ­¢å…¶ä»–ç±»æ— é™åˆ›å»ºå¯¹è±¡ï¼Œä½†æ˜¯ä¸èƒ½é˜²æ­¢åå°„ç ´å

  * é™æ€å˜é‡åˆå§‹åŒ–åœ¨ç±»åŠ è½½æ—¶å®Œæˆï¼Œ**ç”± JVM ä¿è¯çº¿ç¨‹å®‰å…¨**ï¼Œèƒ½ä¿è¯å•ä¾‹å¯¹è±¡åˆ›å»ºæ—¶çš„å®‰å…¨

  * æä¾›é™æ€æ–¹æ³•è€Œä¸æ˜¯ç›´æ¥å°† INSTANCE è®¾ç½®ä¸º publicï¼Œä½“ç°äº†æ›´å¥½çš„å°è£…æ€§ã€æä¾›æ³›å‹æ”¯æŒã€å¯ä»¥æ”¹è¿›æˆæ‡’æ±‰å•ä¾‹è®¾è®¡

* é™æ€ä»£ç å—çš„æ–¹å¼ï¼š

  ```java
  public class Singleton {
      // ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
      
      // åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡
      private static Singleton instance;
      static {
          instance = new Singleton();
      }
      
      // å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          return instance;
      }
  }
  ```

* æšä¸¾æ–¹å¼ï¼šæšä¸¾ç±»å‹æ˜¯æ‰€ç”¨å•ä¾‹å®ç°ä¸­**å”¯ä¸€ä¸€ç§ä¸ä¼šè¢«ç ´å**çš„å•ä¾‹å®ç°æ¨¡å¼

  ```java
  public enum Singleton {
      INSTANCE;
      public void doSomething() {
          System.out.println("doSomething");
      }
  }
  public static void main(String[] args) {
      Singleton.INSTANCE.doSomething();
  }
  ```

  * é—®é¢˜1ï¼šæšä¸¾å•ä¾‹æ˜¯å¦‚ä½•é™åˆ¶å®ä¾‹ä¸ªæ•°çš„ï¼Ÿæ¯ä¸ªæšä¸¾é¡¹éƒ½æ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯ä¸€ä¸ªé™æ€æˆå‘˜å˜é‡
  * é—®é¢˜2ï¼šæšä¸¾å•ä¾‹åœ¨åˆ›å»ºæ—¶æ˜¯å¦æœ‰å¹¶å‘é—®é¢˜ï¼Ÿå¦
  * é—®é¢˜3ï¼šæšä¸¾å•ä¾‹èƒ½å¦è¢«åå°„ç ´åå•ä¾‹ï¼Ÿå¦ï¼Œåå°„åˆ›å»ºå¯¹è±¡æ—¶åˆ¤æ–­æ˜¯æšä¸¾ç±»å‹å°±ç›´æ¥æŠ›å‡ºå¼‚å¸¸
  * é—®é¢˜4ï¼šæšä¸¾å•ä¾‹èƒ½å¦è¢«ååºåˆ—åŒ–ç ´åå•ä¾‹ï¼Ÿå¦
  * é—®é¢˜5ï¼šæšä¸¾å•ä¾‹å±äºæ‡’æ±‰å¼è¿˜æ˜¯é¥¿æ±‰å¼ï¼Ÿ**é¥¿æ±‰å¼**
  * é—®é¢˜6ï¼šæšä¸¾å•ä¾‹å¦‚æœå¸Œæœ›åŠ å…¥ä¸€äº›å•ä¾‹åˆ›å»ºæ—¶çš„åˆå§‹åŒ–é€»è¾‘è¯¥å¦‚ä½•åšï¼Ÿæ·»åŠ æ„é€ æ–¹æ³•

  åç¼–è¯‘ç»“æœï¼š

  ```java
  public final class Singleton extends java.lang.Enum<Singleton> { // Enumå®ç°åºåˆ—åŒ–æ¥å£
  	public static final Singleton INSTANCE = new Singleton();
  }
  ```

  



***



#### æ‡’æ±‰å¼

* çº¿ç¨‹ä¸å®‰å…¨

  ```java
  public class Singleton {
      // ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
  
      // åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡
      private static Singleton instance;
  
      // å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          if(instance == null) {
              // å¤šçº¿ç¨‹ç¯å¢ƒï¼Œä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥è¿™é‡Œ
              instance = new Singleton();
          }
          return instance;
      }
  }
  ```

* åŒç«¯æ£€é”æœºåˆ¶

  åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°ç©ºæŒ‡é’ˆé—®é¢˜ï¼Œå‡ºç°é—®é¢˜çš„åŸå› æ˜¯ JVM åœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šè¿›è¡Œä¼˜åŒ–å’ŒæŒ‡ä»¤é‡æ’åºæ“ä½œï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ `volatile` å…³é”®å­—

  ```java
  public class Singleton { 
      // ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
      private static volatile Singleton instance;
  
      // å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          // ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå¦‚æœinstanceä¸ä¸ºnullï¼Œä¸è¿›å…¥æŠ¢é”é˜¶æ®µï¼Œç›´æ¥è¿”å›å®ä¾‹
          if(instance == null) {
              synchronized (Singleton.class) {
                  // æŠ¢åˆ°é”ä¹‹åå†æ¬¡åˆ¤æ–­æ˜¯å¦ä¸ºnull
                  if(instance == null) {
                      instance = new Singleton();
                  }
              }
          }
          return instance;
      }
  }
  ```

* é™æ€å†…éƒ¨ç±»æ–¹å¼

  ```java
  public class Singleton {
      // ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
  
      private static class SingletonHolder {
          private static final Singleton INSTANCE = new Singleton();
      }
  
      // å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          return SingletonHolder.INSTANCE;
      }
  }
  ```

  * å†…éƒ¨ç±»å±äºæ‡’æ±‰å¼ï¼Œç±»åŠ è½½æœ¬èº«å°±æ˜¯æ‡’æƒ°çš„ï¼Œé¦–æ¬¡è°ƒç”¨æ—¶åŠ è½½ï¼Œç„¶åå¯¹å•ä¾‹è¿›è¡Œåˆå§‹åŒ–

    ç±»åŠ è½½çš„æ—¶å€™æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ getInstance æ–¹æ³•è°ƒç”¨ invokestatic æŒ‡ä»¤å¯¹å†…éƒ¨ç±»è¿›è¡ŒåŠ è½½ï¼›åŠ è½½çš„æ—¶å€™å­—èŠ‚ç å¸¸é‡æ± ä¼šè¢«åŠ å…¥ç±»çš„è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œè§£æå·¥ä½œæ˜¯å°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨è§£ææˆç›´æ¥å¼•ç”¨ï¼Œä½†æ˜¯è§£æè¿‡ç¨‹ä¸ä¸€å®šéå¾—åœ¨ç±»åŠ è½½æ—¶å®Œæˆï¼Œå¯ä»¥å»¶è¿Ÿåˆ°è¿è¡Œæ—¶è¿›è¡Œï¼Œæ‰€ä»¥é™æ€å†…éƒ¨ç±»å®ç°å•ä¾‹ä¼š**å»¶è¿ŸåŠ è½½**

  * æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œé™æ€å˜é‡åˆå§‹åŒ–åœ¨ç±»åŠ è½½æ—¶å®Œæˆï¼Œç”± JVM ä¿è¯çº¿ç¨‹å®‰å…¨



***



#### ç ´åå•ä¾‹

##### ååºåˆ—åŒ–

å°†å•ä¾‹å¯¹è±¡åºåˆ—åŒ–å†ååºåˆ—åŒ–ï¼Œå¯¹è±¡ä»å†…å­˜ååºåˆ—åŒ–åˆ°ç¨‹åºä¸­ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡ååºåˆ—åŒ–å¾—åˆ°çš„å¯¹è±¡æ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œè€Œä¸”å¾—åˆ°çš„å¯¹è±¡ä¸æ˜¯é€šè¿‡æ„é€ å™¨å¾—åˆ°çš„ï¼Œ**ååºåˆ—åŒ–å¾—åˆ°çš„å¯¹è±¡ä¸æ‰§è¡Œæ„é€ å™¨**

* Singleton

  ```java
  public class Singleton implements Serializable {	//å®ç°åºåˆ—åŒ–æ¥å£
      // ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
      private static class SingletonHolder {
          private static final Singleton INSTANCE = new Singleton();
      }
  
      // å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          return SingletonHolder.INSTANCE;
      }
  }
  ```

* åºåˆ—åŒ–

  ```java
  public class Test {
      public static void main(String[] args) throws Exception {
          //å¾€æ–‡ä»¶ä¸­å†™å¯¹è±¡
          //writeObject2File();
          //ä»æ–‡ä»¶ä¸­è¯»å–å¯¹è±¡
          Singleton s1 = readObjectFromFile();
          Singleton s2 = readObjectFromFile();
          //åˆ¤æ–­ä¸¤ä¸ªååºåˆ—åŒ–åçš„å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡
          System.out.println(s1 == s2);
      }
  
      private static Singleton readObjectFromFile() throws Exception {
          //åˆ›å»ºå¯¹è±¡è¾“å…¥æµå¯¹è±¡
          ObjectInputStream ois = new ObjectInputStream(new FileInputStream("C://a.txt"));
          //ç¬¬ä¸€ä¸ªè¯»å–Singletonå¯¹è±¡
          Singleton instance = (Singleton) ois.readObject();
          return instance;
      }
      
      public static void writeObject2File() throws Exception {
          //è·å–Singletonç±»çš„å¯¹è±¡
          Singleton instance = Singleton.getInstance();
          //åˆ›å»ºå¯¹è±¡è¾“å‡ºæµ
          ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("C://a.txt"));
          //å°†instanceå¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­
          oos.writeObject(instance);
      }
  }
  ```

* è§£å†³æ–¹æ³•ï¼š

  åœ¨ Singleton ç±»ä¸­æ·»åŠ  `readResolve()` æ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–æ—¶è¢«åå°„è°ƒç”¨ï¼Œå¦‚æœå®šä¹‰äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°±è¿”å›è¿™ä¸ªæ–¹æ³•çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡

  ```java
  private Object readResolve() {
      return SingletonHolder.INSTANCE;
  }
  ```

  ObjectInputStream ç±»æºç åˆ†æï¼š

  ```java
  public final Object readObject() throws IOException, ClassNotFoundException{
      //...
  	Object obj = readObject0(false);//é‡ç‚¹æŸ¥çœ‹readObject0æ–¹æ³•
  }
  
  private Object readObject0(boolean unshared) throws IOException {
      try {
  		switch (tc) {
  			case TC_OBJECT:
  				return checkResolve(readOrdinaryObject(unshared));
          }
      } 
  }
  private Object readOrdinaryObject(boolean unshared) throws IOException {
  	// isInstantiable è¿”å›trueï¼Œæ‰§è¡Œ desc.newInstance()ï¼Œé€šè¿‡åå°„åˆ›å»ºæ–°çš„å•ä¾‹ç±»
      obj = desc.isInstantiable() ? desc.newInstance() : null; 
      // æ·»åŠ  readResolve æ–¹æ³•å desc.hasReadResolveMethod() æ–¹æ³•æ‰§è¡Œç»“æœä¸ºtrue
      if (obj != null && handles.lookupException(passHandle) == null && desc.hasReadResolveMethod()) {
      	// é€šè¿‡åå°„è°ƒç”¨ Singleton ç±»ä¸­çš„ readResolve æ–¹æ³•ï¼Œå°†è¿”å›å€¼èµ‹å€¼ç»™repå˜é‡
      	// å¤šæ¬¡è°ƒç”¨ObjectInputStreamç±»ä¸­çš„readObjectæ–¹æ³•ï¼Œæœ¬è´¨è°ƒç”¨å®šä¹‰çš„readResolveæ–¹æ³•ï¼Œè¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚
      	Object rep = desc.invokeReadResolve(obj);
      }
      return obj;
  }
  ```



***



##### åå°„ç ´è§£

* åå°„

  ```java
  public class Test {
      public static void main(String[] args) throws Exception {
          //è·å–Singletonç±»çš„å­—èŠ‚ç å¯¹è±¡
          Class clazz = Singleton.class;
          //è·å–Singletonç±»çš„ç§æœ‰æ— å‚æ„é€ æ–¹æ³•å¯¹è±¡
          Constructor constructor = clazz.getDeclaredConstructor();
          //å–æ¶ˆè®¿é—®æ£€æŸ¥
          constructor.setAccessible(true);
  
          //åˆ›å»ºSingletonç±»çš„å¯¹è±¡s1
          Singleton s1 = (Singleton) constructor.newInstance();
          //åˆ›å»ºSingletonç±»çš„å¯¹è±¡s2
          Singleton s2 = (Singleton) constructor.newInstance();
  
          //åˆ¤æ–­é€šè¿‡åå°„åˆ›å»ºçš„ä¸¤ä¸ªSingletonå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡
          System.out.println(s1 == s2);	//false
      }
  }
  ```

* åå°„æ–¹å¼ç ´è§£å•ä¾‹çš„è§£å†³æ–¹æ³•ï¼š

  ```java
  public class Singleton {
      private static volatile Singleton instance;
      
      // ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {
          // åå°„ç ´è§£å•ä¾‹æ¨¡å¼éœ€è¦æ·»åŠ çš„ä»£ç 
          if(instance != null) {
              throw new RuntimeException();
          }
      }
      
      // å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          if(instance != null) {
              return instance;
          }
          synchronized (Singleton.class) {
              if(instance != null) {
                  return instance;
              }
              instance = new Singleton();
              return instance;
          }
      }
  }
  ```





***



#### Runtime

Runtime ç±»å°±æ˜¯ä½¿ç”¨çš„å•ä¾‹è®¾è®¡æ¨¡å¼ä¸­çš„é¥¿æ±‰å¼

```java
public class Runtime {    
    private static Runtime currentRuntime = new Runtime();    
    public static Runtime getRuntime() {        
        return currentRuntime;    
    }   
    private Runtime() {}    
    ...
}
```

ä½¿ç”¨ Runtime

```java
public class RuntimeDemo {
    public static void main(String[] args) throws IOException {
        //è·å–Runtimeç±»å¯¹è±¡
        Runtime runtime = Runtime.getRuntime();

        //è¿”å› Java è™šæ‹Ÿæœºä¸­çš„å†…å­˜æ€»é‡ã€‚
        System.out.println(runtime.totalMemory());
        //è¿”å› Java è™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡ã€‚
        System.out.println(runtime.maxMemory());

        //åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æ‰§è¡ŒæŒ‡å®šçš„å­—ç¬¦ä¸²å‘½ä»¤ï¼Œè¿”å›è¿›ç¨‹å¯¹è±¡
        Process process = runtime.exec("ipconfig");
        //è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœï¼Œé€šè¿‡è¾“å…¥æµè·å–
        InputStream inputStream = process.getInputStream();
        byte[] arr = new byte[1024 * 1024* 100];
        int b = inputStream.read(arr);
        System.out.println(new String(arr,0,b,"gbk"));
    }
}
```





****



### ä»£ç†æ¨¡å¼

#### é™æ€ä»£ç†

ä»£ç†æ¨¡å¼ï¼šç”±äºæŸäº›åŸå› éœ€è¦ç»™æŸå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ä»¥æ§åˆ¶å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œè®¿é—®å¯¹è±¡ä¸é€‚åˆæˆ–è€…ä¸èƒ½ç›´æ¥å¼•ç”¨ä¸ºç›®æ ‡å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡ä½œä¸ºè®¿é—®å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´çš„ä¸­ä»‹

Java ä¸­çš„ä»£ç†æŒ‰ç…§ä»£ç†ç±»ç”Ÿæˆæ—¶æœºä¸åŒåˆåˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ï¼Œé™æ€ä»£ç†ä»£ç†ç±»åœ¨ç¼–è¯‘æœŸå°±ç”Ÿæˆï¼Œè€ŒåŠ¨æ€ä»£ç†ä»£ç†ç±»åˆ™æ˜¯åœ¨ Java è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆï¼ŒåŠ¨æ€ä»£ç†åˆæœ‰ JDK ä»£ç†å’Œ CGLib ä»£ç†ä¸¤ç§

ä»£ç†ï¼ˆProxyï¼‰æ¨¡å¼åˆ†ä¸ºä¸‰ç§è§’è‰²ï¼š

* æŠ½è±¡ä¸»é¢˜ï¼ˆSubjectï¼‰ç±»ï¼šé€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»å£°æ˜çœŸå®ä¸»é¢˜å’Œä»£ç†å¯¹è±¡å®ç°çš„ä¸šåŠ¡æ–¹æ³•
* çœŸå®ä¸»é¢˜ï¼ˆReal Subjectï¼‰ç±»ï¼š å®ç°äº†æŠ½è±¡ä¸»é¢˜ä¸­çš„å…·ä½“ä¸šåŠ¡ï¼Œæ˜¯ä»£ç†å¯¹è±¡æ‰€ä»£è¡¨çš„çœŸå®å¯¹è±¡ï¼Œæ˜¯æœ€ç»ˆè¦å¼•ç”¨çš„å¯¹è±¡
* ä»£ç†ï¼ˆProxyï¼‰ç±»ï¼šæä¾›äº†ä¸çœŸå®ä¸»é¢˜ç›¸åŒçš„æ¥å£ï¼Œå…¶å†…éƒ¨å«æœ‰å¯¹çœŸå®ä¸»é¢˜çš„å¼•ç”¨ï¼Œå¯ä»¥è®¿é—®ã€æ§åˆ¶æˆ–æ‰©å±•çœŸå®ä¸»é¢˜çš„åŠŸèƒ½

ä¹°ç¥¨æ¡ˆä¾‹ï¼Œç«è½¦ç«™æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œä»£å”®ç‚¹æ˜¯ä»£ç†å¯¹è±¡

* å–ç¥¨æ¥å£ï¼š

  ```java
  public interface SellTickets {
      void sell();
  }
  ```

* ç«è½¦ç«™ï¼Œå…·æœ‰å–ç¥¨åŠŸèƒ½ï¼Œéœ€è¦å®ç°SellTicketsæ¥å£

  ```java
  public class TrainStation implements SellTickets {
      public void sell() {
          System.out.println("ç«è½¦ç«™å–ç¥¨");
      }
  }
  ```

* ä»£å”®ç‚¹ï¼š

  ```java
  public class ProxyPoint implements SellTickets {
      private TrainStation station = new TrainStation();
  
      public void sell() {
          System.out.println("ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨");
          station.sell();
      }
  }
  ```

* æµ‹è¯•ç±»ï¼š

  ```java
  public class Client {
      public static void main(String[] args) {
          ProxyPoint pp = new ProxyPoint();
          pp.sell();
      }
  }
  ```

  æµ‹è¯•ç±»ç›´æ¥è®¿é—®çš„æ˜¯ ProxyPoint ç±»å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ ProxyPoint ä½œä¸ºè®¿é—®å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡çš„ä¸­ä»‹



****



#### JDK

##### ä½¿ç”¨æ–¹å¼

Java ä¸­æä¾›äº†ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±» Proxyï¼ŒProxy å¹¶ä¸æ˜¯ä»£ç†å¯¹è±¡çš„ç±»ï¼Œè€Œæ˜¯æä¾›äº†ä¸€ä¸ªåˆ›å»ºä»£ç†å¯¹è±¡çš„é™æ€æ–¹æ³• newProxyInstance() æ¥è·å–ä»£ç†å¯¹è±¡

`static Object newProxyInstance(ClassLoader loader,Class[] interfaces,InvocationHandler h) `

* å‚æ•°ä¸€ï¼šç±»åŠ è½½å™¨ï¼Œè´Ÿè´£åŠ è½½ä»£ç†ç±»ã€‚ä¼ å…¥ç±»åŠ è½½å™¨ï¼Œä»£ç†å’Œè¢«ä»£ç†å¯¹è±¡è¦ç”¨ä¸€ä¸ªç±»åŠ è½½å™¨æ‰æ˜¯çˆ¶å­å…³ç³»ï¼Œä¸åŒç±»åŠ è½½å™¨åŠ è½½ç›¸åŒçš„ç±»åœ¨ JVM ä¸­éƒ½ä¸æ˜¯åŒä¸€ä¸ªç±»å¯¹è±¡

* å‚æ•°äºŒï¼šè¢«ä»£ç†ä¸šåŠ¡å¯¹è±¡çš„**å…¨éƒ¨å®ç°çš„æ¥å£**ï¼Œä»£ç†å¯¹è±¡ä¸çœŸå®å¯¹è±¡å®ç°ç›¸åŒæ¥å£ï¼ŒçŸ¥é“ä¸ºå“ªäº›æ–¹æ³•åšä»£ç†

* å‚æ•°ä¸‰ï¼šä»£ç†çœŸæ­£çš„æ‰§è¡Œæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä»£ç†çš„å¤„ç†é€»è¾‘

ä»£ç å®ç°ï¼š

* ä»£ç†å·¥å‚ï¼šåˆ›å»ºä»£ç†å¯¹è±¡

  ```java
  public class ProxyFactory {
      private TrainStation station = new TrainStation();
  	//ä¹Ÿå¯ä»¥åœ¨å‚æ•°ä¸­æä¾› getProxyObject(TrainStation station)
      public SellTickets getProxyObject() {
          //ä½¿ç”¨ Proxy è·å–ä»£ç†å¯¹è±¡
          SellTickets sellTickets = (SellTickets) Proxy.newProxyInstance(
              	station.getClass().getClassLoader(),
                  station.getClass().getInterfaces(),
                  new InvocationHandler() {
                      public Object invoke(Object proxy, Method method, Object[] args) {
                          System.out.println("ä»£ç†ç‚¹(JDKåŠ¨æ€ä»£ç†æ–¹å¼)");
                          //æ‰§è¡ŒçœŸå®å¯¹è±¡
                          Object result = method.invoke(station, args);
                          return result;
                      }
                  });
          return sellTickets;
      }
  }
  ```

* æµ‹è¯•ç±»ï¼š

  ```java
  public class Client {
      public static void main(String[] args) {
          //è·å–ä»£ç†å¯¹è±¡
          ProxyFactory factory = new ProxyFactory();
          //å¿…é¡»æ—¶ä»£ç†ji
          SellTickets proxyObject = factory.getProxyObject();
          proxyObject.sell();
      }
  }
  ```



***



##### å®ç°åŸç†

JDK åŠ¨æ€ä»£ç†æ–¹å¼çš„ä¼˜ç¼ºç‚¹ï¼š

- ä¼˜ç‚¹ï¼šå¯ä»¥ä¸ºä»»æ„çš„æ¥å£å®ç°ç±»å¯¹è±¡åšä»£ç†ï¼Œä¹Ÿå¯ä»¥ä¸ºè¢«ä»£ç†å¯¹è±¡çš„æ‰€æœ‰æ¥å£çš„æ‰€æœ‰æ–¹æ³•åšä»£ç†ï¼ŒåŠ¨æ€ä»£ç†å¯ä»¥åœ¨ä¸æ”¹å˜æ–¹æ³•æºç çš„æƒ…å†µä¸‹ï¼Œå®ç°å¯¹æ–¹æ³•åŠŸèƒ½çš„å¢å¼ºï¼Œæé«˜äº†è½¯ä»¶çš„å¯æ‰©å±•æ€§ï¼ŒJava åå°„æœºåˆ¶å¯ä»¥ç”Ÿæˆä»»æ„ç±»å‹çš„åŠ¨æ€ä»£ç†ç±»
- ç¼ºç‚¹ï¼š**åªèƒ½é’ˆå¯¹æ¥å£æˆ–è€…æ¥å£çš„å®ç°ç±»å¯¹è±¡åšä»£ç†å¯¹è±¡**ï¼Œæ™®é€šç±»æ˜¯ä¸èƒ½åšä»£ç†å¯¹è±¡çš„
- åŸå› ï¼š**ç”Ÿæˆçš„ä»£ç†ç±»ç»§æ‰¿äº† Proxy**ï¼ŒJava æ˜¯å•ç»§æ‰¿çš„ï¼Œæ‰€ä»¥ JDK åŠ¨æ€ä»£ç†åªèƒ½ä»£ç†æ¥å£

ProxyFactory ä¸æ˜¯ä»£ç†æ¨¡å¼ä¸­çš„ä»£ç†ç±»ï¼Œè€Œä»£ç†ç±»æ˜¯ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€çš„åœ¨å†…å­˜ä¸­ç”Ÿæˆçš„ç±»ï¼Œå¯ä»¥é€šè¿‡ Arthas å·¥å…·æŸ¥çœ‹ä»£ç†ç±»ç»“æ„ï¼š

* ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰å®ç°äº† SellTickets æ¥å£ï¼ŒçœŸå®ç±»å’Œä»£ç†ç±»å®ç°åŒæ ·çš„æ¥å£
* ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰å°†æä¾›äº†çš„åŒ¿åå†…éƒ¨ç±»å¯¹è±¡ä¼ é€’ç»™äº†çˆ¶ç±»
* ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰çš„ä¿®é¥°ç¬¦æ˜¯ public final

```java
// ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»
public final class $Proxy0 extends Proxy implements SellTickets {
    private static Method m3;

    public $Proxy0(InvocationHandler invocationHandler) {
        super(invocationHandler);//InvocationHandlerå¯¹è±¡ä¼ é€’ç»™çˆ¶ç±»
    }

    static {
        m3 = Class.forName("proxy.dynamic.jdk.SellTickets").getMethod("sell", new Class[0]);
    }

    public final void sell() {
        // è°ƒç”¨InvocationHandlerçš„invokeæ–¹æ³•
        this.h.invoke(this, m3, null);
    }
}

// Javaæä¾›çš„åŠ¨æ€ä»£ç†ç›¸å…³ç±»
public class Proxy implements java.io.Serializable {
	protected InvocationHandler h;
	 
	protected Proxy(InvocationHandler h) {
        this.h = h;
    }
}
```

æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š

1. åœ¨æµ‹è¯•ç±»ä¸­é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ sell() æ–¹æ³•
2. æ ¹æ®å¤šæ€çš„ç‰¹æ€§ï¼Œæ‰§è¡Œçš„æ˜¯ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„ sell() æ–¹æ³•
3. ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„ sell() æ–¹æ³•ä¸­åˆè°ƒç”¨äº† InvocationHandler æ¥å£çš„å­å®ç°ç±»å¯¹è±¡çš„ invoke æ–¹æ³•
4. invoke æ–¹æ³•é€šè¿‡åå°„æ‰§è¡Œäº†çœŸå®å¯¹è±¡æ‰€å±ç±»ï¼ˆTrainStationï¼‰ä¸­çš„ sell() æ–¹æ³•



****



##### æºç è§£æ

```java
public static Object newProxyInstance(ClassLoader loader,
                                      Class<?>[] interfaces,
                                      InvocationHandler h){
    // InvocationHandler ä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸
    Objects.requireNonNull(h);

    // å¤åˆ¶ä¸€ä»½ interfaces
    final Class<?>[] intfs = interfaces.clone();
    final SecurityManager sm = System.getSecurityManager();
    if (sm != null) {
        checkProxyAccess(Reflection.getCallerClass(), loader, intfs);
    }

    // ä»ç¼“å­˜ä¸­æŸ¥æ‰¾ class ç±»å‹çš„ä»£ç†å¯¹è±¡ï¼Œä¼šè°ƒç”¨ ProxyClassFactory#apply æ–¹æ³•
    Class<?> cl = getProxyClass0(loader, intfs);
	//proxyClassCache = new WeakCache<>(new KeyFactory(), new ProxyClassFactory())
 
    try {
        if (sm != null) {
            checkNewProxyPermission(Reflection.getCallerClass(), cl);
        }

        // è·å–ä»£ç†ç±»çš„æ„é€ æ–¹æ³•ï¼Œæ ¹æ®å‚æ•° InvocationHandler åŒ¹é…è·å–æŸä¸ªæ„é€ å™¨
        final Constructor<?> cons = cl.getConstructor(constructorParams);
        final InvocationHandler ih = h;
        // æ„é€ æ–¹æ³•ä¸æ˜¯ pubic çš„éœ€è¦å¯ç”¨æƒé™ï¼Œæš´åŠ›p
        if (!Modifier.isPublic(cl.getModifiers())) {
            AccessController.doPrivileged(new PrivilegedAction<Void>() {
                public Void run() {
                    // è®¾ç½®å¯è®¿é—®çš„æƒé™
                    cons.setAccessible(true);
                    return null;
                }
            });
        }
       	// cons æ˜¯æ„é€ æ–¹æ³•ï¼Œå¹¶ä¸”å†…éƒ¨æŒæœ‰ InvocationHandlerï¼Œåœ¨ InvocationHandler ä¸­æŒæœ‰ target ç›®æ ‡å¯¹è±¡
        return cons.newInstance(new Object[]{h});
    } catch (IllegalAccessException|InstantiationException e) {}
}
```

Proxy çš„é™æ€å†…éƒ¨ç±»ï¼š

```java
private static final class ProxyClassFactory {
    // ä»£ç†ç±»å‹çš„åç§°å‰ç¼€
    private static final String proxyClassNamePrefix = "$Proxy";

    // ç”Ÿæˆå”¯ä¸€æ•°å­—ä½¿ç”¨ï¼Œç»“åˆä¸Šé¢çš„ä»£ç†ç±»å‹åç§°å‰ç¼€ä¸€èµ·ç”Ÿæˆ
    private static final AtomicLong nextUniqueNumber = new AtomicLong();

	//å‚æ•°ä¸€ï¼šProxy.newInstance æ—¶ä¼ é€’çš„
    //å‚æ•°äºŒï¼šProxy.newInstance æ—¶ä¼ é€’çš„æ¥å£é›†åˆ
    @Override
    public Class<?> apply(ClassLoader loader, Class<?>[] interfaces) {
		
        Map<Class<?>, Boolean> interfaceSet = new IdentityHashMap<>(interfaces.length);
        // éå†æ¥å£é›†åˆ
        for (Class<?> intf : interfaces) {
            Class<?> interfaceClass = null;
            try {
                // åŠ è½½æ¥å£ç±»åˆ° JVM
                interfaceClass = Class.forName(intf.getName(), false, loader);
            } catch (ClassNotFoundException e) {
            }
            if (interfaceClass != intf) {
                throw new IllegalArgumentException(
                    intf + " is not visible from class loader");
            }
            // å¦‚æœ interfaceClass ä¸æ˜¯æ¥å£ ç›´æ¥æŠ¥é”™ï¼Œä¿è¯é›†åˆå†…éƒ½æ˜¯æ¥å£
            if (!interfaceClass.isInterface()) {
                throw new IllegalArgumentException(
                    interfaceClass.getName() + " is not an interface");
            }
            // ä¿è¯æ¥å£ interfaces é›†åˆä¸­æ²¡æœ‰é‡å¤çš„æ¥å£
            if (interfaceSet.put(interfaceClass, Boolean.TRUE) != null) {
                throw new IllegalArgumentException(
                    "repeated interface: " + interfaceClass.getName());
            }
        }

        // ç”Ÿæˆçš„ä»£ç†ç±»çš„åŒ…å
        String proxyPkg = null;   
        // ã€ç”Ÿæˆçš„ä»£ç†ç±»è®¿é—®ä¿®é¥°ç¬¦ public finalã€‘ 
        int accessFlags = Modifier.PUBLIC | Modifier.FINAL;

        // æ£€æŸ¥æ¥å£é›†åˆå†…çš„æ¥å£ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æŸä¸ªæ¥å£çš„è®¿é—®ä¿®é¥°ç¬¦ä¸æ˜¯ public çš„  å¦‚æœä¸æ˜¯ public çš„æ¥å£ï¼Œ
        // ç”Ÿæˆçš„ä»£ç†ç±» class å°±å¿…é¡»å’Œå®ƒåœ¨ä¸€ä¸ªåŒ…ä¸‹ï¼Œå¦åˆ™è®¿é—®å‡ºç°é—®é¢˜
        for (Class<?> intf : interfaces) {
            // è·å–è®¿é—®ä¿®é¥°ç¬¦
            int flags = intf.getModifiers();
            if (!Modifier.isPublic(flags)) {
                accessFlags = Modifier.FINAL;
                // è·å–å½“å‰æ¥å£çš„å…¨é™å®šå åŒ…å.ç±»å
                String name = intf.getName();
                int n = name.lastIndexOf('.');
                // è·å–åŒ…å
                String pkg = ((n == -1) ? "" : name.substring(0, n + 1));
                if (proxyPkg == null) {
                    proxyPkg = pkg;
                } else if (!pkg.equals(proxyPkg)) {
                    throw new IllegalArgumentException(
                        "non-public interfaces from different packages");
                }
            }
        }

        if (proxyPkg == null) {
            // if no non-public proxy interfaces, use com.sun.proxy package
            proxyPkg = ReflectUtil.PROXY_PACKAGE + ".";
        }

        // è·å–å”¯ä¸€çš„ç¼–å·
        long num = nextUniqueNumber.getAndIncrement();
        // åŒ…å+ $proxy + æ•°å­—ï¼Œæ¯”å¦‚ $proxy1
        String proxyName = proxyPkg + proxyClassNamePrefix + num;

        // ã€ç”ŸæˆäºŒè¿›åˆ¶å­—èŠ‚ç ï¼Œè¿™ä¸ªå­—èŠ‚ç å†™å…¥åˆ°æ–‡ä»¶å†…ã€‘ï¼Œå°±æ˜¯ç¼–è¯‘å¥½çš„ class æ–‡ä»¶
        byte[] proxyClassFile = ProxyGenerator.generateProxyClass(proxyName, interfaces, accessFlags);
        try {
            // ã€ä½¿ç”¨åŠ è½½å™¨åŠ è½½äºŒè¿›åˆ¶åˆ° jvmã€‘ï¼Œå¹¶ä¸”è¿”å› class
            return defineClass0(loader, proxyName, proxyClassFile, 0, proxyClassFile.length);
        } catch (ClassFormatError e) { }
    }
}
```





***



#### CGLIB

CGLIB æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ï¼Œé«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…ï¼Œä¸ºæ²¡æœ‰å®ç°æ¥å£çš„ç±»æä¾›ä»£ç†ï¼Œä¸º JDK åŠ¨æ€ä»£ç†æä¾›äº†è¡¥å……ï¼ˆ$$Proxyï¼‰

* CGLIB æ˜¯ç¬¬ä¸‰æ–¹æä¾›çš„åŒ…ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ jar åŒ…çš„åæ ‡ï¼š

  ```xml
  <dependency>
      <groupId>cglib</groupId>
      <artifactId>cglib</artifactId>
      <version>2.2.2</version>
  </dependency>
  ```

* ä»£ç†å·¥å‚ç±»ï¼š

  ```java
  public class ProxyFactory implements MethodInterceptor {
      private TrainStation target = new TrainStation();
  
      public TrainStation getProxyObject() {
          //åˆ›å»ºEnhancerå¯¹è±¡ï¼Œç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†çš„Proxyç±»ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è®¾ç½®å‡ ä¸ªå‚æ•°
          Enhancer enhancer = new Enhancer();
          //è®¾ç½®çˆ¶ç±»çš„å­—èŠ‚ç å¯¹è±¡
          enhancer.setSuperclass(target.getClass());
          //è®¾ç½®å›è°ƒå‡½æ•°
          enhancer.setCallback(new MethodInterceptor() {
              @Override
              public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable {
  				System.out.println("ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨(CGLIBåŠ¨æ€ä»£ç†æ–¹å¼)");
          		Object o = methodProxy.invokeSuper(obj, args);
          		return null;//å› ä¸ºè¿”å›å€¼ä¸ºvoid
              }
          });
          //åˆ›å»ºä»£ç†å¯¹è±¡
          TrainStation obj = (TrainStation) enhancer.create();
          return obj;
      }
  }
  ```

CGLIB çš„ä¼˜ç¼ºç‚¹

* ä¼˜ç‚¹ï¼š
  * CGLIB åŠ¨æ€ä»£ç†**ä¸é™å®š**æ˜¯å¦å…·æœ‰æ¥å£ï¼Œå¯ä»¥å¯¹ä»»æ„æ“ä½œè¿›è¡Œå¢å¼º
  * CGLIB åŠ¨æ€ä»£ç†æ— éœ€è¦åŸå§‹è¢«ä»£ç†å¯¹è±¡ï¼ŒåŠ¨æ€åˆ›å»ºå‡ºæ–°çš„ä»£ç†å¯¹è±¡
  * **JDKProxy ä»…å¯¹æ¥å£æ–¹æ³•åšå¢å¼ºï¼ŒCGLIB å¯¹æ‰€æœ‰æ–¹æ³•åšå¢å¼º**ï¼ŒåŒ…æ‹¬ Object ç±»ä¸­çš„æ–¹æ³•ï¼ŒtoStringã€hashCode ç­‰
* ç¼ºç‚¹ï¼šCGLIB ä¸èƒ½å¯¹å£°æ˜ä¸º final çš„ç±»æˆ–è€…æ–¹æ³•è¿›è¡Œä»£ç†ï¼Œå› ä¸º CGLIB åŸç†æ˜¯**åŠ¨æ€ç”Ÿæˆè¢«ä»£ç†ç±»çš„å­ç±»ï¼Œç»§æ‰¿è¢«ä»£ç†ç±»**





****



#### æ–¹å¼å¯¹æ¯”

ä¸‰ç§æ–¹å¼å¯¹æ¯”ï¼š

* åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†ï¼š

  * åŠ¨æ€ä»£ç†å°†æ¥å£ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•éƒ½è¢«è½¬ç§»åˆ°ä¸€ä¸ªé›†ä¸­çš„æ–¹æ³•ä¸­å¤„ç†ï¼ˆInvocationHandler.invokeï¼‰ï¼Œåœ¨æ¥å£æ–¹æ³•æ•°é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œå¯ä»¥è¿›è¡Œçµæ´»å¤„ç†ï¼Œä¸éœ€è¦åƒé™æ€ä»£ç†é‚£æ ·æ¯ä¸€ä¸ªæ–¹æ³•è¿›è¡Œä¸­è½¬

  * é™æ€ä»£ç†æ˜¯åœ¨ç¼–è¯‘æ—¶å°±å·²ç»å°†æ¥å£ã€ä»£ç†ç±»ã€è¢«ä»£ç†ç±»çš„å­—èŠ‚ç æ–‡ä»¶ç¡®å®šä¸‹æ¥
  * åŠ¨æ€ä»£ç†æ˜¯ç¨‹åº**åœ¨è¿è¡Œåé€šè¿‡åå°„åˆ›å»ºå­—èŠ‚ç æ–‡ä»¶**äº¤ç”± JVM åŠ è½½

* JDK ä»£ç†å’Œ CGLIB ä»£ç†ï¼š

  JDK åŠ¨æ€ä»£ç†é‡‡ç”¨ `ProxyGenerator.generateProxyClass()` æ–¹æ³•åœ¨è¿è¡Œæ—¶ç”Ÿæˆå­—èŠ‚ç ï¼›CGLIB åº•å±‚é‡‡ç”¨ ASM å­—èŠ‚ç ç”Ÿæˆæ¡†æ¶ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯ç”Ÿæˆä»£ç†ç±»ã€‚åœ¨ JDK1.6ä¹‹å‰æ¯”ä½¿ç”¨ Java åå°„æ•ˆç‡è¦é«˜ï¼Œåˆ° JDK1.8 çš„æ—¶å€™ï¼ŒJDK ä»£ç†æ•ˆç‡é«˜äº CGLIB ä»£ç†ã€‚æ‰€ä»¥å¦‚æœæœ‰æ¥å£æˆ–è€…å½“å‰ç±»å°±æ˜¯æ¥å£ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå¦‚æœæ²¡æœ‰æ¥å£ä½¿ç”¨ CGLIB ä»£ç†

ä»£ç†æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ï¼š

* ä¼˜ç‚¹ï¼š
  * ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨å’Œä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨
  * **ä»£ç†å¯¹è±¡å¯ä»¥å¢å¼ºç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼Œè¢«ç”¨æ¥é—´æ¥è®¿é—®åº•å±‚å¯¹è±¡ï¼Œä¸åŸå§‹å¯¹è±¡å…·æœ‰ç›¸åŒçš„ hashCode**
  * ä»£ç†æ¨¡å¼èƒ½å°†å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡åˆ†ç¦»ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦

* ç¼ºç‚¹ï¼šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦

ä»£ç†æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯ï¼š

* è¿œç¨‹ï¼ˆRemoteï¼‰ä»£ç†ï¼šæœ¬åœ°æœåŠ¡é€šè¿‡ç½‘ç»œè¯·æ±‚è¿œç¨‹æœåŠ¡ï¼Œéœ€è¦å®ç°ç½‘ç»œé€šä¿¡ï¼Œå¤„ç†å…¶ä¸­å¯èƒ½çš„å¼‚å¸¸ã€‚ä¸ºäº†è‰¯å¥½çš„ä»£ç è®¾è®¡å’Œå¯ç»´æŠ¤æ€§ï¼Œå°†ç½‘ç»œé€šä¿¡éƒ¨åˆ†éšè—èµ·æ¥ï¼Œåªæš´éœ²ç»™æœ¬åœ°æœåŠ¡ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡è¯¥æ¥å£å³å¯è®¿é—®è¿œç¨‹æœåŠ¡æä¾›çš„åŠŸèƒ½

* é˜²ç«å¢™ï¼ˆFirewallï¼‰ä»£ç†ï¼šå½“ä½ å°†æµè§ˆå™¨é…ç½®æˆä½¿ç”¨ä»£ç†åŠŸèƒ½æ—¶ï¼Œé˜²ç«å¢™å°±å°†ä½ çš„æµè§ˆå™¨çš„è¯·æ±‚è½¬ç»™äº’è”ç½‘ï¼Œå½“äº’è”ç½‘è¿”å›å“åº”æ—¶ï¼Œä»£ç†æœåŠ¡å™¨å†æŠŠå®ƒè½¬ç»™ä½ çš„æµè§ˆå™¨

* ä¿æŠ¤ï¼ˆProtect or Accessï¼‰ä»£ç†ï¼šæ§åˆ¶å¯¹ä¸€ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ç»™ä¸åŒçš„ç”¨æˆ·æä¾›ä¸åŒçº§åˆ«çš„ä½¿ç”¨æƒé™

***